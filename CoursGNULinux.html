
<!DOCTYPE html>

<html lang="fr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>1 Formation à GNU/Linux &#8212; Documentation CoursGnuLinux 1.9.1</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/translations.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Recherche" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="formation-a-gnu-linux">
<h1><a class="toc-backref" href="#id36"><span class="sectnum">1</span> Formation à GNU/Linux</a><a class="headerlink" href="#formation-a-gnu-linux" title="Lien permanent vers ce titre">¶</a></h1>
<dl class="field-list simple">
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Michaël Launay &lt;<a class="reference external" href="mailto:michaellaunay&#37;&#52;&#48;ecreall&#46;com">michaellaunay<span>&#64;</span>ecreall<span>&#46;</span>com</a>&gt;</p>
</dd>
<dt class="field-even">version</dt>
<dd class="field-even"><p>1.9.1</p>
</dd>
<dt class="field-odd">licence</dt>
<dd class="field-odd"><p>Cette création est mise à disposition selon le Contrat Paternité 2.0 France disponible en ligne <a class="reference external" href="http://creativecommons.org/licenses/by/2.0/fr/">http://creativecommons.org/licenses/by/2.0/fr/</a> ou par courrier postal à Creative Commons, 171 Second Street, Suite 300, San Francisco, California 94105, USA.</p>
</dd>
</dl>
<div class="contents topic" id="sommaire">
<p class="topic-title">Sommaire</p>
<ul class="auto-toc simple">
<li><p><a class="reference internal" href="#formation-a-gnu-linux" id="id36"><span class="sectnum">1</span> Formation à GNU/Linux</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#objectif" id="id37"><span class="sectnum">1.1</span> Objectif</a></p></li>
<li><p><a class="reference internal" href="#introduction" id="id38"><span class="sectnum">1.2</span> Introduction</a></p></li>
<li><p><a class="reference internal" href="#historique" id="id39"><span class="sectnum">1.3</span> Historique</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#unix-les-racines" id="id40"><span class="sectnum">1.3.1</span> UNIX (les racines)</a></p></li>
<li><p><a class="reference internal" href="#la-licence-bsd-versus-la-licence-gpl" id="id41"><span class="sectnum">1.3.2</span> La licence BSD versus la licence GPL</a></p></li>
<li><p><a class="reference internal" href="#la-licence-gpl" id="id42"><span class="sectnum">1.3.3</span> La licence GPL</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#le-gauche-d-auteur" id="id43"><span class="sectnum">1.3.3.1</span> Le gauche d’auteur</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#la-licence-bsd" id="id44"><span class="sectnum">1.3.4</span> La licence BSD</a></p></li>
<li><p><a class="reference internal" href="#gnu-linux" id="id45"><span class="sectnum">1.3.5</span> GNU/Linux</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#les-distributions" id="id46"><span class="sectnum">1.4</span> Les distributions</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#qu-est-ce-qu-un-noyau" id="id47"><span class="sectnum">1.4.1</span> Qu’est-ce qu’un noyau ?</a></p></li>
<li><p><a class="reference internal" href="#qu-est-ce-qu-une-distribution" id="id48"><span class="sectnum">1.4.2</span> Qu’est-ce qu’une distribution ?</a></p></li>
<li><p><a class="reference internal" href="#les-differentes-distributions-gnu-linux" id="id49"><span class="sectnum">1.4.3</span> Les différentes distributions GNU/Linux</a></p></li>
<li><p><a class="reference internal" href="#les-principales-distributions" id="id50"><span class="sectnum">1.4.4</span> Les principales distributions</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#installation" id="id51"><span class="sectnum">1.5</span> Installation</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#installation-de-gnu-linux-ubuntu-version-pc-de-bureau" id="id52"><span class="sectnum">1.5.1</span> Installation de GNU/Linux Ubuntu version pc de bureau</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#installation-d-ubuntu-20-04" id="id53"><span class="sectnum">1.5.1.1</span> Installation d’Ubuntu 20.04</a></p></li>
<li><p><a class="reference internal" href="#etape-01" id="id54"><span class="sectnum">1.5.1.2</span> Étape 01</a></p></li>
<li><p><a class="reference internal" href="#etape-02" id="id55"><span class="sectnum">1.5.1.3</span> Étape 02</a></p></li>
<li><p><a class="reference internal" href="#etape-03" id="id56"><span class="sectnum">1.5.1.4</span> Étape 03</a></p></li>
<li><p><a class="reference internal" href="#etape-04" id="id57"><span class="sectnum">1.5.1.5</span> Étape 04</a></p></li>
<li><p><a class="reference internal" href="#etape-05" id="id58"><span class="sectnum">1.5.1.6</span> Étape 05</a></p></li>
<li><p><a class="reference internal" href="#etape-06" id="id59"><span class="sectnum">1.5.1.7</span> Étape 06</a></p></li>
<li><p><a class="reference internal" href="#etape-07" id="id60"><span class="sectnum">1.5.1.8</span> Étape 07</a></p></li>
<li><p><a class="reference internal" href="#etape-08" id="id61"><span class="sectnum">1.5.1.9</span> Étape 08</a></p></li>
<li><p><a class="reference internal" href="#etape-alternative-04-bis" id="id62"><span class="sectnum">1.5.1.10</span> Étape alternative 04 bis</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#installation-de-gnu-linux-ubuntu-en-version-serveur" id="id63"><span class="sectnum">1.5.2</span> Installation de GNU/Linux Ubuntu en version serveur</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#attention" id="id64"><span class="sectnum">1.5.2.1</span> Attention</a></p></li>
<li><p><a class="reference internal" href="#travaux-pratiques" id="id65"><span class="sectnum">1.5.2.2</span> Travaux pratiques</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#utilisation-de-gnu-linux" id="id66"><span class="sectnum">1.5.3</span> Utilisation de GNU/Linux</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#l-aide-et-la-communaute" id="id67"><span class="sectnum">1.6</span> L’aide et la communauté</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#l-aide-en-ligne" id="id68"><span class="sectnum">1.6.1</span> L’aide en ligne</a></p></li>
<li><p><a class="reference internal" href="#les-man-pages" id="id69"><span class="sectnum">1.6.2</span> Les man pages</a></p></li>
<li><p><a class="reference internal" href="#les-sites" id="id70"><span class="sectnum">1.6.3</span> Les sites</a></p></li>
<li><p><a class="reference internal" href="#les-forums" id="id71"><span class="sectnum">1.6.4</span> Les forums</a></p></li>
<li><p><a class="reference internal" href="#les-lugs" id="id72"><span class="sectnum">1.6.5</span> Les LUGs</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#shell-commandes" id="id73"><span class="sectnum">1.7</span> Shell &amp; Commandes</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#les-terminaux-tty" id="id74"><span class="sectnum">1.7.1</span> Les terminaux (tty)</a></p></li>
<li><p><a class="reference internal" href="#la-ligne-de-commande" id="id75"><span class="sectnum">1.7.2</span> La ligne de commande</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#les-differents-shell" id="id76"><span class="sectnum">1.7.2.1</span> Les différents shell</a></p></li>
<li><p><a class="reference internal" href="#les-fichiers-de-ressources-et-de-configuration-de-bash" id="id77"><span class="sectnum">1.7.2.2</span> Les fichiers de ressources et de configuration de bash</a></p></li>
<li><p><a class="reference internal" href="#les-variables-d-environnement" id="id78"><span class="sectnum">1.7.2.3</span> Les variables d’environnement</a></p></li>
<li><p><a class="reference internal" href="#les-caracteres-speciaux" id="id79"><span class="sectnum">1.7.2.4</span> Les caractères spéciaux</a></p></li>
<li><p><a class="reference internal" href="#variables-speciales" id="id80"><span class="sectnum">1.7.2.5</span> Variables spéciales</a></p></li>
<li><p><a class="reference internal" href="#creation-affectation-de-variable" id="id81"><span class="sectnum">1.7.2.6</span> Création, affectation de variable</a></p></li>
<li><p><a class="reference internal" href="#protection-des-espaces-des-valeurs-des-variables" id="id82"><span class="sectnum">1.7.2.7</span> Protection des espaces des valeurs des variables</a></p></li>
<li><p><a class="reference internal" href="#evaluation-d-une-variable" id="id83"><span class="sectnum">1.7.2.8</span> Évaluation d’une variable</a></p></li>
<li><p><a class="reference internal" href="#export-de-variable" id="id84"><span class="sectnum">1.7.2.9</span> Export de variable</a></p></li>
<li><p><a class="reference internal" href="#les-tests-d-expressions-et-fichier-operateurs-de-controle" id="id85"><span class="sectnum">1.7.2.10</span> Les tests d’expressions et fichier, opérateurs de contrôle</a></p></li>
<li><p><a class="reference internal" href="#execution-d-operations-arithmetiques" id="id86"><span class="sectnum">1.7.2.11</span> Exécution d’opérations arithmétiques</a></p></li>
<li><p><a class="reference internal" href="#la-boucle-while-et-until" id="id87"><span class="sectnum">1.7.2.12</span> La boucle while et until</a></p></li>
<li><p><a class="reference internal" href="#la-boucle-for" id="id88"><span class="sectnum">1.7.2.13</span> La boucle for</a></p></li>
<li><p><a class="reference internal" href="#le-choix-multiple-case" id="id89"><span class="sectnum">1.7.2.14</span> Le choix multiple (case)</a></p></li>
<li><p><a class="reference internal" href="#les-operateurs-et" id="id90"><span class="sectnum">1.7.2.15</span> Les opérateurs &amp;&amp; et ||</a></p></li>
<li><p><a class="reference internal" href="#la-commande-trap" id="id91"><span class="sectnum">1.7.2.16</span> La commande trap</a></p></li>
<li><p><a class="reference internal" href="#la-commande-sed" id="id92"><span class="sectnum">1.7.2.17</span> La commande sed</a></p></li>
<li><p><a class="reference internal" href="#l-expansion-de-parametre" id="id93"><span class="sectnum">1.7.2.18</span> L’expansion de paramètre</a></p></li>
<li><p><a class="reference internal" href="#les-scripts" id="id94"><span class="sectnum">1.7.2.19</span> Les scripts</a></p></li>
<li><p><a class="reference internal" href="#les-fonctions" id="id95"><span class="sectnum">1.7.2.20</span> Les fonctions</a></p></li>
<li><p><a class="reference internal" href="#lecture-des-saisies-clavier" id="id96"><span class="sectnum">1.7.2.21</span> Lecture des saisies clavier</a></p></li>
<li><p><a class="reference internal" href="#exercice" id="id97"><span class="sectnum">1.7.2.22</span> Exercice</a></p></li>
<li><p><a class="reference internal" href="#les-sous-programmes" id="id98"><span class="sectnum">1.7.2.23</span> Les sous-programmes</a></p></li>
<li><p><a class="reference internal" href="#la-completion-de-commande" id="id99"><span class="sectnum">1.7.2.24</span> La complétion de commande</a></p></li>
<li><p><a class="reference internal" href="#historique-des-commandes" id="id100"><span class="sectnum">1.7.2.25</span> Historique des commandes</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#les-commandes" id="id101"><span class="sectnum">1.7.3</span> Les commandes</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#se-deplacer-dans-l-arborescence" id="id102"><span class="sectnum">1.7.3.1</span> Se déplacer dans l’arborescence</a></p></li>
<li><p><a class="reference internal" href="#creation-suppression-de-repertoire" id="id103"><span class="sectnum">1.7.3.2</span> Création / suppression de répertoire</a></p></li>
<li><p><a class="reference internal" href="#lecture-de-fichier" id="id104"><span class="sectnum">1.7.3.3</span> Lecture de fichier</a></p></li>
<li><p><a class="reference internal" href="#rechercher-des-fichiers" id="id105"><span class="sectnum">1.7.3.4</span> Rechercher des fichiers</a></p></li>
<li><p><a class="reference internal" href="#archivage-compression" id="id106"><span class="sectnum">1.7.3.5</span> Archivage / Compression</a></p></li>
<li><p><a class="reference internal" href="#autres-commandes" id="id107"><span class="sectnum">1.7.3.6</span> Autres commandes</a></p></li>
<li><p><a class="reference internal" href="#les-noms-de-fichiers" id="id108"><span class="sectnum">1.7.3.7</span> Les noms de fichiers</a></p></li>
<li><p><a class="reference internal" href="#les-attributs-des-fichiers" id="id109"><span class="sectnum">1.7.3.8</span> Les attributs des fichiers</a></p></li>
<li><p><a class="reference internal" href="#les-types-de-fichiers" id="id110"><span class="sectnum">1.7.3.9</span> Les types de fichiers</a></p></li>
<li><p><a class="reference internal" href="#dev" id="id111"><span class="sectnum">1.7.3.10</span> /dev</a></p></li>
<li><p><a class="reference internal" href="#sys" id="id112"><span class="sectnum">1.7.3.11</span> /sys</a></p></li>
<li><p><a class="reference internal" href="#proc" id="id113"><span class="sectnum">1.7.3.12</span> /proc</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#enchainement-et-parallelisation-des-commandes" id="id114"><span class="sectnum">1.7.4</span> Enchaînement et parallélisation des commandes</a></p></li>
<li><p><a class="reference internal" href="#les-flux-standards" id="id115"><span class="sectnum">1.7.5</span> Les flux standards</a></p></li>
<li><p><a class="reference internal" href="#input-output" id="id116"><span class="sectnum">1.7.6</span> Input, Output</a></p></li>
<li><p><a class="reference internal" href="#les-redirections" id="id117"><span class="sectnum">1.7.7</span> Les redirections</a></p></li>
<li><p><a class="reference internal" href="#les-pipes" id="id118"><span class="sectnum">1.7.8</span> Les pipes</a></p></li>
<li><p><a class="reference internal" href="#les-alias" id="id119"><span class="sectnum">1.7.9</span> Les alias</a></p></li>
<li><p><a class="reference internal" href="#screen" id="id120"><span class="sectnum">1.7.10</span> screen</a></p></li>
<li><p><a class="reference internal" href="#ssh" id="id121"><span class="sectnum">1.7.11</span> ssh</a></p></li>
<li><p><a class="reference internal" href="#iptables-et-ufw" id="id122"><span class="sectnum">1.7.12</span> iptables et ufw</a></p></li>
<li><p><a class="reference internal" href="#un-peu-de-configuration-pour-l-utilisation-en-ligne" id="id123"><span class="sectnum">1.7.13</span> Un peu de configuration pour l’utilisation en ligne</a></p></li>
<li><p><a class="reference internal" href="#configurer-vim-and-bash" id="id124"><span class="sectnum">1.7.14</span> Configurer vim and bash</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#gestion-des-permissions-et-droits-d-acces" id="id125"><span class="sectnum">1.8</span> Gestion des permissions et droits d’accès</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#concepts" id="id126"><span class="sectnum">1.8.1</span> Concepts</a></p></li>
<li><p><a class="reference internal" href="#changer-le-proprietaire-ou-le-groupe-proprietaire" id="id127"><span class="sectnum">1.8.2</span> Changer le propriétaire ou le groupe propriétaire</a></p></li>
<li><p><a class="reference internal" href="#valeurs-symboliques-et-octales-des-permissions" id="id128"><span class="sectnum">1.8.3</span> Valeurs symboliques et octales des permissions</a></p></li>
<li><p><a class="reference internal" href="#changer-les-permissions-sur-les-fichiers" id="id129"><span class="sectnum">1.8.4</span> Changer les permissions sur les fichiers</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#mode-chiffre" id="id130"><span class="sectnum">1.8.4.1</span> Mode chiffré</a></p></li>
<li><p><a class="reference internal" href="#notation-relative-aux-droits-existants" id="id131"><span class="sectnum">1.8.4.2</span> Notation relative (aux droits existants)</a></p></li>
<li><p><a class="reference internal" href="#notation-absolue" id="id132"><span class="sectnum">1.8.4.3</span> Notation absolue</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#umask" id="id133"><span class="sectnum">1.8.5</span> Umask</a></p></li>
<li><p><a class="reference internal" href="#acl" id="id134"><span class="sectnum">1.8.6</span> ACL</a></p></li>
<li><p><a class="reference internal" href="#attributs-etendus" id="id135"><span class="sectnum">1.8.7</span> Attributs étendus</a></p></li>
<li><p><a class="reference internal" href="#affectation-des-acl" id="id136"><span class="sectnum">1.8.8</span> Affectation des ACL</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#les-processus" id="id137"><span class="sectnum">1.9</span> Les processus</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#definition" id="id138"><span class="sectnum">1.9.1</span> Définition</a></p></li>
<li><p><a class="reference internal" href="#attributs-d-un-processus" id="id139"><span class="sectnum">1.9.2</span> Attributs d’un processus</a></p></li>
<li><p><a class="reference internal" href="#cycle-de-vie-d-un-processus" id="id140"><span class="sectnum">1.9.3</span> Cycle de vie d’un processus</a></p></li>
<li><p><a class="reference internal" href="#les-differentes-sortes-de-processus" id="id141"><span class="sectnum">1.9.4</span> Les différentes sortes de processus</a></p></li>
<li><p><a class="reference internal" href="#envoi-de-signaux-aux-processus" id="id142"><span class="sectnum">1.9.5</span> Envoi de signaux aux processus</a></p></li>
<li><p><a class="reference internal" href="#les-commandes-liees-a-la-gestion-des-processus" id="id143"><span class="sectnum">1.9.6</span> Les commandes liées à la gestion des processus</a></p></li>
<li><p><a class="reference internal" href="#arriere-plan-avant-plan-detachement" id="id144"><span class="sectnum">1.9.7</span> Arrière-plan / Avant-plan / Détachement</a></p></li>
<li><p><a class="reference internal" href="#modification-des-priorites" id="id145"><span class="sectnum">1.9.8</span> Modification des priorités</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#planification-de-taches" id="id146"><span class="sectnum">1.10</span> Planification de tâches</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#la-commande-crontab" id="id147"><span class="sectnum">1.10.1</span> La commande crontab</a></p></li>
<li><p><a class="reference internal" href="#le-fichier-crontab-systeme" id="id148"><span class="sectnum">1.10.2</span> Le fichier crontab système</a></p></li>
<li><p><a class="reference internal" href="#la-commande-at" id="id149"><span class="sectnum">1.10.3</span> La commande at</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#les-utilisateurs-et-les-groupes" id="id150"><span class="sectnum">1.11</span> Les utilisateurs et les groupes</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#qu-est-qu-un-utilisateur" id="id151"><span class="sectnum">1.11.1</span> Qu’est qu’un utilisateur ?</a></p></li>
<li><p><a class="reference internal" href="#qu-est-qu-un-groupe" id="id152"><span class="sectnum">1.11.2</span> Qu’est qu’un groupe ?</a></p></li>
<li><p><a class="reference internal" href="#gestion-des-comptes" id="id153"><span class="sectnum">1.11.3</span> Gestion des comptes</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#ajouter-un-utilisateur" id="id154"><span class="sectnum">1.11.3.1</span> Ajouter un utilisateur</a></p></li>
<li><p><a class="reference internal" href="#supprimer-un-utilisateur" id="id155"><span class="sectnum">1.11.3.2</span> Supprimer un utilisateur</a></p></li>
<li><p><a class="reference internal" href="#desactiver-un-compte-utilisateur" id="id156"><span class="sectnum">1.11.3.3</span> Désactiver un compte utilisateur</a></p></li>
<li><p><a class="reference internal" href="#changer-le-mot-de-passe-d-un-utilisateur" id="id157"><span class="sectnum">1.11.3.4</span> Changer le mot de passe d’un utilisateur</a></p></li>
<li><p><a class="reference internal" href="#afficher-des-informations-d-un-utilisateur" id="id158"><span class="sectnum">1.11.3.5</span> Afficher des informations d’un utilisateur</a></p></li>
<li><p><a class="reference internal" href="#modifier-les-informations-d-un-utilisateur" id="id159"><span class="sectnum">1.11.3.6</span> Modifier les informations d’un utilisateur</a></p></li>
<li><p><a class="reference internal" href="#changer-d-identite" id="id160"><span class="sectnum">1.11.3.7</span> Changer d’identité</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#gestion-des-groupes" id="id161"><span class="sectnum">1.11.4</span> Gestion des groupes</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#creer-un-groupe" id="id162"><span class="sectnum">1.11.4.1</span> Créer un groupe</a></p></li>
<li><p><a class="reference internal" href="#afficher-des-informations-sur-les-groupes" id="id163"><span class="sectnum">1.11.4.2</span> Afficher des informations sur les groupes</a></p></li>
<li><p><a class="reference internal" href="#ajouter-un-utilisateur-a-un-groupe" id="id164"><span class="sectnum">1.11.4.3</span> Ajouter un utilisateur à un groupe</a></p></li>
<li><p><a class="reference internal" href="#ajouter-un-utilisateur-au-groupe-des-administrateurs" id="id165"><span class="sectnum">1.11.4.4</span> Ajouter un utilisateur au groupe des administrateurs</a></p></li>
<li><p><a class="reference internal" href="#changer-de-groupe-principal" id="id166"><span class="sectnum">1.11.4.5</span> Changer de groupe principal</a></p></li>
<li><p><a class="reference internal" href="#modifier-un-groupe" id="id167"><span class="sectnum">1.11.4.6</span> Modifier un groupe</a></p></li>
<li><p><a class="reference internal" href="#supprimer-un-groupe" id="id168"><span class="sectnum">1.11.4.7</span> Supprimer un groupe</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#le-fichier-etc-passwd" id="id169"><span class="sectnum">1.11.5</span> Le fichier /,etc/passwd</a></p></li>
<li><p><a class="reference internal" href="#le-fichier-etc-shadow" id="id170"><span class="sectnum">1.11.6</span> Le fichier /,etc/shadow</a></p></li>
<li><p><a class="reference internal" href="#le-fichier-etc-group" id="id171"><span class="sectnum">1.11.7</span> Le fichier /,etc/group</a></p></li>
<li><p><a class="reference internal" href="#installation-openldap" id="id172"><span class="sectnum">1.11.8</span> Installation openldap</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#syslog" id="id173"><span class="sectnum">1.12</span> Syslog</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#modification-de-la-configuration-de-logrotate" id="id174"><span class="sectnum">1.12.1</span> Modification de la configuration de logrotate</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#peripherique-disque-et-systeme-de-fichiers" id="id175"><span class="sectnum">1.13</span> Périphérique disque et système de fichiers</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#les-disques-durs-sous-linux" id="id176"><span class="sectnum">1.13.1</span> Les disques durs sous Linux</a></p></li>
<li><p><a class="reference internal" href="#les-concepts" id="id177"><span class="sectnum">1.13.2</span> Les concepts</a></p></li>
<li><p><a class="reference internal" href="#les-systemes-de-fichiers" id="id178"><span class="sectnum">1.13.3</span> Les systèmes de fichiers</a></p></li>
<li><p><a class="reference internal" href="#partitions" id="id179"><span class="sectnum">1.13.4</span> Partitions</a></p></li>
<li><p><a class="reference internal" href="#utilitaires-de-partitionnement" id="id180"><span class="sectnum">1.13.5</span> Utilitaires de partitionnement</a></p></li>
<li><p><a class="reference internal" href="#arborescence-standard-et-organisation-du-fhs" id="id181"><span class="sectnum">1.13.6</span> Arborescence standard et organisation du FHS</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#arborescence-de" id="id182"><span class="sectnum">1.13.6.1</span> Arborescence de /</a></p></li>
<li><p><a class="reference internal" href="#arborescence-de-usr" id="id183"><span class="sectnum">1.13.6.2</span> Arborescence de /usr</a></p></li>
<li><p><a class="reference internal" href="#arborescence-de-var" id="id184"><span class="sectnum">1.13.6.3</span> Arborescence de /var</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#formater-une-partition" id="id185"><span class="sectnum">1.13.7</span> Formater une partition</a></p></li>
<li><p><a class="reference internal" href="#monter-demonter-une-partition" id="id186"><span class="sectnum">1.13.8</span> Monter / Démonter une partition</a></p></li>
<li><p><a class="reference internal" href="#les-tables-de-montage-etc-fstab" id="id187"><span class="sectnum">1.13.9</span> Les tables de montage : /etc/fstab</a></p></li>
<li><p><a class="reference internal" href="#tables-systemes-inodes" id="id188"><span class="sectnum">1.13.10</span> Tables systèmes, inodes</a></p></li>
<li><p><a class="reference internal" href="#journalisation" id="id189"><span class="sectnum">1.13.11</span> Journalisation</a></p></li>
<li><p><a class="reference internal" href="#recuperation-de-fichiers" id="id190"><span class="sectnum">1.13.12</span> Récupération de fichiers</a></p></li>
<li><p><a class="reference internal" href="#controle-des-systemes-de-fichiers" id="id191"><span class="sectnum">1.13.13</span> Contrôle des systèmes de fichiers</a></p></li>
<li><p><a class="reference internal" href="#montage-des-peripheriques-amovibles" id="id192"><span class="sectnum">1.13.14</span> Montage des périphériques amovibles</a></p></li>
<li><p><a class="reference internal" href="#utilitaire-smartd" id="id193"><span class="sectnum">1.13.15</span> Utilitaire smartd</a></p></li>
<li><p><a class="reference internal" href="#les-montages-en-raid" id="id194"><span class="sectnum">1.13.16</span> Les montages en raid</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#le-raid-0" id="id195"><span class="sectnum">1.13.16.1</span> Le RAID 0</a></p></li>
<li><p><a class="reference internal" href="#le-raid-1" id="id196"><span class="sectnum">1.13.16.2</span> Le RAID 1</a></p></li>
<li><p><a class="reference internal" href="#le-raid-5" id="id197"><span class="sectnum">1.13.16.3</span> Le RAID 5</a></p></li>
<li><p><a class="reference internal" href="#la-gestion-du-raid-logiciel-par-linux" id="id198"><span class="sectnum">1.13.16.4</span> La gestion du RAID logiciel par Linux</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#lvm" id="id199"><span class="sectnum">1.13.17</span> LVM</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#python" id="id200"><span class="sectnum">1.14</span> Python</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#id2" id="id201"><span class="sectnum">1.14.1</span> Historique</a></p></li>
<li><p><a class="reference internal" href="#la-notion-d-objet" id="id202"><span class="sectnum">1.14.2</span> La notion d’objet</a></p></li>
<li><p><a class="reference internal" href="#la-notion-de-classe" id="id203"><span class="sectnum">1.14.3</span> La notion de classe</a></p></li>
<li><p><a class="reference internal" href="#l-instruction-print" id="id204"><span class="sectnum">1.14.4</span> L’instruction print</a></p></li>
<li><p><a class="reference internal" href="#les-primitives-d-acces-aux-informations-de-type" id="id205"><span class="sectnum">1.14.5</span> Les primitives d’accès aux informations de type</a></p></li>
<li><p><a class="reference internal" href="#les-commentaires" id="id206"><span class="sectnum">1.14.6</span> Les commentaires</a></p></li>
<li><p><a class="reference internal" href="#les-chaines-de-caracteres" id="id207"><span class="sectnum">1.14.7</span> Les chaînes de caractères</a></p></li>
<li><p><a class="reference internal" href="#les-numeriques" id="id208"><span class="sectnum">1.14.8</span> Les numériques</a></p></li>
<li><p><a class="reference internal" href="#les-types-a-valeur-unique" id="id209"><span class="sectnum">1.14.9</span> Les types à valeur unique</a></p></li>
<li><p><a class="reference internal" href="#les-sequences" id="id210"><span class="sectnum">1.14.10</span> Les séquences</a></p></li>
<li><p><a class="reference internal" href="#les-operateurs" id="id211"><span class="sectnum">1.14.11</span> Les opérateurs</a></p></li>
<li><p><a class="reference internal" href="#operateurs-binaires" id="id212"><span class="sectnum">1.14.12</span> Opérateurs binaires</a></p></li>
<li><p><a class="reference internal" href="#operateurs-de-comparaison" id="id213"><span class="sectnum">1.14.13</span> Opérateurs de comparaison</a></p></li>
<li><p><a class="reference internal" href="#ordre-de-traitement-des-operations" id="id214"><span class="sectnum">1.14.14</span> Ordre de traitement des opérations</a></p></li>
<li><p><a class="reference internal" href="#l-instruction-pass" id="id215"><span class="sectnum">1.14.15</span> L’instruction pass</a></p></li>
<li><p><a class="reference internal" href="#l-indentation" id="id216"><span class="sectnum">1.14.16</span> L’indentation</a></p></li>
<li><p><a class="reference internal" href="#les-structures-conditionnelles" id="id217"><span class="sectnum">1.14.17</span> Les structures conditionnelles</a></p></li>
<li><p><a class="reference internal" href="#id3" id="id218"><span class="sectnum">1.14.18</span> Les fonctions</a></p></li>
<li><p><a class="reference internal" href="#les-docstrings" id="id219"><span class="sectnum">1.14.19</span> Les docstrings</a></p></li>
<li><p><a class="reference internal" href="#les-decorateurs" id="id220"><span class="sectnum">1.14.20</span> Les décorateurs</a></p></li>
<li><p><a class="reference internal" href="#les-classes" id="id221"><span class="sectnum">1.14.21</span> Les Classes</a></p></li>
<li><p><a class="reference internal" href="#les-exceptions" id="id222"><span class="sectnum">1.14.22</span> Les exceptions</a></p></li>
<li><p><a class="reference internal" href="#les-modules" id="id223"><span class="sectnum">1.14.23</span> Les modules</a></p></li>
<li><p><a class="reference internal" href="#les-paquets" id="id224"><span class="sectnum">1.14.24</span> Les paquets</a></p></li>
<li><p><a class="reference internal" href="#les-principaux-modules" id="id225"><span class="sectnum">1.14.25</span> Les principaux modules</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#builtin" id="id226"><span class="sectnum">1.14.25.1</span> __builtin__</a></p></li>
<li><p><a class="reference internal" href="#id4" id="id227"><span class="sectnum">1.14.25.2</span> sys</a></p></li>
<li><p><a class="reference internal" href="#os" id="id228"><span class="sectnum">1.14.25.3</span> os</a></p></li>
<li><p><a class="reference internal" href="#gzip-zipfile" id="id229"><span class="sectnum">1.14.25.4</span> gzip, zipfile</a></p></li>
<li><p><a class="reference internal" href="#socket" id="id230"><span class="sectnum">1.14.25.5</span> socket</a></p></li>
<li><p><a class="reference internal" href="#urllib2" id="id231"><span class="sectnum">1.14.25.6</span> urllib2</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#environnement-virtuel" id="id232"><span class="sectnum">1.14.26</span> Environnement virtuel</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#initialisation-du-systeme-et-des-services" id="id233"><span class="sectnum">1.15</span> Initialisation du système et des services</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#la-sequence-de-boot" id="id234"><span class="sectnum">1.15.1</span> La séquence de boot</a></p></li>
<li><p><a class="reference internal" href="#grub" id="id235"><span class="sectnum">1.15.2</span> GRUB</a></p></li>
<li><p><a class="reference internal" href="#demarrage-du-noyau" id="id236"><span class="sectnum">1.15.3</span> Démarrage du noyau</a></p></li>
<li><p><a class="reference internal" href="#les-arguments-ou-parametres-du-kernel" id="id237"><span class="sectnum">1.15.4</span> Les arguments ou paramètres du kernel</a></p></li>
<li><p><a class="reference internal" href="#systemd-vs-initv-vs-upstart" id="id238"><span class="sectnum">1.15.5</span> Systemd vs InitV vs upstart</a></p></li>
<li><p><a class="reference internal" href="#les-niveaux-d-execution-run-level" id="id239"><span class="sectnum">1.15.6</span> Les niveaux d’exécution (Run level)</a></p></li>
<li><p><a class="reference internal" href="#le-systeme-de-demarrage-des-services" id="id240"><span class="sectnum">1.15.7</span> Le système de démarrage des services</a></p></li>
<li><p><a class="reference internal" href="#changement-du-niveau-d-execution" id="id241"><span class="sectnum">1.15.8</span> Changement du niveau d’exécution</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#modules" id="id242"><span class="sectnum">1.16</span> Modules</a></p></li>
<li><p><a class="reference internal" href="#configuration-reseau-et-outils-tcp-ip" id="id243"><span class="sectnum">1.17</span> Configuration réseau et outils TCP/IP</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#id5" id="id244"><span class="sectnum">1.17.1</span> Introduction</a></p></li>
<li><p><a class="reference internal" href="#configuration-automatique" id="id245"><span class="sectnum">1.17.2</span> Configuration automatique</a></p></li>
<li><p><a class="reference internal" href="#la-commande-ip" id="id246"><span class="sectnum">1.17.3</span> La commande ip</a></p></li>
<li><p><a class="reference internal" href="#ifconfig-deprecie" id="id247"><span class="sectnum">1.17.4</span> ifconfig (déprécié)</a></p></li>
<li><p><a class="reference internal" href="#iwconfig-deprecie" id="id248"><span class="sectnum">1.17.5</span> iwconfig (déprécié)</a></p></li>
<li><p><a class="reference internal" href="#ifup-ifdown-deprecie" id="id249"><span class="sectnum">1.17.6</span> ifup/ifdown (déprécié)</a></p></li>
<li><p><a class="reference internal" href="#route-deprecie" id="id250"><span class="sectnum">1.17.7</span> route (déprécié)</a></p></li>
<li><p><a class="reference internal" href="#ip" id="id251"><span class="sectnum">1.17.8</span> ip</a></p></li>
<li><p><a class="reference internal" href="#les-interfaces-virtuelles" id="id252"><span class="sectnum">1.17.9</span> Les interfaces virtuelles</a></p></li>
<li><p><a class="reference internal" href="#fixer-le-nom-de-machine" id="id253"><span class="sectnum">1.17.10</span> Fixer le nom de machine</a></p></li>
<li><p><a class="reference internal" href="#positionner-le-reverse" id="id254"><span class="sectnum">1.17.11</span> Positionner le reverse</a></p></li>
<li><p><a class="reference internal" href="#demarrage-et-arret-du-reseau" id="id255"><span class="sectnum">1.17.12</span> Démarrage et arrêt du réseau</a></p></li>
<li><p><a class="reference internal" href="#la-resolution-de-nom" id="id256"><span class="sectnum">1.17.13</span> La résolution de nom</a></p></li>
<li><p><a class="reference internal" href="#la-modification-du-fichier-etc-hosts" id="id257"><span class="sectnum">1.17.14</span> La modification du fichier /,etc/hosts</a></p></li>
<li><p><a class="reference internal" href="#les-outils-et-commandes-de-tests-reseau" id="id258"><span class="sectnum">1.17.15</span> Les outils et commandes de tests réseau</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#ping" id="id259"><span class="sectnum">1.17.15.1</span> ping</a></p></li>
<li><p><a class="reference internal" href="#host" id="id260"><span class="sectnum">1.17.15.2</span> host</a></p></li>
<li><p><a class="reference internal" href="#netstat" id="id261"><span class="sectnum">1.17.15.3</span> netstat</a></p></li>
<li><p><a class="reference internal" href="#tcpdump" id="id262"><span class="sectnum">1.17.15.4</span> tcpdump</a></p></li>
<li><p><a class="reference internal" href="#nmap" id="id263"><span class="sectnum">1.17.15.5</span> nmap</a></p></li>
<li><p><a class="reference internal" href="#ngrep" id="id264"><span class="sectnum">1.17.15.6</span> ngrep</a></p></li>
<li><p><a class="reference internal" href="#wireshark" id="id265"><span class="sectnum">1.17.15.7</span> wireshark</a></p></li>
<li><p><a class="reference internal" href="#last" id="id266"><span class="sectnum">1.17.15.8</span> last</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#gestion-des-paquetages-et-installation-de-logiciels-sous-ubuntu" id="id267"><span class="sectnum">1.18</span> Gestion des paquetages et installation de logiciels sous Ubuntu</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#ubuntu-un-systeme-grand-public" id="id268"><span class="sectnum">1.18.1</span> Ubuntu, un système « Grand Public »</a></p></li>
<li><p><a class="reference internal" href="#quelle-version-choisir-et-pour-quel-usage" id="id269"><span class="sectnum">1.18.2</span> Quelle version choisir et pour quel usage ?</a></p></li>
<li><p><a class="reference internal" href="#les-depots" id="id270"><span class="sectnum">1.18.3</span> Les dépôts</a></p></li>
<li><p><a class="reference internal" href="#installation-de-paquets" id="id271"><span class="sectnum">1.18.4</span> Installation de paquets</a></p></li>
<li><p><a class="reference internal" href="#suppression-de-paquets" id="id272"><span class="sectnum">1.18.5</span> Suppression de paquets</a></p></li>
<li><p><a class="reference internal" href="#informations-sur-les-paquetages" id="id273"><span class="sectnum">1.18.6</span> Informations sur les paquetages</a></p></li>
<li><p><a class="reference internal" href="#recherche-de-paquetages" id="id274"><span class="sectnum">1.18.7</span> Recherche de paquetages</a></p></li>
<li><p><a class="reference internal" href="#mise-a-jour-des-paquetages" id="id275"><span class="sectnum">1.18.8</span> Mise à jour des paquetages</a></p></li>
<li><p><a class="reference internal" href="#installation-avec-parametrage" id="id276"><span class="sectnum">1.18.9</span> Installation avec paramétrage</a></p></li>
<li><p><a class="reference internal" href="#interfaces-graphiques" id="id277"><span class="sectnum">1.18.10</span> Interfaces graphiques</a></p></li>
<li><p><a class="reference internal" href="#commande-alien" id="id278"><span class="sectnum">1.18.11</span> Commande alien</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#apache" id="id279"><span class="sectnum">1.19</span> Apache</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#presentation" id="id280"><span class="sectnum">1.19.1</span> Présentation</a></p></li>
<li><p><a class="reference internal" href="#id6" id="id281"><span class="sectnum">1.19.2</span> Installation</a></p></li>
<li><p><a class="reference internal" href="#configuration" id="id282"><span class="sectnum">1.19.3</span> Configuration</a></p></li>
<li><p><a class="reference internal" href="#securisation" id="id283"><span class="sectnum">1.19.4</span> Sécurisation</a></p></li>
<li><p><a class="reference internal" href="#tracage" id="id284"><span class="sectnum">1.19.5</span> Traçage</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#postfix" id="id285"><span class="sectnum">1.20</span> Postfix</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#id7" id="id286"><span class="sectnum">1.20.1</span> Présentation</a></p></li>
<li><p><a class="reference internal" href="#ressources-postfix-spf-dkim-et-test" id="id287"><span class="sectnum">1.20.2</span> Ressources postfix, spf, dkim et test</a></p></li>
<li><p><a class="reference internal" href="#id8" id="id288"><span class="sectnum">1.20.3</span> Installation</a></p></li>
<li><p><a class="reference internal" href="#id9" id="id289"><span class="sectnum">1.20.4</span> Configuration</a></p></li>
<li><p><a class="reference internal" href="#dmarc" id="id290"><span class="sectnum">1.20.5</span> dmarc</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#mysql" id="id291"><span class="sectnum">1.21</span> MySQL</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#id10" id="id292"><span class="sectnum">1.21.1</span> Présentation</a></p></li>
<li><p><a class="reference internal" href="#id11" id="id293"><span class="sectnum">1.21.2</span> Installation</a></p></li>
<li><p><a class="reference internal" href="#id12" id="id294"><span class="sectnum">1.21.3</span> Configuration</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#id13" id="id295"><span class="sectnum">1.22</span> Sécurisation</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#certificat-x-509" id="id296"><span class="sectnum">1.22.1</span> Certificat X 509</a></p></li>
<li><p><a class="reference internal" href="#postgrey" id="id297"><span class="sectnum">1.22.2</span> postgrey</a></p></li>
<li><p><a class="reference internal" href="#fail2ban" id="id298"><span class="sectnum">1.22.3</span> fail2ban</a></p></li>
<li><p><a class="reference internal" href="#docker" id="id299"><span class="sectnum">1.22.4</span> Docker</a></p></li>
<li><p><a class="reference internal" href="#git" id="id300"><span class="sectnum">1.22.5</span> git</a></p></li>
<li><p><a class="reference internal" href="#gitlab" id="id301"><span class="sectnum">1.22.6</span> gitlab</a></p></li>
<li><p><a class="reference internal" href="#visual-code" id="id302"><span class="sectnum">1.22.7</span> Visual code</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#parametrer-son-environnement-virtuel-python" id="id303"><span class="sectnum">1.22.7.1</span> Paramétrer son environnement virtuel python</a></p></li>
<li><p><a class="reference internal" href="#ajouter-la-previsualisation-sphinx-pour-le-format-rest" id="id304"><span class="sectnum">1.22.7.2</span> Ajouter la prévisualisation sphinx pour le format rest</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#site-de-tests-des-requetes-html" id="id305"><span class="sectnum">1.22.8</span> Site de tests des requêtes html</a></p></li>
<li><p><a class="reference internal" href="#capturer-la-session-en-cours" id="id306"><span class="sectnum">1.22.9</span> Capturer la session en cours</a></p></li>
<li><p><a class="reference internal" href="#formats-de-fichier-de-configuration" id="id307"><span class="sectnum">1.22.10</span> Formats de fichier de configuration</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<section id="objectif">
<h2><a class="toc-backref" href="#id37"><span class="sectnum">1.1</span> Objectif</a><a class="headerlink" href="#objectif" title="Lien permanent vers ce titre">¶</a></h2>
<p>Cette formation a pour but de fournir les bases indispensables à l’utilisation et à l’administration des systèmes GNU/Linux.</p>
<p>La formation privilégie la distribution Ubuntu.</p>
</section>
<section id="introduction">
<h2><a class="toc-backref" href="#id38"><span class="sectnum">1.2</span> Introduction</a><a class="headerlink" href="#introduction" title="Lien permanent vers ce titre">¶</a></h2>
<p>En 1991, l’étudiant finlandais Linus Torvalds publie sur internet l’intégralité du code source d’un noyau Unix qu’il a écrit en C et en assembleur et qui fonctionne sur PC AT 386(486).</p>
<p>Depuis cette date GNU/Linux ne cesse d’évoluer. Il occupe en 2015 1,6% <a class="footnote-reference brackets" href="#id14" id="id1">1</a> du marché mondial des systèmes d’exploitation pour ordinateur personnel, plus de 60% des serveurs web, prés de 75% du Cloud et plus de 80% des smartphones (Android étant basé sur GNU/Linux) et est en autre utilisé en France par la Gendarmerie (Ubuntu) et par l’Assemblée Nationale (Ubuntu), dans la Freebox, par l’entreprise Google (Android) et la fondation Wikipedia (serveur Ubuntu).</p>
</section>
<section id="historique">
<h2><a class="toc-backref" href="#id39"><span class="sectnum">1.3</span> Historique</a><a class="headerlink" href="#historique" title="Lien permanent vers ce titre">¶</a></h2>
<section id="unix-les-racines">
<h3><a class="toc-backref" href="#id40"><span class="sectnum">1.3.1</span> UNIX (les racines)</a><a class="headerlink" href="#unix-les-racines" title="Lien permanent vers ce titre">¶</a></h3>
<figure class="align-center" id="id15">
<img alt="../_images/HistoriqueUnix.jpg" src="../_images/HistoriqueUnix.jpg" />
<figcaption>
<p><span class="caption-text">Histoire des Unix (source wikipedia)</span><a class="headerlink" href="#id15" title="Lien permanent vers cette image">¶</a></p>
</figcaption>
</figure>
<p>Ken Thompson, ingénieur d’AT&amp;T travaille en collaboration avec le MIT au Bell Labs sur Multics.</p>
<p>En 1969 il créait un système d’exploitation inspiré de Multics. Brian Kernighan le nommera Unics.</p>
<p>En 1971 Unics devient Unix et est alors récrit en C spécialement développé pour cela par Dennis Ritchie.</p>
<p>1973 AT&amp;T diffuse Unix avec ses sources à ses clients (première licence open source).</p>
<p>1974 l’Université de Californie Berkeley (UCB) commence ses recherches sur UNIX en collaboration étroite avec AT&amp;T.</p>
<p>1977 Bill Joy alors étudiant à l’UCB réalise la première version de BSD (Berkeley Software Distribution).</p>
<p>À partir de là, les éditions se succèdent (SYSTEM III puis V en 1985 et SVR2 à SVR4 pour AT&amp;T, 4.2BSD pour l’UCB en 1983).</p>
<p>La DARPA finance BSD ce qui aboutit à l’intégration de la première pile TCP/IP en 1983 qui sera intégrée telle quel dans Windows en raison de sa licence permissive.</p>
<p>1985 la 4.3 BSD n’est plus livrée avec les sources de AT&amp;T en raison du prix excessif de la licence.</p>
<p>Face à ce problème, l’UCB récrit et nettoie complètement son UNIX qui sort en 1989 sous le nom NetBSD. Le noyau est alors le MACH de l’université de Carnegie-Mellon. L’accès aux sources et à la distribution complète devient gratuit.</p>
<p>1991 Sun Microsystems co-fondé en 1982 par Bill Joy sort SunOS qui deviendra Solaris.</p>
<p>1992 Procès AT&amp;T BSD</p>
<p>FreeBSD apparaît en 1993 comme le portage de NetBSD sur i386</p>
<p>1998 Solaris supporte le 64 bits</p>
<p>1999 Mac OS X (server)</p>
<p>2005 Open Solaris</p>
<p>Octobre 2008 version 4.0.1 de NetBSD</p>
<p>Janvier 2009 version 7.1 de FreeBSD</p>
<p>La Free Software Foundation (FSF), le projet GNU</p>
<p>1983 Richard Stallman (RMS) qui travaillait au laboratoire d’intelligence artificielle du MIT crée le projet GNU.</p>
<p>GNU est un acronyme récursif (GNU’s Not Unix).</p>
<p>GNU a pour objectif de fournir un système d’exploitation compatible avec UNIX sans dépendre des ayants droit (AT&amp;T et BSD) dont RMS récuse les licences.</p>
<p>1985 création de la Free Software Foundation (FSF) organisation américaine à but non lucratif pour le soutien du logiciel libre.</p>
<p>1987 Rob Pike, Ken Thompson et Dennis Ritchie débutent les travaux de Plan 9 qui inspirera les UNIX modernes.</p>
<p>1989 écriture de la GNU GPL (GNU Genral Public Licence ou  GPL) version 1.</p>
<p>1990 le système GNU possède son propre éditeur (Emacs), d’un compilateur C (GCC), et d’une réécriture de la plupart des bibliothèques système d’UNIX.</p>
<p>1991 le noyau Linux utilise la GPL et GCC.</p>
<p>1997 lancement de GNOME un environnement graphique dont l’objectif était de fournir une alternative libre à l’environnement KDE qui utilisait la bibliothèque Qt alors non libre.</p>
</section>
<section id="la-licence-bsd-versus-la-licence-gpl">
<h3><a class="toc-backref" href="#id41"><span class="sectnum">1.3.2</span> La licence BSD versus la licence GPL</a><a class="headerlink" href="#la-licence-bsd-versus-la-licence-gpl" title="Lien permanent vers ce titre">¶</a></h3>
<p>Il existe presque plusieurs centaines de licences appliquées aux logiciels libres, mais dans la majorité des cas on peut les séparer en deux catégories selon qu’elles sont compatibles avec la licence BSD ou la licence GPL.</p>
</section>
<section id="la-licence-gpl">
<h3><a class="toc-backref" href="#id42"><span class="sectnum">1.3.3</span> La licence GPL</a><a class="headerlink" href="#la-licence-gpl" title="Lien permanent vers ce titre">¶</a></h3>
<p>La licence GPL a pour but de protéger l’auteur et l’utilisateur en garantissant les droits suivants (appelés libertés) :</p>
<ol class="arabic simple">
<li><p>La liberté d’exécuter le logiciel, pour n’importe quel usage ;</p></li>
<li><p>La liberté d’étudier le fonctionnement d’un programme et de l’adapter à ses besoins, ce qui passe par l’accès aux codes sources ;</p></li>
<li><p>La liberté de redistribuer des copies ;</p></li>
<li><p>La liberté d’améliorer le programme et de rendre publiques les modifications afin que l’ensemble de la communauté en bénéficie.</p></li>
</ol>
<p>En contrepartie, l’utilisation du logiciel est au risque et péril de l’utilisateur.</p>
<section id="le-gauche-d-auteur">
<h4><a class="toc-backref" href="#id43"><span class="sectnum">1.3.3.1</span> Le gauche d’auteur</a><a class="headerlink" href="#le-gauche-d-auteur" title="Lien permanent vers ce titre">¶</a></h4>
<p>Le code n’est pas dans le domaine public.</p>
<p>Il est protégé par le droit d’auteur.</p>
<p>L’exécution du logiciel et la diffusion des sources modifiées ne sont possibles qu’à la condition de respecter les obligations de la licence.</p>
<p>Notamment :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Le</span> <span class="n">droit</span> <span class="n">de</span> <span class="n">redistribuer</span> <span class="n">est</span> <span class="n">garanti</span> <span class="n">seulement</span> <span class="n">si</span> <span class="n">l</span><span class="s1">&#39;utilisateur fournit le code source de la version modifiée. En outre, les copies distribuées, incluant les modifications, doivent être aussi sous les termes de la GPL.</span>
<span class="n">Cette</span> <span class="n">condition</span> <span class="n">est</span> <span class="n">connue</span> <span class="n">sous</span> <span class="n">le</span> <span class="n">nom</span> <span class="n">de</span> <span class="n">copyleft</span><span class="o">.</span>
<span class="n">Puisque</span> <span class="n">le</span> <span class="n">logiciel</span> <span class="n">est</span> <span class="n">protégé</span> <span class="n">par</span> <span class="n">les</span> <span class="n">droits</span> <span class="n">d</span><span class="s1">&#39;auteurs, l&#39;</span><span class="n">utilisateur</span> <span class="n">ne</span> <span class="n">peut</span> <span class="n">le</span> <span class="n">modifier</span> <span class="n">ou</span> <span class="n">le</span> <span class="n">redistribuer</span><span class="p">,</span> <span class="n">sauf</span> <span class="n">sous</span> <span class="n">les</span> <span class="n">termes</span> <span class="n">du</span> <span class="n">copyleft</span><span class="o">.</span> <span class="n">En</span> <span class="n">conséquence</span> <span class="n">l</span><span class="s1">&#39;utilisateur doit à son tour fournir les sources et placer ses modifications sous GPL.</span>
</pre></div>
</div>
<p>Puisque le copyleft des versions 1 et 2 de la GPL ne s’appliquait pas aux entrées sorties du programme, il était possible dans le cas par exemple d’un service web de contourner l’obligation de diffusion des sources. De même, il suffisait de transformer tout code GPL en bibliothèque dynamique pour ne pas propager la GPL aux extensions apportées à un programme existant.</p>
<p>Cette faille a été corrigée avec la version GPL v3 qui accorde aux utilisateurs d’un programme accédé par réseau les mêmes droits que les utilisateurs d’un programme installé localement.</p>
<p>La GPL a été adaptée au droit français par le CEA, CNRS, INRIA sous le nom de CECILL. Sa version 2 est compatible avec la licence publique générale GNU.</p>
<p>Le 28 mars 2007 le tribunal de grande instance de Paris a jugé applicable la licence GPL (v2).</p>
</section>
</section>
<section id="la-licence-bsd">
<h3><a class="toc-backref" href="#id44"><span class="sectnum">1.3.4</span> La licence BSD</a><a class="headerlink" href="#la-licence-bsd" title="Lien permanent vers ce titre">¶</a></h3>
<p>La licence BSD permet l’utilisation du logiciel et la réutilisation de n’importe quelle partie de son code source sans restriction. La seule obligation était la mention des auteurs initiaux.</p>
<p>Pour pouvoir utiliser le logiciel écrit sous licence BSD l’utilisateur accepte de ne pas se retourner contre les auteurs en cas de problèmes.</p>
<p>Un logiciel propriétaire peut donc être réalisé à partir du code source d’un logiciel BSD (C.f. pile TCP/IP dans Windows).</p>
</section>
<section id="gnu-linux">
<h3><a class="toc-backref" href="#id45"><span class="sectnum">1.3.5</span> GNU/Linux</a><a class="headerlink" href="#gnu-linux" title="Lien permanent vers ce titre">¶</a></h3>
<p>Linux est développé sur internet par des milliers de contributeurs distants de nationalité et de culture différentes.
C’est l’un des projets collaboratifs les plus importants.</p>
</section>
</section>
<section id="les-distributions">
<h2><a class="toc-backref" href="#id46"><span class="sectnum">1.4</span> Les distributions</a><a class="headerlink" href="#les-distributions" title="Lien permanent vers ce titre">¶</a></h2>
<section id="qu-est-ce-qu-un-noyau">
<h3><a class="toc-backref" href="#id47"><span class="sectnum">1.4.1</span> Qu’est-ce qu’un noyau ?</a><a class="headerlink" href="#qu-est-ce-qu-un-noyau" title="Lien permanent vers ce titre">¶</a></h3>
<p>Pour définir le noyau, nous pouvons nous baser sur les services qu’il fournit :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Abstraction</span> <span class="n">du</span> <span class="n">matériel</span> <span class="p">(</span><span class="n">fourniture</span> <span class="n">d</span><span class="s1">&#39;interface)</span>
<span class="n">Gestion</span> <span class="n">des</span> <span class="n">interruptions</span>
<span class="n">Gestion</span> <span class="n">des</span> <span class="n">tâches</span> <span class="n">et</span> <span class="n">autres</span> <span class="n">logiciels</span>
<span class="n">Gestion</span> <span class="n">des</span> <span class="n">utilisateurs</span>
<span class="n">Gestion</span> <span class="n">des</span> <span class="n">droits</span> <span class="n">d</span><span class="s1">&#39;accès</span>
</pre></div>
</div>
<p>Historiquement on distingue les micro-noyaux des noyaux monolithiques.
Cette séparation vient de ce que le noyau est censé gérer (kernel space) et donc de ce qui est de la responsabilité des utilisateurs (user space). Dans les faits aujourd’hui même les noyaux monolithiques comme Linux sont modulaires et ne charge les modules que si nécessaire pendant l’utilisation.</p>
</section>
<section id="qu-est-ce-qu-une-distribution">
<h3><a class="toc-backref" href="#id48"><span class="sectnum">1.4.2</span> Qu’est-ce qu’une distribution ?</a><a class="headerlink" href="#qu-est-ce-qu-une-distribution" title="Lien permanent vers ce titre">¶</a></h3>
<p>Une distribution est un ensemble cohérent de logiciels fourni avec un noyau (Linux ou BSD). Les logiciels sont choisis pour utiliser les mêmes versions de bibliothèque et être compatibles les uns avec les autres ce qui a pour conséquence d’augmenter la stabilité et d’améliorer l’utilisation.</p>
<p>Elles comprennent des outils d’installation et de configuration.</p>
<p>Il en existe de nombreuses couvrant des besoins et des usages différents (ordinateur personnel, de bureau, serveur, passerelle, intrusion, multimédia center), ou des matériels spécifiques.</p>
</section>
<section id="les-differentes-distributions-gnu-linux">
<h3><a class="toc-backref" href="#id49"><span class="sectnum">1.4.3</span> Les différentes distributions GNU/Linux</a><a class="headerlink" href="#les-differentes-distributions-gnu-linux" title="Lien permanent vers ce titre">¶</a></h3>
<p>Sont orientées vers les utilisateurs débutants :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">*</span> <span class="n">Suse</span>
<span class="o">*</span> <span class="n">Ubuntu</span> <span class="n">Desktop</span><span class="p">,</span>
</pre></div>
</div>
<p>Pour les serveurs :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">*</span> <span class="n">Ubuntu</span> <span class="n">Server</span>
<span class="o">*</span> <span class="n">Debian</span>
<span class="o">*</span> <span class="n">Gentoo</span>
<span class="o">*</span> <span class="n">Red</span> <span class="n">Hat</span>
<span class="o">*</span> <span class="n">CentOS</span>
</pre></div>
</div>
<p>Pour les développeurs :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">*</span> <span class="n">Fedora</span>
<span class="o">*</span> <span class="n">Red</span> <span class="n">Hat</span>
</pre></div>
</div>
<p>Les métas distributions :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">*</span> <span class="n">Red</span> <span class="n">hat</span> <span class="o">-&gt;</span> <span class="n">Fedora</span><span class="p">,</span> <span class="n">CentOS</span>
<span class="o">*</span> <span class="n">Debian</span> <span class="o">-&gt;</span> <span class="n">Ubuntu</span><span class="p">,</span> <span class="n">Knoppix</span><span class="p">,</span>
<span class="o">*</span> <span class="n">Gentoo</span> <span class="o">-&gt;</span> <span class="n">Aurora</span>
</pre></div>
</div>
</section>
<section id="les-principales-distributions">
<h3><a class="toc-backref" href="#id50"><span class="sectnum">1.4.4</span> Les principales distributions</a><a class="headerlink" href="#les-principales-distributions" title="Lien permanent vers ce titre">¶</a></h3>
<p>Debian reste très orienté administrateur. Il est important d’être à l’aise avec la ligne de commande. Les versions stables sortent en moyenne tous les 2 ans.</p>
<p>Ubuntu reprend les outils Debian, mais les versions sortent tous les 6 mois.</p>
<p>Gentoo permet une optimisation poussée du système. Il propose en priorité de compiler les sources de chacun des logiciels et donc de ne garder que les fonctionnalités voulues par l’utilisateur, en tenant compte des nombreux paramètres locaux.</p>
<p>Distributions commerciales :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">*</span> <span class="n">Red</span> <span class="n">Hat</span> <span class="p">(</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">redhat</span><span class="o">.</span><span class="n">com</span><span class="p">),</span>
<span class="o">*</span> <span class="n">Novell</span><span class="o">/</span><span class="n">SUSE</span> <span class="p">(</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">novell</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">linux</span><span class="o">/</span><span class="p">)</span><span class="o">.</span>
</pre></div>
</div>
<p>Distributions « communautaires » :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">*</span> <span class="n">Gentoo</span> <span class="p">(</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">gentoo</span><span class="o">.</span><span class="n">org</span><span class="p">)</span>
<span class="o">*</span> <span class="n">CentOs</span> <span class="p">(</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">centos</span><span class="o">.</span><span class="n">org</span><span class="p">)</span>
<span class="o">*</span> <span class="n">Debian</span> <span class="p">(</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">debian</span><span class="o">.</span><span class="n">org</span><span class="p">)</span>
<span class="o">*</span> <span class="n">Fedora</span> <span class="p">(</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">fedoraproject</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="p">)</span>
<span class="o">*</span> <span class="n">Ubuntu</span> <span class="p">(</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">ubuntu</span><span class="o">.</span><span class="n">com</span><span class="p">)</span>
</pre></div>
</div>
<p>Linus Torvalds défend la multiplicité des distributions.</p>
</section>
</section>
<section id="installation">
<h2><a class="toc-backref" href="#id51"><span class="sectnum">1.5</span> Installation</a><a class="headerlink" href="#installation" title="Lien permanent vers ce titre">¶</a></h2>
<p>Le choix d’une distribution doit se faire en fonction :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">*</span> <span class="n">du</span> <span class="n">besoin</span> <span class="n">technique</span><span class="p">,</span>
<span class="o">*</span> <span class="n">des</span> <span class="n">performances</span> <span class="n">voulues</span><span class="p">,</span>
<span class="o">*</span> <span class="n">de</span> <span class="n">la</span> <span class="n">pérennité</span> <span class="n">désirée</span><span class="p">,</span>
<span class="o">*</span> <span class="n">du</span> <span class="n">niveau</span> <span class="n">de</span> <span class="n">sécurisation</span> <span class="n">attendu</span><span class="o">.</span>
</pre></div>
</div>
<p>Une fois ces exigences connues, il ne reste plus qu’à se procurer les images des distributions adéquates, soit directement sur les sites des distributions, soit sur un miroir.</p>
<section id="installation-de-gnu-linux-ubuntu-version-pc-de-bureau">
<h3><a class="toc-backref" href="#id52"><span class="sectnum">1.5.1</span> Installation de GNU/Linux Ubuntu version pc de bureau</a><a class="headerlink" href="#installation-de-gnu-linux-ubuntu-version-pc-de-bureau" title="Lien permanent vers ce titre">¶</a></h3>
<p>Les versions desktop d’Ubuntu sont fournies avec l’environnement graphique Gnome, des outils de maintenance, la suite open-office, le lecteur de courrier evolution, le logiciel de dessin Gimp, le navigateur firefox, un client vnc permettant de se connecter à distance, des jeux, des logiciels multimédias.</p>
<p>Elles conviennent parfaitement à un poste de travail, mais sont à proscrire pour un serveur en raison du nombre de services fonctionnant par défaut.</p>
<section id="installation-d-ubuntu-20-04">
<h4><a class="toc-backref" href="#id53"><span class="sectnum">1.5.1.1</span> Installation d’Ubuntu 20.04</a><a class="headerlink" href="#installation-d-ubuntu-20-04" title="Lien permanent vers ce titre">¶</a></h4>
<p>Choisir l’image « iso » d’Ubuntu correspondant à sa machine à l’adresse <a class="reference external" href="https://releases.ubuntu.com/20.04/">https://releases.ubuntu.com/20.04/</a></p>
<p>La différence entre Desktop et Server est que dans la Desktop vous aurez tout l’environnement graphique, alors que la version Server suppose une utilisation en ligne de commande.</p>
<p>Créer un disque d’amorçage en suivant <a class="reference external" href="https://help.ubuntu.com/community/BurningIsoHowto">https://help.ubuntu.com/community/BurningIsoHowto</a></p>
<p>Insérer la clé dans votre lecteur usb.
Redémarrer votre ordinateur pour pouvoir modifier les paramètres du <strong>bios</strong>.
Selon la marque de votre ordinateur la touche pour entrer dans le bios lors du démarrage est soit Ech, Entrée, F2, ou Suppr.
Modifier votre bios pour qu’il démarre sur la clé usb (généralement le menu boot).
Enregistrer et quitter le bios.
L’ordinateur va alors démarrer sur la clé et charger Ubuntu comme système d’exploitation.
Ubuntu commence par vérifier qu’il n’y a pas eu de corruption de la clé.
Puis il affiche différents écrans que nous allons expliquer ici.</p>
</section>
<section id="etape-01">
<h4><a class="toc-backref" href="#id54"><span class="sectnum">1.5.1.2</span> Étape 01</a><a class="headerlink" href="#etape-01" title="Lien permanent vers ce titre">¶</a></h4>
<figure class="align-center" id="id16">
<img alt="../_images/00_EssayerOuInstaller.png" src="../_images/00_EssayerOuInstaller.png" />
<figcaption>
<p><span class="caption-text">Choix de la langue du live usb.
Et choix entre tester Ubuntu ou lancer l’installation.</span><a class="headerlink" href="#id16" title="Lien permanent vers cette image">¶</a></p>
</figcaption>
</figure>
<p>Si vous cliquez sur le bouton « Essayer Ubuntu » vous pourrez tester Ubuntu sans rien installer sur votre machine, les logiciels utilisés seront ceux présents sur la clé usb (vous pourrez en installer d’autres).
C’est un excellent moyen de dépanner une machine pour par exemple accéder à vos disques lorsque votre l’OS de votre machine ne fonctionne plus.</p>
</section>
<section id="etape-02">
<h4><a class="toc-backref" href="#id55"><span class="sectnum">1.5.1.3</span> Étape 02</a><a class="headerlink" href="#etape-02" title="Lien permanent vers ce titre">¶</a></h4>
<figure class="align-center" id="id17">
<img alt="../_images/02_Clavier.png" src="../_images/02_Clavier.png" />
<figcaption>
<p><span class="caption-text">Choix de la disposition du clavier.</span><a class="headerlink" href="#id17" title="Lien permanent vers cette image">¶</a></p>
</figcaption>
</figure>
<p>Les différents choix déterminent comment vous allez pouvoir saisir les caractères comme œ.
Par exemple avec le choix de clavier « alt. » il suffira de faire « Alt Gr » « o », pour avoir œ.
Vous pouvez tester les touches du clavier dans la zone de saisie du texte.</p>
</section>
<section id="etape-03">
<h4><a class="toc-backref" href="#id56"><span class="sectnum">1.5.1.4</span> Étape 03</a><a class="headerlink" href="#etape-03" title="Lien permanent vers ce titre">¶</a></h4>
<figure class="align-center" id="id18">
<img alt="../_images/03_TypeInstall.png" src="../_images/03_TypeInstall.png" />
<figcaption>
<p><span class="caption-text">Type d’installation avec mise à jour ou non.</span><a class="headerlink" href="#id18" title="Lien permanent vers cette image">¶</a></p>
</figcaption>
</figure>
<p>L’installation minimale n’installe pas les logiciels comme libre office vous laissant le faire par la suite.
Demander la mise à jour lors de l’installation suppose d’être relié à internet.</p>
</section>
<section id="etape-04">
<h4><a class="toc-backref" href="#id57"><span class="sectnum">1.5.1.5</span> Étape 04</a><a class="headerlink" href="#etape-04" title="Lien permanent vers ce titre">¶</a></h4>
<figure class="align-center" id="id19">
<img alt="../_images/03_TypeInstall.png" src="../_images/03_TypeInstall.png" />
<figcaption>
<p><span class="caption-text">Choix du partitionnement si l’on clique sur « autre chose » on pourra créer ses partitions.</span><a class="headerlink" href="#id19" title="Lien permanent vers cette image">¶</a></p>
</figcaption>
</figure>
<p>Par défaut le disque sera formaté et une partition racine sera créée ainsi qu’une partition swap.
La partition de swap est utilisée pour stocker temporairement la mémoire d’un programme qui s’exécutait, mais qui n’est pas celui en cours d’utilisation.
Par exemple si vous n’avez que très peu de mémoire et que vous lancez plusieurs programmes, celui avec lequel vous interagissez sera en mémoire et les autres peuvent être dans le swap.</p>
<p>Si votre swap a la même taille que votre mémoire vive vous pourrez « hiberner » votre ordinateur, ainsi toute la mémoire vive sera copiée dans le swap et l’ordinateur sera éteint, lorsqu’il sera rallumé tout le swap sera recopié en mémoire vive et les programmes reprendront là où ils en étaient.</p>
<p>C’est pour cela qu’il est intéressant de créer et paramétrer ses partitions et au minimum de créer une partition « /home » pour préserver le contenu de ses données en cas de crash sévère de l’OS, nous allons voir comment partitionner le disque.</p>
<p>Nous détaillerons le partitionnement ci-après.</p>
</section>
<section id="etape-05">
<h4><a class="toc-backref" href="#id58"><span class="sectnum">1.5.1.6</span> Étape 05</a><a class="headerlink" href="#etape-05" title="Lien permanent vers ce titre">¶</a></h4>
<figure class="align-center" id="id20">
<img alt="../_images/05_TypePartitionLVM.png" src="../_images/05_TypePartitionLVM.png" />
<figcaption>
<p><span class="caption-text">Ubuntu propose d’utiliser LVM.</span><a class="headerlink" href="#id20" title="Lien permanent vers cette image">¶</a></p>
</figcaption>
</figure>
<p>LVM (Logical Volume Manager) est un gestionnaire de volumes logiques qui vous permettra de créer des partitions virtuelles afin de pouvoir les retailler ou d’en créer de nouvelles.
Linux crée alors une couche intermédiaire entre le(s) disque(s) physique(s) et l’OS, c’est dans cette couche virtuelle que vous aurez vos partitions virtuelles qui seront écrites dans la partition réelle.
Toutefois si la partition physique est abîmée, on perd les partitions virtuelles écrites dessus, c’est pourquoi il faut faire des copies de sauvegardes ou avoir des disques montés en raid.
Vous pouvez également chiffrer la partition LVM.</p>
</section>
<section id="etape-06">
<h4><a class="toc-backref" href="#id59"><span class="sectnum">1.5.1.7</span> Étape 06</a><a class="headerlink" href="#etape-06" title="Lien permanent vers ce titre">¶</a></h4>
<figure class="align-center" id="id21">
<img alt="../_images/07_FuseauHoraire.png" src="../_images/07_FuseauHoraire.png" />
<figcaption>
<p><span class="caption-text">Choix du fuseau horaire.</span><a class="headerlink" href="#id21" title="Lien permanent vers cette image">¶</a></p>
</figcaption>
</figure>
<p>Si vous êtes en France métropolitaine, choisissez le fuseau passant par la France.</p>
</section>
<section id="etape-07">
<h4><a class="toc-backref" href="#id60"><span class="sectnum">1.5.1.8</span> Étape 07</a><a class="headerlink" href="#etape-07" title="Lien permanent vers ce titre">¶</a></h4>
<figure class="align-center" id="id22">
<img alt="../_images/15_User1000.png" src="../_images/15_User1000.png" />
<figcaption>
<p><span class="caption-text">Création du 1er compte utilisateur.</span><a class="headerlink" href="#id22" title="Lien permanent vers cette image">¶</a></p>
</figcaption>
</figure>
<p>Sous Ubuntu cet utilisateur aura la particularité de pouvoir mettre à jour le système et plus généralement de pouvoir devenir super utilisateur (root).</p>
</section>
<section id="etape-08">
<h4><a class="toc-backref" href="#id61"><span class="sectnum">1.5.1.9</span> Étape 08</a><a class="headerlink" href="#etape-08" title="Lien permanent vers ce titre">¶</a></h4>
<p>Ubuntu affiche un récapitulatif des choix réalisés, la confirmation lance alors le partitionnement des disques, leur formatage puis l’installation du système.</p>
<figure class="align-center" id="id23">
<img alt="../_images/15_User1000.png" src="../_images/15_User1000.png" />
<figcaption>
<p><span class="caption-text">Une fois les choix confirmés, l’installation commence.</span><a class="headerlink" href="#id23" title="Lien permanent vers cette image">¶</a></p>
</figcaption>
</figure>
<p>En fin d’installation un écran vous invite à retirer la clé usb et à redémarrer l’ordinateur.</p>
<figure class="align-center" id="id24">
<img alt="../_images/17_FinInstallation.png" src="../_images/17_FinInstallation.png" />
<figcaption>
<p><span class="caption-text">Fin d’installation.</span><a class="headerlink" href="#id24" title="Lien permanent vers cette image">¶</a></p>
</figcaption>
</figure>
<p>Une fois redémarré saisissez votre identifiant et votre mot de passe (ceux donnés à l’étape 07)</p>
<p>Vous pouvez alors associer votre machine à vos comptes google et microsoft pour par exemple voir vos agendas et recevoir vos notifications.</p>
<figure class="align-center" id="id25">
<img alt="../_images/18_ConfigurationComptesEnLigne.png" src="../_images/18_ConfigurationComptesEnLigne.png" />
<figcaption>
<p><span class="caption-text">Configuration des comptes en lignes.</span><a class="headerlink" href="#id25" title="Lien permanent vers cette image">¶</a></p>
</figcaption>
</figure>
<p>Vous pouvez associer votre machine au mécanisme livepatch de Canonical l’éditeur d’Ubuntu pour faire automatiquement la mise à jour de votre machine.</p>
<figure class="align-center" id="id26">
<img alt="../_images/19_LivePatch.png" src="../_images/19_LivePatch.png" />
<figcaption>
<p><span class="caption-text">Configuration de votre compte Ubuntu pour le live patch.</span><a class="headerlink" href="#id26" title="Lien permanent vers cette image">¶</a></p>
</figcaption>
</figure>
<p>Vous pouvez aider Canonical à corriger les bogues en autorisant la remontée des incidents.</p>
<figure class="align-center" id="id27">
<img alt="../_images/20_UbuntuWatch.png" src="../_images/20_UbuntuWatch.png" />
<figcaption>
<p><span class="caption-text">Remonté des informations pour les développeurs.</span><a class="headerlink" href="#id27" title="Lien permanent vers cette image">¶</a></p>
</figcaption>
</figure>
<p>Il est possible de permettre la géolocalisation.</p>
<figure class="align-center" id="id28">
<img alt="../_images/21_Geolocalisation.png" src="../_images/21_Geolocalisation.png" />
<figcaption>
<p><span class="caption-text">Autorisation de la géolocalisation.</span><a class="headerlink" href="#id28" title="Lien permanent vers cette image">¶</a></p>
</figcaption>
</figure>
<p>On peut installer immédiatement les applications compatibles avec Ubuntu 20.04</p>
<figure class="align-center" id="id29">
<img alt="../_images/22_AutresApplications.png" src="../_images/22_AutresApplications.png" />
<figcaption>
<p><span class="caption-text">Fin d’installation.</span><a class="headerlink" href="#id29" title="Lien permanent vers cette image">¶</a></p>
</figcaption>
</figure>
</section>
<section id="etape-alternative-04-bis">
<h4><a class="toc-backref" href="#id62"><span class="sectnum">1.5.1.10</span> Étape alternative 04 bis</a><a class="headerlink" href="#etape-alternative-04-bis" title="Lien permanent vers ce titre">¶</a></h4>
<p>Le partitionnement est l’étape la plus importante, car il est difficile de corriger les erreurs.</p>
<p>Pour les serveurs cette étape influence directement la sécurité du système (/var/lib, /var/log, /var/spool, /var/www, /tmp), la sécurité est alors physique et ne repose pas seulement sur le mécanisme des quotas. De plus, l’analyse post-mortem d’une partition dédiée est plus facile que celle d’un énorme fourre-tout.</p>
<p>Au minimum, il est recommandé d’avoir une partition /, /home et swap.</p>
<p>Pour activer le partitionnement manuel, il suffit de cocher sur le bouton « Autre chose » à l’étape 04.</p>
<p>Il faut alors choisir un disque.</p>
<figure class="align-center" id="id30">
<img alt="../_images/09_TypePartition_Partitioner_sda.png" src="../_images/09_TypePartition_Partitioner_sda.png" />
<figcaption>
<p><span class="caption-text">Création de la table de partition</span><a class="headerlink" href="#id30" title="Lien permanent vers cette image">¶</a></p>
</figcaption>
</figure>
<figure class="align-center" id="id31">
<img alt="../_images/10_TypePartition_Partitioner_sda_NouvelleTable.png" src="../_images/10_TypePartition_Partitioner_sda_NouvelleTable.png" />
<figcaption>
<p><span class="caption-text">Création de la table de partition</span><a class="headerlink" href="#id31" title="Lien permanent vers cette image">¶</a></p>
</figcaption>
</figure>
<p>Le bouton « + » permet de créer de nouvelle partition</p>
<p>Dans notre cas nous allons créer 3 partitions /, /home et swap.</p>
<figure class="align-center" id="id32">
<img alt="../_images/12_TypePartition_Partitioner_sda_NouvelleTable_root.png" src="../_images/12_TypePartition_Partitioner_sda_NouvelleTable_root.png" />
<figcaption>
<p><span class="caption-text">Création de la racine « / »</span><a class="headerlink" href="#id32" title="Lien permanent vers cette image">¶</a></p>
</figcaption>
</figure>
<p>Sur le même principe, on crée « /home »
On peut cocher la case « formater » pour purger le disque de ce qu’il contenait avant.</p>
<p>Puis vient la partition de « swap ».</p>
<figure class="align-center" id="id33">
<img alt="../_images/13_TypePartition_Partitioner_sda_root_home_swap.png" src="../_images/13_TypePartition_Partitioner_sda_root_home_swap.png" />
<figcaption>
<p><span class="caption-text">Création du swap</span><a class="headerlink" href="#id33" title="Lien permanent vers cette image">¶</a></p>
</figcaption>
</figure>
<p>N’oubliez pas que la taille du swap doit être au moins égale à celle de la mémoire vive (RAM) pour permettre l’hibernation.</p>
<figure class="align-center" id="id34">
<img alt="../_images/14_TypePartition_Partitioner_sda_root_home_swap.png" src="../_images/14_TypePartition_Partitioner_sda_root_home_swap.png" />
<figcaption>
<p><span class="caption-text">Création des partitions</span><a class="headerlink" href="#id34" title="Lien permanent vers cette image">¶</a></p>
</figcaption>
</figure>
</section>
</section>
<section id="installation-de-gnu-linux-ubuntu-en-version-serveur">
<h3><a class="toc-backref" href="#id63"><span class="sectnum">1.5.2</span> Installation de GNU/Linux Ubuntu en version serveur</a><a class="headerlink" href="#installation-de-gnu-linux-ubuntu-en-version-serveur" title="Lien permanent vers ce titre">¶</a></h3>
<p>La philosophie des distributions serveur est moins il y a de programmes installés plus le système est stable et moins il y a de faille de sécurité.</p>
<p>En conséquence, les interfaces graphiques ne sont disponibles qu’en option et le moyen privilégié d’administrer le système est la ligne de commande.</p>
<p>Pour un serveur il vaut mieux opter pour les versions LTS (Long Term Support) des distributions.</p>
<p>Les différences entre « Debian server » et « Ubuntu server » sont liées aux versions du noyau et des bibliothèques utilisées, aux dépôts et fichiers de configurations par défaut.</p>
<section id="attention">
<h4><a class="toc-backref" href="#id64"><span class="sectnum">1.5.2.1</span> Attention</a><a class="headerlink" href="#attention" title="Lien permanent vers ce titre">¶</a></h4>
<p>Sous Ubuntu, il n’est pas possible de créer une partition /var, car le système y stocke des fichiers au démarrage, alors que les points de montage ne sont pas encore installés, ce qui provoque un plantage du système difficile à comprendre.</p>
</section>
<section id="travaux-pratiques">
<h4><a class="toc-backref" href="#id65"><span class="sectnum">1.5.2.2</span> Travaux pratiques</a><a class="headerlink" href="#travaux-pratiques" title="Lien permanent vers ce titre">¶</a></h4>
<p>Installation d’une Ubuntu server LTS</p>
</section>
</section>
<section id="utilisation-de-gnu-linux">
<h3><a class="toc-backref" href="#id66"><span class="sectnum">1.5.3</span> Utilisation de GNU/Linux</a><a class="headerlink" href="#utilisation-de-gnu-linux" title="Lien permanent vers ce titre">¶</a></h3>
<p>Présentation interactive du système d’exploitation:</p>
<blockquote>
<div><ul class="simple">
<li><p>le bureau,</p></li>
<li><p>les fenêtres d’application,</p></li>
<li><p>le tableau de bord.</p></li>
</ul>
</div></blockquote>
<p>Administration graphique du système:</p>
<blockquote>
<div><ul class="simple">
<li><p>Configuration du réseau (Système (Flèche descendante de la barre de menus, à droite) &gt; Wifi ou Filaire (non) connecté ou Administration (Roue dentée) &gt; Wifi ou Réseau)</p></li>
<li><p>Synaptic (Pour l’installer <a class="reference external" href="https://doc.ubuntu-fr.org/synaptic">https://doc.ubuntu-fr.org/synaptic</a> ): l’installation de logiciels (Système &gt; Administration &gt; Gestionnaire de paquets Synaptic)</p></li>
<li><p>configuration des dépôts (Rechercher depuis le menu Activité -&gt; Logiciels &amp; mises à jour)</p></li>
<li><p>personnalisations basiques <a class="reference external" href="https://doc.ubuntu-fr.org/personnalisation_basique">https://doc.ubuntu-fr.org/personnalisation_basique</a></p></li>
<li><p>la configuration de Gnome (installer gnome-tweaks )</p></li>
<li><p>les applets</p></li>
<li><p>la résolution graphique</p></li>
<li><p>les bureaux virtuels</p></li>
<li><p>les services (Système &gt; Administration &gt; Services)</p></li>
</ul>
</div></blockquote>
<p>Les logiciels d’administration ne sont que des surcouches graphiques (front-end) qui appellent les commandes en ligne, par conséquent leurs possibilités sont moindres.</p>
</section>
</section>
<section id="l-aide-et-la-communaute">
<h2><a class="toc-backref" href="#id67"><span class="sectnum">1.6</span> L’aide et la communauté</a><a class="headerlink" href="#l-aide-et-la-communaute" title="Lien permanent vers ce titre">¶</a></h2>
<section id="l-aide-en-ligne">
<h3><a class="toc-backref" href="#id68"><span class="sectnum">1.6.1</span> L’aide en ligne</a><a class="headerlink" href="#l-aide-en-ligne" title="Lien permanent vers ce titre">¶</a></h3>
<p>En mode graphique, les applications possèdent un onglet « Aide » permettant d’ouvrir un navigateur sur l’aide en ligne. Cette aide est généralement accessible par la touche F1.</p>
<figure class="align-center" id="id35">
<img alt="../_images/AideEnLigneUbuntu.jpg" src="../_images/AideEnLigneUbuntu.jpg" />
<figcaption>
<p><span class="caption-text">Aide en ligne d’Ubuntu (appelée avec F1)</span><a class="headerlink" href="#id35" title="Lien permanent vers cette image">¶</a></p>
</figcaption>
</figure>
<p>Dans un shell, la plupart des commandes unix acceptent l’option -h ou –help ou –usage :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>michaellaunay@luciole:~$ apropos --help
Usage: apropos [OPTION...] KEYWORD...
Project-Id-Version: man-db 2.3.90
Report-Msgid-Bugs-To: Colin Watson &lt;cjwatson@debian.org&gt;
POT-Creation-Date: 2008-05-05 02:09+0100
PO-Revision-Date: 2008-08-19 20:37+0000
Last-Translator: Laurent Pelecq &lt;laurent.pelecq@soleil.org&gt;
Language-Team: French &lt;traduc@traduc.org&gt;
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit
X-Launchpad-Export-Date: 2008-11-09 09:58+0000
X-Generator: Launchpad (build Unknown)

  -d, --debug                emit debugging messages
  -v, --verbose              print verbose warning messages
  -e, --exact                search each keyword for exact match
  -r, --regex                interpret each keyword as a regex
  -w, --wildcard             the keyword(s) contain wildcards
  -a, --and                  require all keywords to match
  -l, --long                 do not trim output to terminal width
  -C, --config-file=FICHIER  use this user configuration file
  -L, --locale=LOCALE        define the locale for this search
  -m, --systems=SYSTEM       use manual pages from other systems
  -M, --manpath=CHEMIN       set search path for manual pages to PATH
  -s, --section=SECTION      search only this section
  -?, --help                 give this help list
      --usage                give a short usage message
  -V, --version              print program version

Mandatory or optional arguments to long options are also mandatory or optional
for any corresponding short options.

The --regex option is enabled by default.

Report bugs to cjwatson@debian.org.
</pre></div>
</div>
<p>Pour trouver une commande il suffit de faire apropos MotClé qui affichera toutes les commandes comportant MotClé dans sa description courte. Toutefois la base des commandes peut avoir besoin d’être régénérée par <strong>makewhatis</strong>.</p>
<p><em>whatis NomDeCommande</em> affichera la description courte de NomDeCommande.</p>
</section>
<section id="les-man-pages">
<h3><a class="toc-backref" href="#id69"><span class="sectnum">1.6.2</span> Les man pages</a><a class="headerlink" href="#les-man-pages" title="Lien permanent vers ce titre">¶</a></h3>
<p>Les applications et commandes possèdent toutes un manuel accessible en ligne de commande via la commande man.</p>
<p>Ce manuel est généralement traduit dans la langue de l’utilisateur</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>michaellaunay@luciole:~$ man man
MAN(1)            Utilitaires de l’afficheur des pages de manuel               MAN(1)

NOM
       man - Interface de consultation des manuels de référence en ligne

SYNOPSIS
       man  [-c|-w|-tZ] [-H[navigateur]] [-T[périphérique]] [-adhu7V] [-i|-I]
       [-m système[,...]] [-L langue] [-p chaîne] [-C fichier] [-M chemin]
       [-P afficheur] [-r invite] [-S liste] [-e extension] [[section] page ...] ...
       man -l [-7] [-tZ] [-H[navigateur]] [-T[périphérique]] [-p chaîne]
       [-P afficheur] [-r invite] fichier ...
       man -k [apropos options] expression_rationnelle ...
       man -f [whatis options] page ...

DESCRIPTION
       man est le programme de visualisation des pages de manuel.  Chacun  des  argu-
       ments  page,  indiqué dans la ligne de commande de man, porte, en principe, le
       nom d’un programme, d’un utilitaire ou d’une fonction. La page de manuel  cor-
       respondant à chaque argument est alors trouvée et affichée. Si une section est
       précisée alors man limite  la  recherche  à  cette  section.  Par  défaut,  il
       recherche dans toutes les sections disponibles, suivant un ordre prédéfini. Il
       n’affiche que la première page de manuel trouvée, même si  d’autres  pages  de
       manuel existent dans d’autres sections.

       Le  tableau  ci-dessous  indique le numéro des sections de manuel ainsi que le
       type de pages qu’elles contiennent.

       1   Programmes exécutables ou commandes de l’interpréteur de  com-
           mandes (shell) ;
       2   Appels système (Fonctions fournies par le noyau) ;
       3   Appels  de  bibliothèque  (fonctions  fournies  par  les  bib-
           liothèques des programmes) ;
       4   Fichiers spéciaux (situés généralement dans /dev) ;
       5   Formats des fichiers et conventions. Par exemple /,etc/passwd ;
       6   Jeux ;
       7   Divers (y compris les macropaquets et les  conventions).   Par
           exemple, man(7), groff(7) ;
       8   Commandes  de  gestion  du  système (généralement réservées au
           superutilisateur) ;
       9   Sous-programmes du noyau [hors standard].

       Une page de manuel est constituée de plusieurs parties.

       Elles peuvent être libellées NOM, SYNOPSIS,  DESCRIPTION,  OPTIONS,  FICHIERS,
       VOIR AUSSI, BOGUES et AUTEUR.
</pre></div>
</div>
<p>Pour chercher les pages associées à un mot clé:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>michaellaunay@luciole:~/Documents/ecreall/Cours/CoursGNULinux$ man -k manual
apropos (1)          - search the manual page names and descriptions
catman (8)           - create or update the pre-formatted manual pages
esdcompat (1)        - manual page for pulseaudio esd wrapper 0.9.5
grub-reboot (8)      - manual page for grub-reboot 0.01
man (1)              - an interface to the on-line reference manuals
manconv (1)          - convert manual page from one encoding to another
mandb (8)            - create or update the manual page index caches
manpath (1)          - determine search path for manual pages
missing (7)          - missing manual pages
pulseaudio (1)       - manual page for pulseaudio 0.9.5
readahead-list (8)   - manual page for readahead-list: 0.20050517.0220
readahead-watch (8)  - manual page for readahead-watch: 0.20050517.0220
update-apt-xapian-index (8) - manual page for update-apt-xapian-index 0.15
w3mman (1)           - an interface to the on-line reference manuals by w3m(1)
whatis (1)           - display manual page descriptions
whereis (1)          - locate the binary, source, and manual page files for a command
xman (1)             - Manual page display program for the X Window System
</pre></div>
</div>
</section>
<section id="les-sites">
<h3><a class="toc-backref" href="#id70"><span class="sectnum">1.6.3</span> Les sites</a><a class="headerlink" href="#les-sites" title="Lien permanent vers ce titre">¶</a></h3>
<p>Le site officiel de Linux <a class="reference external" href="http://www.linux.org">http://www.linux.org</a></p>
<p>Un site dédié à Linux (Linux Entre Amis) : <a class="reference external" href="http://www.lea-linux.org">http://www.lea-linux.org</a></p>
<p>Une présentation de Linux <a class="reference external" href="http://fr.wikipedia.org/wiki/Linux">http://fr.wikipedia.org/wiki/Linux</a></p>
<p>La communauté ubuntu française <a class="reference external" href="http://www.ubuntu-fr.org/">http://www.ubuntu-fr.org/</a></p>
</section>
<section id="les-forums">
<h3><a class="toc-backref" href="#id71"><span class="sectnum">1.6.4</span> Les forums</a><a class="headerlink" href="#les-forums" title="Lien permanent vers ce titre">¶</a></h3>
<p>Le forum de la communauté Ubuntu <a class="reference external" href="http://ubuntuforums.org/">http://ubuntuforums.org/</a></p>
<p>Le forum de la communauté Debian française <a class="reference external" href="http://forum.debian-fr.org">http://forum.debian-fr.org</a></p>
</section>
<section id="les-lugs">
<h3><a class="toc-backref" href="#id72"><span class="sectnum">1.6.5</span> Les LUGs</a><a class="headerlink" href="#les-lugs" title="Lien permanent vers ce titre">¶</a></h3>
<p>Un LUG est un groupe d’utilisateurs de Linux (Linux User Group) réuni généralement au sein d’une association loi 1901.</p>
<p>Dans la région lilloise on compte essentiellement Chtinux <a class="reference external" href="http://www.chtinux.org/">http://www.chtinux.org/</a> anciennement Campux et CLX <a class="reference external" href="http://clx.asso.fr/spip">http://clx.asso.fr/spip</a></p>
<p>Les LUGs réalisent la promotion de Linux est des logiciels libres. Ils organisent des manifestations telles que des install party.</p>
</section>
</section>
<section id="shell-commandes">
<h2><a class="toc-backref" href="#id73"><span class="sectnum">1.7</span> Shell &amp; Commandes</a><a class="headerlink" href="#shell-commandes" title="Lien permanent vers ce titre">¶</a></h2>
<section id="les-terminaux-tty">
<h3><a class="toc-backref" href="#id74"><span class="sectnum">1.7.1</span> Les terminaux (tty)</a><a class="headerlink" href="#les-terminaux-tty" title="Lien permanent vers ce titre">¶</a></h3>
<p>Historiquement, un terminal est une interface homme-machine minimale issue des technologies de communication de la fin XIX et du début XX siècle, le Télétype marque déposée en 1906 est l’ancêtre des claviers numériques des premiers ordinateurs.</p>
<p>L’abréviation tty de Télétype a été utilisée pour décrire l’interface série de communication utilisée au début d’Unix. Par usage c’est le terme qui décrit l’interface de saisie et d’affichage avec l’humain. On trouve aussi l’appellation de terminal ou console.</p>
<p>La commande tty affiche le pseudo fichier associé à la saisie.</p>
<p>Dans l’environnement graphique XWindows on trouve des logiciels émulant les terminaux, on les appelle alors des terminaux virtuels (ex: xterm).</p>
<p>Les terminaux ne sont en charge que de la récupération des touches frappées, de leur transformation en lettre, et de l’affichage de celle-ci. L’interprétation de ce qui est saisi est dévolue au shell.</p>
<p>Les six premiers terminaux sont accessibles par la combinaison de touche Ctrl Alt F[1-6].</p>
<p>Le terminal graphique est accessible Ctrl Alt F7</p>
</section>
<section id="la-ligne-de-commande">
<h3><a class="toc-backref" href="#id75"><span class="sectnum">1.7.2</span> La ligne de commande</a><a class="headerlink" href="#la-ligne-de-commande" title="Lien permanent vers ce titre">¶</a></h3>
<p>Sous Unix la CLI (Command Line Interface) est la méthode privilégiée pour transmettre au système les ordres à exécuter.</p>
<section id="les-differents-shell">
<h4><a class="toc-backref" href="#id76"><span class="sectnum">1.7.2.1</span> Les différents shell</a><a class="headerlink" href="#les-differents-shell" title="Lien permanent vers ce titre">¶</a></h4>
<p>Le shell est un logiciel qui interprète séquentiellement les commandes saisies dans un terminal ou stockées dans un fichier (script) ou provenant d’un pseudo fichier.</p>
<p>La syntaxe et la sémantique de cette interprétation dépendent du shell employé.</p>
<p>Historiquement la première version est <strong>sh</strong> (1977 écrit par Stephen Bourne) qui évolua en <strong>csh</strong>, <strong>ksh</strong> et <strong>bash</strong> (Bourne again shell) le plus répandu.</p>
<p>Bash est l’interpréteur de commande par défaut des Unix libres et de Mac OS X.</p>
<p>Pour connaître la version de bash en cours d’utilisation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>michaellaunay@luciole:~$ echo $BASH
/bin/bash
michaellaunay@luciole:~$ echo $BASH_VERSION
4.3.39(1)-release
</pre></div>
</div>
<p>Pour modifier le shell par défaut associé à un utilisateur il faut modifier <em>/,etc/passwd</em> avec la commande <strong>usermod -s /bin/bash login</strong> :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>michaellaunay@luciole:~$ grep michael /etc/passwd
michaellaunay:x:1000:1000:Michael Launay,,,:/home/michaellaunay:/bin/bash
michaellaunay@luciole:~$ sudo usermod -s /bin/sh michaellaunay
michaellaunay@luciole:~$ grep michael /etc/passwd
michaellaunay:x:1000:1000:Michael Launay,,,:/home/michaellaunay:/bin/sh
</pre></div>
</div>
<p>Pour créer un compte qui pourra se connecter sans avoir de shell (utilisation de tunnel) :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">usermod</span> <span class="o">-</span><span class="n">s</span> <span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">false</span> <span class="n">prestataire</span>
</pre></div>
</div>
<p>Détails sur le format du fichier passwd</p>
<blockquote>
<div><p><a class="reference external" href="mailto:michaellaunay&#37;&#52;&#48;luciole">michaellaunay<span>&#64;</span>luciole</a>:~$ man 5 passwd
PASSWD(5)                   Formats et conversions de fich                   PASSWD(5)</p>
<dl>
<dt>NOM</dt><dd><p>passwd - fichier des mots de passe</p>
</dd>
<dt>DESCRIPTION</dt><dd><p>/,etc/passwd contient différentes informations sur les comptes utilisateurs. Ces
informations consistent en sept champs séparés par des deux-points (« : ») :</p>
<p>·   nom de connexion de l´utilisateur (« login »)
·   un mot de passe chiffré optionnel
·   l´identifiant numérique de l´utilisateur
·   l´identifiant numérique du groupe de l´utilisateur
·   le nom complet de l´utilisateur ou un champ de commentaires
·   le répertoire personnel de l´utilisateur
·   l´interpréteur de commandes de l´utilisateur (optionnel)</p>
<p>Le champ du mot de passe chiffré peut être vide. Dans ce cas, aucun mot de
passe n´est nécessaire pour s´authentifier avec le compte donné. Cependant,
certaines applications qui lisent le fichier /,etc/passwd peuvent décider de ne
donner aucun accès si le mot de passe est vide. Si le mot de passe est un « x »
minuscule, alors le mot de passe chiffré se trouve dans le fichier shadow(5) ;
il doit y avoir une ligne correspondante dans le fichier shadow, sinon le
compte de l´utilisateur n´est pas valide. Si le mot de passe est constitué
d´une autre chaîne, alors il est considéré comme un mot de passe chiffré, comme
indiqué dans crypt(3).</p>
</dd>
</dl>
</div></blockquote>
<p>Plus d’information : man bash</p>
<p>Lien : <a class="reference external" href="http://fr.wikipedia.org/wiki/Bourne-Again_shell">http://fr.wikipedia.org/wiki/Bourne-Again_shell</a></p>
</section>
<section id="les-fichiers-de-ressources-et-de-configuration-de-bash">
<h4><a class="toc-backref" href="#id77"><span class="sectnum">1.7.2.2</span> Les fichiers de ressources et de configuration de bash</a><a class="headerlink" href="#les-fichiers-de-ressources-et-de-configuration-de-bash" title="Lien permanent vers ce titre">¶</a></h4>
<p>Au lancement du shell celui-ci détermine s’il a été appelé de façon interactive ou pour exécuter un script ou en tant que shell de login. En fonction de la nature de son lancement, il exécutera plusieurs fichiers lui permettant de ce paramétrer.</p>
<p>Scripts exécutés lors du lancement d’un shell interactif en ouverture de session (interactive login shell) :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="p">,</span><span class="n">etc</span><span class="o">/</span><span class="n">profile</span>
<span class="o">~/.</span><span class="n">bash_profile</span> <span class="c1">#le ~ désigne le répertoire &quot;home&quot; de l&#39;utilisateur</span>
<span class="o">~/.</span><span class="n">bash_login</span> <span class="c1">#si ~/.bash_profile n&#39;existe pas</span>
<span class="o">~/.</span><span class="n">profile</span> <span class="c1">#si ~/.bash_login</span>
</pre></div>
</div>
<p>Scripts exécutés lors d’un shell interactif :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="p">,</span><span class="n">etc</span><span class="o">/</span><span class="n">bash</span><span class="o">.</span><span class="n">bashrc</span>
<span class="o">~/.</span><span class="n">bashrc</span>
</pre></div>
</div>
<p>La modification de ces scripts nécessite la commande <strong>source</strong> pour une prise en compte immédiate dans le shell courant.</p>
<p>Scripts exécutés lors d’un script :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$BASH_ENV #BASH_ENV est une variable. Si elle existe alors les scripts lancés essayent d&#39;exécuter le fichier désigné par $BASH_ENV
</pre></div>
</div>
<p>Un petit exemple :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>michaellaunay@luciole:~$ echo &quot;echo coucou&quot; &gt; /tmp/hello.sh #on crée un fichier hello.sh qui contient echo coucou
michaellaunay@luciole:~$ chmod +x /tmp/hello.sh   # on rend exécutable ce fichier
michaellaunay@luciole:~$ /tmp/hello.sh            # on exécute ce fichier
coucou
michaellaunay@luciole:~$ echo $BASH_ENV           # on affiche le contenu de la variable BASH_ENV

michaellaunay@luciole:~$ BASH_ENV=&#39;/tmp/hello.sh&#39; # on affecte la chaîne /tmp/hello.sh à la variable BASH_ENV
michaellaunay@luciole:~$ export BASH_ENV # maintenant BASH_ENV sera accessible à toute commande exécutée depuis le shell courant
michaellaunay@luciole:~$ echo &quot;echo cuicui&quot; &gt; /tmp/oiseau.sh
michaellaunay@luciole:~$ bash /tmp/oiseau.sh # on exécute oiseau.sh avec bash, car on n&#39;a pas fait le chmod +x dessus
coucou
cuicui
</pre></div>
</div>
</section>
<section id="les-variables-d-environnement">
<h4><a class="toc-backref" href="#id78"><span class="sectnum">1.7.2.3</span> Les variables d’environnement</a><a class="headerlink" href="#les-variables-d-environnement" title="Lien permanent vers ce titre">¶</a></h4>
<p>Les variables d’environnement sont accessibles en consultation avec la commande <strong>env</strong> :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>michaellaunay@luciole:~$ env
SHELL=/bin/bash
TERM=xterm
HISTSIZE=1000
USERNAME=michaellaunay
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
PWD=/home/michaellaunay
EDITOR=vim
LANG=fr_FR.UTF-8
HOME=/home/michaellaunay
LOGNAME=michaellaunay
DISPLAY=:0.0
OLDPWD=/home/michaellaunay
</pre></div>
</div>
<p>Signification des variables d’environnement :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">BASH</span>      <span class="c1"># Le nom du fichier bash</span>
<span class="n">DISPLAY</span>   <span class="c1"># Le numéro de serveur et de session d&#39;affichage</span>
<span class="n">EDITOR</span>    <span class="c1"># L&#39;éditeur à utiliser par défaut</span>
<span class="n">HISTSIZE</span>  <span class="c1"># La taille du fichier historique</span>
<span class="n">HOSTNAME</span>  <span class="c1"># Le nom de la machine</span>
<span class="n">HOME</span>      <span class="c1"># Le répertoire personnel de l&#39;utilisateur</span>
<span class="n">LANG</span>      <span class="c1"># La langue de l&#39;utilisateur et l&#39;encodage utilisé pour afficher cette langue</span>
<span class="n">LOGNAME</span>   <span class="c1"># Le nom d&#39;utilisateur lors de l&#39;ouverture de la session</span>
<span class="n">MAIL</span>      <span class="c1"># Le chemin vers la boite mail de l&#39;utilisateur</span>
<span class="n">OLDPWD</span>    <span class="c1"># Le répertoire où nous étions avant le dernier cd</span>
<span class="n">PATH</span>      <span class="c1"># Le chemin vers les exécutables</span>
<span class="n">PS1</span>       <span class="c1"># Permet de constituer l&#39;invite de commande</span>
<span class="n">PS2</span>       <span class="c1"># Symbole affiché sur les lignes de commande débordant sur plusieurs lignes</span>
<span class="n">PROMPT_COMMAND</span> <span class="c1"># Le nom d&#39;une commande à exécuter à chaque commande</span>
<span class="n">PWD</span>       <span class="c1"># Le chemin actuel</span>
<span class="n">SHELL</span>     <span class="c1"># Le shell de l&#39;utilisateur</span>
<span class="n">TERM</span>      <span class="c1"># Le type de terminal</span>
<span class="n">USERNAME</span>  <span class="c1"># Le nom d&#39;utilisateur</span>
</pre></div>
</div>
<p>Pour accéder au contenu d’une variable, il suffit de la référencer en la précédent de <strong>$</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>michaellaunay@luciole:~$ echo $HOME
/home/michaellaunay
</pre></div>
</div>
<p>Pour voir l’ensemble des définitions réalisées dans un shell (variable et fonction) il suffit de taper <strong>set</strong>.</p>
<p>Pour voir les lignes exécutées dans un script <strong>set -x</strong> en début de script.</p>
</section>
<section id="les-caracteres-speciaux">
<h4><a class="toc-backref" href="#id79"><span class="sectnum">1.7.2.4</span> Les caractères spéciaux</a><a class="headerlink" href="#les-caracteres-speciaux" title="Lien permanent vers ce titre">¶</a></h4>
<p>Les caractères suivants permettent de déclencher des comportements particuliers qui seront expliqués ci-après :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span># # Mise en commentaire
&gt; # Indirection vers un fichier
&lt; # Indirection depuis un fichier
| # Pipe
? # Un caractère ou pas
. # Un caractère
* # Une chaîne de caractère
$ # Référencement d&#39;une variable
\ # Échappement
/ # Séparateur
[ # Début d&#39;un ensemble ou d&#39;un test
] # Fin d&#39;un ensemble ou d&#39;un test
( # Sous shell ou évaluation
) # Fin de sous shell ou d&#39;évaluation
: # Séparateur de groupe
; # Fin de commande
^ # Inversion ou début
@ # Adresse
` # Début ou fin d&#39;interprétation
~ # Désigne le répertoire personnel
</pre></div>
</div>
<p>Si vous voulez les utiliser pour nommer par exemple un fichier sans que le comportement particulier soit déclenché vous avez l’obligation de les échapper avec <strong>** ou de les mettre entre apostrophes **”</strong> ou guillemets <strong>« </strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>\# ou &#39;#&#39; ou &quot;#&quot;
\&gt; ou &#39;&gt;&#39; ou &quot;&gt;&quot;
\&lt; ou &#39;&lt;&#39; ou &quot;&lt;&quot;
\| ou &#39;|&#39; ou &quot;|&quot;
\? ou &#39;?&#39; ou &quot;?&quot;
\. ou &#39;.&#39; ou &quot;.&quot;
\* ou &#39;*&#39; ou &quot;*&quot;
\$ ou &#39;$&#39; ou &quot;$&quot;
\\ ou &#39;\&#39; ou &quot;\&quot;
\/ ou &#39;/&#39; ou &quot;/&quot;
\[ ou &#39;[&#39; ou &quot;[&quot;
\] ou &#39;]&#39; ou &quot;]&quot;
\( ou &#39;(&#39; ou &quot;(&quot;
\) ou &#39;)&#39; ou &quot;)&quot;
\: ou &#39;:&#39; ou &quot;:&quot;
\; ou &#39;;&#39; ou &quot;;&quot;
\^ ou &#39;^&#39; ou &quot;^&quot;
</pre></div>
</div>
<p>exemple :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>michaellaunay@luciole:~$ echo lunettes &gt; /tmp/\[\*\]\^\[&quot;*&quot;&#39;]&#39;
michaellaunay@luciole:~$ ls /tmp
[*]^[*]
michaellaunay@luciole:~$ cat /tmp/\[\*\]\^\[\*\]
lunettes
</pre></div>
</div>
</section>
<section id="variables-speciales">
<h4><a class="toc-backref" href="#id80"><span class="sectnum">1.7.2.5</span> Variables spéciales</a><a class="headerlink" href="#variables-speciales" title="Lien permanent vers ce titre">¶</a></h4>
<p>En plus des variables d’environnement vue précédemment nous avons :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$? # Qui fait référence au code de retour de la dernière commande exécuté.
$$ # Le pid du programme en cours d&#39;exécution.
$! # Le pid de la dernière commande lancée en tâche de fond.
$# # Le nombre de paramètres.
$0 # Le nom du programme en cours d&#39;exécution.
$1 # Le premier paramètre passé.
$2 # Le second paramètre passé.
...
$9 # Le neuvième paramètre.
$*, $@ # L&#39;ensemble des paramètres
</pre></div>
</div>
</section>
<section id="creation-affectation-de-variable">
<h4><a class="toc-backref" href="#id81"><span class="sectnum">1.7.2.6</span> Création, affectation de variable</a><a class="headerlink" href="#creation-affectation-de-variable" title="Lien permanent vers ce titre">¶</a></h4>
<p>Pour créer une variable ou en modifier sa valeur, il suffit de la définir :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>michaellaunay@luciole:~$ VAR=&#39;Bonjour tout le monde&#39;
michaellaunay@luciole:~$ echo $VAR
Bonjour tout le monde
michaellaunay@luciole:~$ VAR=Salut
michaellaunay@luciole:~$ echo $VAR
Salut
michaellaunay@luciole:~$ VAR=$VAR&#39; à tous&#39;
michaellaunay@luciole:~$ echo $VAR
Salut à tous
michaellaunay@luciole:~$ PATH=/home/michaellaunay/MesScripts:$PATH
michaellaunay@luciole:~$ echo $PATH
/home/michaellaunay/MesScripts:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
</pre></div>
</div>
<p>Pour supprimer une variable, on peut utiliser <strong>unset</strong> :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>michaellaunay@luciole:~$ unset BASH_ENV
</pre></div>
</div>
</section>
<section id="protection-des-espaces-des-valeurs-des-variables">
<h4><a class="toc-backref" href="#id82"><span class="sectnum">1.7.2.7</span> Protection des espaces des valeurs des variables</a><a class="headerlink" href="#protection-des-espaces-des-valeurs-des-variables" title="Lien permanent vers ce titre">¶</a></h4>
<p>Attention bash passe les mots d’une variable en les séparant d’un unique espace.
Ainsi :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>michaellaunay@luciole:~$ VARIABLE=&quot;  commence par 2 espaces puis en contient cinq     et finit par deux  &quot;
michaellaunay@luciole:~$ echo DEBUT${VARIABLE}FIN #L&#39;abscence de guillemet forcent le bash à passer en paramettre chacuns des mots séparé par un unique espace.
DEBUT commence par 2 espaces puis en contient cinq et finit par deux FIN
michaellaunay@luciole:~$ echo DEBUT&quot;$VARIABLE&quot;FIN #Les guillemets protègent les espaces !
DEBUT  commence par 2 espaces puis en contient cinq     et finit par deux  FIN
</pre></div>
</div>
<p>On peut aussi échapper les espaces avec des antislashs lors de l’affectation de la variable.</p>
</section>
<section id="evaluation-d-une-variable">
<h4><a class="toc-backref" href="#id83"><span class="sectnum">1.7.2.8</span> Évaluation d’une variable</a><a class="headerlink" href="#evaluation-d-une-variable" title="Lien permanent vers ce titre">¶</a></h4>
<p>Une variable peut contenir une commande.
Son simple appel suffit à provoquer son évaluation :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>michaellaunay@luciole:~$ MON_SCRIPT=&quot;/tmp/ma_cmd.sh&quot;
michaellaunay@luciole:~$ $MON_SCRIPT #exécute la commande contenue dans la variable MON_SCRIPT
Hello
michaellaunay@luciole:~$ cat  $MON_SCRIPT #Affiche ce qu&#39;il y a dans le script /tmp/ma_cmd.sh
#! /bin/bash
echo Hello
</pre></div>
</div>
</section>
<section id="export-de-variable">
<h4><a class="toc-backref" href="#id84"><span class="sectnum">1.7.2.9</span> Export de variable</a><a class="headerlink" href="#export-de-variable" title="Lien permanent vers ce titre">¶</a></h4>
<p>Toute variable créée dans un shell n’est accessible que dans celui-ci.</p>
<p>Pour la rendre accessible aux commandes et scripts appelés après l’affectation il faut l’exporter :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>michaellaunay@luciole:~$ echo &quot;echo \$SALUTATION&quot; &gt; /tmp/cmd.sh
michaellaunay@luciole:~$ /tmp/cmd.sh

michaellaunay@luciole:~$ SALUTATION=coucou
michaellaunay@luciole:~$ echo $SALUTATION
coucou
michaellaunay@luciole:~$ /tmp/cmd.sh

michaellaunay@luciole:~$ export SALUTATION
michaellaunay@luciole:~$ /tmp/cmd.sh
coucou
</pre></div>
</div>
</section>
<section id="les-tests-d-expressions-et-fichier-operateurs-de-controle">
<h4><a class="toc-backref" href="#id85"><span class="sectnum">1.7.2.10</span> Les tests d’expressions et fichier, opérateurs de contrôle</a><a class="headerlink" href="#les-tests-d-expressions-et-fichier-operateurs-de-controle" title="Lien permanent vers ce titre">¶</a></h4>
<p>La commande <strong>test</strong> permet de tester une expression et de retourner 0 si le test est vrai et 1 s’il est faux :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>michaellaunay@luciole:~$ test 1 = 1
michaellaunay@luciole:~$ echo $?
0
michaellaunay@luciole:~$ test 1 = 2
michaellaunay@luciole:~$ echo $?
1
</pre></div>
</div>
<p>On peut aussi remplacer <strong>test</strong> par des crochets, mais il faut alors encadrer les crochets par des espaces :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>michaellaunay@luciole:~$ [ 1 = 2 ]
michaellaunay@luciole:~$ echo $?
1
</pre></div>
</div>
<p>Les options de test sont très nombreuses. Faites man test.</p>
<p>Avec <strong>test</strong> et <strong>if</strong> il est possible d’exécuter conditionnellement des commandes :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>michaellaunay@luciole:~$ VAR=2
michaellaunay@luciole:~$ if [ $VAR = 2 ]; then echo Vrai; else echo Faux;fi
Vrai
michaellaunay@luciole:~$ VAR=$HOME
michaellaunay@luciole:~$ if [ -w $VAR ]
&gt; then echo écriture possible dans $VAR
&gt; else echo écriture impossible dans $VAR
&gt; fi
écriture possible dans /home/michaellaunay
</pre></div>
</div>
</section>
<section id="execution-d-operations-arithmetiques">
<h4><a class="toc-backref" href="#id86"><span class="sectnum">1.7.2.11</span> Exécution d’opérations arithmétiques</a><a class="headerlink" href="#execution-d-operations-arithmetiques" title="Lien permanent vers ce titre">¶</a></h4>
<p>La construction <strong>$[ nombre1 opérateur nombre2 ]</strong> permet de réaliser le calcul d’expression sur des entiers :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>michaellaunay@luciole:~$ echo $[ 10 - 1 ]
9
</pre></div>
</div>
<p>La création d’une variable et sa modification :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>michaellaunay@luciole:~$ CMPT=[0] # équivalent à la ligne suivante
michaellaunay@luciole:~$ let CMPT=0
michaellaunay@luciole:~$ echo $CMPT
0
michaellaunay@luciole:~$ let CMPT+=1
michaellaunay@luciole:~$ echo $CMPT
1
michaellaunay@luciole:~$ let CMPT+=1
michaellaunay@luciole:~$ echo $CMPT
2
</pre></div>
</div>
</section>
<section id="la-boucle-while-et-until">
<h4><a class="toc-backref" href="#id87"><span class="sectnum">1.7.2.12</span> La boucle while et until</a><a class="headerlink" href="#la-boucle-while-et-until" title="Lien permanent vers ce titre">¶</a></h4>
<p><strong>While</strong> permet d’exécuter des commandes tant que la condition est satisfaite alors que <strong>until</strong> exécute des commandes tant que la condition échoue.</p>
<p>Exemple :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>michaellaunay@luciole:~$ VAR=4
michaellaunay@luciole:~$ while [ $VAR -gt 0 ]
&gt; do
&gt; echo itération $VAR;
&gt; VAR=$[ $VAR - 1 ]
&gt; done
itération 4
itération 3
itération 2
itération 1
</pre></div>
</div>
</section>
<section id="la-boucle-for">
<h4><a class="toc-backref" href="#id88"><span class="sectnum">1.7.2.13</span> La boucle for</a><a class="headerlink" href="#la-boucle-for" title="Lien permanent vers ce titre">¶</a></h4>
<p>Pour chaque élément d’un ensemble, on exécute une commande :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>michaellaunay@luciole:~$ NORD=&quot;Lille Roubaix&quot;
michaellaunay@luciole:~$ CENTRE=&quot;Paris Chartres&quot;
michaellaunay@luciole:~$ SUD=&quot;Nice Marseille&quot;
michaellaunay@luciole:~$ for ville in $NORD $CENTRE $SUD
&gt; do
&gt; echo Visiter $ville
&gt; done
Visiter Lille
Visiter Roubaix
Visiter Paris
Visiter Chartres
Visiter Nice
Visiter Marseille
</pre></div>
</div>
</section>
<section id="le-choix-multiple-case">
<h4><a class="toc-backref" href="#id89"><span class="sectnum">1.7.2.14</span> Le choix multiple (case)</a><a class="headerlink" href="#le-choix-multiple-case" title="Lien permanent vers ce titre">¶</a></h4>
<p>Permet de réaliser un branchement. Ne pas oublier les deux points-virgules à la fin d’un cas :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>michaellaunay@luciole:~$ VAR=Lille
michaellaunay@luciole:~$ case $VAR in
&gt; &#39;lille&#39; | &#39;Lille&#39; | &#39;LILLE&#39; )
&gt;   echo J\&#39;y habite
&gt; ;;
&gt; &#39;paris&#39; | &#39;Paris&#39; | &#39;PARIS&#39; )
&gt;   echo J\&#39;y ai habité
&gt; ;;
&gt; * )
&gt;   echo Je ne connais pas
&gt; ;;
&gt; esac
J&#39;y habite
</pre></div>
</div>
</section>
<section id="les-operateurs-et">
<h4><a class="toc-backref" href="#id90"><span class="sectnum">1.7.2.15</span> Les opérateurs &amp;&amp; et ||</a><a class="headerlink" href="#les-operateurs-et" title="Lien permanent vers ce titre">¶</a></h4>
<p>L’opérateur <strong>&amp;&amp;</strong> permet d’exécuter la commande suivante si la commande précédente réussit (retourne 0) :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>michaellaunay@luciole:~$ grep refusée /var/log/user.log &gt; /tmp/connexion.txt &amp;&amp; vim /tmp/connexion.txt
</pre></div>
</div>
<p>L’opérateur <strong>||</strong> permet d’exécuter la commande suivante si la commande précédente a échoué (retour de 1) :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>michaellaunay@luciole:~$ grep refusée /var/log/user.log &gt; /dev/null || echo tout va bien
</pre></div>
</div>
</section>
<section id="la-commande-trap">
<h4><a class="toc-backref" href="#id91"><span class="sectnum">1.7.2.16</span> La commande trap</a><a class="headerlink" href="#la-commande-trap" title="Lien permanent vers ce titre">¶</a></h4>
<p>Elle permet de positionner une fonction qui sera exécutée lors de la réception d’un signal (man 7 signal) :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">trap</span> <span class="s2">&quot;echo Fin d</span><span class="se">\&#39;</span><span class="s2">exécution&quot;</span> <span class="n">EXIT</span>
<span class="n">trap</span> <span class="s2">&quot;echo Interruption violente Ctrl-c&quot;</span> <span class="n">SIGINT</span>
<span class="n">trap</span> <span class="s2">&quot;echo Fin demandée&quot;</span> <span class="n">SIGTERM</span>
<span class="n">trap</span> <span class="s2">&quot;echo Reprise d</span><span class="se">\&#39;</span><span class="s2">exécution&quot;</span> <span class="n">SIGCONT</span>
<span class="n">trap</span> <span class="s2">&quot;echo Signal USR&quot;</span> <span class="n">SIGUSR1</span> <span class="n">SIGUSR2</span>
</pre></div>
</div>
</section>
<section id="la-commande-sed">
<h4><a class="toc-backref" href="#id92"><span class="sectnum">1.7.2.17</span> La commande sed</a><a class="headerlink" href="#la-commande-sed" title="Lien permanent vers ce titre">¶</a></h4>
<p>Elle permet de faire des traitements sur les lignes d’un flux.
Par exemple elle permet de trouver un motif et de le remplacer.
On la rencontre dans de nombreux scripts.</p>
<p>Par exemple dans la ligne suivante :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ls</span> <span class="o">-</span><span class="mi">1</span> <span class="o">|</span> <span class="n">xargs</span> <span class="o">-</span><span class="n">i</span> <span class="n">echo</span> <span class="n">mv</span> <span class="p">{}</span> <span class="p">{}</span> <span class="o">|</span> <span class="n">sed</span> <span class="o">-</span><span class="n">e</span> <span class="s2">&quot;s/Ubuntu20.04_//2&quot;</span> <span class="o">|</span> <span class="n">bash</span>
</pre></div>
</div>
<p>« ls -1 » affiche le contenu du répertoire courant, une ligne par fichier.</p>
<p>Le résultat est envoyé à <strong>xargs</strong> qui pour chaque ligne va créer une chaîne de caractères « mv contenu_ligne contenu_ligne »</p>
<p>Le résultat est envoyé à <strong>sed</strong> qui supprime la seconde occurrence de la chaîne « Ubuntu20.04 » qu’il rencontre.</p>
<p>Le résultat est exécuté par bash en transformant la chaîne de caractères reçue en ligne de commande.</p>
<p>Ici sed permet de renommer les fichiers de type Ubuntu20.04_00_EssayerOuInstaller.png en 00_EssayerOuInstaller.png.</p>
<p>À cette ligne complexe, on préférera renommer de façon plus élégante et rapide avec la ligne de cmd :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>for filename in *; do mv $filename ${filename/Ubuntu20.04_/}; done
</pre></div>
</div>
<p>Pour plus d’information sur <strong>sed</strong> voir <a class="reference external" href="https://www.commentcamarche.net/faq/9536-sed-introduction-a-sed-part-i">https://www.commentcamarche.net/faq/9536-sed-introduction-a-sed-part-i</a></p>
</section>
<section id="l-expansion-de-parametre">
<h4><a class="toc-backref" href="#id93"><span class="sectnum">1.7.2.18</span> L’expansion de paramètre</a><a class="headerlink" href="#l-expansion-de-parametre" title="Lien permanent vers ce titre">¶</a></h4>
<p>Liste des Filtres pour l’expansion de paramètre du Shell <a class="reference external" href="https://www.gnu.org/software/bash/manual/html_node/Shell-Parameter-Expansion.html">https://www.gnu.org/software/bash/manual/html_node/Shell-Parameter-Expansion.html</a> :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>${parameter} sera remplacé par la valeur de parameter
michaellaunay@luciole:~$ CMPT=$(( 1 + 20 / 2 )) # Réalise l&#39;opération puis affecte CMPT pour les opérations possibles voir https://www.gnu.org/software/bash/manual/html_node/Shell-Arithmetic.html#Shell-Arithmetic
michaellaunay@luciole:~$ echo ${CMPT}
11
michaellaunay@luciole:~$ name[1]=&#39;un&#39; # équivalent à &#39;declare -n name&#39; voir https://www.gnu.org/software/bash/manual/html_node/Arrays.html#Arrays
michaellaunay@luciole:~$ name[2]=&#39;deux&#39;
michaellaunay@luciole:~$ name[3]=&#39;trois&#39;
michaellaunay@luciole:~$ echo ${name[2]}
deux
# équivalent à
michaellaunay@luciole:~$ name=(&#39;zero&#39; &#39;un&#39; &#39;deux&#39; &#39;trois&#39;)
michaellaunay@luciole:~$ echo ${name[1]}
un
michaellaunay@luciole:~$ unset name[0]
michaellaunay@luciole:~$ echo ${name[0]}

michaellaunay@luciole:~$ echo ${name[1]}
un
</pre></div>
</div>
</section>
<section id="les-scripts">
<h4><a class="toc-backref" href="#id94"><span class="sectnum">1.7.2.19</span> Les scripts</a><a class="headerlink" href="#les-scripts" title="Lien permanent vers ce titre">¶</a></h4>
<p>Un script est un fichier qui contient une suite de commandes.</p>
<p>La première ligne permet d’indiquer le shell dans lequel doit être exécuté le script :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="n">echo</span> <span class="n">c</span>\<span class="s1">&#39;est du bash</span>
</pre></div>
</div>
<p>Cette ligne s’appelle le <a class="reference external" href="http://en.wikipedia.org/wiki/Shebang_(Unix)">shebang</a>.</p>
</section>
<section id="les-fonctions">
<h4><a class="toc-backref" href="#id95"><span class="sectnum">1.7.2.20</span> Les fonctions</a><a class="headerlink" href="#les-fonctions" title="Lien permanent vers ce titre">¶</a></h4>
<p>Une fonction est une portion de code nommée, réutilisable qui a accès à toutes les variables du script ou du shell d’où elle est appelée :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>michaellaunay@luciole:~$ function carré() {
&gt; echo $[ $1 * $1]
&gt; }
michaellaunay@luciole:~$ carré 3
9
</pre></div>
</div>
</section>
<section id="lecture-des-saisies-clavier">
<h4><a class="toc-backref" href="#id96"><span class="sectnum">1.7.2.21</span> Lecture des saisies clavier</a><a class="headerlink" href="#lecture-des-saisies-clavier" title="Lien permanent vers ce titre">¶</a></h4>
<p>La commande <strong>read</strong> permet de lire la saisie clavier et de l’affecter avec une variable :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>michaellaunay@luciole:~$ read VAR
coucou
michaellaunay@luciole:~$ echo $VAR
coucou
</pre></div>
</div>
</section>
<section id="exercice">
<h4><a class="toc-backref" href="#id97"><span class="sectnum">1.7.2.22</span> Exercice</a><a class="headerlink" href="#exercice" title="Lien permanent vers ce titre">¶</a></h4>
<p>Réalisez une calculatrice demandant la saisie de la première opérande puis de l’opérateur (symbole ou littéral), puis de la seconde opérande. Affichez le résultat puis exécutez à nouveau tant que le signal SIGUSR1 n’est pas reçu.</p>
</section>
<section id="les-sous-programmes">
<h4><a class="toc-backref" href="#id98"><span class="sectnum">1.7.2.23</span> Les sous-programmes</a><a class="headerlink" href="#les-sous-programmes" title="Lien permanent vers ce titre">¶</a></h4>
<p>Dans un shell on peut appeler un script directement en passant son nom si celui-ci est exécutable ou en le faisant interpréter par le shell pour lequel il a été écrit.</p>
<p>Lorsqu’on exécute un ensemble de commandes encadré par des parenthèses alors le shell courant démarre un sous shell pour exécuter les commandes :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>michaellaunay@luciole:~$ VAR=0
michaellaunay@luciole:~$ (VAR=$[ $VAR + 1]; echo $VAR)
1
michaellaunay@luciole:~$ echo $VAR
0
</pre></div>
</div>
<p>Il est également possible de forcer l’exécution de commande en utilisant <strong>`</strong> :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>michaellaunay@luciole:~$ echo date
date
michaellaunay@luciole:~$ echo `date`
dimanche 19 avril 2020, 17:24:32 (UTC+0200)
</pre></div>
</div>
</section>
<section id="la-completion-de-commande">
<h4><a class="toc-backref" href="#id99"><span class="sectnum">1.7.2.24</span> La complétion de commande</a><a class="headerlink" href="#la-completion-de-commande" title="Lien permanent vers ce titre">¶</a></h4>
<p>En appuyant sur la touche tab le shell affiche toutes les commandes ayant pour préfixe les lettres déjà saisies sur la ligne de commande.</p>
</section>
<section id="historique-des-commandes">
<h4><a class="toc-backref" href="#id100"><span class="sectnum">1.7.2.25</span> Historique des commandes</a><a class="headerlink" href="#historique-des-commandes" title="Lien permanent vers ce titre">¶</a></h4>
<p>Les commandes saisies dans un shell sont enregistrées dans le fichier ~/.bash_history</p>
<p>Il est possible d’accéder aux anciennes commandes en utilisant les flèches.</p>
</section>
</section>
<section id="les-commandes">
<h3><a class="toc-backref" href="#id101"><span class="sectnum">1.7.3</span> Les commandes</a><a class="headerlink" href="#les-commandes" title="Lien permanent vers ce titre">¶</a></h3>
<section id="se-deplacer-dans-l-arborescence">
<h4><a class="toc-backref" href="#id102"><span class="sectnum">1.7.3.1</span> Se déplacer dans l’arborescence</a><a class="headerlink" href="#se-deplacer-dans-l-arborescence" title="Lien permanent vers ce titre">¶</a></h4>
<p>Les commandes :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ls</span>        <span class="c1"># Permet d&#39;afficher les informations d&#39;un fichier ou d&#39;un répertoire</span>
<span class="n">ls</span> <span class="n">UnChemin</span> <span class="c1"># Affiche le contenu de UnChemin si c&#39;est un répertoire, sinon affiche le nom de UnChemin</span>
<span class="n">ls</span> <span class="o">-</span><span class="n">lah</span>   <span class="c1"># Affiche les détails, les fichiers cachés, et utilise des unités informatiques</span>
<span class="n">ls</span> <span class="o">-</span><span class="n">F</span>     <span class="c1"># Affiche un / derrière le nom des répertoires</span>
<span class="n">info</span> <span class="n">ls</span>   <span class="c1"># Permet de connaître le sens des colonnes des options de ls, par exemple le chiffre de la seconde colonne de l&#39;option -l est le nombre de hard links.</span>
<span class="n">cd</span>        <span class="c1"># Permet de déplacer le répertoire courant</span>
<span class="n">pwd</span>       <span class="c1"># Affiche le chemin du répertoire courant</span>
</pre></div>
</div>
<p>exemple :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>michaellaunay@luciole:~$ ls -lh /
total 2,1G
drwxr-xr-x   2 root root  12K avril 19 16:40 bin
drwxr-xr-x   4 root root 4,0K avril  8 06:51 boot
drwxr-xr-x   2 root root 4,0K mai   16  2019 cdrom
drwxr-xr-x  19 root root 4,6K avril 18 22:11 dev
drwxr-xr-x 158 root root  12K avril 15 06:43 etc
drwxr-xr-x   5 root root 4,0K août  22  2019 home
lrwxrwxrwx   1 root root   32 janv.  6 18:48 initrd.img -&gt; boot/initrd.img-5.0.0-38-generic
lrwxrwxrwx   1 root root   32 janv.  6 18:48 initrd.img.old -&gt; boot/initrd.img-5.0.0-37-generic
drwxr-xr-x  21 root root 4,0K mars   5 06:28 lib
drwxr-xr-x   2 root root 4,0K mars   5 06:28 lib32
drwxr-xr-x   2 root root 4,0K mars   5 06:28 lib64
drwx------   2 root root  16K mai   16  2019 lost+found
drwxr-xr-x   3 root root 4,0K juin  24  2019 media
drwxr-xr-x   2 root root 4,0K févr. 10  2019 mnt
drwxr-xr-x   5 root root 4,0K août  26  2019 opt
dr-xr-xr-x 354 root root    0 avril 18 22:11 proc
drwx------   8 root root 4,0K mars  25 10:16 root
drwxr-xr-x  39 root root 1,1K avril 19 10:15 run
drwxr-xr-x   2 root root  12K avril 19 16:40 sbin
drwxr-xr-x  17 root root 4,0K mars  22 22:44 snap
drwxr-xr-x   2 root root 4,0K févr. 10  2019 srv
-rw-------   1 root root 2,0G mai   16  2019 swapfile
dr-xr-xr-x  13 root root    0 avril 18 22:11 sys
drwxrwxrwt  24 root root 4,0K avril 19 17:20 tmp
drwxr-xr-x  14 root root 4,0K août   1  2019 usr
drwxr-xr-x  15 root root 4,0K juin  17  2019 var
lrwxrwxrwx   1 root root   29 janv.  6 18:48 vmlinuz -&gt; boot/vmlinuz-5.0.0-38-generic
lrwxrwxrwx   1 root root   29 janv.  6 18:48 vmlinuz.old -&gt; boot/vmlinuz-5.0.0-37-generic


michaellaunay@luciole:~/Documents/ecreall/Cours$ cd
michaellaunay@luciole:~$ pwd
/home/michaellaunay
</pre></div>
</div>
<p>Les jokers :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>* # Désigne toute chaîne contiguë de caractères
? # Désigne un caractère
[...] # Permet de désigner des ensembles de caractères [4-69] accepte 4, 5, 6, et 9, [[] accepte [ identique à \[A
[^...] # Permet de désigner des ensembles à exclure
</pre></div>
</div>
<p>Un <strong>chemin relatif</strong> est un chemin qui permet de se déplacer jusqu’au fichier cible à partir du chemin courant :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>michaellaunay@luciole:~$ cd ~ # identique à cd $HOME ou cd
michaellaunay@luciole:~$ ls -l ../../etc/passwd
-rw-r--r-- 1 root root 1583 2009-04-02 11:35 ../../etc/passwd
</pre></div>
</div>
<p><strong>.</strong> indique le répertoire courant alors que <strong>..</strong> indique le parent.</p>
<p>Un <strong>chemin absolu</strong> est un chemin qui commence à la racine <strong>/</strong> de l’arborescence et énonce tous les sous-répertoires jusqu’à la cible :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>michaellaunay@luciole:~$ ls -l /,etc/passwd
-rw-r--r-- 1 root root 1583 2009-04-02 11:35 /,etc/passwd
</pre></div>
</div>
</section>
<section id="creation-suppression-de-repertoire">
<h4><a class="toc-backref" href="#id103"><span class="sectnum">1.7.3.2</span> Création / suppression de répertoire</a><a class="headerlink" href="#creation-suppression-de-repertoire" title="Lien permanent vers ce titre">¶</a></h4>
<p>La commande <strong>mkdir</strong> permet de créer des répertoires :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="n">NomRep</span> <span class="c1"># Crée le répertoire NomRep.</span>
<span class="n">mkdir</span> <span class="o">-</span><span class="n">p</span> <span class="n">Rep1</span><span class="o">/</span><span class="n">Rep2</span><span class="o">/</span><span class="n">Rep3</span> <span class="c1"># Crée Rep3 et l&#39;arborescence Rep1/Rep2 si nécessaire.</span>
</pre></div>
</div>
<p>La commande <strong>rmdir</strong> permet de supprimer un répertoire vide, on peut aussi le faire avec <strong>rm -r</strong> dans le cas d’un répertoire non vide.</p>
</section>
<section id="lecture-de-fichier">
<h4><a class="toc-backref" href="#id104"><span class="sectnum">1.7.3.3</span> Lecture de fichier</a><a class="headerlink" href="#lecture-de-fichier" title="Lien permanent vers ce titre">¶</a></h4>
<p>La commande <strong>cat</strong> permet d’afficher le contenu d’un fichier.</p>
<p>La commande <strong>strings</strong> permet de n’afficher que les chaînes de caractères d’un fichier binaire.</p>
</section>
<section id="rechercher-des-fichiers">
<h4><a class="toc-backref" href="#id105"><span class="sectnum">1.7.3.4</span> Rechercher des fichiers</a><a class="headerlink" href="#rechercher-des-fichiers" title="Lien permanent vers ce titre">¶</a></h4>
<p>La commande <strong>find</strong> permet de réaliser des recherches basées sur les informations d’un fichier (nom, date de création, de modification, etc.) :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>michaellaunay@luciole:~$ find Documents/ecreall -name &quot;*pdf&quot; -ctime -2
# recherche à partir de Documents/ecreall tous les fichiers finissant par pdf, créés depuis moins de 2 jours
Documents/ecreall/Cours/CoursGNULinux/CoursGNULinux.pdf
</pre></div>
</div>
<p>La commande <strong>grep</strong> permet de réaliser des recherches basées sur la présence d’une chaîne ou d’une expression régulière dans le contenu d’un fichier.</p>
<p>La commande <strong>locate</strong> permet de trouver un fichier si le chemin a été renseigné dans la base de données mise à jour par le super utilisateur avec <strong>updatedb</strong> ou <strong>slocate -u</strong>.</p>
</section>
<section id="archivage-compression">
<h4><a class="toc-backref" href="#id106"><span class="sectnum">1.7.3.5</span> Archivage / Compression</a><a class="headerlink" href="#archivage-compression" title="Lien permanent vers ce titre">¶</a></h4>
<p><strong>zip</strong>, <strong>unzip</strong> permet de compresser et décompresser les fichiers aux format zip</p>
<p><strong>gzip</strong> permet de compresser et décompresser les fichiers au format gzip</p>
<p><strong>tar</strong> avec les options <strong>cf</strong> permet d’archiver une arborescence en conservant les informations de propriétaire, les dates de création, les permissions d’accès. Avec les options <strong>xf</strong>, permet d’extraire une archive.</p>
<p><strong>tar cfz</strong> permet de combiner <strong>tar</strong> et <strong>gzip</strong> en une commande.
L’option  <strong>–listed-incremental=nom_fichier.list</strong> permet d’enregistrer un snapshot des fichiers archivés en vue de permettre des tar incrémentaux. C.f. <a class="reference external" href="https://doc.ubuntu-fr.org/tar#utilisation_en_archivage_incrementiel">https://doc.ubuntu-fr.org/tar#utilisation_en_archivage_incrementiel</a>
Attention il est indispensable que la première archive soit lancée avec cette option pour que l’incrémentation soit possible !</p>
</section>
<section id="autres-commandes">
<h4><a class="toc-backref" href="#id107"><span class="sectnum">1.7.3.6</span> Autres commandes</a><a class="headerlink" href="#autres-commandes" title="Lien permanent vers ce titre">¶</a></h4>
<p><strong>mv</strong> permet de déplacer un fichier ou une arborescence.</p>
<p><strong>tail</strong> permet de n’afficher que les dernières lignes d’un fichier, l’option -f permet d’afficher le contenu au fur et à mesure de son arrivé dans le flux.</p>
<p><strong>tee</strong> permet d’écrire le contenu de la sortie standard dans un fichier tout en laissant ce contenu dans la sortie standard ce qui permet dans un pipe d’avoir une capture du contenu sans casser le pipe.</p>
<p><strong>ln</strong> permet de créer des liens. Ainsi <strong>ln -s Source Destination</strong> permet de créer un lien symbolique.</p>
<p><strong>cp</strong> permet de copier un fichier dans un autre. <strong>cp -r Rep1 Rep2</strong> copie toute l’arborescence Rep1 vers Rep2.</p>
<p><strong>script NOM_Fichier</strong> permet d’enregistrer la session (les interactions en ligne de commande) vers un fichier, ce qui permet de l’auditer voire de la rejouer.
L’option -t permet d’enregistrer les dates des échanges vers le flux d’erreur.
L’enregistrement sera arrêté par la commande <strong>exit</strong>.
<strong>scriptreplay</strong> Permet de rejour la session.
Exemple : <strong>NOM=`date +%y%m%d%H%m%S`_upgrade_jessie;script -t 2&gt;~/$NOM.time -a ~/$NOM.script</strong></p>
</section>
<section id="les-noms-de-fichiers">
<h4><a class="toc-backref" href="#id108"><span class="sectnum">1.7.3.7</span> Les noms de fichiers</a><a class="headerlink" href="#les-noms-de-fichiers" title="Lien permanent vers ce titre">¶</a></h4>
<p>Linux est sensible à la casse (majuscules vs minuscules).</p>
<p>Depuis 2007, l’ensemble du système utilise <a class="reference external" href="http://fr.wikipedia.org/wiki/Utf-8">utf-8</a> comme encodage par défaut, en conséquence tous les caractères accentués peuvent être utilisés pour nommer les fichiers.</p>
<p>Les caractères spéciaux et les espaces peuvent être utilisés à la condition d’être échappés.</p>
<p>La taille des noms ne doit pas excéder 255 octets.</p>
<p>Si l’on utilise des caractères accentués ou asiatiques, le nombre de caractères maximal est inférieur à 255, car il faut 2 à 4 octets pour représenter un caractère autre que ASCII en <a class="reference external" href="http://fr.wikipedia.org/wiki/Utf-8">utf-8</a>.</p>
<p>Tout fichier ou répertoire commençant par un <strong>.</strong> sera caché et accessible uniquement avec l’option <strong>-a</strong> de <strong>ls</strong>.</p>
</section>
<section id="les-attributs-des-fichiers">
<h4><a class="toc-backref" href="#id109"><span class="sectnum">1.7.3.8</span> Les attributs des fichiers</a><a class="headerlink" href="#les-attributs-des-fichiers" title="Lien permanent vers ce titre">¶</a></h4>
<p>Les attributs de fichier permettent de gérer les permissions d’accès en lecture, écriture, exécution, traversée et également de connaître la nature du fichier.</p>
<p>Ainsi :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>michaellaunay@luciole:~/Documents/ecreall/Cours$ ls -lh
total 24K
lrwxrwxrwx   1 michaellaunay users   11 2009-03-01 21:23 unLienSymbolique -&gt; unFichier
drwxr-x--- 139 michaellaunay users  12K 2009-04-30 09:12 unSousRep
drwx------   2 michaellaunay michaellaunay  16K 2009-03-01 21:21 lost+found
-rw-r-----   1 michaellaunay amis  32K 2009-04-02 11:35 unFichier
michaellaunay@luciole:~/Documents/ecreall/Cours/CoursGNULinux$ ls -l /bin/mount
-rwsr-xr-x 1 root root 98440 2008-09-25 15:08 /bin/mount
michaellaunay@luciole:~/Documents/ecreall/Cours/CoursGNULinux$ ls -l
drwxrwxrwt  19 root root  4096 2009-05-03 11:10 tmp
</pre></div>
</div>
<p><em>lrwxrwxrwx 1 michaellaunay users 11 2009-03-01 21:23</em> est la liste des attributs qui doit être décomposée comme ceci :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">première</span> <span class="n">lettre</span> <span class="p">:</span> <span class="p">::</span>

  <span class="n">l</span> <span class="n">indique</span> <span class="n">que</span> <span class="n">le</span> <span class="n">fichier</span> <span class="n">est</span> <span class="n">un</span> <span class="n">lien</span> <span class="n">symbolique</span> <span class="p">(</span><span class="n">un</span> <span class="n">raccourci</span><span class="p">)</span><span class="o">.</span>
  <span class="n">d</span> <span class="n">indique</span> <span class="n">que</span> <span class="n">le</span> <span class="n">fichier</span> <span class="n">est</span> <span class="n">un</span> <span class="n">répertoire</span>
  <span class="o">-</span> <span class="n">indique</span> <span class="n">que</span> <span class="n">le</span> <span class="n">fichier</span> <span class="n">est</span> <span class="n">un</span> <span class="n">fichier</span> <span class="n">ordinaire</span>
  <span class="n">c</span> <span class="n">périphérique</span> <span class="n">de</span> <span class="nb">type</span> <span class="n">caractère</span>
  <span class="n">b</span> <span class="n">périphérique</span> <span class="n">de</span> <span class="nb">type</span> <span class="n">bloc</span>
  <span class="n">s</span> <span class="n">socket</span>
  <span class="n">p</span> <span class="n">fifo</span>

<span class="n">premier</span> <span class="n">groupe</span> <span class="n">de</span> <span class="mi">3</span> <span class="n">lettres</span> <span class="p">:</span> <span class="p">::</span>

  <span class="n">r</span><span class="o">--</span> <span class="n">indique</span> <span class="n">que</span> <span class="n">le</span> <span class="n">propriétaire</span> <span class="n">a</span> <span class="n">le</span> <span class="n">droit</span> <span class="n">de</span> <span class="n">lecture</span>
  <span class="o">-</span><span class="n">w</span><span class="o">-</span> <span class="n">indique</span> <span class="n">que</span> <span class="n">le</span> <span class="n">propriétaire</span> <span class="n">a</span> <span class="n">le</span> <span class="n">droit</span> <span class="n">d</span><span class="s1">&#39;écriture</span>
  <span class="o">--</span><span class="n">x</span> <span class="n">indique</span> <span class="n">que</span> <span class="n">le</span> <span class="n">propriétaire</span> <span class="n">a</span> <span class="n">le</span> <span class="n">droit</span> <span class="n">d</span><span class="s1">&#39;exécuter si le fichier est ordinaire</span>
      <span class="n">indique</span> <span class="n">que</span> <span class="n">le</span> <span class="n">propriétaire</span> <span class="n">a</span> <span class="n">le</span> <span class="n">droit</span> <span class="n">de</span> <span class="n">traverser</span> <span class="n">si</span> <span class="n">le</span> <span class="n">fichier</span> <span class="n">est</span> <span class="n">un</span> <span class="n">répertoire</span>
  <span class="o">--</span><span class="n">s</span> <span class="p">(</span><span class="n">SUID</span><span class="p">)</span> <span class="n">indique</span> <span class="n">qu</span><span class="s1">&#39;un utilisateur qui exécute le fichier usurpe les droits du propriétaire</span>
      <span class="n">pour</span> <span class="n">tous</span> <span class="n">les</span> <span class="n">accès</span> <span class="n">effectués</span> <span class="n">par</span> <span class="n">l</span><span class="s1">&#39;exécutable.</span>
      <span class="n">Le</span> <span class="n">propriétaire</span> <span class="n">a</span> <span class="n">les</span> <span class="n">droits</span> <span class="n">d</span><span class="s1">&#39;exécuter ou de traverser (--x est positionné, mais est caché).</span>
  <span class="o">--</span><span class="n">S</span> <span class="p">(</span><span class="n">SUID</span><span class="p">)</span> <span class="n">indique</span> <span class="n">qu</span><span class="s1">&#39;un utilisateur qui exécute le fichier usurpe les droits du propriétaire.</span>
      <span class="n">Le</span> <span class="n">propriétaire</span> <span class="n">n</span><span class="s1">&#39;a pas les droits d&#39;</span><span class="n">exécuter</span> <span class="n">ou</span> <span class="n">de</span> <span class="n">traverser</span> <span class="p">(</span><span class="o">--</span><span class="n">x</span> <span class="n">n</span><span class="s1">&#39;est pas positionné).</span>

<span class="n">second</span> <span class="n">groupe</span> <span class="n">de</span> <span class="mi">3</span> <span class="n">lettres</span> <span class="p">:</span> <span class="p">::</span>

  <span class="n">même</span> <span class="n">signification</span> <span class="n">que</span> <span class="n">précédemment</span><span class="p">,</span> <span class="n">mais</span> <span class="n">pour</span> <span class="n">les</span> <span class="n">groupes</span> <span class="n">et</span> <span class="n">sauf</span> <span class="n">pour</span> <span class="n">le</span> <span class="n">SUID</span><span class="o">.</span>
  <span class="o">--</span><span class="n">s</span> <span class="p">(</span><span class="n">SGID</span><span class="p">)</span> <span class="n">indique</span> <span class="n">qu</span><span class="s1">&#39;un utilisateur appartenant au groupe qui exécute le fichier usurpe les</span>
      <span class="n">droits</span> <span class="n">du</span> <span class="n">groupe</span> <span class="n">et</span> <span class="n">que</span> <span class="n">le</span> <span class="n">groupe</span> <span class="n">a</span> <span class="n">les</span> <span class="n">droits</span> <span class="n">d</span><span class="s1">&#39;exécution.</span>
  <span class="o">--</span><span class="n">S</span> <span class="p">(</span><span class="n">SGID</span><span class="p">)</span> <span class="n">indique</span> <span class="n">qu</span><span class="s1">&#39;un utilisateur appartenant au groupe qui exécute le fichier usurpe les</span>
      <span class="n">droits</span> <span class="n">du</span> <span class="n">groupe</span><span class="p">,</span> <span class="n">mais</span> <span class="n">que</span> <span class="n">le</span> <span class="n">groupe</span> <span class="n">n</span><span class="s1">&#39;a pas les droits d&#39;</span><span class="n">exécuter</span> <span class="n">ou</span> <span class="n">de</span> <span class="n">traverser</span><span class="o">.</span>

<span class="n">troisième</span> <span class="n">groupe</span> <span class="n">de</span> <span class="mi">3</span> <span class="n">lettres</span> <span class="p">:</span> <span class="p">::</span>

  <span class="n">même</span> <span class="n">signification</span> <span class="n">que</span> <span class="n">précédemment</span> <span class="n">mais</span> <span class="n">pour</span> <span class="n">tous</span> <span class="n">les</span> <span class="n">autres</span> <span class="n">utilisateurs</span> <span class="n">et</span> <span class="n">sauf</span> <span class="n">SGID</span>
  <span class="o">--</span><span class="n">t</span> <span class="p">(</span><span class="n">Sticky</span> <span class="n">bit</span><span class="p">)</span> <span class="n">Indique</span> <span class="n">que</span> <span class="n">les</span> <span class="n">utilisateurs</span> <span class="n">ont</span> <span class="n">le</span> <span class="n">droit</span> <span class="n">de</span> <span class="n">modifier</span> <span class="n">le</span> <span class="n">contenu</span> <span class="n">du</span> <span class="n">fichier</span>
      <span class="n">ou</span> <span class="n">du</span> <span class="n">répertoire</span><span class="p">,</span> <span class="n">mais</span> <span class="n">pas</span> <span class="n">de</span> <span class="n">le</span> <span class="n">supprimer</span><span class="o">.</span>
      <span class="n">Les</span> <span class="n">utilisateurs</span> <span class="n">ont</span> <span class="n">le</span> <span class="n">droit</span> <span class="n">d</span><span class="s1">&#39;exécution ou de traverser.</span>
  <span class="o">--</span><span class="n">T</span> <span class="p">(</span><span class="n">Sticky</span> <span class="n">bit</span><span class="p">)</span> <span class="n">Idem</span> <span class="n">mais</span> <span class="n">les</span> <span class="n">utilisateurs</span> <span class="n">n</span><span class="s1">&#39;ont pas le droit d&#39;</span><span class="n">exécuter</span> <span class="n">ou</span> <span class="n">de</span> <span class="n">traverser</span><span class="o">.</span>
</pre></div>
</div>
<p>Le fichier unFichier a pour propriétaire <em>michaellaunay</em> (owner) et pour groupe <em>amis</em> (owning group).</p>
<p>Les notions de permission et de groupe seront détaillées ci-après.</p>
<p>La taille du fichier unFichier est de 32ko.</p>
<p>La date est celle de dernière modification. La date du dernier accès est accessible avec la commande <strong>ls -u -l</strong>.</p>
<p>Les permissions d’un lien ne sont pas utilisées, car ceux sont celles de la cible qui sont vérifiées.</p>
<p>Si les permissions sont suivies d’un + alors des ACL sont positionnées.</p>
</section>
<section id="les-types-de-fichiers">
<h4><a class="toc-backref" href="#id110"><span class="sectnum">1.7.3.9</span> Les types de fichiers</a><a class="headerlink" href="#les-types-de-fichiers" title="Lien permanent vers ce titre">¶</a></h4>
<p>Outre les fichiers normaux, les répertoires et les liens, il existe de nombreux fichiers spéciaux sous Unix.</p>
<p>En effet la philosophie d’Unix est de vouloir que tout soit fichier :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Les</span> <span class="n">périphériques</span> <span class="n">sont</span> <span class="n">manipulés</span> <span class="n">comme</span> <span class="n">s</span><span class="s1">&#39;ils étaient des fichiers.</span>
<span class="n">Les</span> <span class="n">piles</span> <span class="p">(</span><span class="n">fifo</span><span class="p">,</span> <span class="n">lifo</span><span class="p">),</span> <span class="n">les</span> <span class="n">pipes</span> <span class="n">nommées</span><span class="p">,</span> <span class="n">sockets</span> <span class="n">sont</span> <span class="n">manipulés</span> <span class="n">comme</span> <span class="n">des</span> <span class="n">fichiers</span><span class="o">.</span>
<span class="n">Les</span> <span class="n">caractéristiques</span> <span class="n">du</span> <span class="n">système</span> <span class="n">sont</span> <span class="n">traduites</span> <span class="n">à</span> <span class="n">travers</span> <span class="n">une</span> <span class="n">arborescence</span><span class="o">.</span>
<span class="n">Le</span> <span class="n">noyau</span> <span class="n">lui</span><span class="o">-</span><span class="n">même</span> <span class="n">est</span> <span class="n">adressé</span> <span class="n">à</span> <span class="n">travers</span> <span class="n">une</span> <span class="n">arborescence</span> <span class="n">qui</span> <span class="n">permet</span> <span class="n">de</span> <span class="n">connaître</span> <span class="n">son</span> <span class="n">état</span> <span class="n">et</span> <span class="n">de</span> <span class="n">le</span> <span class="n">modifier</span><span class="o">.</span>
<span class="n">Les</span> <span class="n">processus</span> <span class="n">sont</span> <span class="n">eux</span><span class="o">-</span><span class="n">mêmes</span> <span class="n">manipulés</span> <span class="n">à</span> <span class="n">travers</span> <span class="n">une</span> <span class="n">arborescence</span> <span class="n">de</span> <span class="n">fichiers</span><span class="o">.</span>
</pre></div>
</div>
</section>
<section id="dev">
<h4><a class="toc-backref" href="#id111"><span class="sectnum">1.7.3.10</span> /dev</a><a class="headerlink" href="#dev" title="Lien permanent vers ce titre">¶</a></h4>
<p>Contient les fichiers de périphériques physiques ou virtuels :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda</span>    <span class="c1"># Premier disk scsi ou sata ou usb</span>
<span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda1</span>   <span class="c1"># Première partition de /dev/sda</span>
<span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sdb</span>    <span class="c1"># Second périphérique scsi ou sata ou usb</span>
<span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">cdrom</span>  <span class="c1"># Lien vers le périphérique gérant le cdrom</span>
<span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">null</span>   <span class="c1"># Utile pour se débarrasser du contenu d&#39;un flux</span>
<span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">zero</span>   <span class="c1"># Générateur d&#39;octet nul</span>
<span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">random</span> <span class="c1"># Générateur aléatoire</span>
</pre></div>
</div>
<p>Exemple:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>michaellaunay@luciole:~$ find /usr -name &quot;*.pdf&quot; 2&gt; /dev/null
/usr/share/doc/shared-mime-info/shared-mime-info-spec.pdf
/usr/share/example-content/case_ubuntu_johnshopkins_v2.pdf
/usr/share/example-content/case_howard_county_library.pdf
/usr/share/example-content/case_oxford_archaeology.pdf
/usr/share/example-content/case_ubuntu_locatrix_v1.pdf
/usr/share/example-content/case_Skegness.pdf
/usr/share/example-content/case_Contact.pdf
/usr/share/example-content/case_OaklandUniversity.pdf
/usr/share/example-content/case_KRUU.pdf
/usr/share/example-content/case_Wellcome.pdf
/usr/share/evolution/2.24/help/quickref/fr/quickref.pdf
/usr/share/gnome/help/system-admin-guide/C/system-admin-guide.pdf
/usr/share/gnome/help/gnome-access-guide/C/gnome-access-guide.pdf
/usr/share/gnome/help/user-guide/C/user-guide.pdf
</pre></div>
</div>
<p>Dans ce cas tous les messages d’erreur ont été envoyés à la poubelle.</p>
</section>
<section id="sys">
<h4><a class="toc-backref" href="#id112"><span class="sectnum">1.7.3.11</span> /sys</a><a class="headerlink" href="#sys" title="Lien permanent vers ce titre">¶</a></h4>
<p><strong>sysfs</strong> est une arborescence virtuelle résidant en mémoire qui exporte des informations sur les périphériques.</p>
<p>Cette arborescence offre plusieurs types de classement, une même information peut donc être trouvée de différente manière.</p>
<p>Les commandes telles que <strong>lsusb</strong> ou <strong>lspci</strong> vont chercher les informations dont elles ont besoin dans cette arborescence.</p>
<p><strong>/sys/class/</strong> montre les périphériques regroupés en classes :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>michaellaunay@luciole:~$ ls /sys/class/
atm        firmware       ieee1394_protocol  pci_bus        scsi_disk     usb_host
backlight  gpio           ieee80211          pcmcia_socket  scsi_generic  vc
bdi        graphics       input              power_supply   scsi_host     video_output
block      hidraw         leds               ppdev          sound         vtconsole
bluetooth  hwmon          mem                printer        spi_master
dma        ieee1394       misc               rfkill         thermal
dmi        ieee1394_host  mmc_host           rtc            tty
drm        ieee1394_node  net                scsi_device    usb_endpoint

michaellaunay@luciole:~$ cat /sys/class/thermal/cooling_device0/type
Processor
michaellaunay@luciole:~$ cat /sys/class/thermal/cooling_device0/cur_state
0
</pre></div>
</div>
</section>
<section id="proc">
<h4><a class="toc-backref" href="#id113"><span class="sectnum">1.7.3.12</span> /proc</a><a class="headerlink" href="#proc" title="Lien permanent vers ce titre">¶</a></h4>
<p><strong>procfs</strong> est une arborescence virtuelle résidant en mémoire qui exporte des informations sur le noyau.</p>
<p>C’est dans cette arborescence que des commandes comme <strong>ps</strong> vont chercher des informations sur les processus.</p>
<p>Exemple :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>michaellaunay@luciole:~$ cat /proc/cpuinfo
processor     : 0
vendor_id     : GenuineIntel
cpu family    : 6
model         : 15
model name    : Intel(R) Core(TM)2 Duo CPU     L7500  @ 1.60GHz
stepping      : 11
cpu MHz               : 800.000
cache size    : 4096 KB
physical id   : 0
siblings      : 2
core id               : 0
cpu cores     : 2
apicid                : 0
initial apicid        : 0
fpu           : yes
fpu_exception : yes
cpuid level   : 10
wp            : yes
flags         : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi
          mmx fxsr sse sse2 ss ht tm pbe syscall nx lm constant_tsc arch_perfmon pebs bts rep_good
          nopl pni monitor ds_cpl vmx est tm2 ssse3 cx16 xtpr lahf_lm ida
bogomips      : 3191.95
clflush size  : 64
cache_alignment       : 64
address sizes : 36 bits physical, 48 bits virtual
power management:
</pre></div>
</div>
<p>/proc permet en tant que root et selon l’état du processus observé d’analyser ses ressources et sa mémoire.</p>
<p>Ainsi il est possible de récupérer le contenu de la mémoire du processus arrêté.
Voir <a class="reference external" href="https://unix.stackexchange.com/questions/6301/how-do-i-read-from-proc-pid-mem-under-linux">https://unix.stackexchange.com/questions/6301/how-do-i-read-from-proc-pid-mem-under-linux</a> et <a class="reference external" href="https://unix.stackexchange.com/questions/6267/how-to-re-load-all-running-applications-from-swap-space-into-ram/6271#6271">https://unix.stackexchange.com/questions/6267/how-to-re-load-all-running-applications-from-swap-space-into-ram/6271#6271</a></p>
</section>
</section>
<section id="enchainement-et-parallelisation-des-commandes">
<h3><a class="toc-backref" href="#id114"><span class="sectnum">1.7.4</span> Enchaînement et parallélisation des commandes</a><a class="headerlink" href="#enchainement-et-parallelisation-des-commandes" title="Lien permanent vers ce titre">¶</a></h3>
<p>Toute commande doit être vue comme une boîte noire ayant une entrée standard (stdin), une sortie standard (stdout) et une sortie d’erreur standard qui permet aussi d’afficher des informations (stderr).</p>
<p>Par défaut l’entrée standard est la saisie clavier et les sorties sont l’écran.</p>
</section>
<section id="les-flux-standards">
<h3><a class="toc-backref" href="#id115"><span class="sectnum">1.7.5</span> Les flux standards</a><a class="headerlink" href="#les-flux-standards" title="Lien permanent vers ce titre">¶</a></h3>
<p>Les flux standards stdin, stdout et stderr sont numérotés respectivement 0, 1 et 2.</p>
<p>En conséquence on peut utiliser ces numéros pour les désigner lors des redirections.</p>
</section>
<section id="input-output">
<h3><a class="toc-backref" href="#id116"><span class="sectnum">1.7.6</span> Input, Output</a><a class="headerlink" href="#input-output" title="Lien permanent vers ce titre">¶</a></h3>
<p>La notion d’input (entrée) et d’output (sortie) est relative à la commande, ainsi dans un pipe entre deux commandes l’entrée de la seconde commande et en fait la sortie de la première. Le système crée un flux entre les deux commandes nourri par la première et consommé par la seconde.</p>
</section>
<section id="les-redirections">
<h3><a class="toc-backref" href="#id117"><span class="sectnum">1.7.7</span> Les redirections</a><a class="headerlink" href="#les-redirections" title="Lien permanent vers ce titre">¶</a></h3>
<p>Les redirections vont permettre d’indiquer que faire des entrées et sorties standards.</p>
<p>Les redirections de fichier :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span><span class="p">,</span> <span class="mi">1</span><span class="o">&gt;</span>  <span class="c1"># Stocke la sortie standard dans un fichier</span>
<span class="mi">2</span><span class="o">&gt;</span>     <span class="c1"># Stocke la sortie des erreurs dans un fichier</span>
<span class="o">&amp;&gt;</span>     <span class="c1"># Stocke les sorties dans un seul fichier</span>
<span class="o">&gt;&amp;</span>     <span class="c1"># Idem</span>
<span class="o">&gt;&gt;</span>     <span class="c1"># Concatène la sortie standard à la fin d&#39;un fichier</span>
<span class="o">&lt;</span>      <span class="c1"># Utilise un fichier en entrée</span>
<span class="o">|</span>      <span class="c1"># pipe, décrit ci-après</span>
</pre></div>
</div>
</section>
<section id="les-pipes">
<h3><a class="toc-backref" href="#id118"><span class="sectnum">1.7.8</span> Les pipes</a><a class="headerlink" href="#les-pipes" title="Lien permanent vers ce titre">¶</a></h3>
<p>Le pipe permet d’enchaîner les commandes, l’entrée d’une commande est alors le résultat de la commande précédente.</p>
<p>L’intérêt est de pouvoir créer des comportements complexes à partir de commandes simples. Cette association peut à son tour être manipulée comme une boite noire et être insérée dans un pipe plus complexe.</p>
<p>Exemple:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">netstat</span> <span class="o">-</span><span class="n">anp</span> <span class="o">|</span><span class="n">grep</span> <span class="s1">&#39;tcp\|udp&#39;</span> <span class="o">|</span> <span class="n">awk</span> <span class="s1">&#39;{print $5}&#39;</span> <span class="o">|</span> <span class="n">sed</span> <span class="n">s</span><span class="o">/</span><span class="p">::</span><span class="n">ffff</span><span class="p">:</span><span class="o">//</span> <span class="o">|</span> <span class="n">cut</span> <span class="o">-</span><span class="n">d</span><span class="p">:</span> <span class="o">-</span><span class="n">f1</span> <span class="o">|</span> <span class="n">sort</span> <span class="o">|</span> <span class="n">uniq</span> <span class="o">-</span><span class="n">c</span> <span class="o">|</span> <span class="n">sort</span> <span class="o">-</span><span class="n">n</span>
</pre></div>
</div>
</section>
<section id="les-alias">
<h3><a class="toc-backref" href="#id119"><span class="sectnum">1.7.9</span> Les alias</a><a class="headerlink" href="#les-alias" title="Lien permanent vers ce titre">¶</a></h3>
<p>La commande intégrée alias permet de redéfinir des commandes :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">alias</span> <span class="n">rm</span><span class="o">=</span><span class="s2">&quot;echo &#39;ça va couper&#39; &amp;&amp; rm&quot;</span>
</pre></div>
</div>
<p>La commande <strong>unalias</strong> supprime les alias.</p>
</section>
<section id="screen">
<h3><a class="toc-backref" href="#id120"><span class="sectnum">1.7.10</span> screen</a><a class="headerlink" href="#screen" title="Lien permanent vers ce titre">¶</a></h3>
<p>La commande <strong>screen</strong> est un multiplexeur de terminaux il permet de gérer plusieurs shell et de ce déconnecter sans tuer les shell dont les commandes ne sont pas encore finies.</p>
<p>L’intérêt est de pouvoir réaliser des tâches d’administration longues sans devoir rester connecté, ou si le réseau n’est pas fiable de ne pas perdre le travail accompli en reprenant là ou la connexion s’est rompue.</p>
<p>Les options de bases :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>michaellaunay@luciole:~$ screen -dmS Nom
michaellaunay@luciole:~$ screen -r Nom # Permet de se rattacher au terminal Nom
# Pour se détacher Crtl-a Ctrl-d
# Pour un nouveau Ctrl-a Ctrl-c
# Pour passer de l&#39;un à l&#39;autre : Ctrl-a Ctrl-n
# man screen
</pre></div>
</div>
</section>
<section id="ssh">
<h3><a class="toc-backref" href="#id121"><span class="sectnum">1.7.11</span> ssh</a><a class="headerlink" href="#ssh" title="Lien permanent vers ce titre">¶</a></h3>
<p>La commande <strong>ssh</strong> permet de se connecter à distance sur une machine Unix ceci de façon chiffrée. Elle permet aussi d’ouvrir des tunnels chiffrés.</p>
<p>L’ouverture d’un tunnel entre 2 machines est de la forme :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>ssh -L ${PORT_SOURCE}:${nom_machine_dest}:${PORT_DEST} ${USER}@${DEST}
</pre></div>
</div>
<p>où ${PORT_SOURCE} est le numéro de port d’entrée du tunnel sur la machine où l’on est, ${nom_machine_dest} est soit localhost soit le nom de la machine destination soit une adresse du réseau privé derrière le serveur destination, ${PORT_DEST} est le numéro du port de sortie du tunnel sur la machine cible
${USER} est le nom d’utilisateur
${DEST} est le nom complet du serveur de destination</p>
<p>On peut ajouter l’option -i avec un nom de fichier clé à utiliser</p>
<p>Exemple :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ssh</span> <span class="o">-</span><span class="n">l</span> <span class="mi">9880</span><span class="p">:</span><span class="n">localhost</span><span class="p">:</span><span class="mi">80</span> <span class="n">michaellaunay</span><span class="nd">@plateforme</span><span class="o">.</span><span class="n">test</span><span class="o">.</span><span class="n">com</span>
</pre></div>
</div>
<p>Me permet d’ouvrir un tunnel entre ma machine et le serveur plateforme en utilisant mon compte michaellaunay.</p>
<p>Une fois mon mot de passe ou ma clé acceptée je me retrouve sur la machine distante et un tunnel est ouvert entre ma machine locale et plateforme.</p>
<p>Si j’ouvre un navigateur sur ma machine et que je mets comme adresse <a class="reference external" href="http://localhost:9880">http://localhost:9880</a>, la communication est chiffrée et envoyée sur plateforme où elle ressort sur le port 80 ce qui me permet d’accéder au serveur web de plateforme1 sans que quiconque ne sache ce que je fais.</p>
<p>Compréhension de ssh :</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="http://fr.wikipedia.org/wiki/Ssh">http://fr.wikipedia.org/wiki/Ssh</a></p></li>
<li><p><a class="reference external" href="http://web.archive.org/web/20110907084212/http://www.unixgarden.com/index.php/administration-systeme/principes-et-utilisation-de-ssh">http://web.archive.org/web/20110907084212/http://www.unixgarden.com/index.php/administration-systeme/principes-et-utilisation-de-ssh</a></p></li>
<li><p><a class="reference external" href="https://youtu.be/pLJC96zfwrE">https://youtu.be/pLJC96zfwrE</a></p></li>
</ul>
</div></blockquote>
<p>Si la clé d’une machine à laquelle on se connecte habituellement a changé (cas d’une réinstallation), on peut être amené à supprimer son entrée dans le fichier <em>~/.ssh/known_hosts</em>.</p>
<p>Le plus simple est alors d’utiliser la commande <strong>ssh-keygen -R NomDeLaMachineDistante</strong>.</p>
<p>L’installation du deamon <strong>apt-get install ssh</strong></p>
<p>Pour sécuriser les connexions <strong>ssh</strong>, il faut éditer <em>/etc/ssh/sshd_config</em> et mettre l’option <em>PermitRootLogin=no</em> et ajouter en fin de fichier <em>AllowUsers idUtilisateurAutorise</em>.</p>
<p>On peut aussi limiter les adresses pouvant se connecter via le paramètre <em>ListenAddress</em> et les ports avec <em>PermitOpen host:port</em>.</p>
<p>Il est possible de créer des sections de configuration par utilisateur :</p>
<blockquote>
<div><p>Match User michaellaunay
X11Forwarding yes
MAtch All</p>
</div></blockquote>
<p>Pour ne permettre la connexion que par clé on positionne « ChallengeResponseAuthentication no »</p>
<p>Voir vidéo <a class="reference external" href="https://youtu.be/qrS1rSFb-1w">https://youtu.be/qrS1rSFb-1w</a></p>
<p>La commande <strong>screen</strong> est très utilisée avec « ssh », elle permet de conserver le <strong>tty</strong> ouvert lors des déconnexions et donc de reprendre là où on en était.
Il suffit de la relancer avec l’option « -r » pour rattacher une session précédente,  de même en début de session on peut faire « Ctrl A » « esc » pour enregistrer les lignes et donc avoir la scroll bar.</p>
<p>Créer une clé:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ssh</span><span class="o">-</span><span class="n">keygen</span>
<span class="c1"># L&#39;option -i permet de préciser le nom du fichier de destination</span>
</pre></div>
</div>
<p>Ajouter sa clé public à un serveur distant</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ssh</span><span class="o">-</span><span class="n">copy</span><span class="o">-</span><span class="nb">id</span> <span class="n">user</span><span class="nd">@Serveur_Distant</span>
<span class="c1"># L&#39;option -i permet de préciser le nom du fichier clé à utiliser</span>
</pre></div>
</div>
<p>Pour limiter les connexions par clé à seulement certaines adresses, éditer le fichier ~/.ssh/authorized_keys ajouter devant la clé “from= »192.168.0.1 » “</p>
<p>Supprimer la clé d’un serveur distant</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ssh</span><span class="o">-</span><span class="n">keygen</span> <span class="o">-</span><span class="n">R</span> <span class="n">NomServeurDistant</span>
</pre></div>
</div>
<p>On peut utiliser <strong>tar</strong> et <strong>ssh</strong> pour faire des archives à travers un flux sécurisé</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tar</span> <span class="n">cf</span> <span class="o">-</span> <span class="n">RepertoireSource</span> <span class="o">|</span> <span class="n">ssh</span> <span class="n">user</span><span class="nd">@ServeurSauvegarde</span> <span class="s2">&quot;cat &gt; nom_archive.tar&quot;</span>
</pre></div>
</div>
<p>La restauration se fera alors comme suit</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ssh</span> <span class="n">user</span><span class="nd">@ServeurSauvegarde</span> <span class="s2">&quot;cat nom_archive.tar&quot;</span> <span class="o">|</span> <span class="n">tar</span> <span class="n">xf</span>
</pre></div>
</div>
<p>Utiliser un Agent ssh</p>
<p>Saisir à chaque fois sa clé ou son mot de passe peut être fastidieux. On a alors la possibilité d’utiliser un agent ssh.</p>
<p>Vérifiez qu’il est déjà en train de tourner :</p>
<blockquote>
<div><p>ps -p $SSH_AGENT_PID # s’il fonctionne la variable d’environnement contient son PID</p>
</div></blockquote>
<p>Le lancer sinon :</p>
<blockquote>
<div><p>eval <cite>ssh-agent</cite></p>
</div></blockquote>
<p>Pour ajouter des clés :</p>
<blockquote>
<div><p>ssh-add</p>
</div></blockquote>
<p>Pour se connecter et continuer à utiliser les clés de l’agent sur la destination  (forward agent):</p>
<blockquote>
<div><p>ssh -A …</p>
</div></blockquote>
<p>Pour rebondir (embarque l’agent sur les dernières versions de ssh)</p>
<blockquote>
<div><p>ssh -J 192.168.0.3,192.168.0.1 <a class="reference external" href="mailto:usedest&#37;&#52;&#48;destination&#46;ecreall&#46;com">usedest<span>&#64;</span>destination<span>&#46;</span>ecreall<span>&#46;</span>com</a> #Enchaîne les rebonds sur les adresses séparées par la virgule</p>
</div></blockquote>
<p>On peut aussi paramétrer des rebonds en éditant ~/.ssh/config :</p>
<blockquote>
<div><p>Host machine_intermediaire_ou_alias</p>
<blockquote>
<div><p>Hostname adresse_ip_ou_nom</p>
<p>User nom_utilisateur</p>
<p>IdentityFile chemin_vers_cle_intermediaire</p>
</div></blockquote>
<p>Host serveur_dest_alias</p>
<blockquote>
<div><p>Hostname adresse_ip_ou_nom</p>
<p>User nom_utilisateur</p>
<p>ProxyJump machine_intermediaire_ou_alias</p>
</div></blockquote>
</div></blockquote>
<p>Voir <a class="reference external" href="https://youtu.be/vpbD7xA2wac">https://youtu.be/vpbD7xA2wac</a></p>
<p>Créer un tunnel entre deux machines en tâche de fond :</p>
<blockquote>
<div><p>ssh -fNL port_local_sortant:adresse_rebond:port_entrant_distant <a class="reference external" href="mailto:user&#37;&#52;&#48;Serveur_Distant">user<span>&#64;</span>Serveur_Distant</a> # -f pour mettre en fond -N pour ne pas exécuter de commande</p>
</div></blockquote>
</section>
<section id="iptables-et-ufw">
<h3><a class="toc-backref" href="#id122"><span class="sectnum">1.7.12</span> iptables et ufw</a><a class="headerlink" href="#iptables-et-ufw" title="Lien permanent vers ce titre">¶</a></h3>
<p>La commande <strong>iptables</strong> permet de consulter et modifier les règles du firewall.</p>
<p>Le service <strong>ufw</strong> est un « firewall » pré-configurer que l’on peut facilement compléter.</p>
<p>Pour l’installer il suffit de faire :</p>
<blockquote>
<div><p>apt install ufw</p>
</div></blockquote>
<p>Pour connaître la liste des applications pouvant être autorisées par ufw à passer le firewall :</p>
<blockquote>
<div><p><a class="reference external" href="mailto:root&#37;&#52;&#48;luciole">root<span>&#64;</span>luciole</a>:~# ufw app list
Applications disponibles</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Apache</span>
<span class="n">Apache</span> <span class="n">Full</span>
<span class="n">Apache</span> <span class="n">Secure</span>
<span class="n">Bind9</span>
<span class="n">Dovecot</span> <span class="n">IMAP</span>
<span class="n">Dovecot</span> <span class="n">Secure</span> <span class="n">IMAP</span>
<span class="n">OpenLDAP</span> <span class="n">LDAP</span>
<span class="n">OpenLDAP</span> <span class="n">LDAPS</span>
<span class="n">OpenSSH</span>
<span class="n">Postfix</span>
<span class="n">Postfix</span> <span class="n">SMTPS</span>
<span class="n">Postfix</span> <span class="n">Submission</span>
</pre></div>
</div>
</div></blockquote>
<p>On pourra alors : soit autoriser les ports manuellement, soit autoriser les ports utilisés par une application.</p>
<blockquote>
<div><p>ufw allow OpenSSH</p>
</div></blockquote>
<p>Modification du firewall pour permettre en entrée http, https, smtp :</p>
<blockquote>
<div><p>vim /,etc/ufw/ufw.conf  # ENABLED=yes #si pas déjà positionné
ufw allow 22/tcp # Ouvre le port ssh à tous (on peut restreindre à certaines adresses)
ufw allow 80/tcp # Ouverture de http
ufw allow 443/tcp # Ouverture de https
ufw allow 25/tcp # Ouverture de smtp (envoi des courriels)
ufw enable # Rend actif ufw</p>
</div></blockquote>
<p>Ces commandes permettent aussi de gérer ipv6</p>
<p>Vérification :</p>
<blockquote>
<div><p><a class="reference external" href="mailto:root&#37;&#52;&#48;luciole">root<span>&#64;</span>luciole</a>:/etc/dovecot# ufw status
État : actif</p>
<p>Vers                       Action      De
—-                       ——      –
22/tcp                     ALLOW       Anywhere
25/tcp                     ALLOW       Anywhere
80/tcp                     ALLOW       Anywhere
443/tcp                    ALLOW       Anywhere
22/tcp (v6)                ALLOW       Anywhere (v6)
25/tcp (v6)                ALLOW       Anywhere (v6)
80/tcp (v6)                ALLOW       Anywhere (v6)
443/tcp (v6)               ALLOW       Anywhere (v6)</p>
</div></blockquote>
<p>Permettre le lancement au démarrrage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">systemctl</span> <span class="n">enable</span> <span class="n">ufw</span>
</pre></div>
</div>
</section>
<section id="un-peu-de-configuration-pour-l-utilisation-en-ligne">
<h3><a class="toc-backref" href="#id123"><span class="sectnum">1.7.13</span> Un peu de configuration pour l’utilisation en ligne</a><a class="headerlink" href="#un-peu-de-configuration-pour-l-utilisation-en-ligne" title="Lien permanent vers ce titre">¶</a></h3>
<p>Beaucoup de paramètre par défaut peuvent être modifier dans /,etc</p>
</section>
<section id="configurer-vim-and-bash">
<h3><a class="toc-backref" href="#id124"><span class="sectnum">1.7.14</span> Configurer vim and bash</a><a class="headerlink" href="#configurer-vim-and-bash" title="Lien permanent vers ce titre">¶</a></h3>
<p>Décommenter « syntax on » dans « /etc/vim/vimrc », ce qui permet d’avoir la coloration syntaxique.</p>
<p>Pour avoir la recherche dans l’historique des commandes en saisissant les premières lettres de la commande éditer « /etc/inputrc » et supprimer le guillemet de tête:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;\e[5~&quot;</span><span class="p">:</span> <span class="n">history</span><span class="o">-</span><span class="n">search</span><span class="o">-</span><span class="n">backward</span>
<span class="s2">&quot;\e[6~&quot;</span><span class="p">:</span> <span class="n">history</span><span class="o">-</span><span class="n">search</span><span class="o">-</span><span class="n">forward</span>
</pre></div>
</div>
<p>Pour faire de vim l’éditeur par défaut:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">echo</span> <span class="s2">&quot;export EDITOR=vim&quot;</span> <span class="o">&gt;</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">profile</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">editor</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>Pour augmenter le nombre de ligne dans l’historique des commandes, créer « /etc/profile.d/history.sh » en mettant:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># https://wiki.ubuntu.com/Spec/EnhancedBash</span>
<span class="n">shopt</span> <span class="o">-</span><span class="n">s</span> <span class="n">histappend</span>
<span class="n">PROMPT_COMMAND</span><span class="o">=</span><span class="s2">&quot;history -a; $PROMPT_COMMAND&quot;</span>
<span class="n">export</span> <span class="n">HISTSIZE</span><span class="o">=</span><span class="mi">1000</span>
<span class="n">export</span> <span class="n">HISTFILESIZE</span><span class="o">=</span><span class="mi">1000</span>
<span class="n">export</span> <span class="n">GREP_OPTIONS</span><span class="o">=</span><span class="s1">&#39;--color=auto&#39;</span>
</pre></div>
</div>
</section>
</section>
<section id="gestion-des-permissions-et-droits-d-acces">
<h2><a class="toc-backref" href="#id125"><span class="sectnum">1.8</span> Gestion des permissions et droits d’accès</a><a class="headerlink" href="#gestion-des-permissions-et-droits-d-acces" title="Lien permanent vers ce titre">¶</a></h2>
<section id="concepts">
<h3><a class="toc-backref" href="#id126"><span class="sectnum">1.8.1</span> Concepts</a><a class="headerlink" href="#concepts" title="Lien permanent vers ce titre">¶</a></h3>
<p>Tous les utilisateurs ont un compte qui permet de les identifier.</p>
<p>Les programmes fonctionnant en tâche de fond (services) sont lancés depuis des utilisateurs créés spécialement pour eux. Ainsi, le serveur html <strong>apache</strong> est lancé depuis le compte <strong>www-data</strong>.</p>
<p>Les utilisateurs peuvent appartenir à des groupes ce qui permet de donner des droits à un ensemble d’utilisateurs très facilement.</p>
<p>Tout fichier appartient à un utilisateur et à un groupe.</p>
<p>La gestion des droits d’accès et d’exécution se résume alors à gérer les types d’accès en fonction du propriétaire, du groupe, et du reste des utilisateurs.</p>
<p>Comme vu précédemment la commande <strong>ls -l</strong> permet d’afficher les attributs d’un fichier et donc ses permissions.</p>
<p>À la création d’un fichier, les droits sont automatiquement positionnés en fonction de la valeur par défaut du système et de <strong>umask</strong> :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>michaellaunay@luciole:~$ umask
0022
michaellaunay@luciole:~/tmp$ touch test1 #Permet de créer un le fichier test1 s&#39;il n&#39;existe pas ou de mettre à jour sa date de modification à maintenant.
michaellaunay@luciole:~/tmp$ ls -lh test1
-rw-r--r-- 1 michaellaunay michaellaunay 0 avril  5 12:17 test1
michaellaunay@luciole:~/tmp$ umask 027
michaellaunay@luciole:~/tmp$ touch test2
michaellaunay@luciole:~/tmp$ ls -lh test2
-rw-r----- 1 michaellaunay michaellaunay 0 avril  5 12:18 test2
</pre></div>
</div>
<p>Le propriétaire est alors le créateur, et le groupe est généralement le groupe par défaut de l’utilisateur sauf dans le cas ou le répertoire porte le SGID alors le groupe est celui du répertoire.</p>
</section>
<section id="changer-le-proprietaire-ou-le-groupe-proprietaire">
<h3><a class="toc-backref" href="#id127"><span class="sectnum">1.8.2</span> Changer le propriétaire ou le groupe propriétaire</a><a class="headerlink" href="#changer-le-proprietaire-ou-le-groupe-proprietaire" title="Lien permanent vers ce titre">¶</a></h3>
<p>La commande <strong>chown</strong> permet de changer le propriétaire et le groupe d’un fichier :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>root@luciole:~$ ls -l /tmp/MonFichier
-rw-rw-rw- 1 michaellaunay michaellaunay 0 2009-05-03 19:08 /tmp/MonFichier
root@luciole:~# chown root:users /tmp/MonFichier
root@luciole:~# ls -l /tmp/MonFichier
-rw-rw-rw- 1 root users 0 2009-05-03 19:08 /tmp/MonFichier
</pre></div>
</div>
<p>Toutefois pour des raisons de sécurité (gestion des quotas : attaque sushi) la commande peut être réservée au super utilisateur.</p>
<p>On dispose aussi de la commande <strong>chgrp</strong> qui permet de changer le groupe d’un fichier.</p>
</section>
<section id="valeurs-symboliques-et-octales-des-permissions">
<h3><a class="toc-backref" href="#id128"><span class="sectnum">1.8.3</span> Valeurs symboliques et octales des permissions</a><a class="headerlink" href="#valeurs-symboliques-et-octales-des-permissions" title="Lien permanent vers ce titre">¶</a></h3>
<p>Les tableaux suivants donnent les équivalents symboliques octaux des permissions.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 52%" />
<col style="width: 29%" />
<col style="width: 19%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>DROIT</p></td>
<td><p>LETTRE</p></td>
<td><p>VALEUR</p></td>
</tr>
<tr class="row-even"><td><p>Lecture</p></td>
<td><p>r (read)</p></td>
<td><p>4</p></td>
</tr>
<tr class="row-odd"><td><p>Écriture</p></td>
<td><p>w (write)</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-even"><td><p>Exécution / Traversé</p></td>
<td><p>x (execute)</p></td>
<td><p>1</p></td>
</tr>
</tbody>
</table>
<p>Ainsi les permissions <em>rwx</em> sont équivalentes à <em>7</em> et <em>rwxr-xr–</em> donne <em>754</em>.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 58%" />
<col style="width: 17%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>DROIT</p></td>
<td><p>LETTRE</p></td>
<td><p>VALEUR</p></td>
</tr>
<tr class="row-even"><td><p>SUID</p></td>
<td><p>s si le propriétaire a <em>x</em>
S si non</p></td>
<td><p>4</p></td>
</tr>
<tr class="row-odd"><td><p>SGID</p></td>
<td><p>s si le groupe a <em>x</em>
S sinon</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-even"><td><p>Sticky Bit</p></td>
<td><p>t si les autres ont <em>x</em>
T sinon</p></td>
<td><p>1</p></td>
</tr>
</tbody>
</table>
<p>Ainsi <em>rwsr-sr-t</em> est équivalent à <em>7755</em>.</p>
<p>Si l’on a un S ou un T en majuscule, cela signifie que les droits d’exécution n’ont pas été positionnés.</p>
<p>Ceci n’a pas de sens dans le cas général et indique une suppression du droit d’exécution avec oubli du SUID ou GUID ou Sticky Bit.</p>
<p>Sauf avec l’usage des ACLs, où un utilisateur particulier peut avoir le droit d’exécution et redonne du sens à S ou T.</p>
</section>
<section id="changer-les-permissions-sur-les-fichiers">
<h3><a class="toc-backref" href="#id129"><span class="sectnum">1.8.4</span> Changer les permissions sur les fichiers</a><a class="headerlink" href="#changer-les-permissions-sur-les-fichiers" title="Lien permanent vers ce titre">¶</a></h3>
<p>La commande <strong>chmod</strong> permet de modifier les droits des fichiers.</p>
<section id="mode-chiffre">
<h4><a class="toc-backref" href="#id130"><span class="sectnum">1.8.4.1</span> Mode chiffré</a><a class="headerlink" href="#mode-chiffre" title="Lien permanent vers ce titre">¶</a></h4>
<p>Exemple :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>michaellaunay@luciole:~/tmp$ ls -l MonFichier
-rw-r--r-- 1 michaellaunay michaellaunay 0 2009-05-03 19:40 MonFichier
michaellaunay@luciole:~/tmp$ chmod 754 MonFichier
michaellaunay@luciole:~/tmp$ ls -l MonFichier
-rwxr-xr-- 1 michaellaunay michaellaunay 0 2009-05-03 19:40 MonFichier
</pre></div>
</div>
</section>
<section id="notation-relative-aux-droits-existants">
<h4><a class="toc-backref" href="#id131"><span class="sectnum">1.8.4.2</span> Notation relative (aux droits existants)</a><a class="headerlink" href="#notation-relative-aux-droits-existants" title="Lien permanent vers ce titre">¶</a></h4>
<p>Exemple :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>michaellaunay@luciole:~/tmp$ ls -l MonFichier
-rwxr-xr-- 1 michaellaunay michaellaunay 0 2009-05-03 19:40 MonFichier
michaellaunay@luciole:~/tmp$ chmod u+s,g-x,o-r MonFichier
michaellaunay@luciole:~/tmp$ ls -l MonFichier
-rwsr----- 1 michaellaunay michaellaunay 0 2009-05-03 19:40 MonFichier
</pre></div>
</div>
<p>Attention aux modifications contradictoires :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>michaellaunay@luciole:~$ echo coucou &gt; /tmp/hello
michaellaunay@luciole:~$ ls -l /tmp/hello
-rw-r--r-- 1 michaellaunay michaellaunay 7 2009-05-07 09:45 /tmp/hello
michaellaunay@luciole:~$ sudo chmod u-w,o+w /tmp/hello
michaellaunay@luciole:~$ ls -l /tmp/hello
-r--r--rw- 1 michaellaunay michaellaunay 7 2009-05-07 09:45 /tmp/hello
michaellaunay@luciole:~$ echo bonjour &gt;&gt; /tmp/hello
bash: /tmp/hello: Permission non accordée
</pre></div>
</div>
</section>
<section id="notation-absolue">
<h4><a class="toc-backref" href="#id132"><span class="sectnum">1.8.4.3</span> Notation absolue</a><a class="headerlink" href="#notation-absolue" title="Lien permanent vers ce titre">¶</a></h4>
<p>Exemple :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>michaellaunay@luciole:~/tmp$ ls -l MonFichier
-rwsr----- 1 michaellaunay michaellaunay 0 2009-05-03 19:40 MonFichier
michaellaunay@luciole:~/tmp$ chmod u=rx,g=rx,o=rx MonFichier
michaellaunay@luciole:~/tmp$ ls -l MonFichier
-r-xr-xr-x 1 michaellaunay michaellaunay 0 2009-05-03 19:40 MonFichier
</pre></div>
</div>
</section>
</section>
<section id="umask">
<h3><a class="toc-backref" href="#id133"><span class="sectnum">1.8.5</span> Umask</a><a class="headerlink" href="#umask" title="Lien permanent vers ce titre">¶</a></h3>
<p>Par défaut le système applique les droits 0666 pour un fichier et 0777 pour les répertoires auxquels il applique encore le filtre <strong>umask</strong> qui par défaut vaut 0022, les droits sont alors 0644 (rw-r–r–) pour un fichier et 0755 (rwx-rx-rx) pour un répertoire.</p>
<p>Il est possible de changer la valeur du masque de permissions en appelant <strong>umask nouvellevaleur</strong>.</p>
</section>
<section id="acl">
<h3><a class="toc-backref" href="#id134"><span class="sectnum">1.8.6</span> ACL</a><a class="headerlink" href="#acl" title="Lien permanent vers ce titre">¶</a></h3>
<p>Le mécanisme de gestion des droits Unix couvre 95% des usages.</p>
<p>Il reste donc certains cas non couverts comme le fait d’attribuer les droits de modification d’un fichier à un utilisateur sans avoir à demander à l’administrateur de devoir créer un groupe (ce qui manque un peu de souplesse).</p>
<p>On peut aussi vouloir associer de nouveaux attributs aux fichiers pour par exemple gérer des informations de sécurités.</p>
<p>À l’inverse il est très difficile de restreindre les droits d’un utilisateur d’un groupe donné pour un seul fichier.</p>
<p>C’est pour répondre ce besoin qu’ont été implémentées les Access Control List</p>
<p>Les ACLs reposent sur le mécanisme des attributs étendus.</p>
<p>Pour les rendre disponibles, il faut que la partition soit montée avec les options <em>acl</em> et <em>user_xattr</em> (modifier en conséquence <em>/,etc/fstab</em>).</p>
<p>Les fonctions d’accès aux <em>acl</em> sont <strong>getfacl</strong>, <strong>setfacl</strong>, <strong>getfattr</strong>, <strong>setfattr</strong>.</p>
<p>Voir aussi les man pages de <em>acl</em> et <em>attr(5)</em>.</p>
</section>
<section id="attributs-etendus">
<h3><a class="toc-backref" href="#id135"><span class="sectnum">1.8.7</span> Attributs étendus</a><a class="headerlink" href="#attributs-etendus" title="Lien permanent vers ce titre">¶</a></h3>
<p>Les attributs étendus permettent de gérer simplement les métadonnées associées à un fichier.</p>
<p>Ce sont ces attributs étendus qui recevront les informations liées aux ACLs.</p>
<p>Pour installer le paquet : <strong>apt-get install attr</strong></p>
<p>Ajouter l’option <em>user_xattr</em> aux partitions dans <em>/,etc/fstab</em>.</p>
<p>Puis utiliser <strong>setfattr</strong> pour positionner les attributs et <strong>getfattr</strong> pour les afficher :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>michaellaunay@excalibur:~$ echo test &gt; MonFichier
michaellaunay@excalibur:~$ setfattr -n user.description -v &#39;Contient des données de test&#39; MonFichier
michaellaunay@excalibur:~$ ls -l MonFichier
-rw-r--r-- 1 michaellaunay michaellaunay 5 2009-05-05 08:17 MonFichier
michaellaunay@excalibur:~$ getfattr -d MonFichier
#file: MonFichier
user.description=&quot;Contient des donn\305\251es de test&quot;
</pre></div>
</div>
<p>Remarque : La présence d’attributs étendus n’est pas signalée par <em>ls</em>.</p>
</section>
<section id="affectation-des-acl">
<h3><a class="toc-backref" href="#id136"><span class="sectnum">1.8.8</span> Affectation des ACL</a><a class="headerlink" href="#affectation-des-acl" title="Lien permanent vers ce titre">¶</a></h3>
<p>Pour vérifier que les ACLs peuvent être activées :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>michaellaunay@luciole:~$ grep -i acl /boot/config-`uname -r`

CONFIG_EXT2_FS_POSIX_ACL=y
CONFIG_EXT3_FS_POSIX_ACL=y
CONFIG_EXT4DEV_FS_POSIX_ACL=y
CONFIG_FS_POSIX_ACL=y
CONFIG_GENERIC_ACL=y
CONFIG_JFS_POSIX_ACL=y
CONFIG_NFSD_V2_ACL=y
CONFIG_NFSD_V3_ACL=y
CONFIG_NFS_ACL_SUPPORT=m
CONFIG_NFS_V3_ACL=y
CONFIG_REISERFS_FS_POSIX_ACL=y
CONFIG_TMPFS_POSIX_ACL=y
CONFIG_XFS_POSIX_ACL=y
</pre></div>
</div>
<p>Pour installer les ACL si besoin <em>apt-get install acl</em>.</p>
<p>Puis rendre la partition compatible avec les ACL (édition de fstab).</p>
<p>Exemple de changement de permissions :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>root@excalibur:~# mkdir /tmp/MYDIR
root@excalibur:~# chacl u::rwx,u:michaellaunay:rwx,g::---,o::---,m::rwx /tmp/MYDIR
root@excalibur:~# ls -l /tmp
drwx------+ 2 root     root    4096 2009-05-04 22:37 MYDIR
root@excalibur:~# su - michaellaunay
michaellaunay@excalibur:~$ touch /tmp/MYDIR/MonFichier
michaellaunay@excalibur:~$ ls -l /tmp/MYDIR/
-rw-r--r-- 1 michaellaunay michaellaunay 0 2009-05-04 22:50 /tmp/MYDIR/
michaellaunay@excalibur:~$ setfacl -m isabelle:r /tmp/MYDIR/MonFichier
michaellaunay@excalibur:~$ setfacl -m g:users:- /tmp/MYDIR/MonFichier
michaellaunay@excalibur:~$ getfacl /tmp/MYDIR/MonFichier
getfacl: Removing leading &#39;/&#39; from absolute path names
# file: tmp/MYDIR/MonFichier
# owner: michaellaunay
# group: michaellaunay
user::rw-
user:isabelle:r--
group::r--
group:users:---
mask::r--
other::r--
</pre></div>
</div>
</section>
</section>
<section id="les-processus">
<h2><a class="toc-backref" href="#id137"><span class="sectnum">1.9</span> Les processus</a><a class="headerlink" href="#les-processus" title="Lien permanent vers ce titre">¶</a></h2>
<section id="definition">
<h3><a class="toc-backref" href="#id138"><span class="sectnum">1.9.1</span> Définition</a><a class="headerlink" href="#definition" title="Lien permanent vers ce titre">¶</a></h3>
<p>Un processus est l’instance d’un programme en cours de fonctionnement.</p>
<p>Une application est constituée de un à plusieurs processus qui collaborent à la réalisation du travail demandé.</p>
<p>Chaque processus s’exécute en parallèle des autres.</p>
<p>Un processus correspond à un fichier exécutable.</p>
<p>Les processus utilisent des bibliothèques qui peuvent être statiques ou dynamiques selon qu’elles sont dans le code de l’application ou non.</p>
<p>L’extension des bibliothèques dynamiques est <em>.so</em> (shared object).</p>
<p>Un processus est lancé par un autre processus, ainsi il existe une relation père-fils entre les processus.</p>
<p>Le processus ancêtre de tous les autres est <em>init</em> qui est lancé lors du démarrage par le noyau.</p>
<p>Son <em>PID</em> est 1.</p>
<p><strong>Alt+F2</strong> est un raccourci clavier permettant d’appeler le lanceur.</p>
</section>
<section id="attributs-d-un-processus">
<h3><a class="toc-backref" href="#id139"><span class="sectnum">1.9.2</span> Attributs d’un processus</a><a class="headerlink" href="#attributs-d-un-processus" title="Lien permanent vers ce titre">¶</a></h3>
<p>PID : Identifiant du processus (Process Identification),</p>
<p>PPID : Identifiant du processus père (Parent Process Identification),</p>
<p>PGID : Identifiant du groupe de processus qui permet de connaître l’application à laquelle appartient le processus,</p>
<p>UID : Le compte utilisateur ayant lancé le processus,</p>
<p>GIDs : Les groupes de l’utilisateur ayant lancé le processus,</p>
<p>TTY : Terminal où a été lancé le processus,</p>
<p>NICE : Priorité appliquée pour le scheduling,</p>
<p>CMD : La commande à l’origine du processus.</p>
</section>
<section id="cycle-de-vie-d-un-processus">
<h3><a class="toc-backref" href="#id140"><span class="sectnum">1.9.3</span> Cycle de vie d’un processus</a><a class="headerlink" href="#cycle-de-vie-d-un-processus" title="Lien permanent vers ce titre">¶</a></h3>
<p>Un processus est dans un état qui peut être « created », « ready », « running », « sleeping », « idle » (en attente de signal), « Terminated » = « zombie »</p>
<p><em>Created</em> correspond à l’état du processus au moment de sa création lorsque les variables ne sont pas encore renseignées.</p>
<p><em>Ready</em> le processus est en mémoire, les variables sont renseignées.</p>
<p><em>Running</em> le processus est en cours d’exécution.</p>
<p><em>Sleeping</em> le processus a été préempté.</p>
<p><em>Idle</em> le processus attend un signal.</p>
<p><em>Zombie</em> le processus a fini de s’exécuter, le code de retour attend sa lecture.</p>
<p>Voir : <a class="reference external" href="http://en.wikipedia.org/wiki/Process_states">http://en.wikipedia.org/wiki/Process_states</a></p>
</section>
<section id="les-differentes-sortes-de-processus">
<h3><a class="toc-backref" href="#id141"><span class="sectnum">1.9.4</span> Les différentes sortes de processus</a><a class="headerlink" href="#les-differentes-sortes-de-processus" title="Lien permanent vers ce titre">¶</a></h3>
<p>On distingue les processus classiques des démons qui sont les services unix.</p>
<p>Les démons ou démons fonctionnent en arrière-plan ils ont en général pour père le processus 1.</p>
<p>Les démons sont lancés et arrêtés à partir des scripts contenus dans <strong>/,etc/init.d</strong>.</p>
</section>
<section id="envoi-de-signaux-aux-processus">
<h3><a class="toc-backref" href="#id142"><span class="sectnum">1.9.5</span> Envoi de signaux aux processus</a><a class="headerlink" href="#envoi-de-signaux-aux-processus" title="Lien permanent vers ce titre">¶</a></h3>
<p>L’envoi de signaux au processus se fait par la commande <strong>kill</strong> ou <strong>pkill</strong>.</p>
<p>Les processus peuvent établir entre eux une communication événementielle basée sur les signaux.</p>
<p>Seuls les signaux <strong>9</strong> <strong>SIGKILL</strong>, et <strong>SIGSTOP</strong> ne peuvent être attrapés.</p>
</section>
<section id="les-commandes-liees-a-la-gestion-des-processus">
<h3><a class="toc-backref" href="#id143"><span class="sectnum">1.9.6</span> Les commandes liées à la gestion des processus</a><a class="headerlink" href="#les-commandes-liees-a-la-gestion-des-processus" title="Lien permanent vers ce titre">¶</a></h3>
<p>La commande <strong>free</strong> affiche les ressources mémoires consommées.</p>
<p>La commande <strong>fuser</strong> liste les processus accédant à un fichier.</p>
<p>La commande <strong>ldd</strong> affiche la liste des bibliothèques utilisées par un exécutable.</p>
<p>La commande <strong>lsof</strong> affiche les fichiers ouverts par un processus <strong>lsof -p PID</strong>.</p>
<p>La commande <strong>nice</strong> et <strong>renice</strong> permette de modifier la priorité d’exécution.</p>
<p>La commande <strong>pgrep</strong> recherche un processus par son nom.</p>
<p>La commande <strong>ps</strong> affiche les processus en cours.</p>
<p>La commande <strong>pstree</strong> affiche l’arborescence des processus.</p>
<p>La commande <strong>top</strong> affiche la liste de processus classés par consommation décroissante.</p>
<p>La commande <strong>uptime</strong> affiche les informations de temps de fonctionnement, du nombre d’utilisateurs connectés, de la charge.</p>
</section>
<section id="arriere-plan-avant-plan-detachement">
<h3><a class="toc-backref" href="#id144"><span class="sectnum">1.9.7</span> Arrière-plan / Avant-plan / Détachement</a><a class="headerlink" href="#arriere-plan-avant-plan-detachement" title="Lien permanent vers ce titre">¶</a></h3>
<p>Pour lancer un processus en arrière-plan, on peut soit terminer la ligne de commande qui le lance avec <strong>&amp;</strong>, soit le lancer, faire <strong>Ctrl+z</strong> puis <strong>bg</strong>.</p>
<p>Lors du <strong>Ctrl+z</strong> la commande <strong>fg</strong> ramène le processus au premier plan.</p>
<p>La commande <strong>jobs</strong> permet de lister les processus suspendus, on peut alors les rattacher avec <strong>fg num_job</strong>.</p>
<p>Les processus dont le père meure sans attendre le statut de ses enfants sont raccrochés à <em>init</em>.</p>
</section>
<section id="modification-des-priorites">
<h3><a class="toc-backref" href="#id145"><span class="sectnum">1.9.8</span> Modification des priorités</a><a class="headerlink" href="#modification-des-priorites" title="Lien permanent vers ce titre">¶</a></h3>
<p>Les processus ont des priorités fixées entre -20 (la plus haute) et +19.</p>
<p>Le <em>scheduler</em> gère l’ordre d’exécution des processus en fonction de cette priorité.</p>
<p>Par défaut un processus est lancé avec la priorité +10.</p>
<p>Seul l’administrateur peut donner des priorités négatives aux processus.</p>
<p>La commande <strong>nice [COMMAND [ARG]]</strong> permet de lancer une commande en lui donnant la priorité <em>p</em> si l’on passe l’option <em>-n p</em>.</p>
<p>La commande <strong>renice</strong>  permet de modifier la priorité d’un processus.</p>
</section>
</section>
<section id="planification-de-taches">
<h2><a class="toc-backref" href="#id146"><span class="sectnum">1.10</span> Planification de tâches</a><a class="headerlink" href="#planification-de-taches" title="Lien permanent vers ce titre">¶</a></h2>
<p>Sous unix deux démons sont chargés de la planification des tâches : <strong>atd</strong> qui permet de programmer une tâche différée et <strong>crond</strong> qui permet de programmer les tâches répétitives.</p>
<section id="la-commande-crontab">
<h3><a class="toc-backref" href="#id147"><span class="sectnum">1.10.1</span> La commande crontab</a><a class="headerlink" href="#la-commande-crontab" title="Lien permanent vers ce titre">¶</a></h3>
<p><strong>crond</strong> est un service qui peut être programmé grâce à la commande <strong>crontab</strong>.</p>
<p><strong>crontab -l</strong> liste les commandes déjà programmées pour l’utilisateur courant.</p>
<p><strong>crontab -e</strong> permet d’éditer le fichier des commandes programmées pour l’utilisateur courant.</p>
<p>L’éditeur utilisé par <strong>crontab -e</strong> est celui désigné par la variable <em>EDITOR</em>.</p>
</section>
<section id="le-fichier-crontab-systeme">
<h3><a class="toc-backref" href="#id148"><span class="sectnum">1.10.2</span> Le fichier crontab système</a><a class="headerlink" href="#le-fichier-crontab-systeme" title="Lien permanent vers ce titre">¶</a></h3>
<p>Il est possible d’éditer directement le fichier /,etc/crontab ou ceux contenus dans /var/spool/cron/crontabs/${USER}</p>
<p>Le format du fichier est le même que lors de l’édition avec <em>crontab -e</em>:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 15%" />
<col style="width: 11%" />
<col style="width: 19%" />
<col style="width: 11%" />
<col style="width: 28%" />
<col style="width: 15%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Minutes</p></td>
<td><p>Heures</p></td>
<td><p>Jour du mois</p></td>
<td><p>Mois</p></td>
<td><p>Jour de la semaine</p></td>
<td><p>Commande</p></td>
</tr>
<tr class="row-even"><td><p>(0-60)</p></td>
<td><p>(0-24)</p></td>
<td><p>(0-31)</p></td>
<td><p>(1-12)</p></td>
<td><p>(0-6)</p></td>
<td><p>un script</p></td>
</tr>
</tbody>
</table>
<p>Le joker <strong>*</strong> permet d’indiquer que toutes les valeurs sont acceptées.</p>
<p>Pour les fichiers <em>cron</em> du système, une colonne <em>Utilisateur</em> s’intercale juste avant celle de la <em>commande</em>. Elle permet alors d’indiquer sous quel utilisateur doit être lancée la commande.</p>
<p>Exemple :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">root</span><span class="nd">@serveur</span><span class="p">:</span><span class="o">~</span><span class="c1"># crontab -l</span>
<span class="c1"># m h  dom mon dow   command</span>
<span class="mi">00</span> <span class="mi">4</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">webalizer</span> <span class="o">-</span><span class="n">c</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">webalizer</span><span class="o">/</span><span class="n">www_ecreall</span><span class="o">.</span><span class="n">conf</span>
<span class="mi">10</span> <span class="mi">4</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">webalizer</span> <span class="o">-</span><span class="n">c</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">webalizer</span><span class="o">/</span><span class="n">ssl_ecreall</span><span class="o">.</span><span class="n">conf</span>
<span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">load</span><span class="o">.</span><span class="n">sh</span> <span class="n">update</span>
<span class="mi">0</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">load</span><span class="o">.</span><span class="n">sh</span> <span class="n">graph</span> <span class="o">&gt;</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">null</span>

<span class="n">root</span><span class="nd">@serveur</span><span class="p">:</span><span class="o">~</span><span class="c1"># cat /etc/crontab</span>
<span class="c1"># /etc/crontab: system-wide crontab</span>
<span class="c1"># Unlike any other crontab you don&#39;t have to run the `crontab&#39;</span>
<span class="c1"># command to install the new version when you edit this file</span>
<span class="c1"># and files in /etc/cron.d. These files also have username fields,</span>
<span class="c1"># that none of the other crontabs do.</span>

<span class="n">SHELL</span><span class="o">=/</span><span class="nb">bin</span><span class="o">/</span><span class="n">sh</span>
<span class="n">PATH</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">sbin</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="nb">bin</span><span class="p">:</span><span class="o">/</span><span class="n">sbin</span><span class="p">:</span><span class="o">/</span><span class="nb">bin</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span>

<span class="c1"># m h dom mon dow user        command</span>
<span class="mi">17</span> <span class="o">*</span>  <span class="o">*</span> <span class="o">*</span> <span class="o">*</span>   <span class="n">root</span>    <span class="n">cd</span> <span class="o">/</span> <span class="o">&amp;&amp;</span> <span class="n">run</span><span class="o">-</span><span class="n">parts</span> <span class="o">--</span><span class="n">report</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">cron</span><span class="o">.</span><span class="n">hourly</span>
<span class="mi">25</span> <span class="mi">6</span>  <span class="o">*</span> <span class="o">*</span> <span class="o">*</span>   <span class="n">root</span>    <span class="n">test</span> <span class="o">-</span><span class="n">x</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">anacron</span> <span class="o">||</span> <span class="p">(</span> <span class="n">cd</span> <span class="o">/</span> <span class="o">&amp;&amp;</span> <span class="n">run</span><span class="o">-</span><span class="n">parts</span> <span class="o">--</span><span class="n">report</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">cron</span><span class="o">.</span><span class="n">daily</span> <span class="p">)</span>
<span class="mi">47</span> <span class="mi">6</span>  <span class="o">*</span> <span class="o">*</span> <span class="mi">7</span>   <span class="n">root</span>    <span class="n">test</span> <span class="o">-</span><span class="n">x</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">anacron</span> <span class="o">||</span> <span class="p">(</span> <span class="n">cd</span> <span class="o">/</span> <span class="o">&amp;&amp;</span> <span class="n">run</span><span class="o">-</span><span class="n">parts</span> <span class="o">--</span><span class="n">report</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">cron</span><span class="o">.</span><span class="n">weekly</span> <span class="p">)</span>
<span class="mi">52</span> <span class="mi">6</span>  <span class="mi">1</span> <span class="o">*</span> <span class="o">*</span>   <span class="n">root</span>    <span class="n">test</span> <span class="o">-</span><span class="n">x</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">anacron</span> <span class="o">||</span> <span class="p">(</span> <span class="n">cd</span> <span class="o">/</span> <span class="o">&amp;&amp;</span> <span class="n">run</span><span class="o">-</span><span class="n">parts</span> <span class="o">--</span><span class="n">report</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">cron</span><span class="o">.</span><span class="n">monthly</span> <span class="p">)</span>
<span class="c1">#</span>
</pre></div>
</div>
<p>Sur la plupart des distributions <em>/,etc/crontab</em> lance les scripts contenus dans <em>/,etc/cron.hourly</em>, <em>/,etc/cron.daily</em>, <em>/,etc/cron.weekly</em>, <em>/,etc/cron.monthly</em>. Pour ajouter une tâche, il suffit d’ajouter un script au répertoire désiré.</p>
<p>Les fichiers <em>/,etc/cron.allow</em> et <em>/,etc/cron.deny</em> permettent s’ils existent de nommer les utilisateurs pouvant programmer des tâches.</p>
</section>
<section id="la-commande-at">
<h3><a class="toc-backref" href="#id149"><span class="sectnum">1.10.3</span> La commande at</a><a class="headerlink" href="#la-commande-at" title="Lien permanent vers ce titre">¶</a></h3>
<p><strong>at</strong> permet de lancer une commande à une heure donnée, la commande utilise le démon <strong>atd</strong></p>
<p><strong>atq</strong> permet de voir la liste des commandes en attente d’exécution.</p>
<p><strong>atrm</strong> Permet de supprimer une commande programmée.</p>
<p>Exemple :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">root</span><span class="nd">@server</span><span class="p">:</span><span class="o">~</span><span class="c1"># apt install mailutils # Pour avoir la commande mail</span>
<span class="n">root</span><span class="nd">@server</span><span class="p">:</span><span class="o">~</span><span class="c1"># at 6:45; mail -s &quot;Debout&quot; michaellaunay@ecreall.com &lt; reveil.msg</span>
</pre></div>
</div>
<p>Les fichiers <em>/,etc/at.allow</em> et <em>at.deny</em> permettent comme pour cron de lister les utilisateurs pouvant ou non lancer <strong>at</strong>.</p>
</section>
</section>
<section id="les-utilisateurs-et-les-groupes">
<h2><a class="toc-backref" href="#id150"><span class="sectnum">1.11</span> Les utilisateurs et les groupes</a><a class="headerlink" href="#les-utilisateurs-et-les-groupes" title="Lien permanent vers ce titre">¶</a></h2>
<p>Unix est un système multi-utilisateurs.</p>
<p>Tout fichier est associé à un propriétaire et à un groupe.</p>
<p>La gestion des droits dépend des notions d’utilisateur, de propriétaire, de groupe, et des autres.</p>
<p>Ceci suppose :</p>
<blockquote>
<div><ul class="simple">
<li><p>l’existence d’une base des comptes utilisateurs,</p></li>
<li><p>l’existence d’une base des groupes d’utilisateurs,</p></li>
<li><p>que tout fichier possède un utilisateur propriétaire et un groupe propriétaire,</p></li>
<li><p>que tout processus hérite des droits de l’utilisateur l’ayant lancé et par conséquent de l’ensemble des droits des groupes de l’utilisateur,</p></li>
<li><p>que l’utilisateur <em>root</em> a tous les droits pour pouvoir gérer le système.</p></li>
</ul>
</div></blockquote>
<section id="qu-est-qu-un-utilisateur">
<h3><a class="toc-backref" href="#id151"><span class="sectnum">1.11.1</span> Qu’est qu’un utilisateur ?</a><a class="headerlink" href="#qu-est-qu-un-utilisateur" title="Lien permanent vers ce titre">¶</a></h3>
<p>Chaque utilisateur d’un système Unix est associé à un identifiant unique qui lui permet de s’authentifier et d’accéder à son compte.</p>
<p>Ainsi au <em>login</em> le système demande à l’utilisateur son mot de passe.</p>
<p>Lorsque la connexion réussit, le système associe à l’utilisateur l”<strong>UID</strong> (<strong>User IDentification</strong>) correspondant à son identifiant.</p>
<p>Le système associe également à l’utilisateur un <strong>GID</strong> (<strong>Groupe IDentification</strong>) qui est le groupe principal de l’utilisateur.</p>
<p>Ces numéros seront utilisés pour gérer les permissions des fichiers. Les commandes comme <em>ls</em> feront alors la correspondance entre les numéros et les noms d’utilisateurs et de groupes.</p>
<p>Un <strong>UID</strong> est associé à un répertoire personnel et à un shell.</p>
<p>L’UID 0 désigne l’utilisateur <strong>root</strong></p>
<p>Un utilisateur peut ne pas être une personne physique, mais être l’utilisateur d’exécution d’un démon.</p>
<p>En conséquence, les <strong>UID</strong> des personnes physiques commencent généralement à partir de 1000.</p>
</section>
<section id="qu-est-qu-un-groupe">
<h3><a class="toc-backref" href="#id152"><span class="sectnum">1.11.2</span> Qu’est qu’un groupe ?</a><a class="headerlink" href="#qu-est-qu-un-groupe" title="Lien permanent vers ce titre">¶</a></h3>
<p>Les groupes permettent de créer des ensembles d’utilisateurs afin de gérer collectivement les permissions.</p>
<p>Généralement la création d’un utilisateur engendre la création de son groupe principal ayant pour identifiant de groupe le même identifiant et pour <strong>GID</strong> la même valeur que l”<strong>UID</strong>.</p>
</section>
<section id="gestion-des-comptes">
<h3><a class="toc-backref" href="#id153"><span class="sectnum">1.11.3</span> Gestion des comptes</a><a class="headerlink" href="#gestion-des-comptes" title="Lien permanent vers ce titre">¶</a></h3>
<section id="ajouter-un-utilisateur">
<h4><a class="toc-backref" href="#id154"><span class="sectnum">1.11.3.1</span> Ajouter un utilisateur</a><a class="headerlink" href="#ajouter-un-utilisateur" title="Lien permanent vers ce titre">¶</a></h4>
<p>La création d’un nouvel utilisateur peut être faite à l’aide des commandes <strong>useradd</strong> ou <strong>adduser</strong> la seconde étant préférable, car interactive.</p>
</section>
<section id="supprimer-un-utilisateur">
<h4><a class="toc-backref" href="#id155"><span class="sectnum">1.11.3.2</span> Supprimer un utilisateur</a><a class="headerlink" href="#supprimer-un-utilisateur" title="Lien permanent vers ce titre">¶</a></h4>
<p>La commande <strong>userdel</strong> permet de supprimer un utilisateur.</p>
<p>Avec l’option <em>-r</em> cette commande supprimera en plus le répertoire personnel de l’utilisateur.</p>
</section>
<section id="desactiver-un-compte-utilisateur">
<h4><a class="toc-backref" href="#id156"><span class="sectnum">1.11.3.3</span> Désactiver un compte utilisateur</a><a class="headerlink" href="#desactiver-un-compte-utilisateur" title="Lien permanent vers ce titre">¶</a></h4>
<p>L’une des façons les plus propres d’interdire la connexion à un utilisateur est de lui associer le shell <strong>nologin</strong> :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">root</span><span class="nd">@server</span><span class="p">:</span><span class="o">~</span><span class="c1"># usermod -s /usr/sbin/nologin indesirable</span>
</pre></div>
</div>
</section>
<section id="changer-le-mot-de-passe-d-un-utilisateur">
<h4><a class="toc-backref" href="#id157"><span class="sectnum">1.11.3.4</span> Changer le mot de passe d’un utilisateur</a><a class="headerlink" href="#changer-le-mot-de-passe-d-un-utilisateur" title="Lien permanent vers ce titre">¶</a></h4>
<p>La commande <strong>passwd</strong> permet sous <em>root</em> de changer le mot de passe d’un utilisateur.</p>
<p>Si l’on est un utilisateur, la commande demandera de saisir l’ancien mot de passe.</p>
<p>La commande <strong>chpasswd</strong> permet de scripter les changements de mots de passe.</p>
</section>
<section id="afficher-des-informations-d-un-utilisateur">
<h4><a class="toc-backref" href="#id158"><span class="sectnum">1.11.3.5</span> Afficher des informations d’un utilisateur</a><a class="headerlink" href="#afficher-des-informations-d-un-utilisateur" title="Lien permanent vers ce titre">¶</a></h4>
<p>La commande <strong>id</strong> permet d’afficher les informations de l’utilisateur :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>michaellaunay@serveur:~$ id
uid=1000(michaellaunay) gid=1000(michaellaunay) groupes=4(adm),20(dialout),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),107(fuse),111(lpadmin),112(admin),1000(michaellaunay)
</pre></div>
</div>
<p>La commande <strong>groups</strong> permet d’afficher les informations de groupe :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>michaellaunay@luciole:~/Documents/ecreall/Cours/CoursGNULinux$ groups
michaellaunay adm dialout cdrom plugdev lpadmin admin sambashare
</pre></div>
</div>
<p>La commande <strong>who</strong> permet de savoir qui est connecté sur la machine.</p>
<p>La commande <strong>whoami</strong> permet de savoir sous quelle identité on est connecté.</p>
</section>
<section id="modifier-les-informations-d-un-utilisateur">
<h4><a class="toc-backref" href="#id159"><span class="sectnum">1.11.3.6</span> Modifier les informations d’un utilisateur</a><a class="headerlink" href="#modifier-les-informations-d-un-utilisateur" title="Lien permanent vers ce titre">¶</a></h4>
<p>La commande <strong>usermod</strong> permet de modifier toutes les propriétés d’un utilisateur.</p>
<p>Faire <em>man usermod</em></p>
<p>La commande <strong>chsh</strong> permet de changer le shell de connexion.</p>
<p>La commande <strong>chfn</strong> permet de changer la description d’un utilisateur.</p>
</section>
<section id="changer-d-identite">
<h4><a class="toc-backref" href="#id160"><span class="sectnum">1.11.3.7</span> Changer d’identité</a><a class="headerlink" href="#changer-d-identite" title="Lien permanent vers ce titre">¶</a></h4>
<p>La commande <strong>su</strong> permet de changer d’identité. <strong>su -</strong> permettra en plus d’utiliser l’environnement de l’utilisateur.</p>
<p>La commande <strong>sudo</strong> permet d’exécuter un script ou une commande en tant que <em>root</em>. <strong>sudo -i</strong> permet sous <em>Ubuntu</em> de se connecter en tant que <em>root</em>.</p>
</section>
</section>
<section id="gestion-des-groupes">
<h3><a class="toc-backref" href="#id161"><span class="sectnum">1.11.4</span> Gestion des groupes</a><a class="headerlink" href="#gestion-des-groupes" title="Lien permanent vers ce titre">¶</a></h3>
<section id="creer-un-groupe">
<h4><a class="toc-backref" href="#id162"><span class="sectnum">1.11.4.1</span> Créer un groupe</a><a class="headerlink" href="#creer-un-groupe" title="Lien permanent vers ce titre">¶</a></h4>
<p>Comme pour l’utilisateur nous pouvons utiliser <strong>addgroup</strong> ou <strong>groupadd</strong></p>
</section>
<section id="afficher-des-informations-sur-les-groupes">
<h4><a class="toc-backref" href="#id163"><span class="sectnum">1.11.4.2</span> Afficher des informations sur les groupes</a><a class="headerlink" href="#afficher-des-informations-sur-les-groupes" title="Lien permanent vers ce titre">¶</a></h4>
<p>La commande <strong>groups</strong> déjà vu affiche les informations d’appartenance.</p>
</section>
<section id="ajouter-un-utilisateur-a-un-groupe">
<h4><a class="toc-backref" href="#id164"><span class="sectnum">1.11.4.3</span> Ajouter un utilisateur à un groupe</a><a class="headerlink" href="#ajouter-un-utilisateur-a-un-groupe" title="Lien permanent vers ce titre">¶</a></h4>
<p>On utilise la commande <strong>usermod</strong> de la façon suivante :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">root</span><span class="nd">@server</span><span class="o">~</span><span class="c1"># usermod -a -G cdrom,dev michaellaunay</span>
</pre></div>
</div>
</section>
<section id="ajouter-un-utilisateur-au-groupe-des-administrateurs">
<h4><a class="toc-backref" href="#id165"><span class="sectnum">1.11.4.4</span> Ajouter un utilisateur au groupe des administrateurs</a><a class="headerlink" href="#ajouter-un-utilisateur-au-groupe-des-administrateurs" title="Lien permanent vers ce titre">¶</a></h4>
<p>usermod -a -G sudo identifiant_de_l_utilisateur</p>
</section>
<section id="changer-de-groupe-principal">
<h4><a class="toc-backref" href="#id166"><span class="sectnum">1.11.4.5</span> Changer de groupe principal</a><a class="headerlink" href="#changer-de-groupe-principal" title="Lien permanent vers ce titre">¶</a></h4>
<p>La commande <strong>newgrp</strong> permet de changer de groupe principal.</p>
</section>
<section id="modifier-un-groupe">
<h4><a class="toc-backref" href="#id167"><span class="sectnum">1.11.4.6</span> Modifier un groupe</a><a class="headerlink" href="#modifier-un-groupe" title="Lien permanent vers ce titre">¶</a></h4>
<p>Pour modifier un groupe nous pouvons utiliser la commande <strong>groupmod</strong>.</p>
</section>
<section id="supprimer-un-groupe">
<h4><a class="toc-backref" href="#id168"><span class="sectnum">1.11.4.7</span> Supprimer un groupe</a><a class="headerlink" href="#supprimer-un-groupe" title="Lien permanent vers ce titre">¶</a></h4>
<p>La commande <strong>groupdel</strong> permet de supprimer un groupe.</p>
</section>
</section>
<section id="le-fichier-etc-passwd">
<h3><a class="toc-backref" href="#id169"><span class="sectnum">1.11.5</span> Le fichier /,etc/passwd</a><a class="headerlink" href="#le-fichier-etc-passwd" title="Lien permanent vers ce titre">¶</a></h3>
<p>Le fichier <em>/,etc/passwd</em> contient la définition de tous les comptes.</p>
</section>
<section id="le-fichier-etc-shadow">
<h3><a class="toc-backref" href="#id170"><span class="sectnum">1.11.6</span> Le fichier /,etc/shadow</a><a class="headerlink" href="#le-fichier-etc-shadow" title="Lien permanent vers ce titre">¶</a></h3>
<p>Le fichier <em>/,etc/shadow</em> contient les mots de passe des comptes définis dans <em>/,etc/passwd</em></p>
</section>
<section id="le-fichier-etc-group">
<h3><a class="toc-backref" href="#id171"><span class="sectnum">1.11.7</span> Le fichier /,etc/group</a><a class="headerlink" href="#le-fichier-etc-group" title="Lien permanent vers ce titre">¶</a></h3>
<p>Le fichier <em>/,etc/group</em> contient la définition de tous les groupes.</p>
</section>
<section id="installation-openldap">
<h3><a class="toc-backref" href="#id172"><span class="sectnum">1.11.8</span> Installation openldap</a><a class="headerlink" href="#installation-openldap" title="Lien permanent vers ce titre">¶</a></h3>
<p>Ldap est un annuaire qui permet de gérer l’utilisateur d’un service sans créer un compte unix.</p>
<p>Installation du serveur ldap :</p>
<blockquote>
<div><p>apt install slapd ldap-utils</p>
</div></blockquote>
<p>Modification de la configuration :</p>
<blockquote>
<div><p>dpkg-reconfigure slapd
# saisie de « ecreall.com » comme domaine
# saisie de « people » comme organization
# saisie du mot de passe (comme celui de l’utilisateur michaellaunay, mais pour LDAP)</p>
</div></blockquote>
<p>Attention ! Configurer LTS pour chiffrer les connexions si elles sont extérieures à la machine, car les mots de passe circulent en clair (voir  <a class="reference external" href="https://wiki.debian.org/LDAP/OpenLDAPSetup#Enable_TLS.2FSSL">https://wiki.debian.org/LDAP/OpenLDAPSetup#Enable_TLS.2FSSL</a>)!</p>
<p>Activer le service au démarrage :</p>
<blockquote>
<div><p>systemctl enable slapd</p>
</div></blockquote>
<p>Rendre « ldap » accessible en éditant « /etc/ldap/ldap.conf » en ajoutant :</p>
<blockquote>
<div><p>BASE    dc=ecreall,dc=com
URI     <a class="reference external" href="ldap://127.0.0.1">ldap://127.0.0.1</a></p>
</div></blockquote>
<p>Ajout d’une entrée LDAP :</p>
<blockquote>
<div><p>Créer un fichier ecreall.ldif contenant :</p>
<blockquote>
<div><p>dn: ou=People,dc=ecreall,dc=com
ou: People
objectClass: top
objectClass: organizationalUnit</p>
<p>dn: ou=Group,dc=ecreall,dc=com
ou: Group
objectClass: top
objectClass: organizationalUnit</p>
<p>dn: cn=Gérant,dc=ecreall,dc=com
objectclass: organizationalRole
cn: Gérant</p>
</div></blockquote>
<p>ldapadd -x -D « cn=admin,dc=ecreall,dc=com » -W -f ecreall.ldif</p>
</div></blockquote>
<p>Mettre à jour l’index (cache) :</p>
<blockquote>
<div><p>systemctl stop slapd
slapindex
chown -R openldap:openldap /var/lib/ldap
systemctl start slapd</p>
</div></blockquote>
<p>Vérification :</p>
<blockquote>
<div><p>ldapsearch -x -b “dc=ecreall,dc=com” “(objectclass=*)”</p>
</div></blockquote>
<p>Ajout d’une OrganizationUnit :</p>
<blockquote>
<div><p>Créer un fichier « e-services.ldif » et y mettre :</p>
<blockquote>
<div><p>dn: ou=Études,dc=ereall,dc=com
objectClass: organizationalUnit
ou: Études</p>
</div></blockquote>
<p>ldapadd -x -D « cn=admin,dc=ecreall,dc=com » -W -f e-services.ldif</p>
</div></blockquote>
<p>Ajouter une personne :</p>
<blockquote>
<div><p>Exemple pour ajouter Michaël Launay, créer un fichier « ldif_files/michaellaunay.ldif » :</p>
<blockquote>
<div><p>dn: cn=Michaël Launay, ou=People, dc=ecreall, dc=com
objectclass: top
objectclass: person
objectclass: organizationalPerson
objectclass: inetorgperson
cn: Michaël Launay
sn: Launay
gn: Michaël
uid: michaellaunay
title: Gérant
mail: <a class="reference external" href="mailto:michaellaunay&#37;&#52;&#48;ecreall&#46;com">michaellaunay<span>&#64;</span>ecreall<span>&#46;</span>com</a>
telephoneNumber: 0320793290
officePostalAddress: 11 A Avenue de l’Harmonie
postalCode: 59650
l: Villeneuve d ASCQ</p>
</div></blockquote>
<p>L’ajouter :</p>
<blockquote>
<div><p>ldapadd -x -D « cn=admin,dc=ecreall,dc=com » -W -f ldif_files/michaellaunay.ldif</p>
</div></blockquote>
</div></blockquote>
<p>Voir :</p>
<blockquote>
<div><p><a class="reference external" href="https://wiki.debian.org/LDAP/OpenLDAPSetup">https://wiki.debian.org/LDAP/OpenLDAPSetup</a>
<a class="reference external" href="https://guide.ubuntu-fr.org/server/openldap-server.html">https://guide.ubuntu-fr.org/server/openldap-server.html</a>
<a class="reference external" href="http://www-sop.inria.fr/members/Laurent.Mirtain/ldap-livre.html">http://www-sop.inria.fr/members/Laurent.Mirtain/ldap-livre.html</a></p>
</div></blockquote>
</section>
</section>
<section id="syslog">
<h2><a class="toc-backref" href="#id173"><span class="sectnum">1.12</span> Syslog</a><a class="headerlink" href="#syslog" title="Lien permanent vers ce titre">¶</a></h2>
<p><strong>Syslog</strong> est le système chargé d’enregistrer les fichiers journaux.</p>
<p>Le démon <strong>klogd</strong> consigne les événements de type message du noyau, authentification, connexion alors que <strong>syslogd</strong> enregistre les messages d’envoi ou réception de courrier, ceux d’erreur, etc.</p>
<p>Les fichiers de messages se trouvent dans <em>/var/log</em></p>
<p><strong>syslogd</strong> est configuré avec le fichier <em>/,etc/syslog.conf</em>. Ce fichier permet d’indiquer les sources de messages et les destinations associées (fichier, tty, application ou syslog d’une autre machine). Pour être prise en compte, la modification du fichier de conf doit être suivie par un <em>kill 1 $PID_SYSLOG</em>.</p>
<p>Toutefois de nombreux programmes n’utilisent pas <em>syslog</em> comme <em>CUPS</em>, <em>Samba</em>, etc.</p>
<p>Afin d’éviter que la taille des fichiers de logs n’explose la capacité du disque les fichiers sont compressés de façon régulière par <strong>logrotate</strong> dont la configuration est modifiable en éditant <strong>/,etc/logrotate</strong></p>
<p>La commande <strong>dmesg</strong> permet d’afficher les messages du noyau.</p>
<section id="modification-de-la-configuration-de-logrotate">
<h3><a class="toc-backref" href="#id174"><span class="sectnum">1.12.1</span> Modification de la configuration de logrotate</a><a class="headerlink" href="#modification-de-la-configuration-de-logrotate" title="Lien permanent vers ce titre">¶</a></h3>
<p>Logrotate possède une configuration par défaut contenue dans « /etc/logrotate.conf » puis un répertoire avec les configurations des services pour compléter ou remplacer la configuration par défaut.</p>
<p>Il est fréquent que pour des raisons légales, on doive garder un ou deux ans de logs selon la nature des utilisateurs et des services.
Souvent on garde 104 semaines de connexions et 52 semaines de navigation et 14 semaines pour les autres services.</p>
<p>Pour modifier la conf par défaut à 14 semaines on édite « /etc/logrotate.conf » :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span> <span class="n">Remplacer</span> <span class="s2">&quot;rotate 4&quot;</span> <span class="n">par</span> <span class="s2">&quot;rotate 14&quot;</span> <span class="n">pour</span> <span class="n">garder</span> <span class="mi">3</span> <span class="n">mois</span> <span class="n">de</span> <span class="n">log</span> <span class="n">par</span> <span class="n">défaut</span>
<span class="o">-</span> <span class="n">Décommenter</span> <span class="s2">&quot;compress&quot;</span> <span class="n">pour</span> <span class="n">compresser</span> <span class="n">les</span> <span class="n">anciens</span> <span class="n">fichiers</span> <span class="n">log</span>
<span class="o">-</span> <span class="n">Ajouter</span> <span class="n">delaycompress</span> <span class="n">chaque</span> <span class="n">vieux</span> <span class="n">fichier</span> <span class="n">de</span> <span class="n">log</span>
<span class="o">-</span> <span class="n">Limiter</span> <span class="n">la</span> <span class="n">taille</span> <span class="n">d</span><span class="s1">&#39;un fichier de log à 100M</span>
</pre></div>
</div>
<p>On doit donc avoir dans /,etc/logrotate.conf :</p>
<blockquote>
<div><p>rotate 14
compress
delaycompress
size 100M</p>
</div></blockquote>
<p>Puis on change « rotate X » à « rotate 104 » dans les fichiers des services concernés se trouvant dans le répertoire « /etc/logrotate.d/ ».
Par exemple, on va modifier « /,etc/logrotate.d/apache2 » pour mettre rotate à 104, et modifier le fichier « /etc/logrotate.d/rsyslog » modifier les logs des services d’authentifications.</p>
</section>
</section>
<section id="peripherique-disque-et-systeme-de-fichiers">
<h2><a class="toc-backref" href="#id175"><span class="sectnum">1.13</span> Périphérique disque et système de fichiers</a><a class="headerlink" href="#peripherique-disque-et-systeme-de-fichiers" title="Lien permanent vers ce titre">¶</a></h2>
<section id="les-disques-durs-sous-linux">
<h3><a class="toc-backref" href="#id176"><span class="sectnum">1.13.1</span> Les disques durs sous Linux</a><a class="headerlink" href="#les-disques-durs-sous-linux" title="Lien permanent vers ce titre">¶</a></h3>
<p>L’organisation physique d’un disque est constituée de plateaux superposés divisés en pistes concentriques.</p>
<p>Chaque piste contenant un certain nombre de secteurs de 512 octets.</p>
<p>L’ensemble des pistes des différents plateaux accessibles sans nouveau déplacement des têtes de lecture constitue un cylindre.</p>
<p>Voire <a class="reference external" href="http://fr.wikipedia.org/wiki/Disque_dur">http://fr.wikipedia.org/wiki/Disque_dur</a>.</p>
<p>Le nommage des périphériques disques dépend de leur nature et de la façon dont ils sont gérés par le bios.</p>
<p>Ainsi sda, sdb correspondent à des disques durs alors que nvme0n1p7 correspond à un disque ssd monté sur le connecteur nvme.</p>
<p>Depuis 2013 les nommages des périphériques suivent les règles <em>ifname</em> voir :  <a class="reference external" href="https://access.redhat.com/documentation/fr-fr/red_hat_enterprise_linux/7/html/networking_guide/sec-understanding_the_device_renaming_procedure">https://access.redhat.com/documentation/fr-fr/red_hat_enterprise_linux/7/html/networking_guide/sec-understanding_the_device_renaming_procedure</a></p>
</section>
<section id="les-concepts">
<h3><a class="toc-backref" href="#id177"><span class="sectnum">1.13.2</span> Les concepts</a><a class="headerlink" href="#les-concepts" title="Lien permanent vers ce titre">¶</a></h3>
<p>Un disque est « découpé » en partitions.</p>
<p>Le premier secteur contient le MBR (Master Boot Record) qui décrit la table des 4 premières partitions et contient également le code du chargeur primaire (primary loader).</p>
<p>L’une des quatre partitions primaires peut être du type étendu et contenir des partitions logiques qui sont alors chaînées entre elles.</p>
<p>La taille des partitions est donnée en nombre de cylindres, ce qui fixe le nombre de secteurs de la partition.</p>
<p>La partition possède un type qui fixe son usage, par exemple 83 pour Linux, 82 pour le swap, 5 pour une partition étendue, etc.</p>
</section>
<section id="les-systemes-de-fichiers">
<h3><a class="toc-backref" href="#id178"><span class="sectnum">1.13.3</span> Les systèmes de fichiers</a><a class="headerlink" href="#les-systemes-de-fichiers" title="Lien permanent vers ce titre">¶</a></h3>
<p>Un système de fichier est une structure de données permettant de stocker et organiser les informations dans des fichiers.</p>
<p>Le système de fichier est généralement stocké dans une partition, mais il peut l’être sur un disque amovible (USB) ou dans un fichier.</p>
</section>
<section id="partitions">
<h3><a class="toc-backref" href="#id179"><span class="sectnum">1.13.4</span> Partitions</a><a class="headerlink" href="#partitions" title="Lien permanent vers ce titre">¶</a></h3>
<p>La numérotation des partitions est réalisée en accolant au nom du périphérique le numéro de la partition. Ainsi :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sda</span> <span class="n">est</span> <span class="n">le</span> <span class="n">premier</span> <span class="n">disque</span> <span class="n">complet</span>
<span class="n">sda1</span> <span class="n">est</span> <span class="n">la</span> <span class="n">première</span> <span class="n">partition</span>
<span class="n">sda4</span> <span class="n">est</span> <span class="n">généralement</span> <span class="n">la</span> <span class="n">partition</span> <span class="n">étendue</span>
<span class="n">sda5</span> <span class="n">est</span> <span class="n">la</span> <span class="n">première</span> <span class="n">partition</span> <span class="n">logique</span>
<span class="n">sdb</span> <span class="n">est</span> <span class="n">le</span> <span class="n">second</span> <span class="n">disque</span>
</pre></div>
</div>
</section>
<section id="utilitaires-de-partitionnement">
<h3><a class="toc-backref" href="#id180"><span class="sectnum">1.13.5</span> Utilitaires de partitionnement</a><a class="headerlink" href="#utilitaires-de-partitionnement" title="Lien permanent vers ce titre">¶</a></h3>
<p>Historiquement la commande permettant de créer les partitions était <strong>fdisk</strong>, mais elle est limitée à des partitions de taille inférieure à 2To.</p>
<p>Elle est remplacée par la commande <strong>parted</strong> et par sa version graphique <strong>gparted</strong> qui permet de créer et retailler des partitions déjà existantes, mais il faut descendre le paquet.</p>
<p>La commande <strong>partprobe</strong> permet d’avertir le système que l’on a modifié la table des partitions.</p>
</section>
<section id="arborescence-standard-et-organisation-du-fhs">
<h3><a class="toc-backref" href="#id181"><span class="sectnum">1.13.6</span> Arborescence standard et organisation du FHS</a><a class="headerlink" href="#arborescence-standard-et-organisation-du-fhs" title="Lien permanent vers ce titre">¶</a></h3>
<p>Le Filesystem Hierachy Standard est l’organisation standard Unix utilisée par Linux</p>
<p>Tout est fichier. Les périphériques (scanner, imprimante, etc) sont manipulés sous forme de fichier dans lequel on va lire et écrire.</p>
<section id="arborescence-de">
<h4><a class="toc-backref" href="#id182"><span class="sectnum">1.13.6.1</span> Arborescence de /</a><a class="headerlink" href="#arborescence-de" title="Lien permanent vers ce titre">¶</a></h4>
<p>/ est la racine, elle a pour contenu :</p>
<blockquote>
<div><ul class="simple">
<li><p>/bin contient les exécutables du système d’exploitation,</p></li>
<li><p>/boot les fichiers de démarrage,</p></li>
<li><p>/dev les périphériques sous forme de fichiers pouvant être lus ou écrits,</p></li>
<li><p>/,etc les fichier de configuration et ceux nécessaires au démarrage,</p></li>
<li><p>/home les répertoires des utilisateurs,</p></li>
<li><p>/lib le bibliothèques partagées et les modules du noyau dans le sous-répertoire modules,</p></li>
<li><p>/mnt les dossier des points de montage temporaires,</p></li>
<li><p>/proc les états du noyau,</p></li>
<li><p>/root le répertoire du super utilisateur root,</p></li>
<li><p>/sbin les exécutables du super utilisateur,</p></li>
<li><p>/sys contient les caractéristiques et informations sur les périphériques comme le nom du fabriquant, les bus connectés,</p></li>
<li><p>/tmp les fichiers temporaires liés à l’exécution des applications ou services, ils sont effacés au reboot,</p></li>
<li><p>/usr les ressources du système non essentielles (Unix Système Ressources)</p></li>
<li><p>/var les fichiers tels que les based de données, les pages html, les mails, les logs</p></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><p>Pour une description plus complète C.f. <a class="reference external" href="http://en.wikipedia.org/wiki/Filesystem_Hierarchy_Standard">http://en.wikipedia.org/wiki/Filesystem_Hierarchy_Standard</a></p></li>
</ul>
</section>
<section id="arborescence-de-usr">
<h4><a class="toc-backref" href="#id183"><span class="sectnum">1.13.6.2</span> Arborescence de /usr</a><a class="headerlink" href="#arborescence-de-usr" title="Lien permanent vers ce titre">¶</a></h4>
<p>/usr contient :</p>
<blockquote>
<div><ul class="simple">
<li><p>/usr/bin/ Binaires de l’utilisateur,</p></li>
<li><p>/usr/include/ Entêtes des bibliothèques partagées,</p></li>
<li><p>/usr/lib/ Bibliothèques partagées des logiciels utilisateurs,</p></li>
<li><p>/usr/local/ Hiérarchie pour les données de locales.</p></li>
<li><p>/usr/sbin/ Binaires pour l’administrateur,</p></li>
<li><p>/usr/share/ Fichiers indépendants de la plateforme (non binaires),</p></li>
<li><p>/usr/src/ Les sources du noyau,</p></li>
</ul>
</div></blockquote>
</section>
<section id="arborescence-de-var">
<h4><a class="toc-backref" href="#id184"><span class="sectnum">1.13.6.3</span> Arborescence de /var</a><a class="headerlink" href="#arborescence-de-var" title="Lien permanent vers ce titre">¶</a></h4>
<p>/var contient:</p>
<blockquote>
<div><ul class="simple">
<li><p>/var/lib/ Données persistantes telles les bases de données,</p></li>
<li><p>/var/lock Les fichiers de verrous,</p></li>
<li><p>/var/log Les fichiers de Log</p></li>
<li><p>/var/mail Les mails si la configuration précise qu’ils doivent être stockés ici</p></li>
<li><p>/var/run Les informations d’exécution des daemons</p></li>
<li><p>/var/spool Les queues de traitement (mail, impression, etc)</p></li>
<li><p>/var/tmp Les fichiers temporaires à préserver des reboots</p></li>
</ul>
</div></blockquote>
</section>
</section>
<section id="formater-une-partition">
<h3><a class="toc-backref" href="#id185"><span class="sectnum">1.13.7</span> Formater une partition</a><a class="headerlink" href="#formater-une-partition" title="Lien permanent vers ce titre">¶</a></h3>
<p>La commande <strong>mkfs</strong> permet de formater une partition. Le type système de fichier est alors choisi à ce moment ex: <strong>mkfs.ext3</strong>.</p>
</section>
<section id="monter-demonter-une-partition">
<h3><a class="toc-backref" href="#id186"><span class="sectnum">1.13.8</span> Monter / Démonter une partition</a><a class="headerlink" href="#monter-demonter-une-partition" title="Lien permanent vers ce titre">¶</a></h3>
<p>Un système de fichier est accessible après son <em>montage</em> soit au démarrage, soit à l’aide de la commande <strong>mount</strong>.</p>
<p>Le démontage se fait à l’aide de la commande <strong>umount</strong>.</p>
<p>La commande <strong>sshfs</strong> permet de monter un disque distant à travers le protocole <strong>ssh</strong>.
Pour démonter un système de fichier monté avec sshfs : <strong>fusermount -u point_de_montage</strong>.</p>
</section>
<section id="les-tables-de-montage-etc-fstab">
<h3><a class="toc-backref" href="#id187"><span class="sectnum">1.13.9</span> Les tables de montage : /etc/fstab</a><a class="headerlink" href="#les-tables-de-montage-etc-fstab" title="Lien permanent vers ce titre">¶</a></h3>
<p>Le fichier <strong>/,etc/fstab</strong> contient les montages à réaliser au démarrage ou pour lesquels <em>root</em> a autorisé un montage manuel.</p>
</section>
<section id="tables-systemes-inodes">
<h3><a class="toc-backref" href="#id188"><span class="sectnum">1.13.10</span> Tables systèmes, inodes</a><a class="headerlink" href="#tables-systemes-inodes" title="Lien permanent vers ce titre">¶</a></h3>
<p>Un file system est composé de différentes tables système :</p>
<blockquote>
<div><ul class="simple">
<li><p>Le super-bloc contenant les informations de taille, d’état de montage.</p></li>
<li><p>La table des <em>inodes</em> (nœud d’index) qui fait correspondre à chaque fichier un numéro d’identification unique et qui possède les informations des droits d’accès, de propriété.</p></li>
<li><p>Les répertoires qui sont une table de correspondance <em>inode</em> vers nom de fichier.</p></li>
</ul>
</div></blockquote>
<p>La commande <strong>ls -i</strong> permet d’afficher l’inode d’un fichier.</p>
<p>Remarques :</p>
<blockquote>
<div><ul class="simple">
<li><p>Les <em>inodes</em> ne contiennent pas le nom du fichier.</p></li>
<li><p>Un <em>file system</em> est limité en <em>inodes</em></p></li>
</ul>
</div></blockquote>
</section>
<section id="journalisation">
<h3><a class="toc-backref" href="#id189"><span class="sectnum">1.13.11</span> Journalisation</a><a class="headerlink" href="#journalisation" title="Lien permanent vers ce titre">¶</a></h3>
<p>La journalisation permet d’enregistrer les manipulations réalisées sur les fichiers et l’arborescence.</p>
<p>Pour certains systèmes de fichier, elle enregistre en plus les différences, ce qui permet de revenir à un état précédent.</p>
<p>Les systèmes simples permettent néanmoins de revenir au dernier état cohérent en cas de plantage du système.</p>
<p>Toutefois, les coupures de courant peuvent aboutir à des états incohérents, ceci à cause du cache en écriture des disques durs.</p>
<p>Au redémarrage de la machine, la journalisation va permettre d’accélérer le diagnostic des disques.</p>
<p><strong>ext3</strong> est un système journalisé de manière simple.</p>
</section>
<section id="recuperation-de-fichiers">
<h3><a class="toc-backref" href="#id190"><span class="sectnum">1.13.12</span> Récupération de fichiers</a><a class="headerlink" href="#recuperation-de-fichiers" title="Lien permanent vers ce titre">¶</a></h3>
<p>La journalisation sur les partitions de type ext3 et plus comme la ext4 permet de récupérer les fichiers supprimés.
Pour cela il faut arrêter le système, le booter sur un système externe comme une clé usb bootable (live usb).
Devenir root, installer sur le système externe extundelete :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">apt</span> <span class="n">install</span> <span class="n">extundelete</span>
</pre></div>
</div>
<p>Repérer la partition contenant les fichiers à restaurer avec la commande lsblk.
Puis appeler la commande extundelete :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">extundelete</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda6</span> <span class="o">--</span><span class="n">restore</span><span class="o">-</span><span class="n">directory</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">michaellaunay</span><span class="o">/</span><span class="n">Maildir</span><span class="o">/</span><span class="n">cur</span><span class="o">/</span> <span class="o">--</span><span class="n">after</span> <span class="mi">1636239600</span>
</pre></div>
</div>
<p>Où –restore-directory permet de dire dans quel répertoire on cherche à récupérer les fichiers.
Et –after permet de dire à partir de quelle date de suppression on souhaite récupérer les fichiers.
La date est en seconde à partir du 1er janvier 1970 (On peut utiliser datetime.</p>
</section>
<section id="controle-des-systemes-de-fichiers">
<h3><a class="toc-backref" href="#id191"><span class="sectnum">1.13.13</span> Contrôle des systèmes de fichiers</a><a class="headerlink" href="#controle-des-systemes-de-fichiers" title="Lien permanent vers ce titre">¶</a></h3>
<p>La commande <strong>df</strong> permet de lister les montages réalisés.</p>
<p>La commande <strong>du</strong> permet de calculer la taille d’une arborescence.</p>
<p>La commande <strong>fsck</strong> permet de vérifier l’état d’une partition.
ATTENTION ! Il ne faut pas l’utiliser sur des partitions montées.</p>
<p>La commande <strong>e2label</strong> permet d’affecter un nom à un <em>file system</em>.</p>
<p>La commande <strong>hdparm</strong> permet avec l’option <em>-t</em> de connaître les performances d’un disque.</p>
</section>
<section id="montage-des-peripheriques-amovibles">
<h3><a class="toc-backref" href="#id192"><span class="sectnum">1.13.14</span> Montage des périphériques amovibles</a><a class="headerlink" href="#montage-des-peripheriques-amovibles" title="Lien permanent vers ce titre">¶</a></h3>
<p>La commande <strong>lsusb</strong> permet de voir les périphériques USB connectés.</p>
<p>La commande <strong>lspci</strong> permet de voir les périphériques PCI connectés.</p>
<p>Lorsqu’un périphérique de type blocs ou caractères est détecté par le noyau, un périphérique correspondant est ajouté dans <em>/dev</em> par le démon <strong>udevd</strong> du système <strong>udev</strong>.</p>
<p>Le système <strong>udev</strong> a pour rôle de gérer l’unicité des noms pour les périphériques et de maintenir <em>/dev</em> en cohérence avec les périphériques présents.</p>
<p>Les fichiers de configuration de <strong>udev</strong> sont placés dans <em>/,etc/udev</em>. Il est possible de définir des règles dans <em>/,etc/udev/rules.d</em> qui seront évaluées dans l’ordre lexicographique.</p>
<p>Le démon HAL (Hardware Abstraction Layer) <strong>hald</strong> est notifié par <strong>udev</strong> de l’ajout d’un périphérique (règle <em>/etc/udev/rules.d/90-hal.rules</em>).</p>
<p><strong>HAL</strong> identifie alors le type des périphériques connectés, du système de fichiers, et en fonction des informations comme <em>VendorId</em> ou <em>ProductId</em> d’associer le contenu avec un type d’application.</p>
<p>La base de données des périphériques est située dans le répertoire <em>/usr/share/hal/fdi/</em> :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>michaellaunay@luciole:~$ grep -rl ipod /usr/share/hal/fdi/*
/usr/share/hal/fdi/information/10freedesktop/10-usb-music-players.fdi
</pre></div>
</div>
<p>Une fois le périphérique complètement identifié, <strong>HAL</strong> envoie un message sur le bus de communication des applications <strong>D-Bus</strong>.</p>
<p>Les applications de l’environnement graphique vont alors monter le périphérique et le rendre accessible à l’utilisateur.</p>
<p>Sous <strong>gnome</strong> le comportement peut être modifié via le gestionnaire de fichiers <strong>nautilus</strong> dans Edition-Préférences-Supports**.</p>
<p>Exemple des noms persistants donnés par udev:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>michaellaunay@luciole:~$ ls -lR /dev/disk
/dev/disk:
total 0
drwxr-xr-x 2 root root 260 avril 18 22:11 by-id
drwxr-xr-x 2 root root  80 avril 18 22:11 by-partlabel
drwxr-xr-x 2 root root 100 avril 18 22:11 by-partuuid
drwxr-xr-x 2 root root 160 avril 18 22:11 by-path
drwxr-xr-x 2 root root 100 avril 18 22:11 by-uuid

/dev/disk/by-id:
total 0
lrwxrwxrwx 1 root root  9 avril 18 22:11 ata-ST8000VN0022-2EL112_ZA1F9KQR -&gt; ../../sda
lrwxrwxrwx 1 root root 10 avril 18 22:11 ata-ST8000VN0022-2EL112_ZA1F9KQR-part1 -&gt; ../../sda1
lrwxrwxrwx 1 root root 13 avril 18 22:11 nvme-eui.0025385491b00f2f -&gt; ../../nvme0n1
lrwxrwxrwx 1 root root 15 avril 18 22:11 nvme-eui.0025385491b00f2f-part1 -&gt; ../../nvme0n1p1
lrwxrwxrwx 1 root root 15 avril 18 22:11 nvme-eui.0025385491b00f2f-part2 -&gt; ../../nvme0n1p2
lrwxrwxrwx 1 root root 13 avril 18 22:11 nvme-Samsung_SSD_970_EVO_Plus_1TB_S4EWNF0M403887L -&gt; ../../nvme0n1
lrwxrwxrwx 1 root root 15 avril 18 22:11 nvme-Samsung_SSD_970_EVO_Plus_1TB_S4EWNF0M403887L-part1 -&gt; ../../nvme0n1p1
lrwxrwxrwx 1 root root 15 avril 18 22:11 nvme-Samsung_SSD_970_EVO_Plus_1TB_S4EWNF0M403887L-part2 -&gt; ../../nvme0n1p2
lrwxrwxrwx 1 root root  9 avril 18 22:11 usb-Generic_STORAGE_DEVICE-0:0 -&gt; ../../sdb
lrwxrwxrwx 1 root root  9 avril 18 22:11 wwn-0x5000c500b5c4d662 -&gt; ../../sda
lrwxrwxrwx 1 root root 10 avril 18 22:11 wwn-0x5000c500b5c4d662-part1 -&gt; ../../sda1

/dev/disk/by-partlabel:
total 0
lrwxrwxrwx 1 root root 15 avril 18 22:11 &#39;EFI\x20System\x20Partition&#39; -&gt; ../../nvme0n1p1
lrwxrwxrwx 1 root root 10 avril 18 22:11  Sauvegardes -&gt; ../../sda1

/dev/disk/by-partuuid:
total 0
lrwxrwxrwx 1 root root 15 avril 18 22:11 54795468-79c2-48ce-9c7e-f6bd6aea6914 -&gt; ../../nvme0n1p2
lrwxrwxrwx 1 root root 15 avril 18 22:11 e9a9f238-ec93-4777-82e8-cbea7c8cf986 -&gt; ../../nvme0n1p1
lrwxrwxrwx 1 root root 10 avril 18 22:11 eeb50a63-ec05-4e34-b673-b90bc5ea2cfa -&gt; ../../sda1

/dev/disk/by-path:
total 0
lrwxrwxrwx 1 root root  9 avril 18 22:11 pci-0000:00:14.0-usb-0:1:1.0-scsi-0:0:0:0 -&gt; ../../sda
lrwxrwxrwx 1 root root 10 avril 18 22:11 pci-0000:00:14.0-usb-0:1:1.0-scsi-0:0:0:0-part1 -&gt; ../../sda1
lrwxrwxrwx 1 root root  9 avril 18 22:11 pci-0000:00:14.0-usb-0:5:1.0-scsi-0:0:0:0 -&gt; ../../sdb
lrwxrwxrwx 1 root root 13 avril 18 22:11 pci-0000:03:00.0-nvme-1 -&gt; ../../nvme0n1
lrwxrwxrwx 1 root root 15 avril 18 22:11 pci-0000:03:00.0-nvme-1-part1 -&gt; ../../nvme0n1p1
lrwxrwxrwx 1 root root 15 avril 18 22:11 pci-0000:03:00.0-nvme-1-part2 -&gt; ../../nvme0n1p2

/dev/disk/by-uuid:
total 0
lrwxrwxrwx 1 root root 10 avril 18 22:11 0a2768a9-34ac-4944-83a2-2e10ed4c48a5 -&gt; ../../sda1
lrwxrwxrwx 1 root root 15 avril 18 22:11 aad5ec2d-1dce-4a2b-8b07-2cd2bef72410 -&gt; ../../nvme0n1p2
lrwxrwxrwx 1 root root 15 avril 18 22:11 C3AC-80CA -&gt; ../../nvme0n1p1
</pre></div>
</div>
<p>Voir :</p>
<blockquote>
<div><p><a class="reference external" href="https://doc.ubuntu-fr.org/udev">https://doc.ubuntu-fr.org/udev</a>
<a class="reference external" href="https://web.archive.org/web/20100417131709/www.unixgarden.com/index.php/programmation/decouvertes-et-experimentation-avec-d-bus">https://web.archive.org/web/20100417131709/www.unixgarden.com/index.php/programmation/decouvertes-et-experimentation-avec-d-bus</a></p>
</div></blockquote>
</section>
<section id="utilitaire-smartd">
<h3><a class="toc-backref" href="#id193"><span class="sectnum">1.13.15</span> Utilitaire smartd</a><a class="headerlink" href="#utilitaire-smartd" title="Lien permanent vers ce titre">¶</a></h3>
<p>Smart signifie <strong>Self-Monitoring, Analysis and Reporting Technology</strong> c’est une technologie d’auto surveillance mise en œuvre par certains disques durs.</p>
<p>Le but de cette technologie est de permettre le suivi de l’usure « normale » des disques internes.</p>
<p>Lorsque les disques utilisés supportent les informations d’état <strong>smart</strong>, il devient possible de vérifier leur état, mais aussi de lancer un démon qui nous alerte en cas de risque.</p>
<p>Le contrôle se fait au détriment d’une légère perte de performance.</p>
<p>Installation :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">root</span><span class="nd">@luciole</span><span class="p">:</span><span class="o">~</span><span class="c1"># apt-get install smartmontools</span>
</pre></div>
</div>
<p>Le démon smartd est alors installé et peu prévenir l’administrateur par mail lorsque les informations d’état des disques atteindront les seuils d’alertes.</p>
<p>La vérification se fait au démarrage et est modifiable en éditant <em>,etc/smartd.conf</em>.</p>
<p>Si les erreurs disque n’ont pu être corrigées, il faut fortement songer à changer de disque…</p>
<p>Attention à l’usage de <em>smart</em> avec le <em>RAID</em> qui pose problème avec certains contrôleurs.</p>
<p>Pour savoir si smart est activé sur le disque:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">root</span><span class="nd">@luciole</span><span class="p">:</span><span class="o">~</span><span class="c1"># smartctl -i /dev/sda</span>
<span class="n">smartctl</span> <span class="n">version</span> <span class="mf">5.38</span> <span class="p">[</span><span class="n">x86_64</span><span class="o">-</span><span class="n">unknown</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">gnu</span><span class="p">]</span> <span class="n">Copyright</span> <span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="mi">2002</span><span class="o">-</span><span class="mi">8</span> <span class="n">Bruce</span> <span class="n">Allen</span>
<span class="n">Home</span> <span class="n">page</span> <span class="ow">is</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">smartmontools</span><span class="o">.</span><span class="n">sourceforge</span><span class="o">.</span><span class="n">net</span><span class="o">/</span>

<span class="o">===</span> <span class="n">START</span> <span class="n">OF</span> <span class="n">INFORMATION</span> <span class="n">SECTION</span> <span class="o">===</span>
<span class="n">Device</span> <span class="n">Model</span><span class="p">:</span>     <span class="n">FUJITSU</span> <span class="n">MHW2160BH</span> <span class="n">PL</span>
<span class="n">Serial</span> <span class="n">Number</span><span class="p">:</span>    <span class="n">K10FT7A25Y3B</span>
<span class="n">Firmware</span> <span class="n">Version</span><span class="p">:</span> <span class="mi">0084001</span><span class="n">E</span>
<span class="n">User</span> <span class="n">Capacity</span><span class="p">:</span>    <span class="mi">160</span> <span class="mi">041</span> <span class="mi">885</span> <span class="mi">696</span> <span class="nb">bytes</span>
<span class="n">Device</span> <span class="ow">is</span><span class="p">:</span>        <span class="n">Not</span> <span class="ow">in</span> <span class="n">smartctl</span> <span class="n">database</span> <span class="p">[</span><span class="k">for</span> <span class="n">details</span> <span class="n">use</span><span class="p">:</span> <span class="o">-</span><span class="n">P</span> <span class="n">showall</span><span class="p">]</span>
<span class="n">ATA</span> <span class="n">Version</span> <span class="ow">is</span><span class="p">:</span>   <span class="mi">8</span>
<span class="n">ATA</span> <span class="n">Standard</span> <span class="ow">is</span><span class="p">:</span>  <span class="n">ATA</span><span class="o">-</span><span class="mi">8</span><span class="o">-</span><span class="n">ACS</span> <span class="n">revision</span> <span class="mi">3</span><span class="n">b</span>
<span class="n">Local</span> <span class="n">Time</span> <span class="ow">is</span><span class="p">:</span>    <span class="n">Sun</span> <span class="n">May</span> <span class="mi">24</span> <span class="mi">18</span><span class="p">:</span><span class="mi">33</span><span class="p">:</span><span class="mi">45</span> <span class="mi">2009</span> <span class="n">CEST</span>
<span class="n">SMART</span> <span class="n">support</span> <span class="ow">is</span><span class="p">:</span> <span class="n">Available</span> <span class="o">-</span> <span class="n">device</span> <span class="n">has</span> <span class="n">SMART</span> <span class="n">capability</span><span class="o">.</span>
<span class="n">SMART</span> <span class="n">support</span> <span class="ow">is</span><span class="p">:</span> <span class="n">Enabled</span>

<span class="n">root</span><span class="nd">@luciole</span><span class="p">:</span><span class="o">~</span><span class="c1"># smartctl -A /dev/sda</span>
<span class="n">smartctl</span> <span class="n">version</span> <span class="mf">5.38</span> <span class="p">[</span><span class="n">x86_64</span><span class="o">-</span><span class="n">unknown</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">gnu</span><span class="p">]</span> <span class="n">Copyright</span> <span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="mi">2002</span><span class="o">-</span><span class="mi">8</span> <span class="n">Bruce</span> <span class="n">Allen</span>
<span class="n">Home</span> <span class="n">page</span> <span class="ow">is</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">smartmontools</span><span class="o">.</span><span class="n">sourceforge</span><span class="o">.</span><span class="n">net</span><span class="o">/</span>
</pre></div>
</div>
<p>Pour l’activer si nécessaire :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">root</span><span class="nd">@luciole</span><span class="p">:</span><span class="o">~</span><span class="c1"># smartctl -s /dev/sda</span>
</pre></div>
</div>
<p>Consultation de l’état d’un disque :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">===</span> <span class="n">START</span> <span class="n">OF</span> <span class="n">READ</span> <span class="n">SMART</span> <span class="n">DATA</span> <span class="n">SECTION</span> <span class="o">===</span>
<span class="n">SMART</span> <span class="n">Attributes</span> <span class="n">Data</span> <span class="n">Structure</span> <span class="n">revision</span> <span class="n">number</span><span class="p">:</span> <span class="mi">16</span>
<span class="n">Vendor</span> <span class="n">Specific</span> <span class="n">SMART</span> <span class="n">Attributes</span> <span class="k">with</span> <span class="n">Thresholds</span><span class="p">:</span>
<span class="n">ID</span><span class="c1"># ATTRIBUTE_NAME          FLAG     VALUE WORST THRESH TYPE      UPDATED  WHEN_FAILED RAW_VALUE</span>
  <span class="mi">1</span> <span class="n">Raw_Read_Error_Rate</span>     <span class="mh">0x000f</span>   <span class="mi">100</span>   <span class="mi">100</span>   <span class="mi">046</span>    <span class="n">Pre</span><span class="o">-</span><span class="n">fail</span>  <span class="n">Always</span>       <span class="o">-</span>       <span class="mi">182781</span>
  <span class="mi">2</span> <span class="n">Throughput_Performance</span>  <span class="mh">0x0005</span>   <span class="mi">100</span>   <span class="mi">100</span>   <span class="mi">030</span>    <span class="n">Pre</span><span class="o">-</span><span class="n">fail</span>  <span class="n">Offline</span>      <span class="o">-</span>       <span class="mi">39256064</span>
  <span class="mi">3</span> <span class="n">Spin_Up_Time</span>            <span class="mh">0x0003</span>   <span class="mi">100</span>   <span class="mi">100</span>   <span class="mi">025</span>    <span class="n">Pre</span><span class="o">-</span><span class="n">fail</span>  <span class="n">Always</span>       <span class="o">-</span>       <span class="mi">1</span>
  <span class="mi">4</span> <span class="n">Start_Stop_Count</span>        <span class="mh">0x0032</span>   <span class="mi">099</span>   <span class="mi">099</span>   <span class="mi">000</span>    <span class="n">Old_age</span>   <span class="n">Always</span>       <span class="o">-</span>       <span class="mi">603</span>
  <span class="mi">5</span> <span class="n">Reallocated_Sector_Ct</span>   <span class="mh">0x0033</span>   <span class="mi">100</span>   <span class="mi">100</span>   <span class="mi">024</span>    <span class="n">Pre</span><span class="o">-</span><span class="n">fail</span>  <span class="n">Always</span>       <span class="o">-</span>       <span class="mi">8589934592000</span>
  <span class="mi">7</span> <span class="n">Seek_Error_Rate</span>         <span class="mh">0x000f</span>   <span class="mi">100</span>   <span class="mi">100</span>   <span class="mi">047</span>    <span class="n">Pre</span><span class="o">-</span><span class="n">fail</span>  <span class="n">Always</span>       <span class="o">-</span>       <span class="mi">1690</span>
  <span class="mi">8</span> <span class="n">Seek_Time_Performance</span>   <span class="mh">0x0005</span>   <span class="mi">100</span>   <span class="mi">100</span>   <span class="mi">019</span>    <span class="n">Pre</span><span class="o">-</span><span class="n">fail</span>  <span class="n">Offline</span>      <span class="o">-</span>       <span class="mi">0</span>
  <span class="mi">9</span> <span class="n">Power_On_Hours</span>          <span class="mh">0x0032</span>   <span class="mi">080</span>   <span class="mi">080</span>   <span class="mi">000</span>    <span class="n">Old_age</span>   <span class="n">Always</span>       <span class="o">-</span>       <span class="mi">10494</span>
 <span class="mi">10</span> <span class="n">Spin_Retry_Count</span>        <span class="mh">0x0013</span>   <span class="mi">100</span>   <span class="mi">100</span>   <span class="mi">020</span>    <span class="n">Pre</span><span class="o">-</span><span class="n">fail</span>  <span class="n">Always</span>       <span class="o">-</span>       <span class="mi">0</span>
 <span class="mi">12</span> <span class="n">Power_Cycle_Count</span>       <span class="mh">0x0032</span>   <span class="mi">100</span>   <span class="mi">100</span>   <span class="mi">000</span>    <span class="n">Old_age</span>   <span class="n">Always</span>       <span class="o">-</span>       <span class="mi">564</span>
<span class="mi">192</span> <span class="n">Power</span><span class="o">-</span><span class="n">Off_Retract_Count</span> <span class="mh">0x0032</span>   <span class="mi">100</span>   <span class="mi">100</span>   <span class="mi">000</span>    <span class="n">Old_age</span>   <span class="n">Always</span>       <span class="o">-</span>       <span class="mi">9</span>
<span class="mi">193</span> <span class="n">Load_Cycle_Count</span>        <span class="mh">0x0032</span>   <span class="mi">079</span>   <span class="mi">079</span>   <span class="mi">000</span>    <span class="n">Old_age</span>   <span class="n">Always</span>       <span class="o">-</span>       <span class="mi">422760</span>
<span class="mi">194</span> <span class="n">Temperature_Celsius</span>     <span class="mh">0x0022</span>   <span class="mi">100</span>   <span class="mi">100</span>   <span class="mi">000</span>    <span class="n">Old_age</span>   <span class="n">Always</span>       <span class="o">-</span>       <span class="mi">42</span> <span class="p">(</span><span class="n">Lifetime</span> <span class="n">Min</span><span class="o">/</span><span class="n">Max</span> <span class="mi">14</span><span class="o">/</span><span class="mi">55</span><span class="p">)</span>
<span class="mi">195</span> <span class="n">Hardware_ECC_Recovered</span>  <span class="mh">0x001a</span>   <span class="mi">100</span>   <span class="mi">100</span>   <span class="mi">000</span>    <span class="n">Old_age</span>   <span class="n">Always</span>       <span class="o">-</span>       <span class="mi">166</span>
<span class="mi">196</span> <span class="n">Reallocated_Event_Count</span> <span class="mh">0x0032</span>   <span class="mi">100</span>   <span class="mi">100</span>   <span class="mi">000</span>    <span class="n">Old_age</span>   <span class="n">Always</span>       <span class="o">-</span>       <span class="mi">453509120</span>
<span class="mi">197</span> <span class="n">Current_Pending_Sector</span>  <span class="mh">0x0012</span>   <span class="mi">100</span>   <span class="mi">100</span>   <span class="mi">000</span>    <span class="n">Old_age</span>   <span class="n">Always</span>       <span class="o">-</span>       <span class="mi">0</span>
<span class="mi">198</span> <span class="n">Offline_Uncorrectable</span>   <span class="mh">0x0010</span>   <span class="mi">100</span>   <span class="mi">100</span>   <span class="mi">000</span>    <span class="n">Old_age</span>   <span class="n">Offline</span>      <span class="o">-</span>       <span class="mi">0</span>
<span class="mi">199</span> <span class="n">UDMA_CRC_Error_Count</span>    <span class="mh">0x003e</span>   <span class="mi">200</span>   <span class="mi">200</span>   <span class="mi">000</span>    <span class="n">Old_age</span>   <span class="n">Always</span>       <span class="o">-</span>       <span class="mi">0</span>
<span class="mi">200</span> <span class="n">Multi_Zone_Error_Rate</span>   <span class="mh">0x000f</span>   <span class="mi">100</span>   <span class="mi">100</span>   <span class="mi">060</span>    <span class="n">Pre</span><span class="o">-</span><span class="n">fail</span>  <span class="n">Always</span>       <span class="o">-</span>       <span class="mi">10052</span>
<span class="mi">203</span> <span class="n">Run_Out_Cancel</span>          <span class="mh">0x0002</span>   <span class="mi">100</span>   <span class="mi">100</span>   <span class="mi">000</span>    <span class="n">Old_age</span>   <span class="n">Always</span>       <span class="o">-</span>       <span class="mi">3732309344292</span>
<span class="mi">240</span> <span class="n">Head_Flying_Hours</span>       <span class="mh">0x003e</span>   <span class="mi">200</span>   <span class="mi">200</span>   <span class="mi">000</span>    <span class="n">Old_age</span>   <span class="n">Always</span>       <span class="o">-</span>       <span class="mi">0</span>
</pre></div>
</div>
<p>Lecture du résultat :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TYPE</span> <span class="p">:</span>
    <span class="n">Old_age</span> <span class="p">:</span> <span class="n">indique</span> <span class="n">qu</span><span class="s1">&#39;un dépassement n&#39;</span><span class="n">est</span> <span class="n">pas</span> <span class="n">critique</span><span class="p">,</span> <span class="n">nous</span> <span class="n">avons</span> <span class="n">simplement</span> <span class="n">dépassé</span> <span class="n">la</span> <span class="n">valeur</span>
              <span class="n">garantie</span> <span class="n">par</span> <span class="n">le</span> <span class="n">constructeur</span><span class="o">.</span>
    <span class="n">Pre</span><span class="o">-</span><span class="n">fail</span> <span class="p">:</span> <span class="n">indique</span> <span class="n">que</span> <span class="n">tout</span> <span class="n">dépassement</span> <span class="n">risque</span> <span class="n">de</span> <span class="n">provoquer</span> <span class="n">une</span> <span class="n">perte</span> <span class="n">du</span> <span class="n">disque</span><span class="o">.</span>

<span class="n">UPDATED</span> <span class="p">:</span>
    <span class="n">Always</span> <span class="p">:</span> <span class="n">la</span> <span class="n">valeur</span> <span class="n">est</span> <span class="n">maintenue</span> <span class="n">à</span> <span class="n">jour</span><span class="o">.</span>
    <span class="n">Offline</span> <span class="p">:</span> <span class="n">la</span> <span class="n">valeur</span> <span class="n">est</span> <span class="n">calculée</span> <span class="n">uniquement</span> <span class="n">lors</span> <span class="n">des</span> <span class="n">tests</span><span class="o">.</span>

<span class="n">VALUE</span> <span class="p">:</span> <span class="n">La</span> <span class="n">valeur</span> <span class="n">actuelle</span> <span class="n">du</span> <span class="n">disque</span><span class="o">.</span> <span class="n">Une</span> <span class="n">valeur</span> <span class="n">comprise</span> <span class="n">entre</span> <span class="mi">100</span> <span class="n">et</span> <span class="mi">255</span> <span class="n">indique</span> <span class="n">généralement</span>
    <span class="n">une</span> <span class="n">bonne</span> <span class="n">santé</span> <span class="n">du</span> <span class="n">disque</span><span class="o">.</span>

<span class="n">WORST</span> <span class="p">:</span> <span class="n">La</span> <span class="n">pire</span> <span class="n">valeur</span> <span class="n">enregistrée</span> <span class="n">par</span> <span class="n">le</span> <span class="n">disque</span><span class="o">.</span>

<span class="n">THRESH</span> <span class="p">:</span> <span class="n">La</span> <span class="n">valeur</span> <span class="n">seuil</span> <span class="n">en</span> <span class="n">dessous</span> <span class="n">de</span> <span class="n">laquelle</span> <span class="n">le</span> <span class="n">disque</span> <span class="n">commence</span> <span class="n">à</span> <span class="n">souffrir</span><span class="o">.</span>

<span class="n">RAW</span> <span class="n">VALUE</span> <span class="p">:</span> <span class="n">est</span> <span class="n">la</span> <span class="n">conversion</span> <span class="n">de</span> <span class="n">VALUE</span> <span class="n">dans</span> <span class="n">les</span> <span class="n">unités</span> <span class="n">utilisées</span> <span class="n">par</span> <span class="n">le</span> <span class="n">constructeur</span><span class="o">.</span>
</pre></div>
</div>
<p>Il existe plusieurs types de tests pour mettre à jour les valeurs :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">offline</span> <span class="p">:</span> <span class="n">le</span> <span class="n">disque</span> <span class="n">ne</span> <span class="n">doit</span> <span class="n">pas</span> <span class="n">être</span> <span class="n">monté</span><span class="o">.</span>
<span class="n">short</span> <span class="p">:</span> <span class="n">test</span> <span class="n">court</span> <span class="n">sur</span> <span class="n">les</span> <span class="n">performances</span><span class="p">,</span> <span class="n">les</span> <span class="n">problèmes</span> <span class="n">électriques</span> <span class="n">et</span> <span class="n">lectures</span><span class="o">/</span><span class="n">écritures</span> <span class="n">physiques</span><span class="o">.</span>
<span class="n">long</span> <span class="p">:</span> <span class="n">version</span> <span class="n">longue</span> <span class="n">du</span> <span class="n">précédent</span><span class="o">.</span>
</pre></div>
</div>
<p>Lancement d’un test :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">root</span><span class="nd">@luciole</span><span class="p">:</span><span class="o">~</span><span class="c1"># smartctl -t long /dev/sda</span>
<span class="n">smartctl</span> <span class="n">version</span> <span class="mf">5.38</span> <span class="p">[</span><span class="n">x86_64</span><span class="o">-</span><span class="n">unknown</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">gnu</span><span class="p">]</span> <span class="n">Copyright</span> <span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="mi">2002</span><span class="o">-</span><span class="mi">8</span> <span class="n">Bruce</span> <span class="n">Allen</span>
<span class="n">Home</span> <span class="n">page</span> <span class="ow">is</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">smartmontools</span><span class="o">.</span><span class="n">sourceforge</span><span class="o">.</span><span class="n">net</span><span class="o">/</span>

<span class="o">===</span> <span class="n">START</span> <span class="n">OF</span> <span class="n">OFFLINE</span> <span class="n">IMMEDIATE</span> <span class="n">AND</span> <span class="n">SELF</span><span class="o">-</span><span class="n">TEST</span> <span class="n">SECTION</span> <span class="o">===</span>
<span class="n">Sending</span> <span class="n">command</span><span class="p">:</span> <span class="s2">&quot;Execute SMART Extended self-test routine immediately in off-line mode&quot;</span><span class="o">.</span>
<span class="n">Drive</span> <span class="n">command</span> <span class="s2">&quot;Execute SMART Extended self-test routine immediately in off-line mode&quot;</span> <span class="n">successful</span><span class="o">.</span>
<span class="n">Testing</span> <span class="n">has</span> <span class="n">begun</span><span class="o">.</span>
<span class="n">Please</span> <span class="n">wait</span> <span class="mi">92</span> <span class="n">minutes</span> <span class="k">for</span> <span class="n">test</span> <span class="n">to</span> <span class="n">complete</span><span class="o">.</span>
<span class="n">Test</span> <span class="n">will</span> <span class="n">complete</span> <span class="n">after</span> <span class="n">Sun</span> <span class="n">May</span> <span class="mi">24</span> <span class="mi">20</span><span class="p">:</span><span class="mi">18</span><span class="p">:</span><span class="mi">57</span> <span class="mi">2009</span>

<span class="n">Use</span> <span class="n">smartctl</span> <span class="o">-</span><span class="n">X</span> <span class="n">to</span> <span class="n">abort</span> <span class="n">test</span><span class="o">.</span>
</pre></div>
</div>
<p>Pour voir le résultat il faut soit consulter les <em>logs</em> soit :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">smartctl</span> <span class="o">-</span><span class="n">c</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda</span>
<span class="n">smartctl</span> <span class="o">-</span><span class="n">l</span> <span class="n">selftest</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda</span>
<span class="n">smartctl</span> <span class="o">-</span><span class="n">A</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda</span>
</pre></div>
</div>
<p>Configuration de <strong>smartd</strong> :</p>
<p>Le man de <strong>samrtd</strong> donne l’ensemble des informations permettant de configurer le démon qui scrute l’état des disques.</p>
<p>Informations :</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="http://fr.wikipedia.org/wiki/Self-Monitoring,_Analysis_and_Reporting_Technology">http://fr.wikipedia.org/wiki/Self-Monitoring,_Analysis_and_Reporting_Technology</a></p></li>
<li><p><a class="reference external" href="http://linux-attitude.fr/post/Soyez-encore-plus-a-lecoute-de-vos-disques">http://linux-attitude.fr/post/Soyez-encore-plus-a-lecoute-de-vos-disques</a></p></li>
</ul>
</div></blockquote>
</section>
<section id="les-montages-en-raid">
<h3><a class="toc-backref" href="#id194"><span class="sectnum">1.13.16</span> Les montages en raid</a><a class="headerlink" href="#les-montages-en-raid" title="Lien permanent vers ce titre">¶</a></h3>
<p>Le RAID (Redundant Array of Independant Disk) permet d’augmenter la tolérance aux pannes ou d’avoir un espace de stockage plus rapide ou plus grand que ce que l’on obtiendrait avec un seul disque.</p>
<p>La tolérance est obtenue soit par mirroring, soit par calcul de parité.</p>
<p>Les performances sont obtenues par multiplexage des disques, par exemple un mot de 4 octets voit chacun de ses octets écrits en parallèle sur 4 disques différents.</p>
<p>La concaténation permet elle de disposer virtuellement d’un seul disque dont la capacité est la somme de chacun des disques.</p>
<p>Voir : <a class="reference external" href="http://fr.wikipedia.org/wiki/RAID_(informatique">http://fr.wikipedia.org/wiki/RAID_(informatique</a>)</p>
<section id="le-raid-0">
<h4><a class="toc-backref" href="#id195"><span class="sectnum">1.13.16.1</span> Le RAID 0</a><a class="headerlink" href="#le-raid-0" title="Lien permanent vers ce titre">¶</a></h4>
<p>On cherche les performances sans tolérance aux pannes.</p>
</section>
<section id="le-raid-1">
<h4><a class="toc-backref" href="#id196"><span class="sectnum">1.13.16.2</span> Le RAID 1</a><a class="headerlink" href="#le-raid-1" title="Lien permanent vers ce titre">¶</a></h4>
<p>L’information est dupliquée sur les disques qui sont donc montés en miroir.</p>
</section>
<section id="le-raid-5">
<h4><a class="toc-backref" href="#id197"><span class="sectnum">1.13.16.3</span> Le RAID 5</a><a class="headerlink" href="#le-raid-5" title="Lien permanent vers ce titre">¶</a></h4>
<p>Il nécessite au minimum 3 disques.</p>
<p>Les informations sont stockées par bande (strip).</p>
<p>Par exemple pour un système à 3 disques, deux bandes de données et une de parité sont écrites alternativement sur les 3 disques.</p>
<p>Les bandes de parités sont écrites alternativement sur tous les disques façon a accroitre la résistance aux pannes.</p>
<p>Elles sont calculées en faisant un ou exclusif des bandes de données précédentes.</p>
</section>
<section id="la-gestion-du-raid-logiciel-par-linux">
<h4><a class="toc-backref" href="#id198"><span class="sectnum">1.13.16.4</span> La gestion du RAID logiciel par Linux</a><a class="headerlink" href="#la-gestion-du-raid-logiciel-par-linux" title="Lien permanent vers ce titre">¶</a></h4>
<p>La commande <strong>mdadm</strong> permet de gérer les disques <em>RAID</em>.</p>
<p>La commande <strong>mdadm –create</strong> permet d’initialiser un disque <em>RAID</em>.</p>
<p>La commande <strong>mdadm –detail /dev/mdX</strong> affiche l’état d’un <em>RAID</em>.</p>
<p>La commande <strong>mdadm –deamonise /dev/mdX</strong> démarre le <em>RAID</em>.</p>
<p>Le fichier <em>/,etc/mdadm/mdadm.conf</em> contient la configuration utilisée par mdadm au démarrage.</p>
<p>La commande <strong>mdadm –detail –scan –verbose</strong> permet de récupérer la configuration et si nécessaire de la stocker dans <em>/,etc/mdadm/mdadm.conf</em> pour le prochain démarrage.</p>
<p>Lien : <a class="reference external" href="http://doc.ubuntu-fr.org/raid_logiciel">http://doc.ubuntu-fr.org/raid_logiciel</a></p>
<p>Exemple création d’un disque :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fdisk</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda</span> <span class="c1">#Pour la création de /dev/sda1</span>
<span class="n">fdisk</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sdb</span> <span class="c1">#Pour la création de /dev/sdb1</span>
<span class="n">mdadm</span> <span class="o">--</span><span class="n">create</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">md0</span> <span class="o">--</span><span class="n">level</span><span class="o">=</span><span class="mi">1</span> <span class="o">--</span><span class="n">raid</span><span class="o">-</span><span class="n">devices</span><span class="o">=</span><span class="mi">2</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda1</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sdb1</span>
<span class="n">mdadm</span> <span class="o">--</span><span class="n">daemonise</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">md0</span>
<span class="c1">#sinon en éditant /,etc/mdadm/mdadm.conf on peut y ajouter</span>
<span class="c1">#ARRAY /dev/md0 level=raid1 num-devices=2 devices=/dev/sda1,/dev/sdb1</span>
</pre></div>
</div>
<p>Les périphériques <em>RAID</em> apparaissent sous <em>/dev/md#</em>.</p>
</section>
</section>
<section id="lvm">
<h3><a class="toc-backref" href="#id199"><span class="sectnum">1.13.17</span> LVM</a><a class="headerlink" href="#lvm" title="Lien permanent vers ce titre">¶</a></h3>
<p><strong>LVM</strong> Logical Volume Manager s’intercale entre le noyau et les partitions des disques afin de permettre :</p>
<blockquote>
<div><ul class="simple">
<li><p>de redimensionner les partitions,</p></li>
<li><p>de concaténer les disques,</p></li>
<li><p>de réaliser des instantanés du système de fichier.</p></li>
</ul>
</div></blockquote>
<p>Sa mise en place doit être faite dès le partitionnement (type 8E).</p>
<p><em>GRUB</em> ne fonctionne pas avec <em>LVM</em> il faut donc soit utiliser <em>Lilo</em> soit réserver LVM à <em>/home</em>.</p>
<p>Glossaire :</p>
<p><strong>PV</strong> <em>Physical Volume</em> est un disque ou un ensemble de disques utilisés par <em>LVM</em>,</p>
<p><strong>VG</strong> <em>Volume Group</em> est un ensemble de PV,</p>
<p><strong>LV</strong> <em>Logical Volume</em> est une partie du <em>VG</em> vue par l’utilisateur comme s’il s’agissait d’une partition,</p>
<p><strong>PD</strong> <em>Physical Device</em> est ensemble de partition d’un disque utilisé par <em>LVM</em>,</p>
<p><strong>PE</strong> <em>Physical Extent</em> est la plus petite unité de données gérée par LVM (~= 4Mo).</p>
<p>Les modules de <em>LVM</em> doivent être montés avec <em>modprobe dm_load</em>.</p>
<p>La commande <strong>vgscan</strong> permet de lancer <em>LVM</em>.</p>
<p>La commande <strong>pvcreate</strong> permet de créer un volume physique.</p>
<p>La commande <strong>vgcreate</strong> permet de regrouper le <em>PV</em> dans un groupe de volume.</p>
<p>La commande <strong>lvcreate</strong> permet de créer le volume logique.</p>
<p>Il ne faut pas oublier de formater un volume logique pour pouvoir s’en servir, on utilise alors <em>mkfs</em> classiquement.</p>
<p>La commande <strong>lvextend</strong> permet de modifier la taille d’un <em>LV</em>.</p>
<p>Pour retailler le système de fichier, on utilisera la commande <strong>resize2fs</strong> après avoir démonté le système de fichier.</p>
</section>
</section>
<section id="python">
<h2><a class="toc-backref" href="#id200"><span class="sectnum">1.14</span> Python</a><a class="headerlink" href="#python" title="Lien permanent vers ce titre">¶</a></h2>
<p>Le scripting bash peut vite s’apparenter à du développement, alors pourquoi ne pas utiliser un vrai langage de programmation ?</p>
<section id="id2">
<h3><a class="toc-backref" href="#id201"><span class="sectnum">1.14.1</span> Historique</a><a class="headerlink" href="#id2" title="Lien permanent vers ce titre">¶</a></h3>
<p>Python a été créé fin 1986 par Guido van Rossum au CWI (Institut de recherche en mathématique et informatique de Hollande), à partir de la version 1.2 en 1995 le CNRI (Corporation of Nationnal Research Initiative) finance le projet.</p>
<p>En 2000 Python passe en version 2.0 au sein de Be.open, puis l’équipe rejoint Digitial Creation (Futur Zope Corporation) en 2001. En mars 2001 création de la python fondation et libération complète du code.</p>
</section>
<section id="la-notion-d-objet">
<h3><a class="toc-backref" href="#id202"><span class="sectnum">1.14.2</span> La notion d’objet</a><a class="headerlink" href="#la-notion-d-objet" title="Lien permanent vers ce titre">¶</a></h3>
<p>Tout est objet.</p>
</section>
<section id="la-notion-de-classe">
<h3><a class="toc-backref" href="#id203"><span class="sectnum">1.14.3</span> La notion de classe</a><a class="headerlink" href="#la-notion-de-classe" title="Lien permanent vers ce titre">¶</a></h3>
<p>Tous les objets appartiennent à une classe.</p>
</section>
<section id="l-instruction-print">
<h3><a class="toc-backref" href="#id204"><span class="sectnum">1.14.4</span> L’instruction print</a><a class="headerlink" href="#l-instruction-print" title="Lien permanent vers ce titre">¶</a></h3>
<p>Exemple :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hello world&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;coucou&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="les-primitives-d-acces-aux-informations-de-type">
<h3><a class="toc-backref" href="#id205"><span class="sectnum">1.14.5</span> Les primitives d’accès aux informations de type</a><a class="headerlink" href="#les-primitives-d-acces-aux-informations-de-type" title="Lien permanent vers ce titre">¶</a></h3>
<p><strong>id()</strong> renvoie l’identifiant d’un objet.</p>
<p><strong>type()</strong> renvoie le type de l’objet.</p>
<p><strong>dir()</strong> liste les attributs des objets.</p>
</section>
<section id="les-commentaires">
<h3><a class="toc-backref" href="#id206"><span class="sectnum">1.14.6</span> Les commentaires</a><a class="headerlink" href="#les-commentaires" title="Lien permanent vers ce titre">¶</a></h3>
<p>Le caractère <strong>#</strong> marque le début d’un commentaire.</p>
</section>
<section id="les-chaines-de-caracteres">
<h3><a class="toc-backref" href="#id207"><span class="sectnum">1.14.7</span> Les chaînes de caractères</a><a class="headerlink" href="#les-chaines-de-caracteres" title="Lien permanent vers ce titre">¶</a></h3>
<p>En python 3 l’encodage par défaut est UTF-8 qui est une représentation des types unicode.</p>
<p>On passe d’unicode au str en appelant la fonction encode (u »C’est la fête ».encode(“ISO-8859-15”).</p>
<p>On passe du str au unicode par la fonction decode.</p>
<p>Les délimiteurs et types de chaînes :</p>
<blockquote>
<div><ul class="simple">
<li><p>Les guillemets <strong>« </strong> et <strong>« «  »</strong>,</p></li>
<li><p>Les apostrophes <strong>“</strong>,</p></li>
<li><p>Les chaînes raw <strong>r””</strong>,</p></li>
<li><p>Les chaînes formatable <strong>f””</strong>,</p></li>
</ul>
</div></blockquote>
</section>
<section id="les-numeriques">
<h3><a class="toc-backref" href="#id208"><span class="sectnum">1.14.8</span> Les numériques</a><a class="headerlink" href="#les-numeriques" title="Lien permanent vers ce titre">¶</a></h3>
<p>Les entiers (0 à 2^32) pour le type <strong>int</strong> et pour les entiers longs de type <strong>long</strong> on suffixe par un L ou l, la représentation octale commence par un 0 et l’hexadécimale par 0x.</p>
<p>Le type <strong>bool</strong> (True, False)</p>
<p>Les valeurs à virgule flottante (0.1 et 1e100) leur type est <strong>float</strong>.</p>
<p>Les nombres complexes (1 + 3j) leur type est <strong>complex</strong>.</p>
</section>
<section id="les-types-a-valeur-unique">
<h3><a class="toc-backref" href="#id209"><span class="sectnum">1.14.9</span> Les types à valeur unique</a><a class="headerlink" href="#les-types-a-valeur-unique" title="Lien permanent vers ce titre">¶</a></h3>
<p>None</p>
<p>NotImplemented</p>
</section>
<section id="les-sequences">
<h3><a class="toc-backref" href="#id210"><span class="sectnum">1.14.10</span> Les séquences</a><a class="headerlink" href="#les-sequences" title="Lien permanent vers ce titre">¶</a></h3>
<p>Les tuples ()</p>
<p>Les listes []</p>
<p>Les dictionnaires {}</p>
</section>
<section id="les-operateurs">
<h3><a class="toc-backref" href="#id211"><span class="sectnum">1.14.11</span> Les opérateurs</a><a class="headerlink" href="#les-operateurs" title="Lien permanent vers ce titre">¶</a></h3>
<p>L’affectation =</p>
<p>La division / (Attention identique au C donc 5/6 = 0, mais 5.0/6 = 0.83333….)</p>
<p>La division entière //</p>
<p>Le modulo % ou divmod(5,3) = (1,2)</p>
<p>La négation -</p>
<p>L’inversion bit à bit ~ (complément à un)</p>
<p>La puissance **</p>
<p>Appartenance in</p>
</section>
<section id="operateurs-binaires">
<h3><a class="toc-backref" href="#id212"><span class="sectnum">1.14.12</span> Opérateurs binaires</a><a class="headerlink" href="#operateurs-binaires" title="Lien permanent vers ce titre">¶</a></h3>
<p>Le et <strong>&amp;</strong></p>
<p>Le ou <strong>|</strong></p>
<p>Le ou exclusif <strong>^</strong></p>
</section>
<section id="operateurs-de-comparaison">
<h3><a class="toc-backref" href="#id213"><span class="sectnum">1.14.13</span> Opérateurs de comparaison</a><a class="headerlink" href="#operateurs-de-comparaison" title="Lien permanent vers ce titre">¶</a></h3>
<p>Inférieur <strong>&lt;</strong></p>
<p>Supérieur <strong>&gt;</strong></p>
<p>Inférieur égal <strong>&lt;=</strong></p>
<p>Supérieur égal <strong>&gt;=</strong></p>
<p>égalité <strong>==</strong>
différence <strong>!=</strong> ou <strong>&lt;&gt;</strong></p>
<p>le est <strong>is</strong></p>
<p>le n’est pas <strong>is not</strong></p>
</section>
<section id="ordre-de-traitement-des-operations">
<h3><a class="toc-backref" href="#id214"><span class="sectnum">1.14.14</span> Ordre de traitement des opérations</a><a class="headerlink" href="#ordre-de-traitement-des-operations" title="Lien permanent vers ce titre">¶</a></h3>
<p>Parenthèses, Exposants, Division, Multiplication, Addition, Soustraction</p>
</section>
<section id="l-instruction-pass">
<h3><a class="toc-backref" href="#id215"><span class="sectnum">1.14.15</span> L’instruction pass</a><a class="headerlink" href="#l-instruction-pass" title="Lien permanent vers ce titre">¶</a></h3>
</section>
<section id="l-indentation">
<h3><a class="toc-backref" href="#id216"><span class="sectnum">1.14.16</span> L’indentation</a><a class="headerlink" href="#l-indentation" title="Lien permanent vers ce titre">¶</a></h3>
<p>La création de block de code se fait par indentation.</p>
</section>
<section id="les-structures-conditionnelles">
<h3><a class="toc-backref" href="#id217"><span class="sectnum">1.14.17</span> Les structures conditionnelles</a><a class="headerlink" href="#les-structures-conditionnelles" title="Lien permanent vers ce titre">¶</a></h3>
<p>L’instruction if (else et elif)</p>
<p>L’instruction for in</p>
<p>L’instruction while</p>
</section>
<section id="id3">
<h3><a class="toc-backref" href="#id218"><span class="sectnum">1.14.18</span> Les fonctions</a><a class="headerlink" href="#id3" title="Lien permanent vers ce titre">¶</a></h3>
<p>La définition des fonctions se fait à l’aide de l’instruction « def ».</p>
<p>La fonction est un objet.</p>
<p>Le code doit être indenté.</p>
<p>Les paramètres ne sont pas typés.</p>
<p>Les paramètres peuvent recevoir une valeur par défaut <em>p1 = 0</em>.</p>
<p>Les paramètres non explicites (ex: def f(**dict)) sont placés dans un dictionnaire.</p>
<p>Les paramètres arbitraires (ex : def f(*pars))sont placé dans un tuple.</p>
<p>Combinaison paramètres implicites et arbitraires (ex: def f(*pars, **dict)).</p>
<p>La directive return</p>
<p>La directive lambda</p>
</section>
<section id="les-docstrings">
<h3><a class="toc-backref" href="#id219"><span class="sectnum">1.14.19</span> Les docstrings</a><a class="headerlink" href="#les-docstrings" title="Lien permanent vers ce titre">¶</a></h3>
<p>Les fonctions du code peuvent être documentées, ce qui permet lors de l’exécution d’un code d’interroger une fonction pour savoir comment elle fonctionne.</p>
</section>
<section id="les-decorateurs">
<h3><a class="toc-backref" href="#id220"><span class="sectnum">1.14.20</span> Les décorateurs</a><a class="headerlink" href="#les-decorateurs" title="Lien permanent vers ce titre">¶</a></h3>
<p>On peut en python définir des fonctions qui compléteront d’autres fonctions sur le principe de la composition mathématique.</p>
<p>Exemple :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">mondecorateur</span><span class="p">(</span><span class="n">fonction</span><span class="p">)</span> <span class="p">:</span>
  <span class="k">def</span> <span class="nf">nouvellefonction</span><span class="p">()</span> <span class="p">:</span>
     <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;execution de </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">fonction</span> <span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
     <span class="k">return</span> <span class="n">fonction</span><span class="p">()</span>
  <span class="k">return</span> <span class="n">nouvellefonction</span>

<span class="nd">@mondecorateur</span>
<span class="k">def</span> <span class="nf">f</span><span class="p">()</span> <span class="p">:</span>
  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;coucou&#39;</span><span class="p">)</span>

<span class="n">f</span><span class="p">()</span>
<span class="o">&gt;&gt;</span><span class="n">execution</span> <span class="n">de</span> <span class="n">f</span>
<span class="o">&gt;&gt;</span><span class="n">coucou</span>
</pre></div>
</div>
<p>Utile pour tester les préconditions des fonctions.</p>
</section>
<section id="les-classes">
<h3><a class="toc-backref" href="#id221"><span class="sectnum">1.14.21</span> Les Classes</a><a class="headerlink" href="#les-classes" title="Lien permanent vers ce titre">¶</a></h3>
<p>Les classes regroupent à la fois des données et des fonctions travaillant sur ces données.</p>
<p>Elles sont définies par l’instruction class</p>
<p>Les classes peuvent hériter d’autres classes.</p>
<p>Exemple :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Animal</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">age</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">poids</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">class</span> <span class="nc">Chat</span><span class="p">(</span><span class="n">Animal</span><span class="p">):</span>
   <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nom</span><span class="p">):</span>
     <span class="nb">super</span><span class="p">(</span><span class="n">Chat</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span> <span class="c1"># Permet de construire la partie Animal</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">nom</span> <span class="o">=</span> <span class="n">nom</span>
</pre></div>
</div>
<p>La notion de constructeur <strong>__init__</strong></p>
<p>La notion de destructeur <strong>__del__</strong></p>
<p>Les attributs privés</p>
</section>
<section id="les-exceptions">
<h3><a class="toc-backref" href="#id222"><span class="sectnum">1.14.22</span> Les exceptions</a><a class="headerlink" href="#les-exceptions" title="Lien permanent vers ce titre">¶</a></h3>
<p>Les erreurs sont signalées par le mécanisme des exceptions :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">try</span><span class="p">:</span>
<span class="gp">... </span>   <span class="n">PasDefinie</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">... </span><span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
<span class="gp">... </span>   <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Variable non définie&quot;</span><span class="p">)</span>
<span class="gp">...</span>
<span class="go">Variable non définie</span>
</pre></div>
</div>
</section>
<section id="les-modules">
<h3><a class="toc-backref" href="#id223"><span class="sectnum">1.14.23</span> Les modules</a><a class="headerlink" href="#les-modules" title="Lien permanent vers ce titre">¶</a></h3>
<p>Les bibliothèques de programmation en python s’appellent des modules.</p>
<p>Primitive import</p>
<p>Primitive reload</p>
</section>
<section id="les-paquets">
<h3><a class="toc-backref" href="#id224"><span class="sectnum">1.14.24</span> Les paquets</a><a class="headerlink" href="#les-paquets" title="Lien permanent vers ce titre">¶</a></h3>
<p>Les modules sont généralement découpés en paquets qui se traduisent par des dossiers sur le disque.</p>
</section>
<section id="les-principaux-modules">
<h3><a class="toc-backref" href="#id225"><span class="sectnum">1.14.25</span> Les principaux modules</a><a class="headerlink" href="#les-principaux-modules" title="Lien permanent vers ce titre">¶</a></h3>
<section id="builtin">
<h4><a class="toc-backref" href="#id226"><span class="sectnum">1.14.25.1</span> __builtin__</a><a class="headerlink" href="#builtin" title="Lien permanent vers ce titre">¶</a></h4>
<p>Contient les primitives</p>
</section>
<section id="id4">
<h4><a class="toc-backref" href="#id227"><span class="sectnum">1.14.25.2</span> sys</a><a class="headerlink" href="#id4" title="Lien permanent vers ce titre">¶</a></h4>
<p>Contient les informations relative à l’exécution en cours</p>
</section>
<section id="os">
<h4><a class="toc-backref" href="#id228"><span class="sectnum">1.14.25.3</span> os</a><a class="headerlink" href="#os" title="Lien permanent vers ce titre">¶</a></h4>
<p>Permet de gérer le système</p>
</section>
<section id="gzip-zipfile">
<h4><a class="toc-backref" href="#id229"><span class="sectnum">1.14.25.4</span> gzip, zipfile</a><a class="headerlink" href="#gzip-zipfile" title="Lien permanent vers ce titre">¶</a></h4>
<p>Permettent de gérer les fichiers compressés.</p>
</section>
<section id="socket">
<h4><a class="toc-backref" href="#id230"><span class="sectnum">1.14.25.5</span> socket</a><a class="headerlink" href="#socket" title="Lien permanent vers ce titre">¶</a></h4>
<p>Pour gérer les connexions TCP ou UDP</p>
</section>
<section id="urllib2">
<h4><a class="toc-backref" href="#id231"><span class="sectnum">1.14.25.6</span> urllib2</a><a class="headerlink" href="#urllib2" title="Lien permanent vers ce titre">¶</a></h4>
<p>Pour gérer les connexions http</p>
<p>Liens :</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="http://diveintopython.adrahon.org/">http://diveintopython.adrahon.org/</a></p></li>
<li><p><a class="reference external" href="http://docs.python.org/">http://docs.python.org/</a></p></li>
<li><p><a class="reference external" href="http://www.afpy.org/">http://www.afpy.org/</a></p></li>
</ul>
</div></blockquote>
</section>
</section>
<section id="environnement-virtuel">
<h3><a class="toc-backref" href="#id232"><span class="sectnum">1.14.26</span> Environnement virtuel</a><a class="headerlink" href="#environnement-virtuel" title="Lien permanent vers ce titre">¶</a></h3>
<p>Les environnements virtuels python permettent de créer des environnements de développements ou d’exécutions isolés les uns des autres.
C’est à dire que l’on va pouvoir y installer des bibliothèques sans contaminer les autres environnements python.
Et l’on va pouvoir lister précisément les dépendances dont notre programme a besoin. Fini la livraison où il manque des bibliothèques parce que dans un autre projet on a installé une bibliothèque que l’on utilise sans rendre compte.
Installer le paquet de la distribution :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip3</span> <span class="n">install</span> <span class="n">virtualenv</span> <span class="n">virtualenvwrapper</span>
</pre></div>
</div>
<p>Éditer notre .bashrc et ajouter les lignes suivantes :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span># virtualenv
export WORKON_HOME=$HOME/.virtualenvs
VIRTUALENVWRAPPER_PYTHON=&#39;/usr/bin/python3&#39;
source /usr/local/bin/virtualenvwrapper.sh
</pre></div>
</div>
<p>Pour céer un environnement virtuel :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mkvirtualenv</span> <span class="n">my_venv</span> <span class="o">-</span><span class="n">p</span> <span class="n">python3</span>
</pre></div>
</div>
<p>Par exemple pour installer QT6 dans un environnement vituel :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkvirtualenv qt6_env -p python3

(qt6_env) michaellaunay@luciole:~$ pip install numpy matplotlib PyQT6 # pour installer QT
(qt6_env) michaellaunay@luciole:~$ pip install flake8 pylint # pour installer flake8 qui vérifie le respect de la pep8 et Pylint pour la vérification du code
</pre></div>
</div>
<p>Depuis python3.6, il existe un outil qui fusionne pip et virtual env : <strong>pipenv</strong></p>
<p>Installation de pipenv :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip3</span> <span class="n">install</span> <span class="n">pipenv</span>
</pre></div>
</div>
<p>Création d’un vitual env lors de l’installation d’un module</p>
<blockquote>
<div><p>cd $MY_WORKING_DIR # Aller dans votre espace de travail
pipenv install pyside6 –python=python3.9
# Attention si python 3.9 n’est pas installé sur la machine ne pas oublier de faire « apt install python3.9 »</p>
</div></blockquote>
<p>Pour voir son virtualenv :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pipenv</span> <span class="o">--</span><span class="n">venv</span> <span class="c1">#Indique les virtual env associés avec le chemin courant</span>
</pre></div>
</div>
<p>Pour activer le virtual env créé :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pipenv</span> <span class="n">shell</span> <span class="c1">#Depuis le répertoire de travail</span>
</pre></div>
</div>
<p>Vérification de la conformité pep8 :</p>
<blockquote>
<div><p>(qt6_env) <a class="reference external" href="mailto:michaellaunay&#37;&#52;&#48;luciole">michaellaunay<span>&#64;</span>luciole</a>:~$ flake8 demo.py</p>
</div></blockquote>
</section>
</section>
<section id="initialisation-du-systeme-et-des-services">
<h2><a class="toc-backref" href="#id233"><span class="sectnum">1.15</span> Initialisation du système et des services</a><a class="headerlink" href="#initialisation-du-systeme-et-des-services" title="Lien permanent vers ce titre">¶</a></h2>
<section id="la-sequence-de-boot">
<h3><a class="toc-backref" href="#id234"><span class="sectnum">1.15.1</span> La séquence de boot</a><a class="headerlink" href="#la-sequence-de-boot" title="Lien permanent vers ce titre">¶</a></h3>
<p>Au démarrage de l’ordinateur, le bios cherche un périphérique d’amorçage selon l’ordre établi par sa séquence de boot.</p>
<p>Le bios lance le chargeur (loader) qui se trouve dans le MBR (Master Boot Record) et qui ne fait que 512 octets.</p>
<p>Si le chargeur est GRUB, alors le MBR ne contient que la 1er partie de GRUB appelée <em>stage 1</em> qui à pour unique rôle de charger stage 1_5 et stage 2.</p>
<p>Stage 1_5 contient le code d’accès aux différents systèmes de fichiers. Il est contenu dans les premiers secteurs et peut avoir une taille de 33ko.</p>
<p>Puis stage 2 est chargé, il peut être n’importe où sur le disque.</p>
<p>Stage 2 propose à l’utilisateur de choisir le système d’exploitation ou la version du noyau à démarrer à travers un menu.</p>
<p>L’utilisateur peut aussi modifier la configuration de démarrage en éditant le menu (appuyer sur <em>e</em>).</p>
<p>Stage 2 charge alors l’image du système d’exploitation choisi, le fichier se trouve généralement dans <em>/boot</em> et porte un nom du type <em>vmlinuz-2.6.XXX</em>.</p>
<p><em>/boot</em> contient aussi des fichiers <em>initrd</em> qui permettent de gérer les périphériques nécessitant le chargement de module spécifique (cas des systèmes de ficher non inclus au noyau).</p>
<p>Le menu de démarrage passe quelques options à l’image du système, notamment le nom du périphérique contenant la racine exemple : <em>root=/dev/sda1</em>.</p>
<p>Une fois le noyau lancé, il exécute <em>/sbin/init</em> avec 1 comme PID.</p>
<p><em>init</em> démarre les démons qui vont par exemple configurer les services réseau.</p>
</section>
<section id="grub">
<h3><a class="toc-backref" href="#id235"><span class="sectnum">1.15.2</span> GRUB</a><a class="headerlink" href="#grub" title="Lien permanent vers ce titre">¶</a></h3>
<p><strong>GRUB</strong> est l’acronyme de GRand Unified Bootloader. C’est un programme GNU de démarrage permettant de choisir le système d’exploitation qui sera chargé.</p>
<p>Le fichier <em>/boot/grub/menu.lst</em> permet de créer le menu de démarrage, et d’imposer un choix par défaut.
+
<em>GRUB</em> peut charger l’image du noyau depuis le réseau.</p>
<p>La version 2 est celle installée avec Ubuntu 20.04.</p>
<p>La mise à jour du noyau entraine la modification du fichier <em>/boot/grub/grub.cfg</em>, mais il est possible de la forcer avec la commande <strong>update-grub</strong>.</p>
<p>Pour customiser le bootloader on doit éditer le fichier /,etc/grub.d/40_custom</p>
<p>Lors du démarage de Grub on peut passer des options au kernel en appuyant sur la touche « e ».</p>
<p>Voir la doc :
<a class="reference external" href="https://doc.ubuntu-fr.org/grub-pc">https://doc.ubuntu-fr.org/grub-pc</a></p>
</section>
<section id="demarrage-du-noyau">
<h3><a class="toc-backref" href="#id236"><span class="sectnum">1.15.3</span> Démarrage du noyau</a><a class="headerlink" href="#demarrage-du-noyau" title="Lien permanent vers ce titre">¶</a></h3>
<p>Il est possible de passer des options au noyau lors de son démarrage.</p>
<p>La syntaxe des options est :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">option1</span><span class="o">=</span><span class="n">valeur</span> <span class="n">option2</span><span class="o">=</span><span class="n">valeur1</span><span class="p">,</span><span class="n">valeur2</span>
</pre></div>
</div>
</section>
<section id="les-arguments-ou-parametres-du-kernel">
<h3><a class="toc-backref" href="#id237"><span class="sectnum">1.15.4</span> Les arguments ou paramètres du kernel</a><a class="headerlink" href="#les-arguments-ou-parametres-du-kernel" title="Lien permanent vers ce titre">¶</a></h3>
<p>Les principales options d’amorçage du noyau sont :</p>
<blockquote>
<div><ul class="simple">
<li><p>root=/dev/sda1 indique la partition système,</p></li>
<li><p>ro Indique que le système de fichier doit être monté en lecture seul,</p></li>
<li><p>init permet de démarrer un autre processus à la place d”<em>init</em>,</p></li>
<li><p>single ou emergency permet de passer en mode simple utilisateur et permet par exemple de pouvoir modifier le mot de passe root,</p></li>
<li><p>quiet démarre en mode silencieux,</p></li>
<li><p>nosmp n’utilise qu’un seul processeur,</p></li>
<li><p>noht pas d’hyper threading,</p></li>
<li><p>noapic pas de détection des interruptions,</p></li>
<li><p>nolapic aucune gestion des interruptions,</p></li>
<li><p>apm=off|on désactive ou active la gestion de l’alimentation en énergie,</p></li>
<li><p>noresume ne réveille pas une hibernation.</p></li>
</ul>
</div></blockquote>
</section>
<section id="systemd-vs-initv-vs-upstart">
<h3><a class="toc-backref" href="#id238"><span class="sectnum">1.15.5</span> Systemd vs InitV vs upstart</a><a class="headerlink" href="#systemd-vs-initv-vs-upstart" title="Lien permanent vers ce titre">¶</a></h3>
<p>&#64;TODO Systemd</p>
<p>InitV signifie Init system V.</p>
<p>Ce système est remplacé par <strong>upstart</strong> sur les dernières Ubuntu et Fedora.</p>
<p>Au démarrage, le noyau lance <em>init</em>.</p>
<p>L’ancien système était paramétrable via le fichier <em>/,etc/inittab</em> qui est remplacé par la notion de <em>job</em>.</p>
<p><strong>init</strong> lit le répertoire <em>/,etc/event.d</em> qui contient les jobs à lancer.</p>
<p>Chaque job réalise des actions en fonction du niveau d’exécution du noyau.</p>
<p><strong>init</strong> se charge de maintenir les jobs opérationnels.</p>
<p>La commande <strong>initctl</strong> permet de communiquer avec <strong>init</strong>.</p>
<p>La liste des jobs démarrés est donnés par <strong>initctl list</strong> :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">root</span><span class="nd">@luciole</span><span class="p">:</span><span class="o">~</span><span class="c1"># initctl list</span>
<span class="n">control</span><span class="o">-</span><span class="n">alt</span><span class="o">-</span><span class="n">delete</span> <span class="p">(</span><span class="n">stop</span><span class="p">)</span> <span class="n">waiting</span>
<span class="n">last</span><span class="o">-</span><span class="n">good</span><span class="o">-</span><span class="n">boot</span> <span class="p">(</span><span class="n">stop</span><span class="p">)</span> <span class="n">waiting</span>
<span class="n">logd</span> <span class="p">(</span><span class="n">stop</span><span class="p">)</span> <span class="n">waiting</span>
<span class="n">rc</span><span class="o">-</span><span class="n">default</span> <span class="p">(</span><span class="n">stop</span><span class="p">)</span> <span class="n">waiting</span>
<span class="n">rc0</span> <span class="p">(</span><span class="n">stop</span><span class="p">)</span> <span class="n">waiting</span>
<span class="n">rc1</span> <span class="p">(</span><span class="n">stop</span><span class="p">)</span> <span class="n">waiting</span>
<span class="n">rc2</span> <span class="p">(</span><span class="n">stop</span><span class="p">)</span> <span class="n">waiting</span>
<span class="n">rc3</span> <span class="p">(</span><span class="n">stop</span><span class="p">)</span> <span class="n">waiting</span>
<span class="n">rc4</span> <span class="p">(</span><span class="n">stop</span><span class="p">)</span> <span class="n">waiting</span>
<span class="n">rc5</span> <span class="p">(</span><span class="n">stop</span><span class="p">)</span> <span class="n">waiting</span>
<span class="n">rc6</span> <span class="p">(</span><span class="n">stop</span><span class="p">)</span> <span class="n">waiting</span>
<span class="n">rcS</span> <span class="p">(</span><span class="n">stop</span><span class="p">)</span> <span class="n">waiting</span>
<span class="n">rcS</span><span class="o">-</span><span class="n">sulogin</span> <span class="p">(</span><span class="n">stop</span><span class="p">)</span> <span class="n">waiting</span>
<span class="n">sulogin</span> <span class="p">(</span><span class="n">stop</span><span class="p">)</span> <span class="n">waiting</span>
<span class="n">tty1</span> <span class="p">(</span><span class="n">start</span><span class="p">)</span> <span class="n">running</span><span class="p">,</span> <span class="n">process</span> <span class="mi">10354</span>
<span class="n">tty2</span> <span class="p">(</span><span class="n">start</span><span class="p">)</span> <span class="n">running</span><span class="p">,</span> <span class="n">process</span> <span class="mi">8436</span>
<span class="n">tty3</span> <span class="p">(</span><span class="n">start</span><span class="p">)</span> <span class="n">running</span><span class="p">,</span> <span class="n">process</span> <span class="mi">8437</span>
<span class="n">tty4</span> <span class="p">(</span><span class="n">start</span><span class="p">)</span> <span class="n">running</span><span class="p">,</span> <span class="n">process</span> <span class="mi">8429</span>
<span class="n">tty5</span> <span class="p">(</span><span class="n">start</span><span class="p">)</span> <span class="n">running</span><span class="p">,</span> <span class="n">process</span> <span class="mi">8430</span>
<span class="n">tty6</span> <span class="p">(</span><span class="n">start</span><span class="p">)</span> <span class="n">running</span><span class="p">,</span> <span class="n">process</span> <span class="mi">8439</span>
</pre></div>
</div>
<p>Le lancement d’un job se fait par <em>initctl start rc0</em>, son arrêt par <em>initctl stop rc0</em>.</p>
<p>Liens :</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="http://www.digitbooks.fr/articles/2-upstart.html">http://www.digitbooks.fr/articles/2-upstart.html</a></p></li>
</ul>
</div></blockquote>
</section>
<section id="les-niveaux-d-execution-run-level">
<h3><a class="toc-backref" href="#id239"><span class="sectnum">1.15.6</span> Les niveaux d’exécution (Run level)</a><a class="headerlink" href="#les-niveaux-d-execution-run-level" title="Lien permanent vers ce titre">¶</a></h3>
<p>Signification des niveaux pour Ubuntu :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Niveau</span> <span class="n">S</span> <span class="p">:</span> <span class="n">Initialisation</span> <span class="n">du</span> <span class="n">système</span> <span class="p">(</span><span class="n">le</span> <span class="n">système</span> <span class="n">de</span> <span class="n">fichier</span> <span class="n">est</span> <span class="n">en</span> <span class="n">read</span> <span class="n">only</span><span class="p">),</span>
<span class="n">Niveau</span> <span class="mi">0</span> <span class="p">:</span> <span class="n">Extinction</span><span class="p">,</span>
<span class="n">Niveau</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">Mode</span> <span class="n">mono</span> <span class="n">utilisateur</span><span class="p">,</span>
<span class="n">Niveau</span> <span class="mi">2</span> <span class="n">et</span> <span class="mi">5</span> <span class="p">:</span> <span class="n">Mode</span> <span class="n">multi</span><span class="o">-</span><span class="n">utilisateur</span> <span class="n">avec</span> <span class="n">réseau</span> <span class="n">avec</span> <span class="n">démarrage</span> <span class="n">du</span> <span class="n">serveur</span> <span class="n">X</span><span class="p">,</span>
<span class="n">Niveau</span> <span class="mi">6</span> <span class="p">:</span> <span class="n">Reboot</span><span class="o">.</span>
</pre></div>
</div>
</section>
<section id="le-systeme-de-demarrage-des-services">
<h3><a class="toc-backref" href="#id240"><span class="sectnum">1.15.7</span> Le système de démarrage des services</a><a class="headerlink" href="#le-systeme-de-demarrage-des-services" title="Lien permanent vers ce titre">¶</a></h3>
<p>Lors du lancement d”<em>init</em> par le noyau, celui-ci transmet l’information de niveau à exécuter.</p>
<p>Ainsi <em>init</em> lance les jobs en leur précisant le niveau demandé.</p>
<p>Le job <em>rc5</em> lance <em>/,etc/init.d/rc 5</em>, qui à son tour va lancer les scripts contenus dans <em>/,etc/rc5.d</em> selon l’ordre lexicographique.</p>
<p>Les répertoires <em>/,etc/rcX.d</em> contiennent des liens vers les scripts de <em>/,etc/init.d</em>.</p>
<p>Les scripts contenus dans <em>/,etc/init.d</em> permettent de démarrer, arrêter, ou connaître le statut des démons.</p>
</section>
<section id="changement-du-niveau-d-execution">
<h3><a class="toc-backref" href="#id241"><span class="sectnum">1.15.8</span> Changement du niveau d’exécution</a><a class="headerlink" href="#changement-du-niveau-d-execution" title="Lien permanent vers ce titre">¶</a></h3>
<p>Il est possible de changer le niveau d’exécution.</p>
<p>Exemple pour arrêter la machine :</p>
<blockquote>
<div><p><strong>initctl emit runlevel 0</strong></p>
</div></blockquote>
</section>
</section>
<section id="modules">
<h2><a class="toc-backref" href="#id242"><span class="sectnum">1.16</span> Modules</a><a class="headerlink" href="#modules" title="Lien permanent vers ce titre">¶</a></h2>
<p>Le noyau Linux est modulaire.</p>
<p>La gestion de nombreux périphériques n’est pas faite dans le noyau, mais dans des modules qui sont chargés à la demande.</p>
<p>La commande <strong>modprobe</strong> permet de charger un module directement par son nom.</p>
<p>La commande <strong>lsmod</strong> permet de connaître les modules déjà chargés.</p>
<p>La commande <strong>rmmod</strong> permet de supprimer un module du noyau.</p>
<p>Il est possible d’intégrer définitivement les modules au noyau en recompilant celui-ci.</p>
</section>
<section id="configuration-reseau-et-outils-tcp-ip">
<h2><a class="toc-backref" href="#id243"><span class="sectnum">1.17</span> Configuration réseau et outils TCP/IP</a><a class="headerlink" href="#configuration-reseau-et-outils-tcp-ip" title="Lien permanent vers ce titre">¶</a></h2>
<section id="id5">
<h3><a class="toc-backref" href="#id244"><span class="sectnum">1.17.1</span> Introduction</a><a class="headerlink" href="#id5" title="Lien permanent vers ce titre">¶</a></h3>
<p>L’unix BSD a été l’une des premières plateformes à supporter la pile protocolaire TCP/IP.</p>
<p>Dans cette tradition GNU/Linux regorge d’outils TCP, UDP, ICMP.</p>
<p>TCP signifie Transmission Control Protocol.</p>
<p>IP : Internet Protocol.</p>
<p>UDP : User Datagram Protocol.</p>
<p>ICMP : Internet Control Message Protocol.</p>
<p>Sous Ubuntu l’installation configure l’interface réseau en client DHCP (Dynamique Host Configuration Protocol).</p>
<p>De nombreux programmes communiquent entre eux sur la machine en utilisant l’interface réseau <em>loopback</em> de nom <em>localhost</em> et d’adresse <em>127.0.0.1</em> et ceci alors même que la connexion ne sort pas de la machine.</p>
<p>Liens :</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="http://fr.wikipedia.org/wiki/Tcp">http://fr.wikipedia.org/wiki/Tcp</a></p></li>
<li><p><a class="reference external" href="http://fr.wikipedia.org/wiki/Internet_Protocol">http://fr.wikipedia.org/wiki/Internet_Protocol</a></p></li>
</ul>
</div></blockquote>
</section>
<section id="configuration-automatique">
<h3><a class="toc-backref" href="#id245"><span class="sectnum">1.17.2</span> Configuration automatique</a><a class="headerlink" href="#configuration-automatique" title="Lien permanent vers ce titre">¶</a></h3>
<p>Le protocole DHCP permet de demander à un serveur une adresse IP ainsi que les paramètres de connexion tels que le masque de sous réseau, les DNS, la passerelle.</p>
<p>La commande <strong>dhclient</strong>, permet de relancer la négociation avec le serveur.</p>
<p>Infos : <a class="reference external" href="http://fr.wikipedia.org/wiki/DHCP">http://fr.wikipedia.org/wiki/DHCP</a></p>
</section>
<section id="la-commande-ip">
<h3><a class="toc-backref" href="#id246"><span class="sectnum">1.17.3</span> La commande ip</a><a class="headerlink" href="#la-commande-ip" title="Lien permanent vers ce titre">¶</a></h3>
<p>La commande ip permet d’afficher et modifier toutes les interfaces réseau.</p>
<p>ip addr : Affiche les adresses ip et toutes les informations.
ip addr show dev em1 : Affiche les informations pour le périphérique em1
ip addr add 192.168.1.1/24 dev em1 : Ajoute l’adresse 192.168.1.1 avec le masque 24 au périphérique em1.</p>
<p>ip link : Gère et affiche toutes les interfaces réseaux.
ip link show dev em1 : Affiche les informations pour em1.
ip -s link : ffiche les interfaces statiques.
ip link set dev eno12345678 up : Met en fonctionnement l’interface eno12345678.
ip link set dev eno12345678 down : Éteint l’interface eno12345678.</p>
<p>ip route : Affiche et permet la modification de la table de routage.</p>
<p>ip maddr : Affiche et permet la gestion des adresses multicast.
ip maddr show dev em1 : Affiche les informations multicast de em1</p>
<p>ip neigh : Affiche les objets voisins c’est-à-dire la table ARP pour IPv4.
ip neigh show dev em1 : Affiche le cache ARP de l’interface em1</p>
<p>La commande ip permet de consulter et changer l’état ou les paramètres de tous les types de périphériques réseau.
Elle remplace les commandes ifconfig, iwconfig, ifup/ifdown, route que nous détaillerons ci-après, car elles sont encore proposées par certaines docs.</p>
<p>voir :</p>
<p><a class="reference external" href="http://cpham.perso.univ-pau.fr/ENSEIGNEMENT/UERHD/DescriptifCmdIP.pdf">http://cpham.perso.univ-pau.fr/ENSEIGNEMENT/UERHD/DescriptifCmdIP.pdf</a></p>
<p><a class="reference external" href="https://access.redhat.com/sites/default/files/attachments/rh_ip_command_cheatsheet_1214_jcs_print.pdf">https://access.redhat.com/sites/default/files/attachments/rh_ip_command_cheatsheet_1214_jcs_print.pdf</a></p>
</section>
<section id="ifconfig-deprecie">
<h3><a class="toc-backref" href="#id247"><span class="sectnum">1.17.4</span> ifconfig (déprécié)</a><a class="headerlink" href="#ifconfig-deprecie" title="Lien permanent vers ce titre">¶</a></h3>
<p>La commande <strong>ifconfig</strong> permet à la fois de consulter les paramètres réseau, mais également de configurer les interfaces.
Cette commande est aujourd’hui obsolète et remplacée par <strong>ip</strong> que nous détaillerons ci-après, on peut l’installer avec <strong>apt install net-tools</strong>.
Toutefois elle est beaucoup plus simple, mais moins complète que <strong>ip</strong> .</p>
<p>Exemple de configuration :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">root</span><span class="nd">@luciole</span><span class="p">:</span><span class="o">~</span><span class="c1"># ifconfig eth0 192.168.0.7 netmask 255.255.255.0</span>
</pre></div>
</div>
<p>La configuration ainsi réalisée n’est pas permanent, elle sera perdue au prochain démarrage.</p>
<p>Pour modifier de façon permanente la configuration réseau il faut éditer <em>/,etc/network/interfaces</em>.</p>
<p><strong>ifconfig</strong> est remplacé par la commande <strong>ip addr</strong> ou <strong>ip a</strong>
<strong>ifconfig eth0 192.168.0.11</strong> est remplacé par <strong>ip addr add 192.168.0.11/255.255.255.0 dev enxe4b97aef38eb</strong>
Les noms comme eth0 sont remplacés par la convention de nommage <strong>ifname</strong> pour éviter le changement de nom lors du reboot.</p>
</section>
<section id="iwconfig-deprecie">
<h3><a class="toc-backref" href="#id248"><span class="sectnum">1.17.5</span> iwconfig (déprécié)</a><a class="headerlink" href="#iwconfig-deprecie" title="Lien permanent vers ce titre">¶</a></h3>
<p>La commande <strong>iwconfig</strong> permet de configurer les cartes wifi.</p>
</section>
<section id="ifup-ifdown-deprecie">
<h3><a class="toc-backref" href="#id249"><span class="sectnum">1.17.6</span> ifup/ifdown (déprécié)</a><a class="headerlink" href="#ifup-ifdown-deprecie" title="Lien permanent vers ce titre">¶</a></h3>
<p>La commande <strong>ifup</strong> permet de démarrer une interface réseau en fonction de la configuration indiquée dans <em>/,etc/network/interfaces</em>
Remplacée par <strong>ip link set NOM_PERIPHERIQUE up</strong></p>
<p>La commande <strong>ifdown</strong> permet de l’arrêter.
Remplacée par <strong>ip link set NOM_PERIPHERIQUE down</strong></p>
</section>
<section id="route-deprecie">
<h3><a class="toc-backref" href="#id250"><span class="sectnum">1.17.7</span> route (déprécié)</a><a class="headerlink" href="#route-deprecie" title="Lien permanent vers ce titre">¶</a></h3>
<p>La commande <strong>route</strong> permet de consulter et de fixer l’adresse de la passerelle :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">root</span><span class="nd">@luciole</span><span class="p">:</span><span class="o">~</span><span class="c1"># route add default gw 192.168.0.1</span>
</pre></div>
</div>
<p>Remplacée par <strong>ip route</strong></p>
<p>En consultation elle est identique à <strong>netstat -nr</strong></p>
</section>
<section id="ip">
<h3><a class="toc-backref" href="#id251"><span class="sectnum">1.17.8</span> ip</a><a class="headerlink" href="#ip" title="Lien permanent vers ce titre">¶</a></h3>
<p>La commande ip est le couteau suisse de la configuration réseau, son paquet <strong>iproute2</strong> remplace les commandes du paquet <strong>net-tools</strong> :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Attribuer</span> <span class="n">une</span> <span class="n">adresse</span> <span class="p">:</span> <span class="p">::</span>

  <span class="n">ip</span> <span class="n">addr</span> <span class="n">add</span> <span class="mf">192.168.0.54</span><span class="o">/</span><span class="mi">24</span> <span class="n">dev</span> <span class="n">eth0</span>

<span class="n">Connaître</span> <span class="n">son</span> <span class="n">adresse</span> <span class="p">:</span> <span class="p">::</span>

  <span class="n">ip</span> <span class="o">-</span><span class="mi">4</span><span class="n">c</span> <span class="n">addr</span> <span class="n">show</span> <span class="c1">#-4 affiche uniquement les IPv4, -c pour l&#39;affichage couleur</span>

<span class="n">Activer</span> <span class="n">une</span> <span class="n">interface</span> <span class="n">réseau</span> <span class="p">:</span> <span class="p">::</span>

  <span class="n">ip</span> <span class="n">link</span> <span class="nb">set</span> <span class="n">eth0</span> <span class="n">update</span>

<span class="n">Désactiver</span> <span class="n">une</span> <span class="n">interface</span> <span class="n">réseau</span> <span class="p">:</span> <span class="p">::</span>

  <span class="n">ip</span> <span class="n">link</span> <span class="nb">set</span> <span class="n">eth0</span> <span class="n">down</span>

<span class="n">Supprimer</span> <span class="n">une</span> <span class="n">adresse</span> <span class="n">d</span><span class="s1">&#39;une interface : ::</span>

  <span class="n">ip</span> <span class="n">addr</span> <span class="k">del</span> <span class="mf">192.168.0.54</span> <span class="n">dev</span> <span class="n">eth0</span>

<span class="n">Ajouter</span> <span class="n">une</span> <span class="n">gateway</span> <span class="p">:</span> <span class="p">::</span>

  <span class="n">ip</span> <span class="n">route</span> <span class="n">add</span> <span class="n">default</span> <span class="n">via</span> <span class="mf">192.168.0.1</span>
</pre></div>
</div>
</section>
<section id="les-interfaces-virtuelles">
<h3><a class="toc-backref" href="#id252"><span class="sectnum">1.17.9</span> Les interfaces virtuelles</a><a class="headerlink" href="#les-interfaces-virtuelles" title="Lien permanent vers ce titre">¶</a></h3>
<p>La création d’interfaces virtuelles permet de donner plusieurs adresses IP à une même carte réseau.</p>
<p>Cela permet par exemple de créer une adresse ip fixe pour une entrée DNS tout en la redirigeant via l’interface du datacenter vers une autre ip.</p>
<p>La ligne de commande est du type :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ip</span> <span class="n">link</span> <span class="n">add</span> <span class="n">link</span> <span class="n">DEVICE</span> <span class="n">name</span> <span class="n">NAME</span> <span class="nb">type</span> <span class="n">vlan</span>
</pre></div>
</div>
<p>Voir <a class="reference external" href="https://www.systutorials.com/docs/linux/man/8-ip-link/">https://www.systutorials.com/docs/linux/man/8-ip-link/</a></p>
</section>
<section id="fixer-le-nom-de-machine">
<h3><a class="toc-backref" href="#id253"><span class="sectnum">1.17.10</span> Fixer le nom de machine</a><a class="headerlink" href="#fixer-le-nom-de-machine" title="Lien permanent vers ce titre">¶</a></h3>
<p>La commande <strong>hostname</strong> permet à la fois de consulter et de changer le nom de la machine.</p>
<p>Il est maintenant souhaitable d’utiliser la commande <strong>hostnamectl</strong> par exemple comme suit :</p>
<blockquote>
<div><p>hostnamectl set-hostname luciole</p>
</div></blockquote>
<p>En effet de nombreuse machines recoivent leur nom par la couche réseau lors du boot comme par exemple les images cloud.</p>
<p>Attention il ne s’agit pas du Fully Qualified Domain Name, mais seulement du nom de la machine sans le nom de domaine.</p>
<p>Il est possible aussi de modifier le nom de façon définitive via le fichier /,etc/hostname</p>
</section>
<section id="positionner-le-reverse">
<h3><a class="toc-backref" href="#id254"><span class="sectnum">1.17.11</span> Positionner le reverse</a><a class="headerlink" href="#positionner-le-reverse" title="Lien permanent vers ce titre">¶</a></h3>
<p>Pour ne pas être considéré comme spameur lors de l’envoi de mail il faut positionner le « reverse » du serveur sur le même Full Qualified Domain Name (fqdn), c’est-à-dire que si on fait une recherche du nom de la machine à partir de son adresse ip, le résultat doit être le nom de la machine suivi de son domaine.
Pour cela il faut</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span> <span class="n">Vérifier</span> <span class="n">que</span> <span class="n">dans</span> <span class="n">la</span> <span class="n">zone</span> <span class="n">DNS</span> <span class="n">de</span> <span class="n">notre</span> <span class="n">registrar</span><span class="p">,</span> <span class="n">là</span> <span class="n">où</span> <span class="n">on</span> <span class="n">a</span> <span class="n">enregistré</span> <span class="n">le</span> <span class="n">nom</span> <span class="n">de</span> <span class="n">notre</span> <span class="n">domaine</span><span class="p">,</span> <span class="n">on</span> <span class="n">a</span> <span class="n">bien</span> <span class="n">un</span> <span class="n">champ</span> <span class="n">A</span> <span class="n">qui</span> <span class="n">corresponde</span> <span class="n">à</span> <span class="n">l</span><span class="s1">&#39;adresse de la machine ;</span>
<span class="o">-</span> <span class="n">Aller</span> <span class="n">sur</span> <span class="n">l</span><span class="s1">&#39;interface d&#39;</span><span class="n">administration</span> <span class="n">du</span> <span class="n">serveur</span> <span class="p">(</span><span class="n">Scaleway</span><span class="p">,</span> <span class="n">OVH</span><span class="p">,</span> <span class="n">Gandi</span><span class="p">,</span> <span class="n">etc</span><span class="p">)</span> <span class="p">;</span>
<span class="o">-</span> <span class="n">Modifier</span> <span class="n">le</span> <span class="n">reverse</span> <span class="n">en</span> <span class="n">donnant</span> <span class="n">le</span> <span class="n">fqdn</span> <span class="n">de</span> <span class="n">la</span> <span class="n">machine</span><span class="o">.</span>
</pre></div>
</div>
<p>Pour vérifier, il suffira de comparer l’adresse obtenue avec « dig $FQDN_Du_Serveur » avec « dig -x $IP_Du_Serveur ».</p>
</section>
<section id="demarrage-et-arret-du-reseau">
<h3><a class="toc-backref" href="#id255"><span class="sectnum">1.17.12</span> Démarrage et arrêt du réseau</a><a class="headerlink" href="#demarrage-et-arret-du-reseau" title="Lien permanent vers ce titre">¶</a></h3>
<p>La commande <strong>/,etc/init.d/networking start</strong> permet de démarrer la couche réseau.</p>
</section>
<section id="la-resolution-de-nom">
<h3><a class="toc-backref" href="#id256"><span class="sectnum">1.17.13</span> La résolution de nom</a><a class="headerlink" href="#la-resolution-de-nom" title="Lien permanent vers ce titre">¶</a></h3>
<p>La commande <strong>dig</strong> permet de réaliser la résolution de nom.</p>
<p>La commande <strong>dig -x $ADRESSE_IP</strong> permet de réaliser la résolution inverse.</p>
<p>Le fichier <strong>/,etc/resolv.conf</strong> est utilisé pour connaître les adresses des DNS.</p>
</section>
<section id="la-modification-du-fichier-etc-hosts">
<h3><a class="toc-backref" href="#id257"><span class="sectnum">1.17.14</span> La modification du fichier /,etc/hosts</a><a class="headerlink" href="#la-modification-du-fichier-etc-hosts" title="Lien permanent vers ce titre">¶</a></h3>
<p>Le fichier <em>/,etc/hosts</em> contient les adresses et noms des machines connues.</p>
<p>On y trouve au minimum la définition du loopback et de la machine.</p>
<p>Les valeurs qui y sont priment sur la résolution DNS.</p>
<p>Exemple :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>michaellaunay@griffon:~$ cat /etc/hosts
127.0.0.1     localhost griffon griffon.ecreall.com
88.191.77.45    griffon.ecreall.com
</pre></div>
</div>
<p>La modification est triviale puisqu’il suffit d’ajouter une ligne $Adresse $Nom1 $Nom2.</p>
</section>
<section id="les-outils-et-commandes-de-tests-reseau">
<h3><a class="toc-backref" href="#id258"><span class="sectnum">1.17.15</span> Les outils et commandes de tests réseau</a><a class="headerlink" href="#les-outils-et-commandes-de-tests-reseau" title="Lien permanent vers ce titre">¶</a></h3>
<section id="ping">
<h4><a class="toc-backref" href="#id259"><span class="sectnum">1.17.15.1</span> ping</a><a class="headerlink" href="#ping" title="Lien permanent vers ce titre">¶</a></h4>
<p>La commande <strong>ping</strong> permet d’envoyer des paquets ICMP à une machine distante pour tester la connectivité du réseau.</p>
</section>
<section id="host">
<h4><a class="toc-backref" href="#id260"><span class="sectnum">1.17.15.2</span> host</a><a class="headerlink" href="#host" title="Lien permanent vers ce titre">¶</a></h4>
<p>Un autre utilitaire de résolution de nom de domaine.
Traceroute
++++++++++</p>
<p>La commande <strong>traceroute</strong> permet de connaître les noeuds du réseau nous séparant d’un machine cible.</p>
</section>
<section id="netstat">
<h4><a class="toc-backref" href="#id261"><span class="sectnum">1.17.15.3</span> netstat</a><a class="headerlink" href="#netstat" title="Lien permanent vers ce titre">¶</a></h4>
<p>La commande <strong>netstat</strong> permet de connaître le statut des connexions réseaux.</p>
<p><strong>netstat -tp</strong> permet de voir les connexions restées ouvertes et les processus associés.</p>
<p>Exemple :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">root</span><span class="nd">@luciole</span><span class="p">:</span><span class="o">~</span><span class="c1"># netstat -taupe</span>
<span class="n">Connexions</span> <span class="n">Internet</span> <span class="n">actives</span> <span class="p">(</span><span class="n">serveurs</span> <span class="n">et</span> <span class="n">établies</span><span class="p">)</span>
<span class="n">Proto</span> <span class="n">Recv</span><span class="o">-</span><span class="n">Q</span> <span class="n">Send</span><span class="o">-</span><span class="n">Q</span> <span class="n">Adresse</span> <span class="n">locale</span>          <span class="n">Adresse</span> <span class="n">distante</span>        <span class="n">Etat</span>       <span class="n">User</span>       <span class="n">Inode</span>       <span class="n">PID</span><span class="o">/</span><span class="n">Program</span> <span class="n">name</span>
<span class="n">tcp</span>        <span class="mi">0</span>      <span class="mi">0</span> <span class="n">luciole</span><span class="o">.</span><span class="n">local</span><span class="p">:</span><span class="mi">34978</span>     <span class="n">ecs</span><span class="o">.</span><span class="n">amazonaws</span><span class="o">.</span><span class="n">com</span><span class="p">:</span><span class="n">www</span>   <span class="n">ESTABLISHED</span> <span class="n">michaellaunay</span> <span class="mi">53652</span>       <span class="mi">11400</span><span class="o">/</span><span class="n">gvfsd</span><span class="o">-</span><span class="n">http</span>
<span class="n">tcp</span>        <span class="mi">1</span>      <span class="mi">0</span> <span class="n">luciole</span><span class="o">.</span><span class="n">local</span><span class="p">:</span><span class="mi">35516</span>     <span class="n">ecs</span><span class="o">.</span><span class="n">amazonaws</span><span class="o">.</span><span class="n">com</span><span class="p">:</span><span class="n">www</span>   <span class="n">CLOSE_WAIT</span>  <span class="n">michaellaunay</span> <span class="mi">50142</span>       <span class="mi">11400</span><span class="o">/</span><span class="n">gvfsd</span><span class="o">-</span><span class="n">http</span>
<span class="n">tcp</span>        <span class="mi">1</span>      <span class="mi">0</span> <span class="n">luciole</span><span class="o">.</span><span class="n">local</span><span class="p">:</span><span class="mi">50217</span>     <span class="n">ecs</span><span class="o">.</span><span class="n">amazonaws</span><span class="o">.</span><span class="n">com</span><span class="p">:</span><span class="n">www</span>   <span class="n">CLOSE_WAIT</span>  <span class="n">michaellaunay</span> <span class="mi">53380</span>       <span class="mi">11400</span><span class="o">/</span><span class="n">gvfsd</span><span class="o">-</span><span class="n">http</span>
<span class="n">tcp</span>        <span class="mi">1</span>      <span class="mi">0</span> <span class="n">luciole</span><span class="o">.</span><span class="n">local</span><span class="p">:</span><span class="mi">35515</span>     <span class="n">ecs</span><span class="o">.</span><span class="n">amazonaws</span><span class="o">.</span><span class="n">com</span><span class="p">:</span><span class="n">www</span>   <span class="n">CLOSE_WAIT</span>  <span class="n">michaellaunay</span> <span class="mi">50135</span>       <span class="mi">11400</span><span class="o">/</span><span class="n">gvfsd</span><span class="o">-</span><span class="n">http</span>
<span class="n">tcp</span>        <span class="mi">0</span>      <span class="mi">0</span> <span class="n">luciole</span><span class="o">.</span><span class="n">local</span><span class="p">:</span><span class="mi">34979</span>     <span class="n">ecs</span><span class="o">.</span><span class="n">amazonaws</span><span class="o">.</span><span class="n">com</span><span class="p">:</span><span class="n">www</span>   <span class="n">ESTABLISHED</span> <span class="n">michaellaunay</span> <span class="mi">53668</span>       <span class="mi">11400</span><span class="o">/</span><span class="n">gvfsd</span><span class="o">-</span><span class="n">http</span>
</pre></div>
</div>
<p>Permet de voir des connexions en direction du cloud d’Amazon, un <em>cat /proc/11400/cmd</em> donne :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">root</span><span class="nd">@luciole</span><span class="p">:</span><span class="o">~</span><span class="c1"># cat /proc/11400/cmd</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">gvfs</span><span class="o">/</span><span class="n">gvfsd</span><span class="o">-</span><span class="n">http</span><span class="o">--</span><span class="n">spawner</span><span class="p">:</span><span class="mf">1.82</span><span class="o">/</span><span class="n">org</span><span class="o">/</span><span class="n">gtk</span><span class="o">/</span><span class="n">gvfs</span><span class="o">/</span><span class="n">exec_spaw</span><span class="o">/</span><span class="mi">0</span>
</pre></div>
</div>
<p>On voit que la commande est <em>spawnée</em> ce qui signifie que si on la <em>kill</em> elle sera relancée par le système.</p>
<p>Après quelques recherches, il s’avère que c’est l’application <em>Rhythmbox</em> qui va chercher les couvertures des albums écoutés en utilisant le service gvfs.</p>
</section>
<section id="tcpdump">
<h4><a class="toc-backref" href="#id262"><span class="sectnum">1.17.15.4</span> tcpdump</a><a class="headerlink" href="#tcpdump" title="Lien permanent vers ce titre">¶</a></h4>
<p>La commande <strong>tcpdump</strong> permet « d’espionner » ce qui se passe sur nos interfaces réseau.</p>
</section>
<section id="nmap">
<h4><a class="toc-backref" href="#id263"><span class="sectnum">1.17.15.5</span> nmap</a><a class="headerlink" href="#nmap" title="Lien permanent vers ce titre">¶</a></h4>
<p>La commande <strong>nmap</strong> permet de scanner les ports d’une machine et donc de faire un diagnostic des éventuelles portes d’entrée.</p>
</section>
<section id="ngrep">
<h4><a class="toc-backref" href="#id264"><span class="sectnum">1.17.15.6</span> ngrep</a><a class="headerlink" href="#ngrep" title="Lien permanent vers ce titre">¶</a></h4>
<p>La commande <strong>ngrep</strong> permet de n’afficher les paquets réseau qu’à la condition qu’ils contiennent la chaîne cherchée.</p>
</section>
<section id="wireshark">
<h4><a class="toc-backref" href="#id265"><span class="sectnum">1.17.15.7</span> wireshark</a><a class="headerlink" href="#wireshark" title="Lien permanent vers ce titre">¶</a></h4>
<p>Elle permet d’ausculter les paquets réseau comme ceux enregistrés par <strong>tcpdump</strong>.</p>
</section>
<section id="last">
<h4><a class="toc-backref" href="#id266"><span class="sectnum">1.17.15.8</span> last</a><a class="headerlink" href="#last" title="Lien permanent vers ce titre">¶</a></h4>
<p>La commande <strong>last</strong> permet de connaître les derniers <em>login</em> réalisés sur la machine, leur date et adresse d’origine.</p>
</section>
</section>
</section>
<section id="gestion-des-paquetages-et-installation-de-logiciels-sous-ubuntu">
<h2><a class="toc-backref" href="#id267"><span class="sectnum">1.18</span> Gestion des paquetages et installation de logiciels sous Ubuntu</a><a class="headerlink" href="#gestion-des-paquetages-et-installation-de-logiciels-sous-ubuntu" title="Lien permanent vers ce titre">¶</a></h2>
<section id="ubuntu-un-systeme-grand-public">
<h3><a class="toc-backref" href="#id268"><span class="sectnum">1.18.1</span> Ubuntu, un système « Grand Public »</a><a class="headerlink" href="#ubuntu-un-systeme-grand-public" title="Lien permanent vers ce titre">¶</a></h3>
<p>Ubuntu simplifie extrêmement l’installation et devient donc facile d’accès pour un non linuxien.</p>
</section>
<section id="quelle-version-choisir-et-pour-quel-usage">
<h3><a class="toc-backref" href="#id269"><span class="sectnum">1.18.2</span> Quelle version choisir et pour quel usage ?</a><a class="headerlink" href="#quelle-version-choisir-et-pour-quel-usage" title="Lien permanent vers ce titre">¶</a></h3>
<p>Il existe deux types de versions :</p>
<blockquote>
<div><ul class="simple">
<li><p>Une version serveur, dépouillée d’interface graphique, permettant d’utiliser RAID et LVM,</p></li>
<li><p>Une version pc de bureau, utilisant Gnome.</p></li>
</ul>
</div></blockquote>
</section>
<section id="les-depots">
<h3><a class="toc-backref" href="#id270"><span class="sectnum">1.18.3</span> Les dépôts</a><a class="headerlink" href="#les-depots" title="Lien permanent vers ce titre">¶</a></h3>
<p>Nous avons vu précédemment la gestion graphique des dépôts.</p>
<p>Nous pouvons éditer le fichier <em>/,etc/apt/sources.list</em> et ajouter des dépôts.</p>
<p>Exemple :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">echo</span> <span class="s2">&quot;deb http://packages.medibuntu.org/ karmic free non-free&quot;</span> <span class="o">&gt;&gt;</span> <span class="o">/</span><span class="p">,</span><span class="n">etc</span><span class="o">/</span><span class="n">apt</span><span class="o">/</span><span class="n">sources</span><span class="o">.</span><span class="n">list</span><span class="o">*</span>
</pre></div>
</div>
<p>Toutefois il faudra télécharger la clé d’authentification du nouveau dépôt et l’ajouter avec  :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wget</span> <span class="o">-</span><span class="n">q</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">fr</span><span class="o">.</span><span class="n">packages</span><span class="o">.</span><span class="n">medibuntu</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">medibuntu</span><span class="o">-</span><span class="n">key</span><span class="o">.</span><span class="n">gpg</span> <span class="o">-</span><span class="n">O</span><span class="o">-</span> <span class="o">|</span> <span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">key</span> <span class="n">add</span> <span class="o">-</span>
</pre></div>
</div>
<p>Puis mettre à jour le cache avec <strong>apt update</strong></p>
</section>
<section id="installation-de-paquets">
<h3><a class="toc-backref" href="#id271"><span class="sectnum">1.18.4</span> Installation de paquets</a><a class="headerlink" href="#installation-de-paquets" title="Lien permanent vers ce titre">¶</a></h3>
<p>La commande <strong>apt install $NOM_PAQUET</strong> permet d’installer des paquets :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">apt</span> <span class="n">install</span> <span class="n">libdvdread7</span> <span class="n">mkisofs</span> <span class="n">dvdbackup</span> <span class="n">dvdauthor</span> <span class="n">oggvideotools</span> <span class="n">ffmpeg</span>
<span class="n">apt</span> <span class="n">install</span> <span class="n">libavcodec</span><span class="o">-</span><span class="mi">58</span> <span class="n">libavdevice58</span> <span class="n">libavformat58</span>
</pre></div>
</div>
</section>
<section id="suppression-de-paquets">
<h3><a class="toc-backref" href="#id272"><span class="sectnum">1.18.5</span> Suppression de paquets</a><a class="headerlink" href="#suppression-de-paquets" title="Lien permanent vers ce titre">¶</a></h3>
<p>Pour supprimer un paquet on utilise <strong>apt remove $NOM_PAQUET</strong>.</p>
</section>
<section id="informations-sur-les-paquetages">
<h3><a class="toc-backref" href="#id273"><span class="sectnum">1.18.6</span> Informations sur les paquetages</a><a class="headerlink" href="#informations-sur-les-paquetages" title="Lien permanent vers ce titre">¶</a></h3>
<p>Pour avoir la liste des paquets installés <strong>dpkg -l</strong>.</p>
</section>
<section id="recherche-de-paquetages">
<h3><a class="toc-backref" href="#id274"><span class="sectnum">1.18.7</span> Recherche de paquetages</a><a class="headerlink" href="#recherche-de-paquetages" title="Lien permanent vers ce titre">¶</a></h3>
<p>La commande <strong>apt search $MOT_CLE</strong> permet de chercher un paquet à partir d’un mot de sa description.</p>
</section>
<section id="mise-a-jour-des-paquetages">
<h3><a class="toc-backref" href="#id275"><span class="sectnum">1.18.8</span> Mise à jour des paquetages</a><a class="headerlink" href="#mise-a-jour-des-paquetages" title="Lien permanent vers ce titre">¶</a></h3>
<p>Pour mettre à jour la distribution :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">apt</span> <span class="n">update</span>
<span class="n">apt</span> <span class="n">upgrade</span>
</pre></div>
</div>
</section>
<section id="installation-avec-parametrage">
<h3><a class="toc-backref" href="#id276"><span class="sectnum">1.18.9</span> Installation avec paramétrage</a><a class="headerlink" href="#installation-avec-parametrage" title="Lien permanent vers ce titre">¶</a></h3>
<p>Pour installer un paquet en fournissant les réponses aux questions interactives et donc pourvoir scripter l’installation, il faut utiliser <strong>debconf</strong>.</p>
<p>Par exemple pour connaître les paramètres du paquet <strong>postfix</strong> :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>root@luciole:~# apt install debconf
root@luciole:~# debconf-show postfix
  postfix/main_cf_conversion_warning: true
  postfix/sqlite_warning:
  postfix/recipient_delim: +
  postfix/root_address:
  postfix/not_configured:
  postfix/compat_conversion_warning: true
  postfix/tlsmgr_upgrade_warning:
  postfix/mailbox_limit: 0
  postfix/newaliases: false
  postfix/kernel_version_warning:
  postfix/retry_upgrade_warning:
  postfix/lmtp_retired_warning: true
  postfix/mydomain_warning:
  postfix/protocols: all
* postfix/main_mailer_type: Internet Site
  postfix/bad_recipient_delimiter:
  postfix/rfc1035_violation: false
  postfix/relay_restrictions_warning:
  postfix/mynetworks: 127.0.0.0/8 [::ffff:127.0.0.0]/104 [::1]/128
  postfix/dynamicmaps_conversion_warning:
  postfix/chattr: false
* postfix/mailname: luciole.ecreall.com
  postfix/procmail: false
  postfix/destinations: $myhostname, luciole.ecreall.com, localhost
  postfix/relayhost:
</pre></div>
</div>
<dl class="simple">
<dt>Puis pour fixer les valeurs<span class="classifier">::</span></dt><dd><p>debconf-set-selections</p>
</dd>
</dl>
</section>
<section id="interfaces-graphiques">
<h3><a class="toc-backref" href="#id277"><span class="sectnum">1.18.10</span> Interfaces graphiques</a><a class="headerlink" href="#interfaces-graphiques" title="Lien permanent vers ce titre">¶</a></h3>
<p>Il existe deux types d’interfaces graphiques, une en mode texte <strong>aptitude</strong> et une dans X11 <strong>synaptic</strong>.</p>
</section>
<section id="commande-alien">
<h3><a class="toc-backref" href="#id278"><span class="sectnum">1.18.11</span> Commande alien</a><a class="headerlink" href="#commande-alien" title="Lien permanent vers ce titre">¶</a></h3>
<p>La commande alien permet de transformer un paquet <em>rpm</em> en paquet debian et donc de pouvoir l’installer.</p>
</section>
</section>
<section id="apache">
<h2><a class="toc-backref" href="#id279"><span class="sectnum">1.19</span> Apache</a><a class="headerlink" href="#apache" title="Lien permanent vers ce titre">¶</a></h2>
<section id="presentation">
<h3><a class="toc-backref" href="#id280"><span class="sectnum">1.19.1</span> Présentation</a><a class="headerlink" href="#presentation" title="Lien permanent vers ce titre">¶</a></h3>
<p>Apache est un serveur web pouvant être utilisé comme proxy, cache, etc.</p>
<p>Il supporte le protocole https et est donc utilisé pour servir les applications web à sécuriser.</p>
</section>
<section id="id6">
<h3><a class="toc-backref" href="#id281"><span class="sectnum">1.19.2</span> Installation</a><a class="headerlink" href="#id6" title="Lien permanent vers ce titre">¶</a></h3>
<p>La commande <strong>apt install apache2</strong> permet d’utiliser une version récente d’Apache.</p>
</section>
<section id="configuration">
<h3><a class="toc-backref" href="#id282"><span class="sectnum">1.19.3</span> Configuration</a><a class="headerlink" href="#configuration" title="Lien permanent vers ce titre">¶</a></h3>
<p>Nous allons créer un petit site <em>www.monsite.com</em> et nous allons voir comment le sécuriser.</p>
<p>Dans un premier temps nous allons ajouter sur le poste client les entrées www.monsite.com pour réaliser des tests sans passer par le DNS.</p>
<p>Ajout de ssl.monsite.com /etc/hosts :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">192.168.0.7</span> <span class="n">www</span><span class="o">.</span><span class="n">monsite</span><span class="o">.</span><span class="n">com</span>
</pre></div>
</div>
<p>Puis sur le serveur nous allons activer les modules utilisés pour la sécurisation :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">root</span><span class="nd">@monserveur</span><span class="p">:</span><span class="o">~</span><span class="c1"># a2enmod ssl</span>
</pre></div>
</div>
<p>Cette commande créer 2 liens dans /,etc/apache2/mods-enabled pointant vers ../mods-available/ssl.conf et ../mods-available/ssl.load.</p>
<p>Pour ajouter un site, il suffit de créer un fichier de configuration dans <em>/,etc/apache2/sites-available</em> puis de l’activer :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>root@monserveur:~# vim /,etc/apache2/sites-available/www.monsite.com

  &lt;VirtualHost *:443&gt;
    ServerAdmin michaellaunay@ecreall.com
    ServerName www.monsite.com
    SSLEngine on
    SSLCipherSuite ALL:!ADH:!EXPORT56:RC4+RSA:+HIGH:+MEDIUM:+LOW:+SSLv2:+EXP
    SSLCertificateFile /etc/apache2/ssl/server.crt
    SSLCertificateKeyFile /etc/apache2/ssl/server.key
    &lt;Directory /var/www/&gt;
                  Options Indexes FollowSymLinks MultiViews
                  AllowOverride None
                  Order allow,deny
                  allow from all
    &lt;/Directory&gt;
    DocumentRoot /var/www
  &lt;/VirtualHost&gt;

  &lt;VirtualHost *:80&gt;
    ServerAdmin michaellaunay@ecreall.com
    ServerName www.monsite.com
    &lt;Directory /var/www/&gt;
                  Options Indexes FollowSymLinks MultiViews
                  AllowOverride None
                  Order allow,deny
                  allow from all
    &lt;/Directory&gt;
    DocumentRoot /var/www
  &lt;/VirtualHost&gt;
</pre></div>
</div>
<p>Puis d’activer le site :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">root</span><span class="nd">@monserveur</span><span class="p">:</span><span class="o">~</span><span class="c1"># a2ensite www.monsite.com</span>
<span class="n">root</span><span class="nd">@monserveur</span><span class="p">:</span><span class="o">~</span><span class="c1"># /etc/init.d/apache2 restart</span>
</pre></div>
</div>
</section>
<section id="securisation">
<h3><a class="toc-backref" href="#id283"><span class="sectnum">1.19.4</span> Sécurisation</a><a class="headerlink" href="#securisation" title="Lien permanent vers ce titre">¶</a></h3>
<p>La sécurisation se fait en ajoutant un certificat X 509 sous forme d’une clé privée et d’une clé privée.</p>
<p>Nous verrons au chapitre X 509 l’usage d’une clé autosignée.</p>
</section>
<section id="tracage">
<h3><a class="toc-backref" href="#id284"><span class="sectnum">1.19.5</span> Traçage</a><a class="headerlink" href="#tracage" title="Lien permanent vers ce titre">¶</a></h3>
<p>La configuration des logs permet de surveiller les accès aux sites.</p>
<p>On constatera que pour un site mis en ligne sur internet les tentatives d’intrusions sont importantes.</p>
</section>
</section>
<section id="postfix">
<h2><a class="toc-backref" href="#id285"><span class="sectnum">1.20</span> Postfix</a><a class="headerlink" href="#postfix" title="Lien permanent vers ce titre">¶</a></h2>
<section id="id7">
<h3><a class="toc-backref" href="#id286"><span class="sectnum">1.20.1</span> Présentation</a><a class="headerlink" href="#id7" title="Lien permanent vers ce titre">¶</a></h3>
<p>Postfix est un distributeur de courrier.</p>
<p>Il a pour rôle de recevoir le courrier, de le stocker dans la boite mail du destinataire ou de le relayer à un autre serveur de mail si la boite destinataire n’est pas sur sa machine.</p>
<p>Nous allons voir comment utiliser spf et dkim pour authentifier les mails.</p>
</section>
<section id="ressources-postfix-spf-dkim-et-test">
<h3><a class="toc-backref" href="#id287"><span class="sectnum">1.20.2</span> Ressources postfix, spf, dkim et test</a><a class="headerlink" href="#ressources-postfix-spf-dkim-et-test" title="Lien permanent vers ce titre">¶</a></h3>
<p><a class="reference external" href="https://www.nextinpact.com/article/30341/109074-emails-avec-spf-dkim-dmarc-arcet-bimi-a-quoi-ca-sert-comment-en-profiter">https://www.nextinpact.com/article/30341/109074-emails-avec-spf-dkim-dmarc-arcet-bimi-a-quoi-ca-sert-comment-en-profiter</a>
<a class="reference external" href="https://www.bortzmeyer.org/7208.html">https://www.bortzmeyer.org/7208.html</a>
<a class="reference external" href="https://ubuntu.tutorials24x7.com/blog/install-mail-server-on-ubuntu-20-04-lts-using-postfix-dovecot-and-roundcube">https://ubuntu.tutorials24x7.com/blog/install-mail-server-on-ubuntu-20-04-lts-using-postfix-dovecot-and-roundcube</a>
<a class="reference external" href="https://ubuntu.tutorials24x7.com/blog/set-up-dkim-domainkeys-with-postfix-on-ubuntu-20-04-lts">https://ubuntu.tutorials24x7.com/blog/set-up-dkim-domainkeys-with-postfix-on-ubuntu-20-04-lts</a>
<a class="reference external" href="https://www.linuxbabe.com/mail-server/setting-up-dkim-and-spf">https://www.linuxbabe.com/mail-server/setting-up-dkim-and-spf</a></p>
<p>Pour tester
<a class="reference external" href="https://www.appmaildev.com/en/spf">https://www.appmaildev.com/en/spf</a></p>
<p>RFC en français
<a class="reference external" href="https://www.bortzmeyer.org/7208.html">https://www.bortzmeyer.org/7208.html</a></p>
<p>Les variables d’opendkim
<a class="reference external" href="http://www.opendkim.org/opendkim.8.html">http://www.opendkim.org/opendkim.8.html</a></p>
<p>Pour envoyer un mail avec le From correctement rempli :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">echo</span> <span class="n">test</span> <span class="o">|</span> <span class="n">mail</span> <span class="o">-</span><span class="n">s</span> <span class="s2">&quot;Test postfix&quot;</span> <span class="o">-</span><span class="n">aFROM</span><span class="p">:</span><span class="n">michaellaunay</span><span class="nd">@ecreall</span><span class="o">.</span><span class="n">com</span> <span class="n">michaellaunay</span><span class="nd">@ecreall</span><span class="o">.</span><span class="n">com</span>
</pre></div>
</div>
</section>
<section id="id8">
<h3><a class="toc-backref" href="#id288"><span class="sectnum">1.20.3</span> Installation</a><a class="headerlink" href="#id8" title="Lien permanent vers ce titre">¶</a></h3>
<blockquote>
<div><p>apt install postfix</p>
</div></blockquote>
<p>Lors de l’installation, il faut préciser le nom du host, mettez le FQDN.
Il faut que le reverse ait été correctement positionné sinon les mails risquent d’être considérés comme du spam dés la connexion du serveur.
On va en profiter pour installer spf et dkim, puis, dmarc,</p>
<p>Si postfix transmet des mails</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">apt</span> <span class="n">install</span> <span class="n">opendkim</span> <span class="n">opendkim</span><span class="o">-</span><span class="n">tools</span> <span class="c1">#Pour la chaîne de signature</span>
<span class="n">apt</span> <span class="n">install</span> <span class="n">mailutils</span> <span class="c1"># Pour pouvoir tester l&#39;envoi de mail avec la commande mail</span>
</pre></div>
</div>
<p>Si postfix gère la réception des mails alors installer aussi</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">apt</span> <span class="n">install</span> <span class="n">postfix</span><span class="o">-</span><span class="n">policyd</span><span class="o">-</span><span class="n">spf</span><span class="o">-</span><span class="n">python</span>
<span class="n">vim</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">postfix</span><span class="o">/</span><span class="n">master</span><span class="o">.</span><span class="n">cf</span>
  <span class="c1">#Ajouter en fin de fichier</span>
  <span class="n">policyd</span><span class="o">-</span><span class="n">spf</span>  <span class="n">unix</span>  <span class="o">-</span>       <span class="n">n</span>       <span class="n">n</span>       <span class="o">-</span>       <span class="mi">0</span>       <span class="n">spawn</span>
  <span class="n">user</span><span class="o">=</span><span class="n">policyd</span><span class="o">-</span><span class="n">spf</span> <span class="n">argv</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">policyd</span><span class="o">-</span><span class="n">spf</span>
</pre></div>
</div>
<p>L’édition du fichier master permet de lancer le démon d’analyse des mails reçus.</p>
</section>
<section id="id9">
<h3><a class="toc-backref" href="#id289"><span class="sectnum">1.20.4</span> Configuration</a><a class="headerlink" href="#id9" title="Lien permanent vers ce titre">¶</a></h3>
<p>Le fichier de configuration est <em>/,etc/postfix/main.cf</em></p>
<p>Selon que le serveur est la destination ou seulement un relai on précisera <em>mydestination</em> ou non.</p>
<p>Exemple pour un serveur destinataire :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>michaellaunay@monserveur:~$ cat /etc/postfix/main.cf
biff = no
append_dot_mydomain = no
readme_directory = no
smtpd_tls_cert_file=/etc/ssl/certs/ssl-cert-snakeoil.pem
smtpd_tls_key_file=/etc/ssl/private/ssl-cert-snakeoil.key
smtpd_use_tls=yes
smtpd_tls_session_cache_database = btree:${data_directory}/smtpd_scache
smtp_tls_session_cache_database = btree:${data_directory}/smtp_scache
home_mailbox = Maildir/
mail_spool_directory = /var/spool/mail/
myhostname = monserveur.masociete.com
mydomain = masociete.com
myorigin = $mydomain
header_checks = regexp:/etc/postfix/header_checks
alias_maps = hash:/etc/aliases
alias_database = hash:/etc/aliases
relayhost =
mydestination = masociete.org, masociete.com, localhost.localdomain, localhost
unknown_local_recipient_reject_code = 550
mynetworks_style = host
mynetworks = 127.0.0.1, 82.236.252.174
mailbox_size_limit = 4294967296
recipient_delimiter = +
inet_interfaces = all
inet_protocols = all
message_size_limit = 10240000
header_size_limit = 102400
bounce_size_limit = 512000
disable_vrfy_command = no
smtpd_helo_required = yes
smtpd_banner = $myhostname ESMTP
maps_rbl_domains = relays.ordb.org, sbl.spamhaus.org, list.dsbl.org
smtpd_helo_restrictions = reject_invalid_hostname,  permit
smtpd_sender_restrictions = reject_unknown_sender_domain, reject_non_fqdn_sender, permit
smtpd_client_restrictions = permit_mynetworks, reject_rbl_client, permit
smtpd_recipient_restrictions = permit_mynetworks,
                                permit_sasl_authenticated,
                                reject_unauth_destination,
                                check_policy_service unix:private/policyd-spf
milter_protocol = 6
milter_default_action = accept
smtpd_milters = inet:localhost:8992
non_smtpd_milters = inet:localhost:8992
</pre></div>
</div>
<p>Configuration de spf</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Ajouter</span> <span class="n">une</span> <span class="n">entrée</span> <span class="n">spf</span> <span class="n">à</span> <span class="n">vos</span> <span class="n">entrées</span> <span class="n">DNS</span> <span class="n">sur</span> <span class="n">votre</span> <span class="n">Registrar</span><span class="o">.</span>

<span class="n">Par</span> <span class="n">exemple</span><span class="p">,</span> <span class="n">le</span> <span class="n">registrar</span> <span class="n">de</span> <span class="o">**</span><span class="n">ecreall</span><span class="o">.</span><span class="n">com</span><span class="o">**</span> <span class="n">est</span> <span class="n">OVH</span> <span class="n">et</span> <span class="n">il</span> <span class="n">faut</span> <span class="n">ajouter</span> <span class="n">une</span> <span class="n">entrée</span> <span class="n">SPF</span> <span class="n">et</span> <span class="n">la</span> <span class="n">remplir</span> <span class="n">comme</span> <span class="n">suit</span> <span class="p">:</span>

  <span class="n">Sous</span><span class="o">-</span><span class="n">domaine</span> <span class="p">[]</span><span class="o">**.</span><span class="n">ecreall</span><span class="o">.</span><span class="n">com</span><span class="o">**</span> <span class="c1">#Préciser le sous-domaine, ici il n&#39;y en a pas donc on laisse vide</span>
  <span class="n">TTL</span> <span class="p">[</span><span class="n">Par</span> <span class="n">défaut</span><span class="p">]</span> <span class="c1">#Mais pour les tests [personnalisés] on peut alors mettre une valeur faible en secondes comme [60]</span>
  <span class="n">Autoriser</span> <span class="n">l</span><span class="s1">&#39;IP de **ecreall.com** à envoyer des emails ? [v]oui # on autorisera les adresses ip que l&#39;</span><span class="n">on</span> <span class="n">souhaite</span><span class="o">.</span>
  <span class="n">Autoriser</span> <span class="n">les</span> <span class="n">serveurs</span> <span class="n">MX</span> <span class="n">à</span> <span class="n">envoyer</span> <span class="n">des</span> <span class="n">emails</span> <span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="n">oui</span> <span class="c1">#si MX est notre serveur</span>
  <span class="n">Autoriser</span> <span class="n">tous</span> <span class="n">les</span> <span class="n">serveurs</span> <span class="n">dont</span> <span class="n">le</span> <span class="n">nom</span> <span class="n">se</span> <span class="n">termine</span> <span class="n">par</span> <span class="o">**</span><span class="n">ecreall</span><span class="o">.</span><span class="n">com</span><span class="o">**</span> <span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="n">Non</span> <span class="c1"># permet de gérer les sous-domaines</span>
  <span class="n">D</span><span class="s1">&#39;autres serveurs ? # Mettre les autres adresses ou noms autorisés à envoyer.</span>

<span class="n">Sous</span> <span class="n">Gandi</span> <span class="n">il</span> <span class="n">ne</span> <span class="n">faut</span> <span class="n">surtout</span> <span class="n">pas</span> <span class="n">utiliser</span> <span class="n">le</span> <span class="n">champ</span> <span class="n">spf</span> <span class="n">qui</span> <span class="n">est</span> <span class="n">documenté</span> <span class="n">comme</span> <span class="n">obsolète</span><span class="p">,</span> <span class="n">à</span> <span class="n">la</span> <span class="n">place</span> <span class="n">il</span> <span class="n">faut</span> <span class="n">utiliser</span> <span class="n">une</span> <span class="n">entrée</span> <span class="n">TXT</span>

<span class="n">Il</span> <span class="n">faut</span> <span class="n">alors</span> <span class="n">mettre</span> <span class="s2">&quot;v=spf1 a mx ip4:51.159.31.17 -all&quot;</span> <span class="n">dans</span> <span class="n">le</span> <span class="n">champ</span><span class="o">.</span>

<span class="n">La</span> <span class="n">valeur</span> <span class="n">des</span> <span class="n">champs</span> <span class="n">spf</span> <span class="n">est</span> <span class="n">expliquée</span> <span class="n">par</span> <span class="n">Google</span> <span class="n">ici</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">support</span><span class="o">.</span><span class="n">google</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">a</span><span class="o">/</span><span class="n">answer</span><span class="o">/</span><span class="mi">33786</span>
</pre></div>
</div>
<p>Pour tester</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nslookup</span> <span class="o">-</span><span class="nb">type</span><span class="o">=</span><span class="n">txt</span> <span class="n">ecreall</span><span class="o">.</span><span class="n">com</span>
<span class="c1">#Ce qui donne</span>
  <span class="n">ecreall</span><span class="o">.</span><span class="n">com</span> <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;v=spf1 a mx ip4:51.159.31.255 -all&quot;</span>
</pre></div>
</div>
<p>Configuration de opendkim</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">vim</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">opendkim</span><span class="o">.</span><span class="n">conf</span>
<span class="c1">#Ajoutez ou mettez les variables à :</span>
  <span class="n">Domain</span>                <span class="n">ecreall</span><span class="o">.</span><span class="n">com</span>
  <span class="n">KeyFile</span>               <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">dkimkeys</span><span class="o">/</span><span class="n">dkim</span><span class="o">.</span><span class="n">private</span>
  <span class="n">Selector</span>              <span class="n">dkim</span>
  <span class="n">UserID</span>                <span class="n">opendkim</span>
  <span class="n">Socket</span> <span class="n">inet</span><span class="p">:</span><span class="mi">8992</span><span class="nd">@localhost</span>
</pre></div>
</div>
<p>Le champ « Domain » indique quels vont être les mails signés avec la clé contenue dans le fichier « Keyfile »
Le champ « Selector » indique quelle clé dans le fichier utiliser pour ce domaine.
UsserID indique l’utilisateur du démon, attention le fichier de la clé privée doit pouvoir être lu par cet utilisateur.
Socket indique la socket qui sera utilisée par postfix pour se connecter et signer les mails transmis.</p>
<p>Génération de la clé de signature des mails</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">dkimkeys</span><span class="o">/</span>
<span class="n">opendkim</span><span class="o">-</span><span class="n">genkey</span> <span class="o">-</span><span class="n">t</span> <span class="o">-</span><span class="n">s</span> <span class="n">dkim</span> <span class="o">-</span><span class="n">d</span> <span class="n">ecreall</span><span class="o">.</span><span class="n">com</span>
<span class="n">chown</span> <span class="n">root</span><span class="p">:</span><span class="n">opendkim</span> <span class="n">dkim</span><span class="o">.</span><span class="n">private</span>
<span class="n">chmod</span> <span class="mi">660</span> <span class="n">dkim</span><span class="o">.</span><span class="n">private</span>
</pre></div>
</div>
<p>L’attribut « -s dkim » permet de préciser de signer différemment chaque mail selon son domaine dans le cas où le serveur gère plusieurs domaines.</p>
<p>On a alors</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">root</span><span class="nd">@luciole</span><span class="p">:</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">dkimkeys</span><span class="c1"># ls -lh</span>
<span class="n">total</span> <span class="mi">12</span><span class="n">K</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">----</span> <span class="mi">1</span> <span class="n">root</span> <span class="n">opendkim</span> <span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="n">K</span> <span class="n">févr</span><span class="o">.</span> <span class="mi">11</span> <span class="mi">16</span><span class="p">:</span><span class="mi">09</span> <span class="n">dkim</span><span class="o">.</span><span class="n">private</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-------</span> <span class="mi">1</span> <span class="n">root</span> <span class="n">root</span>      <span class="mi">508</span> <span class="n">févr</span><span class="o">.</span> <span class="mi">11</span> <span class="mi">16</span><span class="p">:</span><span class="mi">09</span> <span class="n">dkim</span><span class="o">.</span><span class="n">txt</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span> <span class="mi">1</span> <span class="n">root</span> <span class="n">root</span>      <span class="mi">664</span> <span class="n">déc</span><span class="o">.</span>  <span class="mi">27</span>  <span class="mi">2019</span> <span class="n">README</span><span class="o">.</span><span class="n">PrivateKeys</span>
</pre></div>
</div>
<p>Vérifier la clé</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">root</span><span class="nd">@luciole</span><span class="p">:</span><span class="o">/</span><span class="c1"># opendkim-testkey -d ecreall.com -s dkim -vvv</span>
<span class="n">opendkim</span><span class="o">-</span><span class="n">testkey</span><span class="p">:</span> <span class="n">using</span> <span class="n">default</span> <span class="n">configfile</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">opendkim</span><span class="o">.</span><span class="n">conf</span>
<span class="n">opendkim</span><span class="o">-</span><span class="n">testkey</span><span class="p">:</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">dkimkeys</span><span class="o">/</span><span class="n">dkim</span><span class="o">.</span><span class="n">private</span><span class="p">:</span> <span class="n">WARNING</span><span class="p">:</span> <span class="n">unsafe</span> <span class="n">permissions</span>
<span class="n">opendkim</span><span class="o">-</span><span class="n">testkey</span><span class="p">:</span> <span class="n">key</span> <span class="n">loaded</span> <span class="kn">from</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">dkimkeys</span><span class="o">/</span><span class="n">dkim</span><span class="o">.</span><span class="n">private</span>
<span class="n">opendkim</span><span class="o">-</span><span class="n">testkey</span><span class="p">:</span> <span class="n">checking</span> <span class="n">key</span> <span class="s1">&#39;dkim._domainkey.ecreall.com&#39;</span>
<span class="n">opendkim</span><span class="o">-</span><span class="n">testkey</span><span class="p">:</span> <span class="n">key</span> <span class="ow">not</span> <span class="n">secure</span>
<span class="n">opendkim</span><span class="o">-</span><span class="n">testkey</span><span class="p">:</span> <span class="n">key</span> <span class="n">OK</span>
</pre></div>
</div>
<p>La ligne « opendkim-testkey: key not secure » est due au fait que DNSSEC n’a pas été activé sur le dns.</p>
<p>Afficher le contenu de dkim.txt</p>
<blockquote>
<div><dl class="simple">
<dt>cat /etc/dkimkeys/dkim.txt</dt><dd><dl class="simple">
<dt>dkim._domainkey     IN      TXT     ( « v=DKIM1; h=sha256; k=rsa; t=y; « </dt><dd><p>« p=MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAxvKAG6fOfx+BnzZX1DSOpWEh/VzRqSb6/zmXp2MwUmS238Rx3LtQB0qJeJW9uGmsIS2GlNc1bL+0RnAeVi5q2vh3oGOQ0+kCmrqtaQwhUa6SYxjd5+QLZXbpt2emtaWIn687ufXmWa4gVnGxVN8O3K2ALcVyToPLB5e48s5fUh5Ln15f+X2XKAJkoZVlqeIvyD9+zHD1D7wvoL »
« EDR3fSMYQmMQfBc2hR8nLArbCQj3HdJD5LITNQ9HlnM8dX56/MonWyavIKKWp3CV9IQZz0syG6i3XoxqdwdFvKh1daF+wnbYxS7ug9OlvWUo+6p4up6zFoEgT6PXo/cnjbYHA+FQIDAQAB » )  ; —– DKIM key dkim for ecreall.com</p>
</dd>
</dl>
</dd>
</dl>
</div></blockquote>
<p>Configurer votre registrar</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Se</span> <span class="n">connecter</span> <span class="n">à</span> <span class="n">la</span> <span class="n">zone</span> <span class="n">DNS</span> <span class="n">de</span> <span class="n">son</span> <span class="n">domaine</span><span class="p">,</span> <span class="n">par</span> <span class="n">exemple</span> <span class="n">pour</span> <span class="n">Ecreall</span> <span class="n">dans</span> <span class="n">OVH</span><span class="p">,</span> <span class="n">on</span> <span class="n">ajoute</span> <span class="n">une</span> <span class="n">entrée</span> <span class="n">DKIM</span> <span class="n">en</span> <span class="n">remplissant</span> <span class="n">les</span> <span class="n">champs</span> <span class="n">comme</span> <span class="n">suit</span> <span class="p">::</span>

  <span class="n">Sous</span><span class="o">-</span><span class="n">domaine</span> <span class="p">[</span><span class="n">dkim</span><span class="o">.</span><span class="n">_domainkey</span><span class="p">]</span>

  <span class="n">Version</span> <span class="p">[</span><span class="n">v</span><span class="p">]</span>

  <span class="n">Algorithme</span> <span class="p">(</span><span class="nb">hash</span><span class="p">)</span> <span class="o">-</span><span class="mi">256</span> <span class="p">[</span><span class="n">v</span><span class="p">]</span>

  <span class="n">Clé</span> <span class="n">Publique</span> <span class="p">[</span><span class="n">MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA1YRDtepyDeIgVolfFz4bRgacdE0hxGFhB</span><span class="o">+</span><span class="mi">9</span><span class="n">XTXmZbYcPc0iyDaGJivpd7TYAZ2zRBG</span><span class="o">+</span><span class="n">wU6s8viK9mxA</span><span class="o">/</span><span class="n">JLDTklhdbnD2oQOjBA1g7bcqqo</span><span class="o">/</span><span class="n">F3gHbApaz</span><span class="o">/</span><span class="n">M2DrQ4y5HEaHTjm</span><span class="o">/</span><span class="n">bsCLzbO7v3buTuhxu6mpVp5m</span><span class="o">/</span><span class="n">q</span><span class="o">+</span><span class="n">uX7o2LB1GkTw</span><span class="o">/</span><span class="n">DbqE2j3tHx5N5sojX6dZxvk</span><span class="o">+</span><span class="n">V9nyInArY4ni3uWrH3Y8aLSK7</span><span class="o">+</span><span class="n">QHyZVJAVGiT6jdRDdEERQlo2CTZj6UQu3jGtic</span><span class="o">+</span><span class="n">GZCU8Hp</span><span class="o">/</span><span class="n">SJWQj</span><span class="o">/</span><span class="n">xrx</span><span class="o">/</span><span class="n">ygZEJ0z294fLEIOGgUw66vRl6iVE9NJCaavTqBxlfgX7QNOa</span><span class="o">/</span><span class="mi">9</span><span class="n">bqnR9uDI2flwIDAQAB</span>
  <span class="p">]</span>

  <span class="n">Type</span> <span class="n">de</span> <span class="n">service</span> <span class="p">[]</span>

  <span class="n">Mode</span> <span class="n">test</span> <span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="c1"># Permet de demander aux serveurs recevant nos mails de ne pas tenir compte de DKIM tant qu&#39;on a pas fini</span>

  <span class="n">sous</span><span class="o">-</span><span class="n">domaine</span> <span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="n">La</span> <span class="n">clé</span> <span class="n">publique</span> <span class="n">n</span><span class="s1">&#39;est pas valide pour les sous-domaines</span>

<span class="n">Quand</span> <span class="n">tout</span> <span class="n">est</span> <span class="n">au</span> <span class="n">point</span><span class="p">,</span> <span class="n">ne</span> <span class="n">pas</span> <span class="n">oublier</span> <span class="n">d</span><span class="s1">&#39;éditer l&#39;</span><span class="n">entrée</span> <span class="n">pour</span> <span class="n">enlever</span> <span class="n">le</span> <span class="n">mode</span> <span class="n">de</span> <span class="n">test</span><span class="o">.</span>
</pre></div>
</div>
</section>
<section id="dmarc">
<h3><a class="toc-backref" href="#id290"><span class="sectnum">1.20.5</span> dmarc</a><a class="headerlink" href="#dmarc" title="Lien permanent vers ce titre">¶</a></h3>
<p>L’ajout de DMARC se fait par simple ajoute d’une entrée de type DMARC ou TXT pour le sous-domaine _dmarc avec les valeurs suivantes</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">v</span><span class="o">=</span><span class="n">DMARC1</span><span class="p">;</span><span class="n">p</span><span class="o">=</span><span class="n">quarantine</span><span class="p">;</span><span class="n">pct</span><span class="o">=</span><span class="mi">100</span><span class="p">;</span><span class="n">rua</span><span class="o">=</span><span class="n">mailto</span><span class="p">:</span><span class="n">michaellaunay</span><span class="o">+</span><span class="n">dmarc</span><span class="nd">@ecreall</span><span class="o">.</span><span class="n">com</span><span class="p">;</span><span class="n">sp</span><span class="o">=</span><span class="n">quarantine</span><span class="p">;</span><span class="n">aspf</span><span class="o">=</span><span class="n">s</span><span class="p">;</span>
</pre></div>
</div>
<p>Où V est la version du protocole,</p>
<p>p est la politique à appliquer pour les messages reçus soi-disant de notre domaine, mais qui échoue, None (ne rien faire) ou Quarantine marquer douteux, Reject rejeter.</p>
<p>pct le pourcentage à traiter.</p>
<p>rua l’uri de la ressource à prévenir en cas d’usurpation.</p>
<p>sp la politique des sous domainkeys.</p>
<p>aspf s’il faut suivre spf à la lettre.</p>
</section>
</section>
<section id="mysql">
<h2><a class="toc-backref" href="#id291"><span class="sectnum">1.21</span> MySQL</a><a class="headerlink" href="#mysql" title="Lien permanent vers ce titre">¶</a></h2>
<section id="id10">
<h3><a class="toc-backref" href="#id292"><span class="sectnum">1.21.1</span> Présentation</a><a class="headerlink" href="#id10" title="Lien permanent vers ce titre">¶</a></h3>
<p>MySQL est une base de données légère facile à mettre en œuvre est très utilisée par les sites web, on lui préfèrera MariaDB (<a class="reference external" href="https://mariadb.com/fr/">https://mariadb.com/fr/</a>) ou mieux PostgresSQL (<a class="reference external" href="https://www.postgresql.org/">https://www.postgresql.org/</a>).
À noter que MariaDB possède des offres serverless.</p>
<p>Son utilisation est libre, mais si les sources de l’application réalisée ne sont pas en GPL, il faut s’acquitter de l’achat d’une licence commerciale.</p>
</section>
<section id="id11">
<h3><a class="toc-backref" href="#id293"><span class="sectnum">1.21.2</span> Installation</a><a class="headerlink" href="#id11" title="Lien permanent vers ce titre">¶</a></h3>
<p>La commande <strong>apt install mysql-server</strong> permet d’installer le serveur contenant la base de données alors que <strong>apt-get install mysql-client</strong> se contentera d’installer le client.</p>
</section>
<section id="id12">
<h3><a class="toc-backref" href="#id294"><span class="sectnum">1.21.3</span> Configuration</a><a class="headerlink" href="#id12" title="Lien permanent vers ce titre">¶</a></h3>
<p>À l’installation il est fortement recommandé de donner un mot de passe à l’utilisateur root.</p>
<p>Liens :</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="http://www-fr.mysql.com/">http://www-fr.mysql.com/</a></p></li>
<li><p><a class="reference external" href="http://fr.wikipedia.org/wiki/Mysql">http://fr.wikipedia.org/wiki/Mysql</a></p></li>
</ul>
</div></blockquote>
</section>
</section>
<section id="id13">
<h2><a class="toc-backref" href="#id295"><span class="sectnum">1.22</span> Sécurisation</a><a class="headerlink" href="#id13" title="Lien permanent vers ce titre">¶</a></h2>
<section id="certificat-x-509">
<h3><a class="toc-backref" href="#id296"><span class="sectnum">1.22.1</span> Certificat X 509</a><a class="headerlink" href="#certificat-x-509" title="Lien permanent vers ce titre">¶</a></h3>
<p>Les certificats X 509 sont utilisés à la fois pour l’authentification et pour le chiffrage des infrastructures à clés publiques (PKI) par exemple dans le protocole ssl lors des connexions ssh (port 22) ou https (port 443).</p>
<p>Ils sont délivrés par une autorité de certification et sont liés à une adresse électronique ou à une entrée DNS.</p>
<p>Si l’autorité de certification est connue du navigateur, la connexion se fera sans alerter l’utilisateur. Dans le cas contraire, il sera prévenu que le site n’est pas de confiance.</p>
<p>Toutefois, il est possible de disposer des avantages du chiffrement sans passer par une autorité <em>de confiance</em>, en utilisant un certificat <em>auto-signé</em> :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">root</span><span class="nd">@monserveur</span><span class="p">:</span><span class="o">~</span><span class="c1"># make-ssl-cert /usr/share/ssl-cert/ssleay.cnf /etc/ssl/apache2/ssl/ssl.monsite.com.pem</span>
<span class="n">root</span><span class="nd">@monserveur</span><span class="p">:</span><span class="o">~</span><span class="c1"># vim /etc/apache2/sites-available/ssl.monsite.com</span>
<span class="c1">#remove SSLCertificateFile and update SSLCertificateKeyFile with</span>
<span class="n">SSLCertificateKeyFile</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">apache2</span><span class="o">/</span><span class="n">ssl</span><span class="o">/</span><span class="n">ssl</span><span class="o">.</span><span class="n">monsite</span><span class="o">.</span><span class="n">com</span><span class="o">.</span><span class="n">pem</span>
<span class="n">root</span><span class="nd">@monserveur</span><span class="p">:</span><span class="o">~</span><span class="c1"># service apache2 restart</span>
</pre></div>
</div>
<p>Mais les certificats autosignés ont l’inconvénient de ne pas avoir d’autorité connue et donc d’être refusé.</p>
<p>Nous pouvons utiliser les services let’s encrypt qui permettent d’avoir un certificat valide reconnu par tous les navigateurs.</p>
<p>Configuration de Let’s Encrypt pour générer nos certificats ssl</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">apt</span> <span class="n">install</span> <span class="n">apache2</span> <span class="c1">#Si ce n&#39;est pas fait, vérifier que le port http est ouvert sur ufw !</span>
<span class="n">apt</span> <span class="n">install</span> <span class="n">certbot</span>
<span class="n">certbot</span> <span class="n">certonly</span> <span class="o">--</span><span class="n">webroot</span> <span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">html</span> <span class="o">-</span><span class="n">d</span> <span class="n">URL_De_Mon_Site</span>
</pre></div>
</div>
<p>Vérification de la génération</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">root</span><span class="nd">@triticale</span><span class="p">:</span><span class="o">~</span><span class="c1"># openssl x509 -noout -text -in /etc/letsencrypt/live/URL_De_Mon_Site/fullchain.pem | grep &quot;Not After&quot;</span>
        <span class="n">Not</span> <span class="n">After</span> <span class="p">:</span> <span class="n">Aug</span>  <span class="mi">5</span> <span class="mi">11</span><span class="p">:</span><span class="mi">25</span><span class="p">:</span><span class="mi">06</span> <span class="mi">2020</span> <span class="n">GMT</span>
</pre></div>
</div>
<p>Modifier le cron de renouvellement « /,etc/cron.d/certbot » et mettre</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>0 \*/12 \* \* \* root test -x /usr/bin/certbot -a \! -d /run/systemd/system &amp;&amp; perl -e &#39;sleep int(rand(43200))&#39; &amp;&amp; certbot -q renew --apache
</pre></div>
</div>
<p>Forcer le renouvellement</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">certbot</span> <span class="n">renew</span> <span class="o">--</span><span class="n">force</span><span class="o">-</span><span class="n">renewal</span> <span class="c1">#Pour forcer le renouvellement de tous les noms de domaines</span>

<span class="n">certbot</span> <span class="o">-</span><span class="n">d</span> <span class="n">michaellaunay</span><span class="o">.</span><span class="n">ecreall</span><span class="o">.</span><span class="n">com</span> <span class="o">--</span><span class="n">force</span><span class="o">-</span><span class="n">renewal</span> <span class="c1"># Pour renouveler un domaine en particulier</span>
</pre></div>
</div>
<p>Liens :</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="http://doc.ubuntu-fr.org/tutoriel/securiser_apache2_avec_ssl">http://doc.ubuntu-fr.org/tutoriel/securiser_apache2_avec_ssl</a></p></li>
<li><p><a class="reference external" href="http://fr.wikipedia.org/wiki/X.509">http://fr.wikipedia.org/wiki/X.509</a></p></li>
</ul>
</div></blockquote>
</section>
<section id="postgrey">
<h3><a class="toc-backref" href="#id297"><span class="sectnum">1.22.2</span> postgrey</a><a class="headerlink" href="#postgrey" title="Lien permanent vers ce titre">¶</a></h3>
<p><strong>postgrey</strong> est un paquet de configuration de <em>postfix</em> permettant de différer la réception des mails des serveurs inconnus.</p>
<p>Le but est d’éliminer les spams, car les serveurs de spams ne prennent pas la peine de renvoyer un courrier dont la réception est différée.</p>
</section>
<section id="fail2ban">
<h3><a class="toc-backref" href="#id298"><span class="sectnum">1.22.3</span> fail2ban</a><a class="headerlink" href="#fail2ban" title="Lien permanent vers ce titre">¶</a></h3>
<p>Fail2ban est un démon qui permet de modifier les règles du firewall pour bannir pendant un temps déterminé les adresses IP qui ont échoué plusieurs connexions de suite à l’un des services du serveur.</p>
<p>Le temps d’exclusion, le nombre de tentatives tolérées, les adresses non bannies sont configurables via les fichiers /,etc/fail2ban/fail2ban.conf et /,etc/fail2ban/jail.conf.</p>
</section>
<section id="docker">
<h3><a class="toc-backref" href="#id299"><span class="sectnum">1.22.4</span> Docker</a><a class="headerlink" href="#docker" title="Lien permanent vers ce titre">¶</a></h3>
<p>Nous allons voir comment installer et utiliser Docker.
Docker est un système de conteneurisation, c’est-à-dire qu’il permet de crée des images d’une autre distribution très légère qui utilisent ou partagent les ressources de l’ordinateur hôte.
De plus les images sont partagées sur un HUB (attention peu ou pas de vérification de la plupart des images)</p>
<p>Pour installer docker le plus simple est d’utiliser la version des dépôts et donc de faire :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">apt</span> <span class="n">install</span> <span class="n">docker</span>
</pre></div>
</div>
<p>Nous allons chercher notre première image ce qui permettra de vérifier notre installation de docker et notre accès au réseau :</p>
<blockquote>
<div><p><a class="reference external" href="mailto:root&#37;&#52;&#48;Luciole">root<span>&#64;</span>Luciole</a>:~# docker run hello-world
Unable to find image “hello-world:latest” locally
latest: Pulling from library/hello-world
2db29710123e: Pull complete
Digest: sha256:2498fce14358aa50ead0cc6c19990fc6ff866ce72aeb5546e1d59caac3d0d60f
Status: Downloaded newer image for hello-world:latest</p>
<p>Hello from Docker!</p>
<dl class="simple">
<dt>To generate this message, Docker took the following steps:</dt><dd><ol class="arabic simple">
<li><p>The Docker client contacted the Docker daemon.</p></li>
<li><dl class="simple">
<dt>The Docker daemon pulled the « hello-world » image from the Docker Hub.</dt><dd><p>(amd64)</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>The Docker daemon created a new container from that image which runs the</dt><dd><p>executable that produces the output you are currently reading.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>The Docker daemon streamed that output to the Docker client, which sent it</dt><dd><p>to your terminal.</p>
</dd>
</dl>
</li>
</ol>
</dd>
<dt>To try something more ambitious, you can run an Ubuntu container with:</dt><dd><p>$ docker run -it ubuntu bash</p>
</dd>
<dt>Share images, automate workflows, and more with a free Docker ID:</dt><dd><p><a class="reference external" href="https://hub.docker.com/">https://hub.docker.com/</a></p>
</dd>
<dt>For more examples and ideas, visit:</dt><dd><p><a class="reference external" href="https://docs.docker.com/get-started/">https://docs.docker.com/get-started/</a></p>
</dd>
</dl>
</div></blockquote>
<p>Nous voyons que docker a été chercher l’image sur dockerhub, puis l’a exécuté en suivant les étapes indiquées par l’exécution.</p>
<p>Il est possible de faire les étapes d’exécution individuellement :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">docker</span> <span class="n">pull</span> <span class="n">hello</span><span class="o">-</span><span class="n">world</span>
<span class="n">docker</span> <span class="n">create</span> <span class="o">--</span><span class="n">name</span> <span class="n">docker</span><span class="o">-</span><span class="n">hello</span> <span class="n">hello</span><span class="o">-</span><span class="n">world</span>
<span class="n">docker</span> <span class="n">start</span> <span class="o">--</span><span class="n">attach</span> <span class="n">docker</span><span class="o">-</span><span class="n">hello</span>
</pre></div>
</div>
<p>L’exécution terminée le conteneur est détruit :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">root</span><span class="nd">@luciole</span><span class="p">:</span><span class="o">~</span><span class="c1"># docker ps --ALL</span>
<span class="n">CONTAINER</span> <span class="n">ID</span>   <span class="n">IMAGE</span>     <span class="n">COMMAND</span>   <span class="n">CREATED</span>   <span class="n">STATUS</span>    <span class="n">PORTS</span>     <span class="n">NAMES</span>
<span class="n">f842b65b9e36</span>   <span class="n">hello</span><span class="o">-</span><span class="n">world</span>   <span class="s2">&quot;/hello&quot;</span>   <span class="mi">5</span> <span class="n">hours</span> <span class="n">ago</span>   <span class="n">Exited</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="mi">5</span> <span class="n">hours</span> <span class="n">ago</span>             <span class="n">funny_hermann</span>
</pre></div>
</div>
<p>On peut alors supprimer le conteneur puis l’image du disque :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">root</span><span class="nd">@Caravale</span><span class="p">:</span><span class="o">~</span><span class="c1"># docker rm funny_hermann</span>
<span class="n">funny_hermann</span>
<span class="n">root</span><span class="nd">@Caravale</span><span class="p">:</span><span class="o">~</span><span class="c1"># docker rmi hello-world</span>
<span class="o">...</span>
</pre></div>
</div>
<p>Pour faire le ménage de toutes les images non en cours d’exécution :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>docker rm $(sudo docker ps -a -q)
docker rmi $(sudo docker images -a -q)
</pre></div>
</div>
<p>Différentes versions d’une image existent, elles sont taguées et il suffit de descendre l’une d’elles pour avoir une image partielle.</p>
<p>Pour tester la future version de python par exemple on peut faire :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">docker</span> <span class="n">run</span> <span class="n">python</span><span class="p">:</span><span class="mf">3.11</span><span class="o">-</span><span class="n">rc</span><span class="o">-</span><span class="n">alpine</span> <span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s2">&quot;from typing import TypeVar; help(TypeVar)&quot;</span>
</pre></div>
</div>
<p>Qui affichera la doc de TypeVar.</p>
<p>Pour accéder au shell du conteneur en mode interactif, il faut mettre le flag -it
Pour effacer le conteneur une fois terminé, mettre le flag –rm</p>
<p>Liens :</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="https://docs.docker.com/engine/install/#server">https://docs.docker.com/engine/install/#server</a></p></li>
<li><p><a class="reference external" href="https://www.nextinpact.com/article/48913/docker-et-conteneurisation-par-exemple">https://www.nextinpact.com/article/48913/docker-et-conteneurisation-par-exemple</a></p></li>
</ul>
</div></blockquote>
</section>
<section id="git">
<h3><a class="toc-backref" href="#id300"><span class="sectnum">1.22.5</span> git</a><a class="headerlink" href="#git" title="Lien permanent vers ce titre">¶</a></h3>
<p>Git est un outil de gestion de versions du code développé par Linus Torval fondateur de Linux pour gérer le « versioning » du noyau Linux à partir de 2005.</p>
<p>Pour installer le client :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">apt</span> <span class="n">install</span> <span class="n">git</span>
</pre></div>
</div>
<p>Pour configurer son compte :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">config</span> <span class="n">user</span><span class="o">.</span><span class="n">name</span> <span class="n">Michaël</span> <span class="n">Launay</span>
<span class="n">git</span> <span class="n">config</span> <span class="n">user</span><span class="o">.</span><span class="n">mail</span> <span class="n">michaellaunay</span><span class="nd">@ecreall</span><span class="o">.</span><span class="n">com</span>
</pre></div>
</div>
<p>Connaître sa configuration :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">config</span> <span class="o">--</span><span class="nb">list</span>
</pre></div>
</div>
<p>La configuration se trouve soit dans :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;/etc/gitconfig&quot;</span>
<span class="s2">&quot;~/.gitconfig&quot;</span>
<span class="o">&lt;</span><span class="n">rep_projet</span><span class="o">&gt;/.</span><span class="n">git</span><span class="o">/</span><span class="n">config</span>
</pre></div>
</div>
<p>Liens :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">git</span><span class="o">-</span><span class="n">scm</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">book</span><span class="o">/</span><span class="n">fr</span><span class="o">/</span><span class="n">v2</span><span class="o">/</span><span class="n">Personnalisation</span><span class="o">-</span><span class="n">de</span><span class="o">-</span><span class="n">Git</span><span class="o">-</span><span class="n">Configuration</span><span class="o">-</span><span class="n">de</span><span class="o">-</span><span class="n">Git</span>
<span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">youtu</span><span class="o">.</span><span class="n">be</span><span class="o">/</span><span class="n">KVULgIbyeQs</span>
</pre></div>
</div>
<p>Créer un projet :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="n">Soit</span> <span class="n">directement</span> <span class="n">depuis</span> <span class="n">github</span> <span class="n">ou</span> <span class="n">gitlab</span><span class="p">,</span> <span class="n">puis</span> <span class="n">faire</span> <span class="n">un</span> <span class="s2">&quot;git clone&quot;</span><span class="p">,</span> <span class="n">soit</span> <span class="n">créer</span> <span class="n">un</span> <span class="n">porjet</span> <span class="n">local</span> <span class="n">et</span> <span class="n">l</span><span class="s1">&#39;importer dans github/gitlab en ayant créé un projet vide.</span>

 <span class="n">Si</span> <span class="n">l</span><span class="s1">&#39;option locale en premier est choisie : ::</span>

   <span class="n">mkdir</span> <span class="n">MonProjet</span>
   <span class="n">cd</span> <span class="n">MonProjet</span>
   <span class="n">vim</span> <span class="n">README</span><span class="o">.</span><span class="n">md</span>
   <span class="n">git</span> <span class="n">init</span>

<span class="n">Il</span> <span class="n">est</span> <span class="n">indispensable</span> <span class="n">de</span> <span class="n">créer</span> <span class="n">à</span> <span class="n">minima</span> <span class="n">un</span> <span class="n">fichier</span> <span class="s2">&quot;.gitkeep&quot;</span> <span class="n">dans</span> <span class="n">un</span> <span class="n">répertoire</span><span class="p">,</span> <span class="n">car</span> <span class="n">git</span> <span class="n">n</span><span class="s1">&#39;archive pas les dossiers vides !</span>
</pre></div>
</div>
<p>Liens :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">*</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">git</span><span class="o">-</span><span class="n">scm</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">book</span><span class="o">/</span><span class="n">fr</span><span class="o">/</span><span class="n">v2</span>
<span class="o">*</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">youtu</span><span class="o">.</span><span class="n">be</span><span class="o">/</span><span class="mi">0</span><span class="n">sGQgfUdCAY</span>
</pre></div>
</div>
<p>Les commandes principales :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">status</span> <span class="c1"># Donne l&#39;état du dépôt git local</span>
<span class="n">git</span> <span class="n">add</span> <span class="n">Fichiers_ou_</span><span class="o">*</span> <span class="c1"># Versionne</span>
<span class="n">git</span> <span class="n">commit</span> <span class="o">-</span><span class="n">m</span> <span class="s2">&quot;Nature du commit&quot;</span>
<span class="n">git</span> <span class="n">push</span>
<span class="n">git</span> <span class="n">pull</span>
<span class="n">git</span> <span class="n">checkout</span>
</pre></div>
</div>
</section>
<section id="gitlab">
<h3><a class="toc-backref" href="#id301"><span class="sectnum">1.22.6</span> gitlab</a><a class="headerlink" href="#gitlab" title="Lien permanent vers ce titre">¶</a></h3>
<p>Gitlab évoluant sans cesse, il vaut mieux installer les paquets fournis par les développeurs.
Ajout des clés de gitlab :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">--</span><span class="n">silent</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">packages</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">gpg</span><span class="o">.</span><span class="n">key</span> <span class="o">|</span> <span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">key</span> <span class="n">add</span> <span class="o">-</span>
<span class="n">apt</span> <span class="n">update</span>
<span class="n">apt</span> <span class="n">install</span> <span class="n">gitlab</span>
</pre></div>
</div>
<p>Liens :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">*</span>
</pre></div>
</div>
</section>
<section id="visual-code">
<h3><a class="toc-backref" href="#id302"><span class="sectnum">1.22.7</span> Visual code</a><a class="headerlink" href="#visual-code" title="Lien permanent vers ce titre">¶</a></h3>
<p>Visual code est devenu l’outil d’édition de code incontournable, nous allons voir comment l’utiliser et le configurer pour nos besoins.</p>
<p>Quelques extensions à installer :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">reStructuredText</span> <span class="p">(</span><span class="n">pip</span> <span class="n">install</span> <span class="n">snooty</span><span class="o">-</span><span class="n">lextudio</span><span class="p">,</span> <span class="n">pip</span> <span class="n">install</span> <span class="n">sphinx</span> <span class="n">sphinx</span><span class="o">-</span><span class="n">autobuild</span><span class="p">,</span> <span class="n">pip</span> <span class="n">install</span> <span class="n">rstcheck</span><span class="p">)</span>
<span class="n">docstrings</span>
</pre></div>
</div>
<section id="parametrer-son-environnement-virtuel-python">
<h4><a class="toc-backref" href="#id303"><span class="sectnum">1.22.7.1</span> Paramétrer son environnement virtuel python</a><a class="headerlink" href="#parametrer-son-environnement-virtuel-python" title="Lien permanent vers ce titre">¶</a></h4>
<p>Créer un environnement comme indiqué en fin de section python et installer flake8 et pylint :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>michaellaunay@Luciole:~$ workon venv #Pour activer l&#39;environnement virtuel
</pre></div>
</div>
<p>Ouvrir le dossier du projet où l’on souhaite travailler.
Normalement VisualCode a créé un répertoire « .vscode » qui contient un fichier settings.json
Éditer ce fichier et positionner la variable python.defaultInterpreterPath à :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;python.defaultInterpreterPath&quot;</span><span class="p">:</span> <span class="s2">&quot;${env:HOME}/.virtualenvs/venv/bin/python&quot;</span>
</pre></div>
</div>
<p>Liens :</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="https://code.visualstudio.com/docs/python/environments">https://code.visualstudio.com/docs/python/environments</a></p></li>
<li><p><a class="reference external" href="https://code.visualstudio.com/docs/editor/tasks#_variable-substitution">https://code.visualstudio.com/docs/editor/tasks#_variable-substitution</a></p></li>
</ul>
</div></blockquote>
<p>Ne pas oublier d’installer pytest et pytest-cov :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip3</span> <span class="n">install</span> <span class="n">pytest</span> <span class="n">pytest</span><span class="o">-</span><span class="n">cov</span>
</pre></div>
</div>
<p>Pour lancer les tests, on pourra alors faire :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="o">-</span><span class="n">m</span> <span class="n">unittest</span> <span class="n">discover</span> <span class="c1"># pour unittest</span>
<span class="n">python3</span> <span class="o">-</span><span class="n">m</span> <span class="n">pytest</span> <span class="c1">#pour pytest et donc avoir une syntaxe à base de &quot;assert&quot;</span>
<span class="n">python3</span> <span class="o">-</span><span class="n">m</span> <span class="n">pytest</span> <span class="o">--</span><span class="n">cov</span><span class="o">=</span><span class="n">perfect_maze</span> <span class="c1">#Pour avoir le taux de couverture des tests</span>
</pre></div>
</div>
<p>Pour automatiser les tests, par exemple dans une intégration continue (CI), on peut utiliser Tox et le brancher à notre dépôt « git » via un hook.</p>
<blockquote>
<div><p>pip3 install tox</p>
</div></blockquote>
<p>Pour le configurer, lancer « tox-quickstart » depuis le dossier du projet et répondre aux questions.</p>
</section>
<section id="ajouter-la-previsualisation-sphinx-pour-le-format-rest">
<h4><a class="toc-backref" href="#id304"><span class="sectnum">1.22.7.2</span> Ajouter la prévisualisation sphinx pour le format rest</a><a class="headerlink" href="#ajouter-la-previsualisation-sphinx-pour-le-format-rest" title="Lien permanent vers ce titre">¶</a></h4>
<p>Pour cela il faut d’abord ajouter rest à l’environnement virtuel par défaut et le configurer :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>(venv) michaellaunay@Luciole:~/workspace$ pip install sphinx
(venv) michaellaunay@Luciole:~/workspace$ sphinx-quickstart
</pre></div>
</div>
<p>Puis éditer la configuration de l’extension (Ctrl+Shift+P) et y ajouter comme chemin celui saisit pour Sphinx c’est-à-dire là où on a dit quickstart de travailler et où il a créé le fichier conf.py (le workspace est le plus pratique).</p>
</section>
</section>
<section id="site-de-tests-des-requetes-html">
<h3><a class="toc-backref" href="#id305"><span class="sectnum">1.22.8</span> Site de tests des requêtes html</a><a class="headerlink" href="#site-de-tests-des-requetes-html" title="Lien permanent vers ce titre">¶</a></h3>
<p>Pour tester les différentes requêtes du web :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">httpbin</span><span class="o">.</span><span class="n">org</span>
</pre></div>
</div>
</section>
<section id="capturer-la-session-en-cours">
<h3><a class="toc-backref" href="#id306"><span class="sectnum">1.22.9</span> Capturer la session en cours</a><a class="headerlink" href="#capturer-la-session-en-cours" title="Lien permanent vers ce titre">¶</a></h3>
<p>Ubuntu inclut un outil de capture d’écran appelé Screenshot pour l’image est Screencast pour la vidéo, pour le déclencher faire la combinaison de touches :</p>
<blockquote>
<div><p>Ctrl+Alt+Shift+R</p>
</div></blockquote>
<p>Pour interrompre la session, faire la même combinaison de touches.</p>
<p>Il est possible de le lancer en ligne avec par exemple un délai avant enregistrement, mais il ne prend alors qu’un seul cliché à la fois:</p>
<blockquote>
<div><p>gnome-screenshot -d 30 -f /tmp/capture.png #Dans 30s prend une capture et l’enregistre au format png</p>
</div></blockquote>
<p>Par défaut le temps de capture de screencast est positionné à 30s pour le changer :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gsettings</span> <span class="nb">set</span> <span class="n">org</span><span class="o">.</span><span class="n">gnome</span><span class="o">.</span><span class="n">settings</span><span class="o">-</span><span class="n">daemon</span><span class="o">.</span><span class="n">plugins</span><span class="o">.</span><span class="n">media</span><span class="o">-</span><span class="n">keys</span> <span class="nb">max</span><span class="o">-</span><span class="n">screencast</span><span class="o">-</span><span class="n">length</span> <span class="mi">240</span> <span class="c1">#remplacer 240s par ce que vous voulez</span>
</pre></div>
</div>
</section>
<section id="formats-de-fichier-de-configuration">
<h3><a class="toc-backref" href="#id307"><span class="sectnum">1.22.10</span> Formats de fichier de configuration</a><a class="headerlink" href="#formats-de-fichier-de-configuration" title="Lien permanent vers ce titre">¶</a></h3>
<p>Selon les logiciels installés, on trouve différents formats de fichier de configuration dont voici les principaux :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">*</span> <span class="n">json</span>
<span class="o">*</span> <span class="n">xml</span>
<span class="o">*</span> <span class="n">toml</span>
<span class="o">*</span> <span class="n">ini</span>
<span class="o">*</span> <span class="n">yaml</span>
</pre></div>
</div>
<p>&#64;TODO</p>
<dl class="footnote brackets">
<dt class="label" id="id14"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p><a class="reference external" href="http://en.wikipedia.org/wiki/Comparison_of_operating_systems">http://en.wikipedia.org/wiki/Comparison_of_operating_systems</a></p>
</dd>
</dl>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">CoursGnuLinux</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Recherche rapide</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, Michael Launay.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.3.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/CoursGNULinux/CoursGNULinux.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>