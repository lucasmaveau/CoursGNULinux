<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.16: http://docutils.sourceforge.net/" />
<title>Formation à GNU/Linux</title>
<meta name="author" content="Michaël Launay &lt;michaellaunay&#64;ecreall.com&gt;" />
<style type="text/css">

/*
:Author: David Goodger (goodger@python.org)
:Id: $Id: html4css1.css 7952 2016-07-26 18:15:59Z milde $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

.subscript {
  vertical-align: sub;
  font-size: smaller }

.superscript {
  vertical-align: super;
  font-size: smaller }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

object[type="image/svg+xml"], object[type="application/x-shockwave-flash"] {
  overflow: hidden;
}

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title, .code .error {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left, .figure.align-left, object.align-left, table.align-left {
  clear: left ;
  float: left ;
  margin-right: 1em }

img.align-right, .figure.align-right, object.align-right, table.align-right {
  clear: right ;
  float: right ;
  margin-left: 1em }

img.align-center, .figure.align-center, object.align-center {
  display: block;
  margin-left: auto;
  margin-right: auto;
}

table.align-center {
  margin-left: auto;
  margin-right: auto;
}

.align-left {
  text-align: left }

.align-center {
  clear: both ;
  text-align: center }

.align-right {
  text-align: right }

/* reset inner alignment in figures */
div.align-right {
  text-align: inherit }

/* div.align-center * { */
/*   text-align: left } */

.align-top    {
  vertical-align: top }

.align-middle {
  vertical-align: middle }

.align-bottom {
  vertical-align: bottom }

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font: inherit }

pre.literal-block, pre.doctest-block, pre.math, pre.code {
  margin-left: 2em ;
  margin-right: 2em }

pre.code .ln { color: grey; } /* line numbers */
pre.code, code { background-color: #eeeeee }
pre.code .comment, code .comment { color: #5C6576 }
pre.code .keyword, code .keyword { color: #3B0D06; font-weight: bold }
pre.code .literal.string, code .literal.string { color: #0C5404 }
pre.code .name.builtin, code .name.builtin { color: #352B84 }
pre.code .deleted, code .deleted { background-color: #DEB0A1}
pre.code .inserted, code .inserted { background-color: #A3D289}

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

/* "booktabs" style (no vertical lines) */
table.docutils.booktabs {
  border: 0px;
  border-top: 2px solid;
  border-bottom: 2px solid;
  border-collapse: collapse;
}
table.docutils.booktabs * {
  border: 0px;
}
table.docutils.booktabs th {
  border-bottom: thin solid;
  text-align: left;
}

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }

</style>
</head>
<body>
<div class="header">
Ecréall 2020 update de la version 2009 pour Ubuntu 20.04
<hr class="header"/>
</div>
<div class="document" id="formation-a-gnu-linux">
<h1 class="title">Formation à GNU/Linux</h1>
<table class="docinfo" frame="void" rules="none">
<col class="docinfo-name" />
<col class="docinfo-content" />
<tbody valign="top">
<tr><th class="docinfo-name">Author:</th>
<td>Michaël Launay &lt;<a class="reference external" href="mailto:michaellaunay&#64;ecreall.com">michaellaunay&#64;ecreall.com</a>&gt;</td></tr>
<tr><th class="docinfo-name">Version:</th>
<td>1.9</td></tr>
<tr class="licence field"><th class="docinfo-name">licence:</th><td class="field-body">Cette création est mise à disposition selon le Contrat Paternité 2.0 France disponible en ligne <a class="reference external" href="http://creativecommons.org/licenses/by/2.0/fr/">http://creativecommons.org/licenses/by/2.0/fr/</a> ou par courrier postal à Creative Commons, 171 Second Street, Suite 300, San Francisco, California 94105, USA.</td>
</tr>
</tbody>
</table>
<div class="contents topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="auto-toc simple">
<li><a class="reference internal" href="#objectif" id="id25">1&nbsp;&nbsp;&nbsp;Objectif</a></li>
<li><a class="reference internal" href="#introduction" id="id26">2&nbsp;&nbsp;&nbsp;Introduction</a></li>
<li><a class="reference internal" href="#historique" id="id27">3&nbsp;&nbsp;&nbsp;Historique</a><ul class="auto-toc">
<li><a class="reference internal" href="#unix-les-racines" id="id28">3.1&nbsp;&nbsp;&nbsp;UNIX (les racines)</a></li>
<li><a class="reference internal" href="#la-licence-bsd-versus-la-licence-gpl" id="id29">3.2&nbsp;&nbsp;&nbsp;La licence BSD versus la licence GPL</a></li>
<li><a class="reference internal" href="#la-licence-gpl" id="id30">3.3&nbsp;&nbsp;&nbsp;La licence GPL</a><ul class="auto-toc">
<li><a class="reference internal" href="#le-gauche-d-auteur" id="id31">3.3.1&nbsp;&nbsp;&nbsp;Le gauche d'auteur</a></li>
</ul>
</li>
<li><a class="reference internal" href="#la-licence-bsd" id="id32">3.4&nbsp;&nbsp;&nbsp;La licence BSD</a></li>
<li><a class="reference internal" href="#gnu-linux" id="id33">3.5&nbsp;&nbsp;&nbsp;GNU/Linux</a></li>
</ul>
</li>
<li><a class="reference internal" href="#les-distributions" id="id34">4&nbsp;&nbsp;&nbsp;Les distributions</a><ul class="auto-toc">
<li><a class="reference internal" href="#qu-est-ce-qu-un-noyau" id="id35">4.1&nbsp;&nbsp;&nbsp;Qu'est-ce qu'un noyau ?</a></li>
<li><a class="reference internal" href="#qu-est-ce-qu-une-distribution" id="id36">4.2&nbsp;&nbsp;&nbsp;Qu'est ce qu'une distribution ?</a></li>
<li><a class="reference internal" href="#les-differentes-distributions-gnu-linux" id="id37">4.3&nbsp;&nbsp;&nbsp;Les différentes distributions GNU/Linux</a></li>
<li><a class="reference internal" href="#les-principales-distributions" id="id38">4.4&nbsp;&nbsp;&nbsp;Les principales distributions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#installation" id="id39">5&nbsp;&nbsp;&nbsp;Installation</a><ul class="auto-toc">
<li><a class="reference internal" href="#installation-de-gnu-linux-ubuntu-version-pc-de-bureau" id="id40">5.1&nbsp;&nbsp;&nbsp;Installation de GNU/Linux Ubuntu version pc de bureau</a><ul class="auto-toc">
<li><a class="reference internal" href="#installation-d-ubuntu-20-04" id="id41">5.1.1&nbsp;&nbsp;&nbsp;Installation d'Ubuntu 20.04</a></li>
<li><a class="reference internal" href="#etape-01" id="id42">5.1.2&nbsp;&nbsp;&nbsp;Étape 01</a></li>
<li><a class="reference internal" href="#etape-02" id="id43">5.1.3&nbsp;&nbsp;&nbsp;Étape 02</a></li>
<li><a class="reference internal" href="#etape-03" id="id44">5.1.4&nbsp;&nbsp;&nbsp;Étape 03</a></li>
<li><a class="reference internal" href="#etape-04" id="id45">5.1.5&nbsp;&nbsp;&nbsp;Étape 04</a></li>
<li><a class="reference internal" href="#etape-05" id="id46">5.1.6&nbsp;&nbsp;&nbsp;Étape 05</a></li>
<li><a class="reference internal" href="#etape-06" id="id47">5.1.7&nbsp;&nbsp;&nbsp;Étape 06</a></li>
<li><a class="reference internal" href="#etape-07" id="id48">5.1.8&nbsp;&nbsp;&nbsp;Étape 07</a></li>
<li><a class="reference internal" href="#etape-08" id="id49">5.1.9&nbsp;&nbsp;&nbsp;Étape 08</a></li>
<li><a class="reference internal" href="#etape-alternative-04-bis" id="id50">5.1.10&nbsp;&nbsp;&nbsp;Étape alternative 04 bis</a></li>
</ul>
</li>
<li><a class="reference internal" href="#installation-de-gnu-linux-ubuntu-en-version-serveur" id="id51">5.2&nbsp;&nbsp;&nbsp;Installation de GNU/Linux Ubuntu en version serveur</a><ul class="auto-toc">
<li><a class="reference internal" href="#attention" id="id52">5.2.1&nbsp;&nbsp;&nbsp;Attention</a></li>
<li><a class="reference internal" href="#travaux-pratiques" id="id53">5.2.2&nbsp;&nbsp;&nbsp;Travaux pratiques</a></li>
</ul>
</li>
<li><a class="reference internal" href="#utilisation-de-gnu-linux" id="id54">5.3&nbsp;&nbsp;&nbsp;Utilisation de GNU/Linux</a></li>
</ul>
</li>
<li><a class="reference internal" href="#l-aide-et-la-communaute" id="id55">6&nbsp;&nbsp;&nbsp;L'aide et la communauté</a><ul class="auto-toc">
<li><a class="reference internal" href="#l-aide-en-ligne" id="id56">6.1&nbsp;&nbsp;&nbsp;L'aide en ligne</a></li>
<li><a class="reference internal" href="#les-man-pages" id="id57">6.2&nbsp;&nbsp;&nbsp;Les man pages</a></li>
<li><a class="reference internal" href="#les-sites" id="id58">6.3&nbsp;&nbsp;&nbsp;Les sites</a></li>
<li><a class="reference internal" href="#les-forums" id="id59">6.4&nbsp;&nbsp;&nbsp;Les forums</a></li>
<li><a class="reference internal" href="#les-lugs" id="id60">6.5&nbsp;&nbsp;&nbsp;Les LUGs</a></li>
</ul>
</li>
<li><a class="reference internal" href="#shell-commandes" id="id61">7&nbsp;&nbsp;&nbsp;Shell &amp; Commandes</a><ul class="auto-toc">
<li><a class="reference internal" href="#les-terminaux-tty" id="id62">7.1&nbsp;&nbsp;&nbsp;Les terminaux (tty)</a></li>
<li><a class="reference internal" href="#la-ligne-de-commande" id="id63">7.2&nbsp;&nbsp;&nbsp;La ligne de commande</a><ul class="auto-toc">
<li><a class="reference internal" href="#les-differents-shell" id="id64">7.2.1&nbsp;&nbsp;&nbsp;Les différents shell</a></li>
<li><a class="reference internal" href="#les-fichiers-de-ressources-et-de-configuration-de-bash" id="id65">7.2.2&nbsp;&nbsp;&nbsp;Les fichiers de ressources et de configuration de bash</a></li>
<li><a class="reference internal" href="#les-variables-d-environnement" id="id66">7.2.3&nbsp;&nbsp;&nbsp;Les variables d'environnement</a></li>
<li><a class="reference internal" href="#les-caracteres-speciaux" id="id67">7.2.4&nbsp;&nbsp;&nbsp;Les caractères spéciaux</a></li>
<li><a class="reference internal" href="#variables-speciales" id="id68">7.2.5&nbsp;&nbsp;&nbsp;Variables spéciales</a></li>
<li><a class="reference internal" href="#creation-affectation-de-variable" id="id69">7.2.6&nbsp;&nbsp;&nbsp;Création, affectation de variable</a></li>
<li><a class="reference internal" href="#export-de-variable" id="id70">7.2.7&nbsp;&nbsp;&nbsp;Export de variable</a></li>
<li><a class="reference internal" href="#les-tests-d-expressions-et-fichier-operateurs-de-controle" id="id71">7.2.8&nbsp;&nbsp;&nbsp;Les tests d'expressions et fichier, opérateurs de contrôle</a></li>
<li><a class="reference internal" href="#execution-d-operations-arithmetiques" id="id72">7.2.9&nbsp;&nbsp;&nbsp;Exécution d'opérations arithmétiques</a></li>
<li><a class="reference internal" href="#la-boucle-while-et-until" id="id73">7.2.10&nbsp;&nbsp;&nbsp;La boucle while et until</a></li>
<li><a class="reference internal" href="#la-boucle-for" id="id74">7.2.11&nbsp;&nbsp;&nbsp;La boucle for</a></li>
<li><a class="reference internal" href="#le-choix-multiple-case" id="id75">7.2.12&nbsp;&nbsp;&nbsp;Le choix multiple (case)</a></li>
<li><a class="reference internal" href="#les-operateurs-et" id="id76">7.2.13&nbsp;&nbsp;&nbsp;Les opérateurs &amp;&amp; et ||</a></li>
<li><a class="reference internal" href="#la-commande-trap" id="id77">7.2.14&nbsp;&nbsp;&nbsp;La commande trap</a></li>
<li><a class="reference internal" href="#la-commande-sed" id="id78">7.2.15&nbsp;&nbsp;&nbsp;La commande sed</a></li>
<li><a class="reference internal" href="#l-expansion-de-parametre" id="id79">7.2.16&nbsp;&nbsp;&nbsp;L'expansion de paramètre</a></li>
<li><a class="reference internal" href="#les-scripts" id="id80">7.2.17&nbsp;&nbsp;&nbsp;Les scripts</a></li>
<li><a class="reference internal" href="#les-fonctions" id="id81">7.2.18&nbsp;&nbsp;&nbsp;Les fonctions</a></li>
<li><a class="reference internal" href="#lecture-des-saisies-clavier" id="id82">7.2.19&nbsp;&nbsp;&nbsp;Lecture des saisies clavier</a></li>
<li><a class="reference internal" href="#exercice" id="id83">7.2.20&nbsp;&nbsp;&nbsp;Exercice</a></li>
<li><a class="reference internal" href="#les-sous-programmes" id="id84">7.2.21&nbsp;&nbsp;&nbsp;Les sous-programmes</a></li>
<li><a class="reference internal" href="#la-completion-de-commande" id="id85">7.2.22&nbsp;&nbsp;&nbsp;La complétion de commande</a></li>
<li><a class="reference internal" href="#historique-des-commandes" id="id86">7.2.23&nbsp;&nbsp;&nbsp;Historique des commandes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#les-commandes" id="id87">7.3&nbsp;&nbsp;&nbsp;Les commandes</a><ul class="auto-toc">
<li><a class="reference internal" href="#se-deplacer-dans-l-arborescence" id="id88">7.3.1&nbsp;&nbsp;&nbsp;Se déplacer dans l'arborescence</a></li>
<li><a class="reference internal" href="#creation-suppression-de-repertoire" id="id89">7.3.2&nbsp;&nbsp;&nbsp;Création / suppression de répertoire</a></li>
<li><a class="reference internal" href="#lecture-de-fichier" id="id90">7.3.3&nbsp;&nbsp;&nbsp;Lecture de fichier</a></li>
<li><a class="reference internal" href="#rechercher-des-fichiers" id="id91">7.3.4&nbsp;&nbsp;&nbsp;Rechercher des fichiers</a></li>
<li><a class="reference internal" href="#archivage-compression" id="id92">7.3.5&nbsp;&nbsp;&nbsp;Archivage / Compression</a></li>
<li><a class="reference internal" href="#autres-commandes" id="id93">7.3.6&nbsp;&nbsp;&nbsp;Autres commandes</a></li>
<li><a class="reference internal" href="#les-noms-de-fichiers" id="id94">7.3.7&nbsp;&nbsp;&nbsp;Les noms de fichiers</a></li>
<li><a class="reference internal" href="#les-attributs-des-fichiers" id="id95">7.3.8&nbsp;&nbsp;&nbsp;Les attributs des fichiers</a></li>
<li><a class="reference internal" href="#les-types-de-fichiers" id="id96">7.3.9&nbsp;&nbsp;&nbsp;Les types de fichiers</a></li>
<li><a class="reference internal" href="#dev" id="id97">7.3.10&nbsp;&nbsp;&nbsp;/dev</a></li>
<li><a class="reference internal" href="#sys" id="id98">7.3.11&nbsp;&nbsp;&nbsp;/sys</a></li>
<li><a class="reference internal" href="#proc" id="id99">7.3.12&nbsp;&nbsp;&nbsp;/proc</a></li>
</ul>
</li>
<li><a class="reference internal" href="#enchainement-et-parallelisation-des-commandes" id="id100">7.4&nbsp;&nbsp;&nbsp;Enchaînement et parallélisation des commandes</a></li>
<li><a class="reference internal" href="#les-flux-standards" id="id101">7.5&nbsp;&nbsp;&nbsp;Les flux standards</a></li>
<li><a class="reference internal" href="#input-output" id="id102">7.6&nbsp;&nbsp;&nbsp;Input, Output</a></li>
<li><a class="reference internal" href="#les-redirections" id="id103">7.7&nbsp;&nbsp;&nbsp;Les redirections</a></li>
<li><a class="reference internal" href="#les-pipes" id="id104">7.8&nbsp;&nbsp;&nbsp;Les pipes</a></li>
<li><a class="reference internal" href="#les-alias" id="id105">7.9&nbsp;&nbsp;&nbsp;Les alias</a></li>
<li><a class="reference internal" href="#screen" id="id106">7.10&nbsp;&nbsp;&nbsp;screen</a></li>
<li><a class="reference internal" href="#ssh" id="id107">7.11&nbsp;&nbsp;&nbsp;ssh</a></li>
<li><a class="reference internal" href="#iptables-et-ufw" id="id108">7.12&nbsp;&nbsp;&nbsp;iptables et ufw</a></li>
</ul>
</li>
<li><a class="reference internal" href="#gestion-des-permissions-et-droits-d-acces" id="id109">8&nbsp;&nbsp;&nbsp;Gestion des permissions et droits d'accès</a><ul class="auto-toc">
<li><a class="reference internal" href="#concepts" id="id110">8.1&nbsp;&nbsp;&nbsp;Concepts</a></li>
<li><a class="reference internal" href="#changer-le-proprietaire-ou-le-groupe-proprietaire" id="id111">8.2&nbsp;&nbsp;&nbsp;Changer le propriétaire ou le groupe propriétaire</a></li>
<li><a class="reference internal" href="#valeurs-symboliques-et-octales-des-permissions" id="id112">8.3&nbsp;&nbsp;&nbsp;Valeurs symboliques et octales des permissions</a></li>
<li><a class="reference internal" href="#changer-les-permissions-sur-les-fichiers" id="id113">8.4&nbsp;&nbsp;&nbsp;Changer les permissions sur les fichiers</a><ul class="auto-toc">
<li><a class="reference internal" href="#mode-chiffre" id="id114">8.4.1&nbsp;&nbsp;&nbsp;Mode chiffré</a></li>
<li><a class="reference internal" href="#notation-relative-aux-droits-existants" id="id115">8.4.2&nbsp;&nbsp;&nbsp;Notation relative (aux droits existants)</a></li>
<li><a class="reference internal" href="#notation-absolue" id="id116">8.4.3&nbsp;&nbsp;&nbsp;Notation absolue</a></li>
</ul>
</li>
<li><a class="reference internal" href="#umask" id="id117">8.5&nbsp;&nbsp;&nbsp;Umask</a></li>
<li><a class="reference internal" href="#acl" id="id118">8.6&nbsp;&nbsp;&nbsp;ACL</a></li>
<li><a class="reference internal" href="#attributs-etendus" id="id119">8.7&nbsp;&nbsp;&nbsp;Attributs étendus</a></li>
<li><a class="reference internal" href="#affectation-des-acl" id="id120">8.8&nbsp;&nbsp;&nbsp;Affectation des ACL</a></li>
</ul>
</li>
<li><a class="reference internal" href="#les-processus" id="id121">9&nbsp;&nbsp;&nbsp;Les processus</a><ul class="auto-toc">
<li><a class="reference internal" href="#definition" id="id122">9.1&nbsp;&nbsp;&nbsp;Définition</a></li>
<li><a class="reference internal" href="#attributs-d-un-processus" id="id123">9.2&nbsp;&nbsp;&nbsp;Attributs d'un processus</a></li>
<li><a class="reference internal" href="#cycle-de-vie-d-un-processus" id="id124">9.3&nbsp;&nbsp;&nbsp;Cycle de vie d'un processus</a></li>
<li><a class="reference internal" href="#les-differentes-sortes-de-processus" id="id125">9.4&nbsp;&nbsp;&nbsp;Les différentes sortes de processus</a></li>
<li><a class="reference internal" href="#envoi-de-signaux-aux-processus" id="id126">9.5&nbsp;&nbsp;&nbsp;Envoi de signaux aux processus</a></li>
<li><a class="reference internal" href="#les-commandes-liees-a-la-gestion-des-processus" id="id127">9.6&nbsp;&nbsp;&nbsp;Les commandes liées à la gestion des processus</a></li>
<li><a class="reference internal" href="#arriere-plan-avant-plan-detachement" id="id128">9.7&nbsp;&nbsp;&nbsp;Arrière plan / Avant plan / Détachement</a></li>
<li><a class="reference internal" href="#modification-des-priorites" id="id129">9.8&nbsp;&nbsp;&nbsp;Modification des priorités</a></li>
</ul>
</li>
<li><a class="reference internal" href="#planification-de-taches" id="id130">10&nbsp;&nbsp;&nbsp;Planification de tâches</a><ul class="auto-toc">
<li><a class="reference internal" href="#la-commande-crontab" id="id131">10.1&nbsp;&nbsp;&nbsp;La commande crontab</a></li>
<li><a class="reference internal" href="#le-fichier-crontab-systeme" id="id132">10.2&nbsp;&nbsp;&nbsp;Le fichier crontab système</a></li>
<li><a class="reference internal" href="#la-commande-at" id="id133">10.3&nbsp;&nbsp;&nbsp;La commande at</a></li>
</ul>
</li>
<li><a class="reference internal" href="#les-utilisateurs-et-les-groupes" id="id134">11&nbsp;&nbsp;&nbsp;Les utilisateurs et les groupes</a><ul class="auto-toc">
<li><a class="reference internal" href="#qu-est-qu-un-utilisateur" id="id135">11.1&nbsp;&nbsp;&nbsp;Qu'est qu'un utilisateur ?</a></li>
<li><a class="reference internal" href="#qu-est-qu-un-groupe" id="id136">11.2&nbsp;&nbsp;&nbsp;Qu'est qu'un groupe ?</a></li>
<li><a class="reference internal" href="#gestion-des-comptes" id="id137">11.3&nbsp;&nbsp;&nbsp;Gestion des comptes</a><ul class="auto-toc">
<li><a class="reference internal" href="#ajouter-un-utilisateur" id="id138">11.3.1&nbsp;&nbsp;&nbsp;Ajouter un utilisateur</a></li>
<li><a class="reference internal" href="#supprimer-un-utilisateur" id="id139">11.3.2&nbsp;&nbsp;&nbsp;Supprimer un utilisateur</a></li>
<li><a class="reference internal" href="#desactiver-un-compte-utilisateur" id="id140">11.3.3&nbsp;&nbsp;&nbsp;Désactiver un compte utilisateur</a></li>
<li><a class="reference internal" href="#changer-le-mot-de-passe-d-un-utilisateur" id="id141">11.3.4&nbsp;&nbsp;&nbsp;Changer le mot de passe d'un utilisateur</a></li>
<li><a class="reference internal" href="#afficher-des-informations-d-un-utilisateur" id="id142">11.3.5&nbsp;&nbsp;&nbsp;Afficher des informations d'un utilisateur</a></li>
<li><a class="reference internal" href="#modifier-les-informations-d-un-utilisateur" id="id143">11.3.6&nbsp;&nbsp;&nbsp;Modifier les informations d'un utilisateur</a></li>
<li><a class="reference internal" href="#changer-d-identite" id="id144">11.3.7&nbsp;&nbsp;&nbsp;Changer d'identité</a></li>
</ul>
</li>
<li><a class="reference internal" href="#gestion-des-groupes" id="id145">11.4&nbsp;&nbsp;&nbsp;Gestion des groupes</a><ul class="auto-toc">
<li><a class="reference internal" href="#creer-un-groupe" id="id146">11.4.1&nbsp;&nbsp;&nbsp;Créer un groupe</a></li>
<li><a class="reference internal" href="#afficher-des-informations-sur-les-groupes" id="id147">11.4.2&nbsp;&nbsp;&nbsp;Afficher des informations sur les groupes</a></li>
<li><a class="reference internal" href="#ajouter-un-utilisateur-a-un-groupe" id="id148">11.4.3&nbsp;&nbsp;&nbsp;Ajouter un utilisateur à un groupe</a></li>
<li><a class="reference internal" href="#changer-de-groupe-principal" id="id149">11.4.4&nbsp;&nbsp;&nbsp;Changer de groupe principal</a></li>
<li><a class="reference internal" href="#modifier-un-groupe" id="id150">11.4.5&nbsp;&nbsp;&nbsp;Modifier un groupe</a></li>
<li><a class="reference internal" href="#supprimer-un-groupe" id="id151">11.4.6&nbsp;&nbsp;&nbsp;Supprimer un groupe</a></li>
</ul>
</li>
<li><a class="reference internal" href="#le-fichier-etc-passwd" id="id152">11.5&nbsp;&nbsp;&nbsp;Le fichier /etc/passwd</a></li>
<li><a class="reference internal" href="#le-fichier-etc-shadow" id="id153">11.6&nbsp;&nbsp;&nbsp;Le fichier /etc/shadow</a></li>
<li><a class="reference internal" href="#le-fichier-etc-group" id="id154">11.7&nbsp;&nbsp;&nbsp;Le fichier /etc/group</a></li>
<li><a class="reference internal" href="#installation-openldap" id="id155">11.8&nbsp;&nbsp;&nbsp;Installation openldap</a></li>
</ul>
</li>
<li><a class="reference internal" href="#syslog" id="id156">12&nbsp;&nbsp;&nbsp;Syslog</a><ul class="auto-toc">
<li><a class="reference internal" href="#modification-de-la-configuration-de-logrotate" id="id157">12.1&nbsp;&nbsp;&nbsp;Modification de la configuration de logrotate</a></li>
</ul>
</li>
<li><a class="reference internal" href="#peripherique-disque-et-systeme-de-fichiers" id="id158">13&nbsp;&nbsp;&nbsp;Périphérique disque et système de fichiers</a><ul class="auto-toc">
<li><a class="reference internal" href="#les-disques-durs-sous-linux" id="id159">13.1&nbsp;&nbsp;&nbsp;Les disques durs sous Linux</a></li>
<li><a class="reference internal" href="#les-concepts" id="id160">13.2&nbsp;&nbsp;&nbsp;Les concepts</a></li>
<li><a class="reference internal" href="#les-systemes-de-fichiers" id="id161">13.3&nbsp;&nbsp;&nbsp;Les systèmes de fichiers</a></li>
<li><a class="reference internal" href="#partitions" id="id162">13.4&nbsp;&nbsp;&nbsp;Partitions</a></li>
<li><a class="reference internal" href="#utilitaires-de-partitionnement" id="id163">13.5&nbsp;&nbsp;&nbsp;Utilitaires de partitionnement</a></li>
<li><a class="reference internal" href="#arborescence-standard-et-organisation-du-fhs" id="id164">13.6&nbsp;&nbsp;&nbsp;Arborescence standard et organisation du FHS</a><ul class="auto-toc">
<li><a class="reference internal" href="#arborescence-de" id="id165">13.6.1&nbsp;&nbsp;&nbsp;Arborescence de /</a></li>
<li><a class="reference internal" href="#arborescence-de-usr" id="id166">13.6.2&nbsp;&nbsp;&nbsp;Arborescence de /usr</a></li>
<li><a class="reference internal" href="#arborescence-de-var" id="id167">13.6.3&nbsp;&nbsp;&nbsp;Arborescence de /var</a></li>
</ul>
</li>
<li><a class="reference internal" href="#formater-une-partition" id="id168">13.7&nbsp;&nbsp;&nbsp;Formater une partition</a></li>
<li><a class="reference internal" href="#monter-demonter-une-partition" id="id169">13.8&nbsp;&nbsp;&nbsp;Monter / Démonter une partition</a></li>
<li><a class="reference internal" href="#les-tables-de-montage-etc-fstab" id="id170">13.9&nbsp;&nbsp;&nbsp;Les tables de montage : /etc/fstab</a></li>
<li><a class="reference internal" href="#tables-systemes-inodes" id="id171">13.10&nbsp;&nbsp;&nbsp;Tables systèmes, inodes</a></li>
<li><a class="reference internal" href="#journalisation" id="id172">13.11&nbsp;&nbsp;&nbsp;Journalisation</a></li>
<li><a class="reference internal" href="#controle-des-systemes-de-fichiers" id="id173">13.12&nbsp;&nbsp;&nbsp;Contrôle des systèmes de fichiers</a></li>
<li><a class="reference internal" href="#montage-des-peripheriques-amovibles" id="id174">13.13&nbsp;&nbsp;&nbsp;Montage des périphériques amovibles</a></li>
<li><a class="reference internal" href="#utilitaire-smartd" id="id175">13.14&nbsp;&nbsp;&nbsp;Utilitaire smartd</a></li>
<li><a class="reference internal" href="#les-montages-en-raid" id="id176">13.15&nbsp;&nbsp;&nbsp;Les montages en raid</a><ul class="auto-toc">
<li><a class="reference internal" href="#le-raid-0" id="id177">13.15.1&nbsp;&nbsp;&nbsp;Le RAID 0</a></li>
<li><a class="reference internal" href="#le-raid-1" id="id178">13.15.2&nbsp;&nbsp;&nbsp;Le RAID 1</a></li>
<li><a class="reference internal" href="#le-raid-5" id="id179">13.15.3&nbsp;&nbsp;&nbsp;Le RAID 5</a></li>
<li><a class="reference internal" href="#la-gestion-du-raid-logiciel-par-linux" id="id180">13.15.4&nbsp;&nbsp;&nbsp;La gestion du RAID logiciel par Linux</a></li>
</ul>
</li>
<li><a class="reference internal" href="#lvm" id="id181">13.16&nbsp;&nbsp;&nbsp;LVM</a></li>
</ul>
</li>
<li><a class="reference internal" href="#python" id="id182">14&nbsp;&nbsp;&nbsp;Python</a><ul class="auto-toc">
<li><a class="reference internal" href="#id2" id="id183">14.1&nbsp;&nbsp;&nbsp;Historique</a></li>
<li><a class="reference internal" href="#la-notion-d-objet" id="id184">14.2&nbsp;&nbsp;&nbsp;La notion d'objet</a></li>
<li><a class="reference internal" href="#la-notion-de-classe" id="id185">14.3&nbsp;&nbsp;&nbsp;La notion de classe</a></li>
<li><a class="reference internal" href="#l-instruction-print" id="id186">14.4&nbsp;&nbsp;&nbsp;L'instruction print</a></li>
<li><a class="reference internal" href="#les-primitives-d-acces-aux-informations-de-type" id="id187">14.5&nbsp;&nbsp;&nbsp;Les primitives d'accès aux informations de type</a></li>
<li><a class="reference internal" href="#les-commentaires" id="id188">14.6&nbsp;&nbsp;&nbsp;Les commentaires</a></li>
<li><a class="reference internal" href="#les-chaines-de-caracteres" id="id189">14.7&nbsp;&nbsp;&nbsp;Les chaînes de caractères</a></li>
<li><a class="reference internal" href="#les-numeriques" id="id190">14.8&nbsp;&nbsp;&nbsp;Les numériques</a></li>
<li><a class="reference internal" href="#les-types-a-valeur-unique" id="id191">14.9&nbsp;&nbsp;&nbsp;Les types à valeur unique</a></li>
<li><a class="reference internal" href="#les-sequences" id="id192">14.10&nbsp;&nbsp;&nbsp;Les séquences</a></li>
<li><a class="reference internal" href="#les-operateurs" id="id193">14.11&nbsp;&nbsp;&nbsp;Les opérateurs</a></li>
<li><a class="reference internal" href="#operateurs-binaires" id="id194">14.12&nbsp;&nbsp;&nbsp;Opérateurs binaires</a></li>
<li><a class="reference internal" href="#operateurs-de-comparaison" id="id195">14.13&nbsp;&nbsp;&nbsp;Opérateurs de comparaison</a></li>
<li><a class="reference internal" href="#ordre-de-traitement-des-operations" id="id196">14.14&nbsp;&nbsp;&nbsp;Ordre de traitement des opérations</a></li>
<li><a class="reference internal" href="#l-instruction-pass" id="id197">14.15&nbsp;&nbsp;&nbsp;L'instruction pass</a></li>
<li><a class="reference internal" href="#l-indentation" id="id198">14.16&nbsp;&nbsp;&nbsp;L'indentation</a></li>
<li><a class="reference internal" href="#les-structures-conditionnelles" id="id199">14.17&nbsp;&nbsp;&nbsp;Les structures conditionnelles</a></li>
<li><a class="reference internal" href="#id3" id="id200">14.18&nbsp;&nbsp;&nbsp;Les fonctions</a></li>
<li><a class="reference internal" href="#les-docstrings" id="id201">14.19&nbsp;&nbsp;&nbsp;Les docstrings</a></li>
<li><a class="reference internal" href="#les-decorateurs" id="id202">14.20&nbsp;&nbsp;&nbsp;Les décorateurs</a></li>
<li><a class="reference internal" href="#les-classes" id="id203">14.21&nbsp;&nbsp;&nbsp;Les Classes</a></li>
<li><a class="reference internal" href="#les-exceptions" id="id204">14.22&nbsp;&nbsp;&nbsp;Les exceptions</a></li>
<li><a class="reference internal" href="#les-modules" id="id205">14.23&nbsp;&nbsp;&nbsp;Les modules</a></li>
<li><a class="reference internal" href="#les-paquets" id="id206">14.24&nbsp;&nbsp;&nbsp;Les paquets</a></li>
<li><a class="reference internal" href="#les-principaux-modules" id="id207">14.25&nbsp;&nbsp;&nbsp;Les principaux modules</a><ul class="auto-toc">
<li><a class="reference internal" href="#builtin" id="id208">14.25.1&nbsp;&nbsp;&nbsp;__builtin__</a></li>
<li><a class="reference internal" href="#id12" id="id209">14.25.2&nbsp;&nbsp;&nbsp;sys</a></li>
<li><a class="reference internal" href="#os" id="id210">14.25.3&nbsp;&nbsp;&nbsp;os</a></li>
<li><a class="reference internal" href="#gzip-zipfile" id="id211">14.25.4&nbsp;&nbsp;&nbsp;gzip, zipfile</a></li>
<li><a class="reference internal" href="#socket" id="id212">14.25.5&nbsp;&nbsp;&nbsp;socket</a></li>
<li><a class="reference internal" href="#urllib2" id="id213">14.25.6&nbsp;&nbsp;&nbsp;urllib2</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#initialisation-du-systeme-et-des-services" id="id214">15&nbsp;&nbsp;&nbsp;Initialisation du système et des services</a><ul class="auto-toc">
<li><a class="reference internal" href="#la-sequence-de-boot" id="id215">15.1&nbsp;&nbsp;&nbsp;La séquence de boot</a></li>
<li><a class="reference internal" href="#grub" id="id216">15.2&nbsp;&nbsp;&nbsp;GRUB</a></li>
<li><a class="reference internal" href="#demarrage-du-noyau" id="id217">15.3&nbsp;&nbsp;&nbsp;Démarrage du noyau</a></li>
<li><a class="reference internal" href="#les-arguments-ou-parametres-du-kernel" id="id218">15.4&nbsp;&nbsp;&nbsp;Les arguments ou paramètres du kernel</a></li>
<li><a class="reference internal" href="#systemd-vs-initv-vs-upstart" id="id219">15.5&nbsp;&nbsp;&nbsp;Systemd vs InitV vs upstart</a></li>
<li><a class="reference internal" href="#les-niveaux-d-execution-run-level" id="id220">15.6&nbsp;&nbsp;&nbsp;Les niveaux d'exécution (Run level)</a></li>
<li><a class="reference internal" href="#le-systeme-de-demarrage-des-services" id="id221">15.7&nbsp;&nbsp;&nbsp;Le système de démarrage des services</a></li>
<li><a class="reference internal" href="#changement-du-niveau-d-execution" id="id222">15.8&nbsp;&nbsp;&nbsp;Changement du niveau d'exécution</a></li>
</ul>
</li>
<li><a class="reference internal" href="#modules" id="id223">16&nbsp;&nbsp;&nbsp;Modules</a></li>
<li><a class="reference internal" href="#configuration-reseau-et-outils-tcp-ip" id="id224">17&nbsp;&nbsp;&nbsp;Configuration réseau et outils TCP/IP</a><ul class="auto-toc">
<li><a class="reference internal" href="#id13" id="id225">17.1&nbsp;&nbsp;&nbsp;Introduction</a></li>
<li><a class="reference internal" href="#configuration-automatique" id="id226">17.2&nbsp;&nbsp;&nbsp;Configuration automatique</a></li>
<li><a class="reference internal" href="#la-commande-ip" id="id227">17.3&nbsp;&nbsp;&nbsp;La commande ip</a></li>
<li><a class="reference internal" href="#ifconfig-deprecie" id="id228">17.4&nbsp;&nbsp;&nbsp;ifconfig (déprécié)</a></li>
<li><a class="reference internal" href="#iwconfig-deprecie" id="id229">17.5&nbsp;&nbsp;&nbsp;iwconfig (déprécié)</a></li>
<li><a class="reference internal" href="#ifup-ifdown-deprecie" id="id230">17.6&nbsp;&nbsp;&nbsp;ifup/ifdown (déprécié)</a></li>
<li><a class="reference internal" href="#route-deprecie" id="id231">17.7&nbsp;&nbsp;&nbsp;route (déprécié)</a></li>
<li><a class="reference internal" href="#ip" id="id232">17.8&nbsp;&nbsp;&nbsp;ip</a></li>
<li><a class="reference internal" href="#les-interfaces-virtuelles" id="id233">17.9&nbsp;&nbsp;&nbsp;Les interfaces virtuelles</a></li>
<li><a class="reference internal" href="#fixer-le-nom-de-machine" id="id234">17.10&nbsp;&nbsp;&nbsp;Fixer le nom de machine</a></li>
<li><a class="reference internal" href="#demarrage-et-arret-du-reseau" id="id235">17.11&nbsp;&nbsp;&nbsp;Démarrage et arrêt du réseau</a></li>
<li><a class="reference internal" href="#la-resolution-de-nom" id="id236">17.12&nbsp;&nbsp;&nbsp;La résolution de nom</a></li>
<li><a class="reference internal" href="#la-modification-du-fichier-etc-hosts" id="id237">17.13&nbsp;&nbsp;&nbsp;La modification du fichier /etc/hosts</a></li>
<li><a class="reference internal" href="#les-outils-et-commandes-de-tests-reseau" id="id238">17.14&nbsp;&nbsp;&nbsp;Les outils et commandes de tests réseau</a><ul class="auto-toc">
<li><a class="reference internal" href="#ping" id="id239">17.14.1&nbsp;&nbsp;&nbsp;ping</a></li>
<li><a class="reference internal" href="#host" id="id240">17.14.2&nbsp;&nbsp;&nbsp;host</a></li>
<li><a class="reference internal" href="#netstat" id="id241">17.14.3&nbsp;&nbsp;&nbsp;netstat</a></li>
<li><a class="reference internal" href="#tcpdump" id="id242">17.14.4&nbsp;&nbsp;&nbsp;tcpdump</a></li>
<li><a class="reference internal" href="#nmap" id="id243">17.14.5&nbsp;&nbsp;&nbsp;nmap</a></li>
<li><a class="reference internal" href="#ngrep" id="id244">17.14.6&nbsp;&nbsp;&nbsp;ngrep</a></li>
<li><a class="reference internal" href="#wireshark" id="id245">17.14.7&nbsp;&nbsp;&nbsp;wireshark</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#gestion-des-paquetages-et-installation-de-logiciels-sous-ubuntu" id="id246">18&nbsp;&nbsp;&nbsp;Gestion des paquetages et installation de logiciels sous Ubuntu</a><ul class="auto-toc">
<li><a class="reference internal" href="#ubuntu-un-systeme-grand-public" id="id247">18.1&nbsp;&nbsp;&nbsp;Ubuntu, un système &quot;Grand Public&quot;</a></li>
<li><a class="reference internal" href="#quelle-version-choisir-et-pour-quel-usage" id="id248">18.2&nbsp;&nbsp;&nbsp;Quelle version choisir et pour quel usage ?</a></li>
<li><a class="reference internal" href="#les-depots" id="id249">18.3&nbsp;&nbsp;&nbsp;Les dépôts</a></li>
<li><a class="reference internal" href="#installation-de-paquets" id="id250">18.4&nbsp;&nbsp;&nbsp;Installation de paquets</a></li>
<li><a class="reference internal" href="#suppression-de-paquets" id="id251">18.5&nbsp;&nbsp;&nbsp;Suppression de paquets</a></li>
<li><a class="reference internal" href="#informations-sur-les-paquetages" id="id252">18.6&nbsp;&nbsp;&nbsp;Informations sur les paquetages</a></li>
<li><a class="reference internal" href="#recherche-de-paquetages" id="id253">18.7&nbsp;&nbsp;&nbsp;Recherche de paquetages</a></li>
<li><a class="reference internal" href="#mise-a-jour-des-paquetages" id="id254">18.8&nbsp;&nbsp;&nbsp;Mise à jour des paquetages</a></li>
<li><a class="reference internal" href="#interfaces-graphiques" id="id255">18.9&nbsp;&nbsp;&nbsp;Interfaces graphiques</a></li>
<li><a class="reference internal" href="#commande-alien" id="id256">18.10&nbsp;&nbsp;&nbsp;Commande alien</a></li>
</ul>
</li>
<li><a class="reference internal" href="#apache" id="id257">19&nbsp;&nbsp;&nbsp;Apache</a><ul class="auto-toc">
<li><a class="reference internal" href="#presentation" id="id258">19.1&nbsp;&nbsp;&nbsp;Présentation</a></li>
<li><a class="reference internal" href="#id14" id="id259">19.2&nbsp;&nbsp;&nbsp;Installation</a></li>
<li><a class="reference internal" href="#configuration" id="id260">19.3&nbsp;&nbsp;&nbsp;Configuration</a></li>
<li><a class="reference internal" href="#securisation" id="id261">19.4&nbsp;&nbsp;&nbsp;Sécurisation</a></li>
<li><a class="reference internal" href="#tracage" id="id262">19.5&nbsp;&nbsp;&nbsp;Traçage</a></li>
</ul>
</li>
<li><a class="reference internal" href="#postfix" id="id263">20&nbsp;&nbsp;&nbsp;Postfix</a><ul class="auto-toc">
<li><a class="reference internal" href="#id15" id="id264">20.1&nbsp;&nbsp;&nbsp;Présentation</a></li>
<li><a class="reference internal" href="#id16" id="id265">20.2&nbsp;&nbsp;&nbsp;Installation</a></li>
<li><a class="reference internal" href="#id17" id="id266">20.3&nbsp;&nbsp;&nbsp;Configuration</a></li>
</ul>
</li>
<li><a class="reference internal" href="#mysql" id="id267">21&nbsp;&nbsp;&nbsp;MySQL</a><ul class="auto-toc">
<li><a class="reference internal" href="#id18" id="id268">21.1&nbsp;&nbsp;&nbsp;Présentation</a></li>
<li><a class="reference internal" href="#id19" id="id269">21.2&nbsp;&nbsp;&nbsp;Installation</a></li>
<li><a class="reference internal" href="#id20" id="id270">21.3&nbsp;&nbsp;&nbsp;Configuration</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id21" id="id271">22&nbsp;&nbsp;&nbsp;Sécurisation</a><ul class="auto-toc">
<li><a class="reference internal" href="#certificat-x-509" id="id272">22.1&nbsp;&nbsp;&nbsp;Certificat X 509</a></li>
<li><a class="reference internal" href="#postgrey" id="id273">22.2&nbsp;&nbsp;&nbsp;postgrey</a></li>
<li><a class="reference internal" href="#fail2ban" id="id274">22.3&nbsp;&nbsp;&nbsp;fail2ban</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="objectif">
<h1><a class="toc-backref" href="#id25">1&nbsp;&nbsp;&nbsp;Objectif</a></h1>
<p>Cette formation a pour but de fournir les bases indispensables à l'utilisation et à l'administration des systèmes GNU/Linux.</p>
<p>La formation privilégie la distribution Ubuntu.</p>
</div>
<div class="section" id="introduction">
<h1><a class="toc-backref" href="#id26">2&nbsp;&nbsp;&nbsp;Introduction</a></h1>
<p>En 1991, l'étudiant finlandais Linus Torvalds publie sur internet l'intégralité du code source d'un noyau Unix qu'il a écrit en C et en assembleur et qui fonctionne sur PC AT 386(486).</p>
<p>Depuis cette date GNU/Linux ne cesse d'évoluer. Il occupe en 2015 1,6% <a class="footnote-reference" href="#id24" id="id1">[1]</a> du marché mondial des systèmes d'exploitation pour ordinateur personnel, plus de 60% des serveurs web, prés de 75% du Cloud et plus de 80% des smartphones (Android étant basé sur GNU/Linux) et est en autre utilisé en France par la Gendarmerie (Ubuntu) et par l'Assemblée Nationale (Ubuntu), dans la Freebox, par l'entreprise Google (Android) et la fondation Wikipedia (serveur Ubuntu).</p>
</div>
<div class="section" id="historique">
<h1><a class="toc-backref" href="#id27">3&nbsp;&nbsp;&nbsp;Historique</a></h1>
<div class="section" id="unix-les-racines">
<h2><a class="toc-backref" href="#id28">3.1&nbsp;&nbsp;&nbsp;UNIX (les racines)</a></h2>
<div class="figure align-center">
<img alt="HistoriqueUnix.jpg" src="HistoriqueUnix.jpg" />
<p class="caption">Histoire des Unix (source wikipedia)</p>
</div>
<p>Ken Thompson, ingénieur d'AT&amp;T travaille en collaboration avec le MIT au Bell Labs sur Multics.</p>
<p>En 1969 il créait un système d'exploitation inspiré de Multics. Brian Kernighan le nommera Unics.</p>
<p>En 1971 Unics devient Unix et est alors récrit en C spécialement développé pour cela par Dennis Ritchie.</p>
<p>1973 AT&amp;T diffuse Unix avec ses sources à ses clients (première licence open source).</p>
<p>1974 l'Université de Californie Berkeley (UCB) commence ses recherches sur UNIX en collaboration étroite avec AT&amp;T.</p>
<p>1977 Bill Joy alors étudiant à l'UCB réalise la première version de BSD (Berkeley Software Distribution).</p>
<p>À partir de là, les éditions se succèdent (SYSTEM III puis V en 1985 et SVR2 à SVR4 pour AT&amp;T, 4.2BSD pour l'UCB en 1983).</p>
<p>La DARPA finance BSD ce qui aboutit à l'intégration de la première pile TCP/IP en 1983 qui sera intégrée telle quel dans Windows en raison de sa licence permissive.</p>
<p>1985 la 4.3 BSD n'est plus livrée avec les sources de AT&amp;T en raison du prix excessif de la licence.</p>
<p>Face à ce problème, l'UCB réécrit et nettoie complètement son UNIX qui sort en 1989 sous le nom NetBSD. Le noyau est alors le MACH de l'université de Carnegie-Mellon. L'accès aux sources et à la distribution complète devient gratuit.</p>
<p>1991 Sun Microsystems co-fondé en 1982 par Bill Joy sort SunOS qui deviendra Solaris.</p>
<p>1992 Procès AT&amp;T BSD</p>
<p>FreeBSD apparaît en 1993 comme le portage de NetBSD sur i386</p>
<p>1998 Solaris supporte le 64 bits</p>
<p>1999 Mac OS X (server)</p>
<p>2005 Open Solaris</p>
<p>Octobre 2008 version 4.0.1 de NetBSD</p>
<p>Janvier 2009 version 7.1 de FreeBSD</p>
<p>La Free Software Foundation (FSF), le projet GNU</p>
<p>1983 Richard Stallman (RMS) qui travaillait au laboratoire d'intelligence artificielle du MIT crée le projet GNU.</p>
<p>GNU est un acronyme récursif (GNU's Not Unix).</p>
<p>GNU a pour objectif de fournir un système d'exploitation compatible avec UNIX sans dépendre des ayant droits (AT&amp;T et BSD) dont RMS récuse les licences.</p>
<p>1985 création de la Free Software Foundation (FSF) organisation américaine à but non lucratif pour le soutien du logiciel libre.</p>
<p>1987 Rob Pike, Ken Thompson et Dennis Ritchie débutent les travaux de Plan 9 qui inspirera les UNIX modernes.</p>
<p>1989 écriture de la GNU GPL (GNU Genral Public Licence ou  GPL) version 1.</p>
<p>1990 le système GNU possède son propre éditeur (Emacs), d'un compilateur C (GCC), et d'une réécriture de la plupart des bibliothèques système d'UNIX.</p>
<p>1991 le noyau Linux utilise la GPL et GCC.</p>
<p>1997 lancement de GNOME un environnement graphique dont l'objectif était de fournir une alternative libre à l'environnement KDE qui utilisait la bibliothèque Qt alors non libre.</p>
</div>
<div class="section" id="la-licence-bsd-versus-la-licence-gpl">
<h2><a class="toc-backref" href="#id29">3.2&nbsp;&nbsp;&nbsp;La licence BSD versus la licence GPL</a></h2>
<p>Il existe presque plusieurs centaines de licences appliquées aux logiciels libres, mais dans la majorité des cas on peut les séparer en deux catégories selon qu'elles sont compatibles avec la licence BSD ou la licence GPL.</p>
</div>
<div class="section" id="la-licence-gpl">
<h2><a class="toc-backref" href="#id30">3.3&nbsp;&nbsp;&nbsp;La licence GPL</a></h2>
<p>La licence GPL a pour but de protéger l'auteur et l'utilisateur en garantissant les droits suivants (appelés libertés) :</p>
<ol class="arabic simple">
<li>La liberté d'exécuter le logiciel, pour n'importe quel usage ;</li>
<li>La liberté d'étudier le fonctionnement d'un programme et de l'adapter à ses besoins, ce qui passe par l'accès aux codes sources ;</li>
<li>La liberté de redistribuer des copies ;</li>
<li>La liberté d'améliorer le programme et de rendre publiques les modifications afin que l'ensemble de la communauté en bénéficie.</li>
</ol>
<p>En contrepartie l'utilisation du logiciel est au risque et péril de l'utilisateur.</p>
<div class="section" id="le-gauche-d-auteur">
<h3><a class="toc-backref" href="#id31">3.3.1&nbsp;&nbsp;&nbsp;Le gauche d'auteur</a></h3>
<p>Le code n'est pas dans le domaine public.</p>
<p>Il est protégé par le droit d'auteur.</p>
<p>L'exécution du logiciel et la diffusion des sources modifiées ne sont possibles qu'à la condition de respecter les obligations de la licence.</p>
<p>Notamment :</p>
<blockquote>
<p>Le droit de redistribuer est garanti seulement si l'utilisateur fournit le code source de la version modifiée. En outre, les copies distribuées, incluant les modifications, doivent être aussi sous les termes de la GPL.</p>
<p>Cette condition est connue sous le nom de copyleft.</p>
<p>Puisque le logiciel est protégé par les droits d'auteurs, l'utilisateur ne peut le modifier ou le redistribuer, sauf sous les termes du copyleft. En conséquence l'utilisateur doit à son tour fournir les sources et placer ses modifications sous GPL.</p>
</blockquote>
<p>Puisque le copyleft des versions 1 et 2 de la GPL ne s'appliquait pas aux entrées sorties du programme, il était possible dans le cas par exemple d'un service web de contourner l'obligation de diffusion des sources. De même, il suffisait de transformer tout code GPL en bibliothèque dynamique pour ne pas propager la GPL aux extensions apportées à un programme existant.</p>
<p>Cette faille a été corrigée avec la version GPL v3 qui accorde aux utilisateurs d’un programme accédé par réseau les mêmes droits que les utilisateurs d’un programme installé localement.</p>
<p>La GPL a été adaptée au droit Français par le CEA, CNRS, INRIA sous le nom de CECILL. Sa version 2 est compatible avec la licence publique générale GNU.</p>
<p>Le 28 mars 2007 le tribunal de grande instance de Paris a jugé applicable la licence GPL (v2).</p>
</div>
</div>
<div class="section" id="la-licence-bsd">
<h2><a class="toc-backref" href="#id32">3.4&nbsp;&nbsp;&nbsp;La licence BSD</a></h2>
<p>La licence BSD permet l'utilisation du logiciel et la réutilisation de n'importe quelle partie de son code source sans restriction. La seule obligation était la mention des auteurs initiaux.</p>
<p>Pour pouvoir utiliser le logiciel écrit sous licence BSD l'utilisateur accepte de ne pas se retourner contre les auteurs en cas de problèmes.</p>
<p>Un logiciel propriétaire peut donc être réalisé à partir du code source d'un logiciel BSD (C.f. pile TCP/IP dans Windows).</p>
</div>
<div class="section" id="gnu-linux">
<h2><a class="toc-backref" href="#id33">3.5&nbsp;&nbsp;&nbsp;GNU/Linux</a></h2>
<p>Linux est développé sur internet par des milliers de contributeurs distants de nationalité et de culture différentes.
C'est l'un des projets collaboratifs les plus importants.</p>
</div>
</div>
<div class="section" id="les-distributions">
<h1><a class="toc-backref" href="#id34">4&nbsp;&nbsp;&nbsp;Les distributions</a></h1>
<div class="section" id="qu-est-ce-qu-un-noyau">
<h2><a class="toc-backref" href="#id35">4.1&nbsp;&nbsp;&nbsp;Qu'est-ce qu'un noyau ?</a></h2>
<dl class="docutils">
<dt>Pour définir le noyau, nous pouvons nous baser sur les services qu'il fournit :</dt>
<dd>Abstraction du matériel (fourniture d'interface)
Gestion des interruptions
Gestion des tâches et autres logiciels
Gestion des utilisateurs
Gestion des droits d'accès</dd>
</dl>
<p>Historiquement on distingue les micro-noyaux des noyaux monolithiques.
Cette séparation vient de ce que le noyau est censé gérer (kernel space) et donc de ce qui est de la responsabilité des utilisateurs (user space). Dans les faits aujourd'hui même les noyaux monolithiques comme Linux sont modulaires et ne charge les modules que si nécessaire pendant l'utilisation.</p>
</div>
<div class="section" id="qu-est-ce-qu-une-distribution">
<h2><a class="toc-backref" href="#id36">4.2&nbsp;&nbsp;&nbsp;Qu'est ce qu'une distribution ?</a></h2>
<p>Une distribution est un ensemble cohérent de logiciels fourni avec un noyau (Linux ou BSD). Les logiciels sont choisis pour utiliser les mêmes versions de bibliothèque et être compatibles les uns avec les autres ce qui a pour conséquence d'augmenter la stabilité et d'améliorer l'utilisation.</p>
<p>Elles comprennent des outils d'installation et de configuration.</p>
<p>Il en existe de nombreuses couvrant des besoins et des usages différents (ordinateur personnel, de bureau, serveur, passerelle, intrusion, multimédia center), ou des matériels spécifiques.</p>
</div>
<div class="section" id="les-differentes-distributions-gnu-linux">
<h2><a class="toc-backref" href="#id37">4.3&nbsp;&nbsp;&nbsp;Les différentes distributions GNU/Linux</a></h2>
<p>Sont orientées vers les utilisateurs débutants :</p>
<blockquote>
<ul class="simple">
<li>Suse</li>
<li>Ubuntu Desktop,</li>
</ul>
</blockquote>
<p>Pour les serveurs :</p>
<blockquote>
<ul class="simple">
<li>Ubuntu Server</li>
<li>Debian</li>
<li>Gentoo</li>
<li>Red Hat</li>
<li>CentOS</li>
</ul>
</blockquote>
<p>Pour les développeurs :</p>
<blockquote>
<ul class="simple">
<li>Fedora</li>
<li>Red Hat</li>
</ul>
</blockquote>
<p>Les métas distributions :</p>
<blockquote>
<ul class="simple">
<li>Red hat -&gt; Fedora, CentOS</li>
<li>Debian -&gt; Ubuntu, Knoppix,</li>
<li>Gentoo -&gt; Aurora</li>
</ul>
</blockquote>
</div>
<div class="section" id="les-principales-distributions">
<h2><a class="toc-backref" href="#id38">4.4&nbsp;&nbsp;&nbsp;Les principales distributions</a></h2>
<p>Debian reste très orienté administrateur. Il est important d'être à l'aise avec la ligne de commande. Les versions stables sortent en moyenne tous les 2 ans.</p>
<p>Ubuntu reprend les outils Debian mais les versions sortent tous les 6 mois.</p>
<p>Gentoo permet une optimisation poussée du système. Il propose en priorité de compiler les sources de chacun des logiciels et donc de ne garder que les fonctionnalités voulues par l'utilisateur, en tenant compte des nombreux paramètres locaux.</p>
<p>Distributions commerciales :</p>
<blockquote>
<ul class="simple">
<li>Red Hat (<a class="reference external" href="http://www.redhat.com">http://www.redhat.com</a>),</li>
<li>Novell/SUSE (<a class="reference external" href="http://www.novell.com/linux/">http://www.novell.com/linux/</a>).</li>
</ul>
</blockquote>
<p>Distributions &quot;communautaires&quot; :</p>
<blockquote>
<ul class="simple">
<li>Gentoo (<a class="reference external" href="http://www.gentoo.org">http://www.gentoo.org</a>)</li>
<li>CentOs (<a class="reference external" href="http://www.centos.org">http://www.centos.org</a>)</li>
<li>Debian (<a class="reference external" href="http://www.debian.org">http://www.debian.org</a>)</li>
<li>Fedora (<a class="reference external" href="http://fedoraproject.org/">http://fedoraproject.org/</a>)</li>
<li>Ubuntu (<a class="reference external" href="http://www.ubuntu.com">http://www.ubuntu.com</a>)</li>
</ul>
</blockquote>
<p>Linus Torvalds défend la multiplicité des distributions.</p>
</div>
</div>
<div class="section" id="installation">
<h1><a class="toc-backref" href="#id39">5&nbsp;&nbsp;&nbsp;Installation</a></h1>
<p>Le choix d'une distribution doit se faire en fonction :</p>
<blockquote>
<ul class="simple">
<li>du besoin technique,</li>
<li>des performances voulues,</li>
<li>de la pérennité désirée,</li>
<li>du niveau de sécurisation attendu.</li>
</ul>
</blockquote>
<p>Une fois ces exigences connues, il ne reste plus qu'à se procurer les images des distributions adéquates, soit directement sur les sites des distributions, soit sur un miroir.</p>
<div class="section" id="installation-de-gnu-linux-ubuntu-version-pc-de-bureau">
<h2><a class="toc-backref" href="#id40">5.1&nbsp;&nbsp;&nbsp;Installation de GNU/Linux Ubuntu version pc de bureau</a></h2>
<p>Les versions desktop d'Ubuntu sont fournies avec l'environnement graphique Gnome, des outils de maintenance, la suite open-office, le lecteur de courrier evolution, le logiciel de dessin Gimp, le navigateur firefox, un client vnc permettant de se connecter à distance, des jeux, des logiciels multimédias.</p>
<p>Elles conviennent parfaitement à un poste de travail, mais sont à proscrire pour un serveur en raison du nombre de services fonctionnant par défaut.</p>
<div class="section" id="installation-d-ubuntu-20-04">
<h3><a class="toc-backref" href="#id41">5.1.1&nbsp;&nbsp;&nbsp;Installation d'Ubuntu 20.04</a></h3>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">CoursGNULinux.rst</tt>, line 266)</p>
<p>Title underline too short.</p>
<pre class="literal-block">
Installation d'Ubuntu 20.04
++++++++++++++++++++++++++
</pre>
</div>
<p>Choisir l'image &quot;iso&quot; d'Ubuntu correspondant à sa machine à l'adresse <a class="reference external" href="https://releases.ubuntu.com/20.04/">https://releases.ubuntu.com/20.04/</a></p>
<p>La différence entre Desktop et Server est que dans la Desktop vous aurez tout l'environnement graphique, alors que la version Server suppose une utilisation en ligne de commande.</p>
<p>Créer un disque d'amorçage en suivant <a class="reference external" href="https://help.ubuntu.com/community/BurningIsoHowto">https://help.ubuntu.com/community/BurningIsoHowto</a></p>
<p>Insérer la clé dans votre lecteur usb.
Redémarrer votre ordinateur pour pouvoir modifier les paramètres du <strong>bios</strong>.
Selon la marque de votre ordinateur la touche pour entrer dans le bios lors du démarrage est soit Ech, Entrée, F2, ou Suppr.
Modifier votre bios pour qu'il démarre sur la clé usb (généralement le menu boot).
Enregistrer et quitter le bios.
L'ordinateur va alors démarrer sur la clé et charger Ubuntu comme système d'exploitation.
Ubuntu commence par vérifier qu'il n'y a pas eu de corruption de la clé.
Puis il affiche différents écrans que nous allons expliquer ici.</p>
</div>
<div class="section" id="etape-01">
<h3><a class="toc-backref" href="#id42">5.1.2&nbsp;&nbsp;&nbsp;Étape 01</a></h3>
<div class="figure align-center">
<img alt="./images_ubuntu_20_04/00_EssayerOuInstaller.png" src="./images_ubuntu_20_04/00_EssayerOuInstaller.png" />
<p class="caption">Choix de la langue du live usb.
Et choix entre tester Ubuntu ou lancer l'istallation.</p>
</div>
<p>Si vous cliquez sur le bouton &quot;Essayer Ubuntu&quot; vous pourrez tester Ubuntu sans rien installer sur votre machine, les logiciels utilisés seront ceux présents sur la clé usb (vou pourrez en installer d'autres).
C'est un excellent moyen de dépanner une machine pour par exemple accéder à vos disques lorsque votre l'OS de votre machine ne fonctionne plus.</p>
</div>
<div class="section" id="etape-02">
<h3><a class="toc-backref" href="#id43">5.1.3&nbsp;&nbsp;&nbsp;Étape 02</a></h3>
<div class="figure align-center">
<img alt="./images_ubuntu_20_04/02_Clavier.png" src="./images_ubuntu_20_04/02_Clavier.png" />
<p class="caption">Choix de la disposition du clavier.</p>
</div>
<p>Les différents choix déterminent comment vous allez pouvoir saisir les caractères comme œ.
Par exemple avec le choix de clavier &quot;alt.&quot; il suffira de faire &quot;Alt Gr&quot; &quot;o&quot;, pour avoir œ.
Vous pouvez tester les touches du clavier dans la zone de saisie du texte.</p>
</div>
<div class="section" id="etape-03">
<h3><a class="toc-backref" href="#id44">5.1.4&nbsp;&nbsp;&nbsp;Étape 03</a></h3>
<div class="figure align-center">
<img alt="./images_ubuntu_20_04/03_TypeInstall.png" src="./images_ubuntu_20_04/03_TypeInstall.png" />
<p class="caption">Type d'installation avec mise à jour ou non.</p>
</div>
<p>L'installation minimale n'installe pas les logiciels comme libre office vous laissant le faire par la suite.
Demander la mise à jour lors de l'installation suppose d'être relié à internet.</p>
</div>
<div class="section" id="etape-04">
<h3><a class="toc-backref" href="#id45">5.1.5&nbsp;&nbsp;&nbsp;Étape 04</a></h3>
<div class="figure align-center">
<img alt="./images_ubuntu_20_04/03_TypeInstall.png" src="./images_ubuntu_20_04/03_TypeInstall.png" />
<p class="caption">Choix du partitionnement si l'on clique sur &quot;autre chose&quot; on pourra créer ses partitions.</p>
</div>
<p>Par défaut le disque sera formaté et une partition racine sera créée ainsi qu'une partition swap.
La partition de swap est utilisée pour stocker temporairement la mémoire d'un programme qui s'exécutait, mais qui n'est pas celui en cours d'utilisation.
Par exemple si vous n'avez que très peu de mémoire et que vous lancez plusieurs programmes, celui avec lequel vous interagissez sera en mémoire et les autres peuvent être dans le swap.</p>
<p>Si votre swap a la même taille que votre mémoire vive vous pourrez &quot;hiberner&quot; votre ordinateur, ainsi toute la mémoire vive sera copiée dans le swap et l'ordinateur sera éteint, lorsqu'il sera rallumé tout le swap sera recopié en mémoire vive et les programmes reprendront là où ils en éteint.</p>
<p>C'est pour cela qu'il est intéressant de créer et paramétrer ses partitions et au minimum de créer une partition &quot;/home&quot; pour préserver le contenu de ses données en cas de crash sévère de l'OS, nous allons voir comment partitionner le disque.</p>
<p>Nous détaillerons le partitionnement ci-après.</p>
</div>
<div class="section" id="etape-05">
<h3><a class="toc-backref" href="#id46">5.1.6&nbsp;&nbsp;&nbsp;Étape 05</a></h3>
<div class="figure align-center">
<img alt="./images_ubuntu_20_04/05_TypePartitionLVM.png" src="./images_ubuntu_20_04/05_TypePartitionLVM.png" />
<p class="caption">Ubuntu propose d'utiliser LVM.</p>
</div>
<p>LVM (Logical Volume Manager) est un gestionnaire de volumes logiques qui vous permettra de créer des partitions virtuelles afin de pouvoir les retailler ou d'en créer de nouvelles.
Linux crée alors une couche intermédiaire entre le(s) disque(s) physique(s) et l'OS, c'est dans cette couche virtuelle que vous aurez vos partitions virtuelles qui seront écrites dans la partition réelle.
Toutefois si la partition physique est abîmée, on pert les partitions virtuelles écrites dessus, c'est pourquoi il faut faire des copies de sauvegardes ou avoir des disques montés en raid.
Vous pouvez également chiffrer la partition LVM.</p>
</div>
<div class="section" id="etape-06">
<h3><a class="toc-backref" href="#id47">5.1.7&nbsp;&nbsp;&nbsp;Étape 06</a></h3>
<div class="figure align-center">
<img alt="./images_ubuntu_20_04/07_FuseauHoraire.png" src="./images_ubuntu_20_04/07_FuseauHoraire.png" />
<p class="caption">Choix du fuseau horaire.</p>
</div>
<p>Si vous êtes en France métropolitaine, choisissez le fuseau passant par la France.</p>
</div>
<div class="section" id="etape-07">
<h3><a class="toc-backref" href="#id48">5.1.8&nbsp;&nbsp;&nbsp;Étape 07</a></h3>
<div class="figure align-center">
<img alt="./images_ubuntu_20_04/15_User1000.png" src="./images_ubuntu_20_04/15_User1000.png" />
<p class="caption">Création du 1er compte utilisateur.</p>
</div>
<p>Sous Ubuntu cet utilisateur aura la particularité de pouvoir mettre à jour le système et plus généralement de pouvoir devenir super utilisateur (root).</p>
</div>
<div class="section" id="etape-08">
<h3><a class="toc-backref" href="#id49">5.1.9&nbsp;&nbsp;&nbsp;Étape 08</a></h3>
<p>Ubuntu affiche un récapitulatif des choix réalisés, la confirmation lance alors le partitionnement des disques, leur formatage puis l'installation du système.</p>
<div class="figure align-center">
<img alt="./images_ubuntu_20_04/15_User1000.png" src="./images_ubuntu_20_04/15_User1000.png" />
<p class="caption">Une fois les choix confirmés, l'installation commence.</p>
</div>
<p>En fin d'installation un écran vous invite à retirer la clé usb et à redémarrer l'ordinateur.</p>
<div class="figure align-center">
<img alt="./images_ubuntu_20_04/17_FinInstallation.png" src="./images_ubuntu_20_04/17_FinInstallation.png" />
<p class="caption">Fin d'installation.</p>
</div>
<p>Une fois redémarrer saisissez votre identifiant et votre mot de passe (ceux donnés à l'étape 07)</p>
<p>Vous pouvez alors associer votre machine à vos comptes google et microsoft pour par exemple voir vos agendas et recevoir vos notifications.</p>
<div class="figure align-center">
<img alt="./images_ubuntu_20_04/18_ConfigurationComptesEnLigne.png" src="./images_ubuntu_20_04/18_ConfigurationComptesEnLigne.png" />
<p class="caption">Configuration des comptes en lignes.</p>
</div>
<p>Vous pouvez associer votre machine au mécanisme livepatch de Canonical l'éditeur d'Ubuntu pour faire automatiquement la mise à jour de votre machine.</p>
<div class="figure align-center">
<img alt="./images_ubuntu_20_04/19_LivePatch.png" src="./images_ubuntu_20_04/19_LivePatch.png" />
<p class="caption">Configuration de votre compte Ubuntu pour le live patch.</p>
</div>
<p>Vous pouvez aider Canonical à corriger les bogues en autorisant la remontée des incidents.</p>
<div class="figure align-center">
<img alt="./images_ubuntu_20_04/20_UbuntuWatch.png" src="./images_ubuntu_20_04/20_UbuntuWatch.png" />
<p class="caption">Remonté des informations pour les développeurs.</p>
</div>
<p>Il est possible de permettre la géolocalisation.</p>
<div class="figure align-center">
<img alt="./images_ubuntu_20_04/21_Geolocalisation.png" src="./images_ubuntu_20_04/21_Geolocalisation.png" />
<p class="caption">Autorisation de la géolocalisation.</p>
</div>
<p>On peut installer immédiatement les applications compatibles avec Ubuntu 20.04</p>
<div class="figure align-center">
<img alt="./images_ubuntu_20_04/22_AutresApplications.png" src="./images_ubuntu_20_04/22_AutresApplications.png" />
<p class="caption">Fin d'installation.</p>
</div>
</div>
<div class="section" id="etape-alternative-04-bis">
<h3><a class="toc-backref" href="#id50">5.1.10&nbsp;&nbsp;&nbsp;Étape alternative 04 bis</a></h3>
<p>Le partitionnement est l'étape la plus importante, car il est difficile de corriger les erreurs.</p>
<p>Pour les serveurs cette étape influence directement la sécurité du système (/var/lib, /var/log, /var/spool, /var/www, /tmp), la sécurité est alors physique et ne repose pas seulement sur le mécanisme des quotas. De plus, l'analyse post-mortem d'une partition dédiée est plus facile que celle d'un énorme fourre-tout.</p>
<p>Au minimum, il est recommandé d'avoir une partition /, /home et swap.</p>
<p>Pour activer le partitionnement manuelle, il suffit de cocher sur le bouton &quot;Autre chose&quot; à l'étape 04.</p>
<p>Il faut alors choisir un disque.</p>
<div class="figure align-center">
<img alt="./images_ubuntu_20_04/09_TypePartition_Partitioner_sda.png" src="./images_ubuntu_20_04/09_TypePartition_Partitioner_sda.png" />
<p class="caption">Création de la table de partition</p>
</div>
<div class="figure align-center">
<img alt="./images_ubuntu_20_04/10_TypePartition_Partitioner_sda_NouvelleTable.png" src="./images_ubuntu_20_04/10_TypePartition_Partitioner_sda_NouvelleTable.png" />
<p class="caption">Création de la table de partition</p>
</div>
<p>Le bouton &quot;+&quot; permet de créer de nouvelle partition</p>
<p>Dans notre cas nous allons créer 3 partitions /, /home et swap.</p>
<div class="figure align-center">
<img alt="./images_ubuntu_20_04/12_TypePartition_Partitioner_sda_NouvelleTable_root.png" src="./images_ubuntu_20_04/12_TypePartition_Partitioner_sda_NouvelleTable_root.png" />
<p class="caption">Création de la racine &quot;/&quot;</p>
</div>
<p>Sur le même principe, on crée &quot;/home&quot;
On peut cocher la case &quot;formater&quot; pour purger le disque de ce qu'il contenait avant.</p>
<p>Puis vient la partition de &quot;swap&quot;.</p>
<div class="figure align-center">
<img alt="./images_ubuntu_20_04/13_TypePartition_Partitioner_sda_root_home_swap.png" src="./images_ubuntu_20_04/13_TypePartition_Partitioner_sda_root_home_swap.png" />
<p class="caption">Création du swap</p>
</div>
<p>N'oubliez pas que la taille du swap doit être au moins égale à celle de la mémoire vive (RAM) pour permettre l'hibernation.</p>
<div class="figure align-center">
<img alt="./images_ubuntu_20_04/14_TypePartition_Partitioner_sda_root_home_swap.png" src="./images_ubuntu_20_04/14_TypePartition_Partitioner_sda_root_home_swap.png" />
<p class="caption">Création des partitions</p>
</div>
</div>
</div>
<div class="section" id="installation-de-gnu-linux-ubuntu-en-version-serveur">
<h2><a class="toc-backref" href="#id51">5.2&nbsp;&nbsp;&nbsp;Installation de GNU/Linux Ubuntu en version serveur</a></h2>
<p>La philosophie des distributions serveur est moins il y a de programmes installés plus le système est stable et moins il y a de faille de sécurité.</p>
<p>En conséquence, les interfaces graphiques ne sont disponibles qu'en option et le moyen privilégié d'administrer le système est la ligne de commande.</p>
<p>Pour un serveur il vaut mieux opter pour les versions LTS (Long Term Support) des distributions.</p>
<p>Les différences entre &quot;Debian server&quot; et &quot;Ubuntu server&quot; sont liées aux versions du noyau et des bibliothèques utilisées, aux dépôts et fichiers de configurations par défaut.</p>
<div class="section" id="attention">
<h3><a class="toc-backref" href="#id52">5.2.1&nbsp;&nbsp;&nbsp;Attention</a></h3>
<p>Sous Ubuntu, il n'est pas possible de créer une partition /var, car le système y stocke des fichiers au démarrage, alors que les points de montage ne sont pas encore installés, ce qui provoque un plantage du système difficile à comprendre.</p>
</div>
<div class="section" id="travaux-pratiques">
<h3><a class="toc-backref" href="#id53">5.2.2&nbsp;&nbsp;&nbsp;Travaux pratiques</a></h3>
<p>Installation d'une Ubuntu server LTS</p>
</div>
</div>
<div class="section" id="utilisation-de-gnu-linux">
<h2><a class="toc-backref" href="#id54">5.3&nbsp;&nbsp;&nbsp;Utilisation de GNU/Linux</a></h2>
<p>Présentation interactive du système d'exploitation:</p>
<blockquote>
<ul class="simple">
<li>le bureau,</li>
<li>les fenêtres d'application,</li>
<li>le tableau de bord.</li>
</ul>
</blockquote>
<p>Administration graphique du système:</p>
<blockquote>
<ul class="simple">
<li>Configuration du réseau (Système (Flèche descendante de la barre de menus, à droite) &gt; Wifi ou Filaire (non) connecté ou Administration (Roue dentée) &gt; Wifi ou Réseau)</li>
<li>Synaptic (Pour l'installer <a class="reference external" href="https://doc.ubuntu-fr.org/synaptic">https://doc.ubuntu-fr.org/synaptic</a> ): l'installation de logiciels (Système &gt; Administration &gt; Gestionnaire de paquets Synaptic)</li>
<li>configuration des dépôts (Rechercher depuis le menu Activité -&gt; Logiciels &amp; mises à jour)</li>
<li>personnalisations basiques <a class="reference external" href="https://doc.ubuntu-fr.org/personnalisation_basique">https://doc.ubuntu-fr.org/personnalisation_basique</a></li>
<li>la configuration de Gnome (installer gnome-tweaks )</li>
<li>les applets</li>
<li>la résolution graphique</li>
<li>les bureaux virtuels</li>
<li>les services (Système &gt; Administration &gt; Services)</li>
</ul>
</blockquote>
<p>Les logiciels d'administration ne sont que des surcouches graphiques (front-end) qui appellent les commandes en ligne, par conséquent leurs possibilités sont moindres.</p>
</div>
</div>
<div class="section" id="l-aide-et-la-communaute">
<h1><a class="toc-backref" href="#id55">6&nbsp;&nbsp;&nbsp;L'aide et la communauté</a></h1>
<div class="section" id="l-aide-en-ligne">
<h2><a class="toc-backref" href="#id56">6.1&nbsp;&nbsp;&nbsp;L'aide en ligne</a></h2>
<p>En mode graphique, les applications possèdent un onglet &quot;Aide&quot; permettant d'ouvrir un navigateur sur l'aide en ligne. Cette aide est généralement accessible par la touche F1.</p>
<div class="figure align-center">
<img alt="AideEnLigneUbuntu.jpg" src="AideEnLigneUbuntu.jpg" />
<p class="caption">Aide en ligne d'Ubuntu (appelée avec F1)</p>
</div>
<p>Dans un shell, la plupart des commandes unix acceptent l'option -h ou --help ou --usage :</p>
<pre class="literal-block">
michaellaunay&#64;luciole:~$ apropos --help
Usage: apropos [OPTION...] KEYWORD...
Project-Id-Version: man-db 2.3.90
Report-Msgid-Bugs-To: Colin Watson &lt;cjwatson&#64;debian.org&gt;
POT-Creation-Date: 2008-05-05 02:09+0100
PO-Revision-Date: 2008-08-19 20:37+0000
Last-Translator: Laurent Pelecq &lt;laurent.pelecq&#64;soleil.org&gt;
Language-Team: French &lt;traduc&#64;traduc.org&gt;
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit
X-Launchpad-Export-Date: 2008-11-09 09:58+0000
X-Generator: Launchpad (build Unknown)

  -d, --debug                emit debugging messages
  -v, --verbose              print verbose warning messages
  -e, --exact                search each keyword for exact match
  -r, --regex                interpret each keyword as a regex
  -w, --wildcard             the keyword(s) contain wildcards
  -a, --and                  require all keywords to match
  -l, --long                 do not trim output to terminal width
  -C, --config-file=FICHIER  use this user configuration file
  -L, --locale=LOCALE        define the locale for this search
  -m, --systems=SYSTEM       use manual pages from other systems
  -M, --manpath=CHEMIN       set search path for manual pages to PATH
  -s, --section=SECTION      search only this section
  -?, --help                 give this help list
      --usage                give a short usage message
  -V, --version              print program version

Mandatory or optional arguments to long options are also mandatory or optional
for any corresponding short options.

The --regex option is enabled by default.

Report bugs to cjwatson&#64;debian.org.
</pre>
<p>Pour trouver une commande il suffit de faire apropos MotClé qui affichera toutes les commandes comportant MotClé dans sa description courte. Toutefois la base des commandes peut avoir besoin d'être régénérée par <strong>makewhatis</strong>.</p>
<p><em>whatis NomDeCommande</em> affichera la description courte de NomDeCommande.</p>
</div>
<div class="section" id="les-man-pages">
<h2><a class="toc-backref" href="#id57">6.2&nbsp;&nbsp;&nbsp;Les man pages</a></h2>
<p>Les applications et commandes possèdent toutes un manuel accessible en ligne de commande via la commande man.</p>
<p>Ce manuel est généralement traduit dans la langue de l'utilisateur</p>
<pre class="literal-block">
michaellaunay&#64;luciole:~$ man man
MAN(1)            Utilitaires de l’afficheur des pages de manuel               MAN(1)

NOM
       man - Interface de consultation des manuels de référence en ligne

SYNOPSIS
       man  [-c|-w|-tZ] [-H[navigateur]] [-T[périphérique]] [-adhu7V] [-i|-I]
       [-m système[,...]] [-L langue] [-p chaîne] [-C fichier] [-M chemin]
       [-P afficheur] [-r invite] [-S liste] [-e extension] [[section] page ...] ...
       man -l [-7] [-tZ] [-H[navigateur]] [-T[périphérique]] [-p chaîne]
       [-P afficheur] [-r invite] fichier ...
       man -k [apropos options] expression_rationnelle ...
       man -f [whatis options] page ...

DESCRIPTION
       man est le programme de visualisation des pages de manuel.  Chacun  des  argu-
       ments  page,  indiqué dans la ligne de commande de man, porte, en principe, le
       nom d’un programme, d’un utilitaire ou d’une fonction. La page de manuel  cor-
       respondant à chaque argument est alors trouvée et affichée. Si une section est
       précisée alors man limite  la  recherche  à  cette  section.  Par  défaut,  il
       recherche dans toutes les sections disponibles, suivant un ordre prédéfini. Il
       n’affiche que la première page de manuel trouvée, même si  d’autres  pages  de
       manuel existent dans d’autres sections.

       Le  tableau  ci-dessous  indique le numéro des sections de manuel ainsi que le
       type de pages qu’elles contiennent.

       1   Programmes exécutables ou commandes de l’interpréteur de  com-
           mandes (shell) ;
       2   Appels système (Fonctions fournies par le noyau) ;
       3   Appels  de  bibliothèque  (fonctions  fournies  par  les  bib-
           liothèques des programmes) ;
       4   Fichiers spéciaux (situés généralement dans /dev) ;
       5   Formats des fichiers et conventions. Par exemple /etc/passwd ;
       6   Jeux ;
       7   Divers (y compris les macropaquets et les  conventions).   Par
           exemple, man(7), groff(7) ;
       8   Commandes  de  gestion  du  système (généralement réservées au
           superutilisateur) ;
       9   Sous-programmes du noyau [hors standard].

       Une page de manuel est constituée de plusieurs parties.

       Elles peuvent être libellées NOM, SYNOPSIS,  DESCRIPTION,  OPTIONS,  FICHIERS,
       VOIR AUSSI, BOGUES et AUTEUR.
</pre>
<p>Pour chercher les pages associées à un mot clé:</p>
<pre class="literal-block">
michaellaunay&#64;luciole:~/Documents/ecreall/Cours/CoursGNULinux$ man -k manual
apropos (1)          - search the manual page names and descriptions
catman (8)           - create or update the pre-formatted manual pages
esdcompat (1)        - manual page for pulseaudio esd wrapper 0.9.5
grub-reboot (8)      - manual page for grub-reboot 0.01
man (1)              - an interface to the on-line reference manuals
manconv (1)          - convert manual page from one encoding to another
mandb (8)            - create or update the manual page index caches
manpath (1)          - determine search path for manual pages
missing (7)          - missing manual pages
pulseaudio (1)       - manual page for pulseaudio 0.9.5
readahead-list (8)   - manual page for readahead-list: 0.20050517.0220
readahead-watch (8)  - manual page for readahead-watch: 0.20050517.0220
update-apt-xapian-index (8) - manual page for update-apt-xapian-index 0.15
w3mman (1)           - an interface to the on-line reference manuals by w3m(1)
whatis (1)           - display manual page descriptions
whereis (1)          - locate the binary, source, and manual page files for a command
xman (1)             - Manual page display program for the X Window System
</pre>
</div>
<div class="section" id="les-sites">
<h2><a class="toc-backref" href="#id58">6.3&nbsp;&nbsp;&nbsp;Les sites</a></h2>
<p>Le site officiel de Linux <a class="reference external" href="http://www.linux.org">http://www.linux.org</a></p>
<p>Un site dédié à Linux (Linux Entre Amis) : <a class="reference external" href="http://www.lea-linux.org">http://www.lea-linux.org</a></p>
<p>Une présentation de Linux <a class="reference external" href="http://fr.wikipedia.org/wiki/Linux">http://fr.wikipedia.org/wiki/Linux</a></p>
<p>La communauté ubuntu française <a class="reference external" href="http://www.ubuntu-fr.org/">http://www.ubuntu-fr.org/</a></p>
</div>
<div class="section" id="les-forums">
<h2><a class="toc-backref" href="#id59">6.4&nbsp;&nbsp;&nbsp;Les forums</a></h2>
<p>Le forum de la communauté Ubuntu <a class="reference external" href="http://ubuntuforums.org/">http://ubuntuforums.org/</a></p>
<p>Le forum de la communauté Debian française <a class="reference external" href="http://forum.debian-fr.org">http://forum.debian-fr.org</a></p>
</div>
<div class="section" id="les-lugs">
<h2><a class="toc-backref" href="#id60">6.5&nbsp;&nbsp;&nbsp;Les LUGs</a></h2>
<p>Un LUG est un groupe d'utilisateurs de Linux (Linux User Group) réuni généralement au sein d'une association loi 1901.</p>
<p>Dans la région lilloise on compte essentiellement Chtinux <a class="reference external" href="http://www.chtinux.org/">http://www.chtinux.org/</a> anciennement Campux et CLX <a class="reference external" href="http://clx.asso.fr/spip">http://clx.asso.fr/spip</a></p>
<p>Les LUGs réalisent la promotion de Linux est des logiciels libres. Ils organisent des manifestations telles que des install party.</p>
</div>
</div>
<div class="section" id="shell-commandes">
<h1><a class="toc-backref" href="#id61">7&nbsp;&nbsp;&nbsp;Shell &amp; Commandes</a></h1>
<div class="section" id="les-terminaux-tty">
<h2><a class="toc-backref" href="#id62">7.1&nbsp;&nbsp;&nbsp;Les terminaux (tty)</a></h2>
<p>Historiquement, un terminal est une interface homme machine minimale issue des technologies de communication de la fin XIX et du début XX siècle, le Télétype marque déposée en 1906 est l'ancêtre des claviers numériques des premiers ordinateurs.</p>
<p>L'abréviation tty de Télétype a été utilisée pour décrire l'interface série de communication utilisée au début d'Unix. Par usage c'est le terme qui décrit l'interface de saisie et d'affichage avec l'humain. On trouve aussi l'appellation de terminal ou console.</p>
<p>La commande tty affiche le pseudo fichier associé à la saisie.</p>
<p>Dans l'environnement graphique XWindows on trouve des logiciels émulant les terminaux, on les appelle alors des terminaux virtuels (ex: xterm).</p>
<p>Les terminaux ne sont en charge que de la récupération des touches frappées, de leur transformation en lettre, et de l'affichage de celle-ci. L'interprétation de ce qui est saisi est dévolue au shell.</p>
<p>Les six premiers terminaux sont accessibles par la combinaison de touche Ctrl Alt F[1-6].</p>
<p>Le terminal graphique est accessible Ctrl Alt F7</p>
</div>
<div class="section" id="la-ligne-de-commande">
<h2><a class="toc-backref" href="#id63">7.2&nbsp;&nbsp;&nbsp;La ligne de commande</a></h2>
<p>Sous Unix la CLI (Command Line Interface) est la méthode privilégiée pour transmettre au système les ordres à exécuter.</p>
<div class="section" id="les-differents-shell">
<h3><a class="toc-backref" href="#id64">7.2.1&nbsp;&nbsp;&nbsp;Les différents shell</a></h3>
<p>Le shell est un logiciel qui interprète séquentiellement les commandes saisies dans un terminal ou stockées dans un fichier (script) ou provenant d'un pseudo fichier.</p>
<p>La syntaxe et la sémantique de cette interprétation dépendent du shell employé.</p>
<p>Historiquement la première version est <strong>sh</strong> (1977 écrit par Stephen Bourne) qui évolua en <strong>csh</strong>, <strong>ksh</strong> et <strong>bash</strong> (Bourne again shell) le plus répandu.</p>
<p>Bash est l'interpréteur de commande par défaut des Unix libres et de Mac OS X.</p>
<p>Pour connaître la version de bash en cours d'utilisation:</p>
<pre class="literal-block">
michaellaunay&#64;luciole:~$ echo $BASH
/bin/bash
michaellaunay&#64;luciole:~$ echo $BASH_VERSION
4.3.39(1)-release
</pre>
<p>Pour modifier le shell par défaut associé à un utilisateur il faut modifier <em>/etc/passwd</em> avec la commande <strong>usermod -s /bin/bash login</strong> :</p>
<pre class="literal-block">
michaellaunay&#64;luciole:~$ grep michael /etc/passwd
michaellaunay:x:1000:1000:Michael Launay,,,:/home/michaellaunay:/bin/bash
michaellaunay&#64;luciole:~$ sudo usermod -s /bin/sh michaellaunay
michaellaunay&#64;luciole:~$ grep michael /etc/passwd
michaellaunay:x:1000:1000:Michael Launay,,,:/home/michaellaunay:/bin/sh
</pre>
<p>Pour créer un compte qui pourra se connecter sans avoir de shell (utilisation de tunnel) :</p>
<pre class="literal-block">
usermod -s /bin/false prestataire
</pre>
<p>Détails sur le format du fichier passwd</p>
<blockquote>
<p><a class="reference external" href="mailto:michaellaunay&#64;luciole">michaellaunay&#64;luciole</a>:~$ man 5 passwd
PASSWD(5)                   Formats et conversions de fich                   PASSWD(5)</p>
<dl class="docutils">
<dt>NOM</dt>
<dd>passwd - fichier des mots de passe</dd>
<dt>DESCRIPTION</dt>
<dd><p class="first">/etc/passwd contient différentes informations sur les comptes utilisateurs. Ces
informations consistent en sept champs séparés par des deux-points (« : ») :</p>
<p>·   nom de connexion de l´utilisateur (« login »)</p>
<p>·   un mot de passe chiffré optionnel</p>
<p>·   l´identifiant numérique de l´utilisateur</p>
<p>·   l´identifiant numérique du groupe de l´utilisateur</p>
<p>·   le nom complet de l´utilisateur ou un champ de commentaires</p>
<p>·   le répertoire personnel de l´utilisateur</p>
<p>·   l´interpréteur de commandes de l´utilisateur (optionnel)</p>
<p class="last">Le champ du mot de passe chiffré peut être vide. Dans ce cas, aucun mot de
passe n´est nécessaire pour s´authentifier avec le compte donné. Cependant,
certaines applications qui lisent le fichier /etc/passwd peuvent décider de ne
donner aucun accès si le mot de passe est vide. Si le mot de passe est un « x »
minuscule, alors le mot de passe chiffré se trouve dans le fichier shadow(5) ;
il doit y avoir une ligne correspondante dans le fichier shadow, sinon le
compte de l´utilisateur n´est pas valide. Si le mot de passe est constitué
d´une autre chaîne, alors il est considéré comme un mot de passe chiffré, comme
indiqué dans crypt(3).</p>
</dd>
</dl>
</blockquote>
<p>Plus d'information : man bash</p>
<p>Lien : <a class="reference external" href="http://fr.wikipedia.org/wiki/Bourne-Again_shell">http://fr.wikipedia.org/wiki/Bourne-Again_shell</a></p>
</div>
<div class="section" id="les-fichiers-de-ressources-et-de-configuration-de-bash">
<h3><a class="toc-backref" href="#id65">7.2.2&nbsp;&nbsp;&nbsp;Les fichiers de ressources et de configuration de bash</a></h3>
<p>Au lancement du shell celui-ci détermine s'il a été appelé de façon interactive ou pour exécuter un script ou en tant que shell de login. En fonction de la nature de son lancement, il exécutera plusieurs fichiers lui permettant de ce paramétrer.</p>
<p>Scripts exécutés lors du lancement d'un shell interactif en ouverture de session (interactive login shell) :</p>
<pre class="literal-block">
/etc/profile
~/.bash_profile #le ~ désigne le répertoire &quot;home&quot; de l'utilisateur
~/.bash_login #si ~/.bash_profile n'existe pas
~/.profile #si ~/.bash_login
</pre>
<p>Scripts exécutés lors d'un shell interactif :</p>
<pre class="literal-block">
/etc/bash.bashrc
~/.bashrc
</pre>
<p>La modification de ces scripts nécessite la commande <strong>source</strong> pour une prise en compte immédiate dans le shell courant.</p>
<p>Scripts exécutés lors d'un script :</p>
<pre class="literal-block">
$BASH_ENV #BASH_ENV est une variable. Si elle existe alors les scripts lancés essayent d'exécuter le fichier désigné par $BASH_ENV
</pre>
<p>Un petit exemple :</p>
<pre class="literal-block">
michaellaunay&#64;luciole:~$ echo &quot;echo coucou&quot; &gt; /tmp/hello.sh #on crée un fichier hello.sh qui contient echo coucou
michaellaunay&#64;luciole:~$ chmod +x /tmp/hello.sh   # on rend exécutable ce fichier
michaellaunay&#64;luciole:~$ /tmp/hello.sh            # on exécute ce fichier
coucou
michaellaunay&#64;luciole:~$ echo $BASH_ENV           # on affiche le contenu de la variable BASH_ENV

michaellaunay&#64;luciole:~$ BASH_ENV='/tmp/hello.sh' # on affecte la chaîne /tmp/hello.sh à la variable BASH_ENV
michaellaunay&#64;luciole:~$ export BASH_ENV # maintenant BASH_ENV sera accessible à toute commande exécutée depuis le shell courant
michaellaunay&#64;luciole:~$ echo &quot;echo cuicui&quot; &gt; /tmp/oiseau.sh
michaellaunay&#64;luciole:~$ bash /tmp/oiseau.sh # on exécute oiseau.sh avec bash, car on n'a pas fait le chmod +x dessus
coucou
cuicui
</pre>
</div>
<div class="section" id="les-variables-d-environnement">
<h3><a class="toc-backref" href="#id66">7.2.3&nbsp;&nbsp;&nbsp;Les variables d'environnement</a></h3>
<p>Les variables d'environnement sont accessibles en consultation avec la commande <strong>env</strong> :</p>
<pre class="literal-block">
michaellaunay&#64;luciole:~$ env
SHELL=/bin/bash
TERM=xterm
HISTSIZE=1000
USERNAME=michaellaunay
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
PWD=/home/michaellaunay
EDITOR=vim
LANG=fr_FR.UTF-8
HOME=/home/michaellaunay
LOGNAME=michaellaunay
DISPLAY=:0.0
OLDPWD=/home/michaellaunay
</pre>
<p>Signification des variables d'environnement :</p>
<pre class="literal-block">
BASH      # Le nom du fichier bash
DISPLAY   # Le numéro de serveur et de session d'affichage
EDITOR    # L'éditeur à utiliser par défaut
HISTSIZE  # La taille du fichier historique
HOSTNAME  # Le nom de la machine
HOME      # Le répertoire personnel de l'utilisateur
LANG      # La langue de l'utilisateur et l'encodage utilisé pour afficher cette langue
LOGNAME   # Le nom d'utilisateur lors de l'ouverture de la session
MAIL      # Le chemin vers la boite mail de l'utilisateur
OLDPWD    # Le répertoire où nous étions avant le dernier cd
PATH      # Le chemin vers les exécutables
PS1       # Permet de constituer l'invite de commande
PS2       # Symbole affiché sur les lignes de commande débordant sur plusieurs lignes
PROMPT_COMMAND # Le nom d'une commande à exécuter à chaque commande
PWD       # Le chemin actuel
SHELL     # Le shell de l'utilisateur
TERM      # Le type de terminal
USERNAME  # Le nom d'utilisateur
</pre>
<p>Pour accéder au contenu d'une variable, il suffit de la référencer en la précédent de <strong>$</strong>:</p>
<pre class="literal-block">
michaellaunay&#64;luciole:~$ echo $HOME
/home/michaellaunay
</pre>
<p>Pour voir l'ensemble des définitions réalisées dans un shell (variable et fonction) il suffit de taper <strong>set</strong>.</p>
<p>Pour voir les lignes exécutées dans un script <strong>set -x</strong> en début de cript.</p>
</div>
<div class="section" id="les-caracteres-speciaux">
<h3><a class="toc-backref" href="#id67">7.2.4&nbsp;&nbsp;&nbsp;Les caractères spéciaux</a></h3>
<p>Les caractères suivants permettent de déclencher des comportements particuliers qui seront expliqués ci-après :</p>
<pre class="literal-block">
# # Mise en commentaire
&gt; # Indirection vers un fichier
&lt; # Indirection depuis un fichier
| # Pipe
? # Un caractère ou pas
. # Un caractère
* # Une chaîne de caractère
$ # Référencement d'une variable
\ # Échappement
/ # Séparateur
[ # Début d'un ensemble ou d'un test
] # Fin d'un ensemble ou d'un test
( # Sous shell ou évaluation
) # Fin de sous shell ou d'évaluation
: # Séparateur de groupe
; # Fin de commande
^ # Inversion ou début
&#64; # Adresse
` # Début ou fin d'interprétation
~ # Désigne le répertoire personnel
</pre>
<p>Si vous voulez les utiliser pour nommer par exemple un fichier sans que le comportement particulier soit déclenché vous avez l'obligation de les échapper avec <strong>** ou de les mettre entre apostrophes **'</strong> ou guillemets <strong>&quot;</strong>:</p>
<pre class="literal-block">
\# ou '#' ou &quot;#&quot;
\&gt; ou '&gt;' ou &quot;&gt;&quot;
\&lt; ou '&lt;' ou &quot;&lt;&quot;
\| ou '|' ou &quot;|&quot;
\? ou '?' ou &quot;?&quot;
\. ou '.' ou &quot;.&quot;
\* ou '*' ou &quot;*&quot;
\$ ou '$' ou &quot;$&quot;
\\ ou '\' ou &quot;\&quot;
\/ ou '/' ou &quot;/&quot;
\[ ou '[' ou &quot;[&quot;
\] ou ']' ou &quot;]&quot;
\( ou '(' ou &quot;(&quot;
\) ou ')' ou &quot;)&quot;
\: ou ':' ou &quot;:&quot;
\; ou ';' ou &quot;;&quot;
\^ ou '^' ou &quot;^&quot;
</pre>
<p>exemple :</p>
<pre class="literal-block">
michaellaunay&#64;luciole:~$ echo lunettes &gt; /tmp/\[\*\]\^\[&quot;*&quot;']'
michaellaunay&#64;luciole:~$ ls /tmp
[*]^[*]
michaellaunay&#64;luciole:~$ cat /tmp/\[\*\]\^\[\*\]
lunettes
</pre>
</div>
<div class="section" id="variables-speciales">
<h3><a class="toc-backref" href="#id68">7.2.5&nbsp;&nbsp;&nbsp;Variables spéciales</a></h3>
<p>En plus des variables d'environnement vue précédemment nous avons :</p>
<pre class="literal-block">
$? # Qui fait référence au code de retour de la dernière commande exécuté.
$$ # Le pid du programme en cours d'exécution.
$! # Le pid de la dernière commande lancée en tâche de fond.
$# # Le nombre de paramètres.
$0 # Le nom du programme en cours d'exécution.
$1 # Le premier paramètre passé.
$2 # Le second paramètre passé.
...
$9 # Le neuvième paramètre.
$*, $&#64; # L'ensemble des paramètres
</pre>
</div>
<div class="section" id="creation-affectation-de-variable">
<h3><a class="toc-backref" href="#id69">7.2.6&nbsp;&nbsp;&nbsp;Création, affectation de variable</a></h3>
<p>Pour créer une variable ou en modifier sa valeur il suffit de la définir :</p>
<pre class="literal-block">
michaellaunay&#64;luciole:~$ VAR='Bonjour tout le monde'
michaellaunay&#64;luciole:~$ echo $VAR
Bonjour tout le monde
michaellaunay&#64;luciole:~$ VAR=Salut
michaellaunay&#64;luciole:~$ echo $VAR
Salut
michaellaunay&#64;luciole:~$ VAR=$VAR' à tous'
michaellaunay&#64;luciole:~$ echo $VAR
Salut à tous
michaellaunay&#64;luciole:~$ PATH=/home/michaellaunay/MesScripts:$PATH
michaellaunay&#64;luciole:~$ echo $PATH
/home/michaellaunay/MesScripts:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
</pre>
<p>Pour supprimer une variable, on peut utiliser <strong>unset</strong> :</p>
<pre class="literal-block">
michaellaunay&#64;luciole:~$ unset BASH_ENV
</pre>
</div>
<div class="section" id="export-de-variable">
<h3><a class="toc-backref" href="#id70">7.2.7&nbsp;&nbsp;&nbsp;Export de variable</a></h3>
<p>Toute variable créée dans un shell n'est accessible que dans celui-ci.</p>
<p>Pour la rendre accessible aux commandes et scripts appelés après l'affectation il faut l'exporter :</p>
<pre class="literal-block">
michaellaunay&#64;luciole:~$ echo &quot;echo \$SALUTATION&quot; &gt; /tmp/cmd.sh
michaellaunay&#64;luciole:~$ /tmp/cmd.sh

michaellaunay&#64;luciole:~$ SALUTATION=coucou
michaellaunay&#64;luciole:~$ echo $SALUTATION
coucou
michaellaunay&#64;luciole:~$ /tmp/cmd.sh

michaellaunay&#64;luciole:~$ export SALUTATION
michaellaunay&#64;luciole:~$ /tmp/cmd.sh
coucou
</pre>
</div>
<div class="section" id="les-tests-d-expressions-et-fichier-operateurs-de-controle">
<h3><a class="toc-backref" href="#id71">7.2.8&nbsp;&nbsp;&nbsp;Les tests d'expressions et fichier, opérateurs de contrôle</a></h3>
<p>La commande <strong>test</strong> permet de tester une expression et de retourner 0 si le test est vrai et 1 s'il est faux :</p>
<pre class="literal-block">
michaellaunay&#64;luciole:~$ test 1 = 1
michaellaunay&#64;luciole:~$ echo $?
0
michaellaunay&#64;luciole:~$ test 1 = 2
michaellaunay&#64;luciole:~$ echo $?
1
</pre>
<p>On peut aussi remplacer <strong>test</strong> par des crochets, mais il faut alors encadrer les crochets par des espaces :</p>
<pre class="literal-block">
michaellaunay&#64;luciole:~$ [ 1 = 2 ]
michaellaunay&#64;luciole:~$ echo $?
1
</pre>
<p>Les options de test sont très nombreuses. Faites man test.</p>
<p>Avec <strong>test</strong> et <strong>if</strong> il est possible d'exécuter conditionnellement des commandes :</p>
<pre class="literal-block">
michaellaunay&#64;luciole:~$ VAR=2
michaellaunay&#64;luciole:~$ if [ $VAR = 2 ]; then echo Vrai; else echo Faux;fi
Vrai
michaellaunay&#64;luciole:~$ VAR=$HOME
michaellaunay&#64;luciole:~$ if [ -w $VAR ]
&gt; then echo écriture possible dans $VAR
&gt; else echo écriture impossible dans $VAR
&gt; fi
écriture possible dans /home/michaellaunay
</pre>
</div>
<div class="section" id="execution-d-operations-arithmetiques">
<h3><a class="toc-backref" href="#id72">7.2.9&nbsp;&nbsp;&nbsp;Exécution d'opérations arithmétiques</a></h3>
<p>La construction <strong>$[ nombre1 opérateur nombre2 ]</strong> permet de réaliser le calcul d'expression sur des entiers :</p>
<pre class="literal-block">
michaellaunay&#64;luciole:~$ echo $[ 10 - 1 ]
9
</pre>
<p>La création de variable et sa modification :</p>
<pre class="literal-block">
michaellaunay&#64;luciole:~$ CMPT=[0] # équivalent à la ligne suivante
michaellaunay&#64;luciole:~$ let CMPT=0
michaellaunay&#64;luciole:~$ echo $CMPT
0
michaellaunay&#64;luciole:~$ let CMPT+=1
michaellaunay&#64;luciole:~$ echo $CMPT
1
michaellaunay&#64;luciole:~$ let CMPT+=1
michaellaunay&#64;luciole:~$ echo $CMPT
2
</pre>
</div>
<div class="section" id="la-boucle-while-et-until">
<h3><a class="toc-backref" href="#id73">7.2.10&nbsp;&nbsp;&nbsp;La boucle while et until</a></h3>
<p><strong>While</strong> permet d'exécuter des commandes tant que la condition est satisfaite alors que <strong>until</strong> exécute des commandes tant que la condition échoue.</p>
<p>Exemple :</p>
<pre class="literal-block">
michaellaunay&#64;luciole:~$ VAR=4
michaellaunay&#64;luciole:~$ while [ $VAR -gt 0 ]
&gt; do
&gt; echo itération $VAR;
&gt; VAR=$[ $VAR - 1 ]
&gt; done
itération 4
itération 3
itération 2
itération 1
</pre>
</div>
<div class="section" id="la-boucle-for">
<h3><a class="toc-backref" href="#id74">7.2.11&nbsp;&nbsp;&nbsp;La boucle for</a></h3>
<p>Pour chaque élément d'un ensemble, on exécute une commande :</p>
<pre class="literal-block">
michaellaunay&#64;luciole:~$ NORD=&quot;Lille Roubaix&quot;
michaellaunay&#64;luciole:~$ CENTRE=&quot;Paris Chartres&quot;
michaellaunay&#64;luciole:~$ SUD=&quot;Nice Marseille&quot;
michaellaunay&#64;luciole:~$ for ville in $NORD $CENTRE $SUD
&gt; do
&gt; echo Visiter $ville
&gt; done
Visiter Lille
Visiter Roubaix
Visiter Paris
Visiter Chartres
Visiter Nice
Visiter Marseille
</pre>
</div>
<div class="section" id="le-choix-multiple-case">
<h3><a class="toc-backref" href="#id75">7.2.12&nbsp;&nbsp;&nbsp;Le choix multiple (case)</a></h3>
<p>Permet de réaliser un branchement. Ne pas oublier les deux points-virgules à la fin d'un cas :</p>
<pre class="literal-block">
michaellaunay&#64;luciole:~$ VAR=Lille
michaellaunay&#64;luciole:~$ case $VAR in
&gt; 'lille' | 'Lille' | 'LILLE' )
&gt;   echo J\'y habite
&gt; ;;
&gt; 'paris' | 'Paris' | 'PARIS' )
&gt;   echo J\'y ai habité
&gt; ;;
&gt; * )
&gt;   echo Je ne connais pas
&gt; ;;
&gt; esac
J'y habite
</pre>
</div>
<div class="section" id="les-operateurs-et">
<h3><a class="toc-backref" href="#id76">7.2.13&nbsp;&nbsp;&nbsp;Les opérateurs &amp;&amp; et ||</a></h3>
<p>L'opérateur <strong>&amp;&amp;</strong> permet d'exécuter la commande suivante si la commande précédente réussit (retourne 0) :</p>
<pre class="literal-block">
michaellaunay&#64;luciole:~$ grep refusée /var/log/user.log &gt; /tmp/connexion.txt &amp;&amp; vim /tmp/connexion.txt
</pre>
<p>L'opérateur <strong>||</strong> permet d'exécuter la commande suivante si la commande précédente a échoué (retour de 1) :</p>
<pre class="literal-block">
michaellaunay&#64;luciole:~$ grep refusée /var/log/user.log &gt; /dev/null || echo tout va bien
</pre>
</div>
<div class="section" id="la-commande-trap">
<h3><a class="toc-backref" href="#id77">7.2.14&nbsp;&nbsp;&nbsp;La commande trap</a></h3>
<p>Elle permet de positionner une fonction qui sera exécuté lors de la réception d'un signal (man 7 signal) :</p>
<pre class="literal-block">
trap &quot;echo Fin d\'exécution&quot; EXIT
trap &quot;echo Interruption violente Ctrl-c&quot; SIGINT
trap &quot;echo Fin demandée&quot; SIGTERM
trap &quot;echo Reprise d\'exécution&quot; SIGCONT
trap &quot;echo Signal USR&quot; SIGUSR1 SIGUSR2
</pre>
</div>
<div class="section" id="la-commande-sed">
<h3><a class="toc-backref" href="#id78">7.2.15&nbsp;&nbsp;&nbsp;La commande sed</a></h3>
<p>Elle permet de faire des traitements sur les lignes d'un flux.
Par exemple elle permet de trouver un motif et de le remplacer.
On la rencontre dans de nombreux scripts.</p>
<p>Par exemple dans la ligne suivante :</p>
<pre class="literal-block">
ls -1 | xargs -i echo mv {} {} | sed -e &quot;s/Ubuntu20.04_//2&quot; | bash
</pre>
<p>&quot;ls -1&quot; affiche le contenu du répertoire courant, une ligne par fichier.</p>
<p>Le résultat est envoyé à <strong>xargs</strong> qui pour chaque ligne va créer une chaîne de caractères &quot;mv contenu_ligne contenu_ligne&quot;</p>
<p>Le résultat est envoyé à <strong>sed</strong> qui supprime la seconde occurence de la chaîne &quot;Ubuntu20.04&quot; qu'il rencontre.</p>
<p>Le résultat est exécuté par bash en transformant la chaîne de caractères reçu en ligne de commande.</p>
<p>Ici sed permet de renommer les fichiers de type Ubuntu20.04_00_EssayerOuInstaller.png en 00_EssayerOuInstaller.png.</p>
<p>À cette ligne complexe, on préférera renommer de façon plus élégante et rapide avec la ligne de cmd :</p>
<pre class="literal-block">
for filename in *; do mv $filename ${filename/Ubuntu20.04_/}; done
</pre>
<p>Pour plus d'information sur <strong>sed</strong> voir <a class="reference external" href="https://www.commentcamarche.net/faq/9536-sed-introduction-a-sed-part-i">https://www.commentcamarche.net/faq/9536-sed-introduction-a-sed-part-i</a></p>
</div>
<div class="section" id="l-expansion-de-parametre">
<h3><a class="toc-backref" href="#id79">7.2.16&nbsp;&nbsp;&nbsp;L'expansion de paramètre</a></h3>
<p>Liste des Filtres pour l'expansion de paramètre du Shell <a class="reference external" href="https://www.gnu.org/software/bash/manual/html_node/Shell-Parameter-Expansion.html">https://www.gnu.org/software/bash/manual/html_node/Shell-Parameter-Expansion.html</a> :</p>
<pre class="literal-block">
${parameter} sera remplacé par la valeur de parameter
michaellaunay&#64;luciole:~$ CMPT=$(( 1 + 20 / 2 )) # Réalise l'opération puis affecte CMPT pour les opérations possibles voir https://www.gnu.org/software/bash/manual/html_node/Shell-Arithmetic.html#Shell-Arithmetic
michaellaunay&#64;luciole:~$ echo ${CMPT}
11
michaellaunay&#64;luciole:~$ name[1]='un' # équivalent à 'declare -n name' voir https://www.gnu.org/software/bash/manual/html_node/Arrays.html#Arrays
michaellaunay&#64;luciole:~$ name[2]='deux'
michaellaunay&#64;luciole:~$ name[3]='trois'
michaellaunay&#64;luciole:~$ echo ${name[2]}
deux
# équivalent à
michaellaunay&#64;luciole:~$ name=('zero' 'un' 'deux' 'trois')
michaellaunay&#64;luciole:~$ echo ${name[1]}
un
michaellaunay&#64;luciole:~$ unset name[0]
michaellaunay&#64;luciole:~$ echo ${name[0]}

michaellaunay&#64;luciole:~$ echo ${name[1]}
un
</pre>
</div>
<div class="section" id="les-scripts">
<h3><a class="toc-backref" href="#id80">7.2.17&nbsp;&nbsp;&nbsp;Les scripts</a></h3>
<p>Un script est un fichier qui contient une suite de commandes.</p>
<p>La première ligne permet d'indiquer le shell dans lequel doit être exécuté le script :</p>
<pre class="literal-block">
#!/bin/bash
echo c\'est du bash
</pre>
<p>Cette ligne s'appelle le <a class="reference external" href="http://en.wikipedia.org/wiki/Shebang_(Unix)">shebang</a>.</p>
</div>
<div class="section" id="les-fonctions">
<h3><a class="toc-backref" href="#id81">7.2.18&nbsp;&nbsp;&nbsp;Les fonctions</a></h3>
<p>Une fonction est une portion de code nommée, réutilisable qui a accès à toutes les variables du script ou du shell d'où elle est appelée :</p>
<pre class="literal-block">
michaellaunay&#64;luciole:~$ function carré() {
&gt; echo $[ $1 * $1]
&gt; }
michaellaunay&#64;luciole:~$ carré 3
9
</pre>
</div>
<div class="section" id="lecture-des-saisies-clavier">
<h3><a class="toc-backref" href="#id82">7.2.19&nbsp;&nbsp;&nbsp;Lecture des saisies clavier</a></h3>
<p>La commande <strong>read</strong> permet de lire la saisie clavier et de l'affecter avec une variable :</p>
<pre class="literal-block">
michaellaunay&#64;luciole:~$ read VAR
coucou
michaellaunay&#64;luciole:~$ echo $VAR
coucou
</pre>
</div>
<div class="section" id="exercice">
<h3><a class="toc-backref" href="#id83">7.2.20&nbsp;&nbsp;&nbsp;Exercice</a></h3>
<p>Réalisez une calculatrice demandant la saisie de la première opérande puis de l'opérateur (symbole ou littéral), puis de la seconde opérande. Affichez le résultat puis exécutez à nouveau tant que le signal SIGUSR1 n'est pas reçu.</p>
</div>
<div class="section" id="les-sous-programmes">
<h3><a class="toc-backref" href="#id84">7.2.21&nbsp;&nbsp;&nbsp;Les sous-programmes</a></h3>
<p>Dans un shell on peut appeler un script directement en passant son nom si celui-ci est exécutable ou en le faisant interpréter par le shell pour lequel il a été écrit.</p>
<p>Lorsqu'on exécute un ensemble de commandes encadré par des parenthèses alors le shell courant démarre un sous shell pour exécuter les commandes :</p>
<pre class="literal-block">
michaellaunay&#64;luciole:~$ VAR=0
michaellaunay&#64;luciole:~$ (VAR=$[ $VAR + 1]; echo $VAR)
1
michaellaunay&#64;luciole:~$ echo $VAR
0
</pre>
<p>Il est également possible de forcer l'exécution de commande en utilisant <strong>`</strong> :</p>
<pre class="literal-block">
michaellaunay&#64;luciole:~$ echo date
date
michaellaunay&#64;luciole:~$ echo `date`
dimanche 19 avril 2020, 17:24:32 (UTC+0200)
</pre>
</div>
<div class="section" id="la-completion-de-commande">
<h3><a class="toc-backref" href="#id85">7.2.22&nbsp;&nbsp;&nbsp;La complétion de commande</a></h3>
<p>En appuyant sur la touche tab le shell affiche toutes les commandes ayant pour préfixe les lettres déjà saisies sur la ligne de commande.</p>
</div>
<div class="section" id="historique-des-commandes">
<h3><a class="toc-backref" href="#id86">7.2.23&nbsp;&nbsp;&nbsp;Historique des commandes</a></h3>
<p>Les commandes saisies dans un shell sont enregistrées dans le fichier ~/.bash_history</p>
<p>Il est possible d'accéder aux anciennes commandes en utilisant les flèches.</p>
</div>
</div>
<div class="section" id="les-commandes">
<h2><a class="toc-backref" href="#id87">7.3&nbsp;&nbsp;&nbsp;Les commandes</a></h2>
<div class="section" id="se-deplacer-dans-l-arborescence">
<h3><a class="toc-backref" href="#id88">7.3.1&nbsp;&nbsp;&nbsp;Se déplacer dans l'arborescence</a></h3>
<p>Les commandes :</p>
<pre class="literal-block">
ls        # Permet d'afficher les informations d'un fichier ou d'un répertoire
ls UnChemin # Affiche le contenu de UnChemin si c'est un répertoire, sinon affiche le nom de UnChemin
ls -lah   # Affiche les détails, les fichiers cachés, et utilise des unités informatiques
ls -F     # Affiche un / derrière le nom des répertoires
info ls   # Permet de connaître le sens des colonnes des options de ls, par exemple le chiffre de la seconde colonne de l'option -l est le nombre de hard links.
cd        # Permet de déplacer le répertoire courant
pwd       # Affiche le chemin du répertoire courant
</pre>
<p>exemple :</p>
<pre class="literal-block">
michaellaunay&#64;luciole:~$ ls -lh /
total 2,1G
drwxr-xr-x   2 root root  12K avril 19 16:40 bin
drwxr-xr-x   4 root root 4,0K avril  8 06:51 boot
drwxr-xr-x   2 root root 4,0K mai   16  2019 cdrom
drwxr-xr-x  19 root root 4,6K avril 18 22:11 dev
drwxr-xr-x 158 root root  12K avril 15 06:43 etc
drwxr-xr-x   5 root root 4,0K août  22  2019 home
lrwxrwxrwx   1 root root   32 janv.  6 18:48 initrd.img -&gt; boot/initrd.img-5.0.0-38-generic
lrwxrwxrwx   1 root root   32 janv.  6 18:48 initrd.img.old -&gt; boot/initrd.img-5.0.0-37-generic
drwxr-xr-x  21 root root 4,0K mars   5 06:28 lib
drwxr-xr-x   2 root root 4,0K mars   5 06:28 lib32
drwxr-xr-x   2 root root 4,0K mars   5 06:28 lib64
drwx------   2 root root  16K mai   16  2019 lost+found
drwxr-xr-x   3 root root 4,0K juin  24  2019 media
drwxr-xr-x   2 root root 4,0K févr. 10  2019 mnt
drwxr-xr-x   5 root root 4,0K août  26  2019 opt
dr-xr-xr-x 354 root root    0 avril 18 22:11 proc
drwx------   8 root root 4,0K mars  25 10:16 root
drwxr-xr-x  39 root root 1,1K avril 19 10:15 run
drwxr-xr-x   2 root root  12K avril 19 16:40 sbin
drwxr-xr-x  17 root root 4,0K mars  22 22:44 snap
drwxr-xr-x   2 root root 4,0K févr. 10  2019 srv
-rw-------   1 root root 2,0G mai   16  2019 swapfile
dr-xr-xr-x  13 root root    0 avril 18 22:11 sys
drwxrwxrwt  24 root root 4,0K avril 19 17:20 tmp
drwxr-xr-x  14 root root 4,0K août   1  2019 usr
drwxr-xr-x  15 root root 4,0K juin  17  2019 var
lrwxrwxrwx   1 root root   29 janv.  6 18:48 vmlinuz -&gt; boot/vmlinuz-5.0.0-38-generic
lrwxrwxrwx   1 root root   29 janv.  6 18:48 vmlinuz.old -&gt; boot/vmlinuz-5.0.0-37-generic


michaellaunay&#64;luciole:~/Documents/ecreall/Cours$ cd
michaellaunay&#64;luciole:~$ pwd
/home/michaellaunay
</pre>
<p>Les jokers :</p>
<pre class="literal-block">
* # Désigne toute chaîne contiguë de caractères
? # Désigne un caractère
[...] # Permet de désigner des ensembles de caractères [4-69] accepte 4, 5, 6, et 9, [[] accepte [ identique à \[A
[^...] # Permet de désigner des ensembles à exclure
</pre>
<p>Un <strong>chemin relatif</strong> est un chemin qui permet de se déplacer jusqu'au fichier cible à partir du chemin courant :</p>
<pre class="literal-block">
michaellaunay&#64;luciole:~$ cd ~ # identique à cd $HOME ou cd
michaellaunay&#64;luciole:~$ ls -l ../../etc/passwd
-rw-r--r-- 1 root root 1583 2009-04-02 11:35 ../../etc/passwd
</pre>
<p><strong>.</strong> indique le répertoire courant alors que <strong>..</strong> indique le parent.</p>
<p>Un <strong>chemin absolu</strong> est un chemin qui commence à la racine <strong>/</strong> de l'arborescence et énonce tous les sous-répertoires jusqu'à la cible :</p>
<pre class="literal-block">
michaellaunay&#64;luciole:~$ ls -l /etc/passwd
-rw-r--r-- 1 root root 1583 2009-04-02 11:35 /etc/passwd
</pre>
</div>
<div class="section" id="creation-suppression-de-repertoire">
<h3><a class="toc-backref" href="#id89">7.3.2&nbsp;&nbsp;&nbsp;Création / suppression de répertoire</a></h3>
<p>La commande <strong>mkdir</strong> permet de créer des répertoires :</p>
<pre class="literal-block">
mkdir NomRep # Crée le répertoire NomRep.
mkdir -p Rep1/Rep2/Rep3 # Crée Rep3 et l'arborescence Rep1/Rep2 si nécessaire.
</pre>
<p>La commande <strong>rmdir</strong> permet de supprimer un répertoire vide, on peut aussi le faire avec <strong>rm -r</strong> dans le cas d'un répertoire non vide.</p>
</div>
<div class="section" id="lecture-de-fichier">
<h3><a class="toc-backref" href="#id90">7.3.3&nbsp;&nbsp;&nbsp;Lecture de fichier</a></h3>
<p>La commande <strong>cat</strong> permet d'afficher le contenu d'un fichier.</p>
<p>La commande <strong>strings</strong> permet de n'afficher que les chaînes de caractères d'un fichier binaire.</p>
</div>
<div class="section" id="rechercher-des-fichiers">
<h3><a class="toc-backref" href="#id91">7.3.4&nbsp;&nbsp;&nbsp;Rechercher des fichiers</a></h3>
<p>La commande <strong>find</strong> permet de réaliser des recherches basées sur les informations d'un fichier (nom, date de création, de modification etc.) :</p>
<pre class="literal-block">
michaellaunay&#64;luciole:~$ find Documents/ecreall -name &quot;*pdf&quot; -ctime -2
# recherche à partir de Documents/ecreall tous les fichiers finissant par pdf, créés depuis moins de 2 jours
Documents/ecreall/Cours/CoursGNULinux/CoursGNULinux.pdf
</pre>
<p>La commande <strong>grep</strong> permet de réaliser des recherches basées sur la présence d'une chaîne ou d'une expression régulière dans le contenu d'un fichier.</p>
<p>La commande <strong>locate</strong> permet de trouver un fichier si le chemin a été renseigné dans la base de données mise à jour par le super utilisateur avec <strong>updatedb</strong> ou <strong>slocate -u</strong>.</p>
</div>
<div class="section" id="archivage-compression">
<h3><a class="toc-backref" href="#id92">7.3.5&nbsp;&nbsp;&nbsp;Archivage / Compression</a></h3>
<p><strong>zip</strong>, <strong>unzip</strong> permet de compresser et décompresser les fichiers aux format zip</p>
<p><strong>gzip</strong> permet de compresser et décompresser les fichiers au format gzip</p>
<p><strong>tar</strong> avec les options <strong>cf</strong> permet d'archiver une arborescence en conservant les informations de propriétaire, les dates de création, les permissions d'accès. Avec les options <strong>xf</strong>, permet d'extraire une archive.</p>
<p><strong>tar cfz</strong> permet de combiner <strong>tar</strong> et <strong>gzip</strong> en une commande.
L'option  <strong>--listed-incremental=nom_fichier.list</strong> permet d'enregistrer un snapshot des fichiers archivés en vue de permettre des tar incrémentaux. C.f. <a class="reference external" href="https://doc.ubuntu-fr.org/tar#utilisation_en_archivage_incrementiel">https://doc.ubuntu-fr.org/tar#utilisation_en_archivage_incrementiel</a>
Attention il est indispensable que la première archive soit lancée avec cette option pour que l'incrémentation soit possible !</p>
</div>
<div class="section" id="autres-commandes">
<h3><a class="toc-backref" href="#id93">7.3.6&nbsp;&nbsp;&nbsp;Autres commandes</a></h3>
<p><strong>mv</strong> permet de déplacer un fichier ou une arborescence.</p>
<p><strong>tail</strong> permet de n'afficher que les dernières lignes d'un fichier, l'option -f permet d'afficher le contenu au fur et à mesure de son arrivé dans le flux.</p>
<p><strong>tee</strong> permet d'écrire le contenu de la sortie standard dans un fichier tout en laissant ce contenu dans la sortie standard ce qui permet dans un pipe d'avoir une capture du contenu sans casser le pipe.</p>
<p><strong>ln</strong> permet de créer des liens. Ainsi <strong>ln -s Source Destination</strong> permet de créer un lien symbolique.</p>
<p><strong>cp</strong> permet de copier un fichier dans un autre. <strong>cp -r Rep1 Rep2</strong> copie toute l'arborescence Rep1 vers Rep2.</p>
<p><strong>script NOM_Fichier</strong> permet d'enregistrer la session (les interactions en ligne de commande) vers un fichier, ce qui permet de l'auditer voire de la rejouer.
L'option -t permet d'enregistrer les dates des échanges vers le flux d'erreur.
L'enregistrement sera arrêté par la commande <strong>exit</strong>.
<strong>scriptreplay</strong> Permet de rejour la session.
Exemple : <strong>NOM=`date +%y%m%d%H%m%S`_upgrade_jessie;script -t 2&gt;~/$NOM.time -a ~/$NOM.script</strong></p>
</div>
<div class="section" id="les-noms-de-fichiers">
<h3><a class="toc-backref" href="#id94">7.3.7&nbsp;&nbsp;&nbsp;Les noms de fichiers</a></h3>
<p>Linux est sensible à la casse (majuscules vs minuscules).</p>
<p>Depuis 2007, l'ensemble du système utilise <a class="reference external" href="http://fr.wikipedia.org/wiki/Utf-8">utf-8</a> comme encodage par défaut, en conséquence tous les caractères accentués peuvent être utilisés pour nommer les fichiers.</p>
<p>Les caractères spéciaux et les espaces peuvent être utilisés à la condition d'être échappés.</p>
<p>La taille des noms ne doit pas excéder 255 octets.</p>
<p>Si l'on utilise des caractères accentués ou asiatiques, le nombre de caractères maximal est inférieur à 255, car il faut 2 à 4 octets pour représenter un caractère autre que ASCII en <a class="reference external" href="http://fr.wikipedia.org/wiki/Utf-8">utf-8</a>.</p>
<p>Tout fichier ou répertoire commençant par un <strong>.</strong> sera caché et accessible uniquement avec l'option <strong>-a</strong> de <strong>ls</strong>.</p>
</div>
<div class="section" id="les-attributs-des-fichiers">
<h3><a class="toc-backref" href="#id95">7.3.8&nbsp;&nbsp;&nbsp;Les attributs des fichiers</a></h3>
<p>Les attributs de fichier permettent de gérer les permissions d'accès en lecture, écriture, exécution, traversée et également de connaître la nature du fichier.</p>
<p>Ainsi :</p>
<pre class="literal-block">
michaellaunay&#64;luciole:~/Documents/ecreall/Cours$ ls -lh
total 24K
lrwxrwxrwx   1 michaellaunay users   11 2009-03-01 21:23 unLienSymbolique -&gt; unFichier
drwxr-x--- 139 michaellaunay users  12K 2009-04-30 09:12 unSousRep
drwx------   2 michaellaunay michaellaunay  16K 2009-03-01 21:21 lost+found
-rw-r-----   1 michaellaunay amis  32K 2009-04-02 11:35 unFichier
michaellaunay&#64;luciole:~/Documents/ecreall/Cours/CoursGNULinux$ ls -l /bin/mount
-rwsr-xr-x 1 root root 98440 2008-09-25 15:08 /bin/mount
michaellaunay&#64;luciole:~/Documents/ecreall/Cours/CoursGNULinux$ ls -l
drwxrwxrwt  19 root root  4096 2009-05-03 11:10 tmp
</pre>
<p><em>lrwxrwxrwx 1 michaellaunay users 11 2009-03-01 21:23</em> est la liste des attributs qui doit être décomposée comme ceci :</p>
<pre class="literal-block">
première lettre :
  l indique que le fichier est un lien symbolique (un raccourci).
  d indique que le fichier est un répertoire
  - indique que le fichier est un fichier ordinaire
  c périphérique de type caractère
  b périphérique de type bloc
  s socket
  p fifo

premier groupe de 3 lettres :
  r-- indique que le propriétaire a le droit de lecture
  -w- indique que le propriétaire a le droit d'écriture
  --x indique que le propriétaire a le droit d'exécuter si le fichier est ordinaire
      indique que le propriétaire a le droit de traverser si le fichier est un répertoire
  --s (SUID) indique qu'un utilisateur qui exécute le fichier usurpe les droits du propriétaire
      pour tous les accès effectués par l'exécutable.
      Le propriétaire a les droits d'exécuter ou de traverser (--x est positionné mais est caché).
  --S (SUID) indique qu'un utilisateur qui exécute le fichier usurpe les droits du propriétaire.
      Le propriétaire n'a pas les droits d'exécuter ou de traverser (--x n'est pas positionné).

second groupe de 3 lettres :
  même signification que précédemment, mais pour les groupes et sauf pour le SUID.
  --s (SGID) indique qu'un utilisateur appartenant au groupe qui exécute le fichier usurpe les
      droits du groupe et que le groupe a les droits d'exécution.
  --S (SGID) indique qu'un utilisateur appartenant au groupe qui exécute le fichier usurpe les
      droits du groupe mais que le groupe n'a pas les droits d'exécuter ou de traverser.

troisième groupe de 3 lettres :
  même signification que précédemment, mais pour tous les autres utilisateurs et sauf SGID
  --t (Sticky bit) Indique que les utilisateurs ont le droit de modifier le contenu du fichier
      ou du répertoire, mais pas de le supprimer.
      Les utilisateurs ont le droit d'exécution ou de traverser.
  --T (Sticky bit) Idem mais les utilisateurs n'ont pas le droit d'exécuter ou de traverser.
</pre>
<p>Le fichier unFichier a pour propriétaire <em>michaellaunay</em> (owner) et pour groupe <em>amis</em> (owning group).</p>
<p>Les notions de permission et de groupe seront détaillées ci-après.</p>
<p>La taille du fichier unFichier est de 32ko.</p>
<p>La date est celle de dernière modification. La date du dernier accès est accessible avec la commande <strong>ls -u -l</strong>.</p>
<p>Les permissions d'un lien ne sont pas utilisées, car ceux sont celles de la cible qui sont vérifiées.</p>
<p>Si les permissions sont suivies d'un + alors des ACL sont positionnées.</p>
</div>
<div class="section" id="les-types-de-fichiers">
<h3><a class="toc-backref" href="#id96">7.3.9&nbsp;&nbsp;&nbsp;Les types de fichiers</a></h3>
<p>Outre les fichiers normaux, les répertoires et les liens, il existe de nombreux fichiers spéciaux sous Unix.</p>
<p>En effet la philosophie d'Unix est de vouloir que tout soit fichier :</p>
<pre class="literal-block">
Les périphériques sont manipulés comme s'ils étaient des fichiers.
Les piles (fifo, lifo), les pipes nommées, sockets sont manipulés comme des fichiers.
Les caractéristiques du système sont traduites à travers une arborescence.
Le noyau lui-même est adressé à travers une arborescence qui permet de connaître son état et de le modifier.
Les processus sont eux même manipulés à travers une arborescence de fichiers.
</pre>
</div>
<div class="section" id="dev">
<h3><a class="toc-backref" href="#id97">7.3.10&nbsp;&nbsp;&nbsp;/dev</a></h3>
<p>Contient les fichiers de périphériques physiques ou virtuels :</p>
<pre class="literal-block">
/dev/sda    # Premier disk scsi ou sata ou usb
/dev/sda1   # Première partition de /dev/sda
/dev/sdb    # Second périphérique scsi ou sata ou usb
/dev/cdrom  # Lien vers le périphérique gérant le cdrom
/dev/null   # Utile pour se débarrasser du contenu d'un flux
/dev/zero   # Générateur d'octet nul
/dev/random # Générateur aléatoire
</pre>
<p>Exemple:</p>
<pre class="literal-block">
michaellaunay&#64;luciole:~$ find /usr -name &quot;*.pdf&quot; 2&gt; /dev/null
/usr/share/doc/shared-mime-info/shared-mime-info-spec.pdf
/usr/share/example-content/case_ubuntu_johnshopkins_v2.pdf
/usr/share/example-content/case_howard_county_library.pdf
/usr/share/example-content/case_oxford_archaeology.pdf
/usr/share/example-content/case_ubuntu_locatrix_v1.pdf
/usr/share/example-content/case_Skegness.pdf
/usr/share/example-content/case_Contact.pdf
/usr/share/example-content/case_OaklandUniversity.pdf
/usr/share/example-content/case_KRUU.pdf
/usr/share/example-content/case_Wellcome.pdf
/usr/share/evolution/2.24/help/quickref/fr/quickref.pdf
/usr/share/gnome/help/system-admin-guide/C/system-admin-guide.pdf
/usr/share/gnome/help/gnome-access-guide/C/gnome-access-guide.pdf
/usr/share/gnome/help/user-guide/C/user-guide.pdf
</pre>
<p>Dans ce cas tous les messages d'erreur ont été envoyés à la poubelle.</p>
</div>
<div class="section" id="sys">
<h3><a class="toc-backref" href="#id98">7.3.11&nbsp;&nbsp;&nbsp;/sys</a></h3>
<p><strong>sysfs</strong> est une arborescence virtuelle résidant en mémoire qui exporte des informations sur les périphériques.</p>
<p>Cette arborescence offre plusieurs types de classement, une même information peut donc être trouvée de différente manière.</p>
<p>Les commandes telles que <strong>lsusb</strong> ou <strong>lspci</strong> vont chercher les informations dont elles ont besoin dans cette arborescence.</p>
<p><strong>/sys/class/</strong> montre les périphériques regroupés en classes :</p>
<pre class="literal-block">
michaellaunay&#64;luciole:~$ ls /sys/class/
atm        firmware       ieee1394_protocol  pci_bus        scsi_disk     usb_host
backlight  gpio           ieee80211          pcmcia_socket  scsi_generic  vc
bdi        graphics       input              power_supply   scsi_host     video_output
block      hidraw         leds               ppdev          sound         vtconsole
bluetooth  hwmon          mem                printer        spi_master
dma        ieee1394       misc               rfkill         thermal
dmi        ieee1394_host  mmc_host           rtc            tty
drm        ieee1394_node  net                scsi_device    usb_endpoint

michaellaunay&#64;luciole:~$ cat /sys/class/thermal/cooling_device0/type
Processor
michaellaunay&#64;luciole:~$ cat /sys/class/thermal/cooling_device0/cur_state
0
</pre>
</div>
<div class="section" id="proc">
<h3><a class="toc-backref" href="#id99">7.3.12&nbsp;&nbsp;&nbsp;/proc</a></h3>
<p><strong>procfs</strong> est une arborescence virtuelle résidant en mémoire qui exporte des informations sur le noyau.</p>
<p>C'est dans cette arborescence que des commandes comme <strong>ps</strong> vont chercher des informations sur les processus.</p>
<p>Exemple :</p>
<pre class="literal-block">
michaellaunay&#64;luciole:~$ cat /proc/cpuinfo
processor     : 0
vendor_id     : GenuineIntel
cpu family    : 6
model         : 15
model name    : Intel(R) Core(TM)2 Duo CPU     L7500  &#64; 1.60GHz
stepping      : 11
cpu MHz               : 800.000
cache size    : 4096 KB
physical id   : 0
siblings      : 2
core id               : 0
cpu cores     : 2
apicid                : 0
initial apicid        : 0
fpu           : yes
fpu_exception : yes
cpuid level   : 10
wp            : yes
flags         : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi
          mmx fxsr sse sse2 ss ht tm pbe syscall nx lm constant_tsc arch_perfmon pebs bts rep_good
          nopl pni monitor ds_cpl vmx est tm2 ssse3 cx16 xtpr lahf_lm ida
bogomips      : 3191.95
clflush size  : 64
cache_alignment       : 64
address sizes : 36 bits physical, 48 bits virtual
power management:
</pre>
<p>/proc permet en tant que root et selon l'état du processus observé d'analyser ses ressources et sa mémoire.</p>
<p>Ainsi il est possible de récupérer le contenu de la mémoire du processus arrêté.
Voir <a class="reference external" href="https://unix.stackexchange.com/questions/6301/how-do-i-read-from-proc-pid-mem-under-linux">https://unix.stackexchange.com/questions/6301/how-do-i-read-from-proc-pid-mem-under-linux</a> et <a class="reference external" href="https://unix.stackexchange.com/questions/6267/how-to-re-load-all-running-applications-from-swap-space-into-ram/6271#6271">https://unix.stackexchange.com/questions/6267/how-to-re-load-all-running-applications-from-swap-space-into-ram/6271#6271</a></p>
</div>
</div>
<div class="section" id="enchainement-et-parallelisation-des-commandes">
<h2><a class="toc-backref" href="#id100">7.4&nbsp;&nbsp;&nbsp;Enchaînement et parallélisation des commandes</a></h2>
<p>Toute commande doit être vue comme une boîte noire ayant une entrée standard (stdin), une sortie standard (stdout) et une sortie d'erreur standard qui permet aussi d'afficher des informations (stderr).</p>
<p>Par défaut l'entrée standard est la saisie clavier et les sorties sont l'écran.</p>
</div>
<div class="section" id="les-flux-standards">
<h2><a class="toc-backref" href="#id101">7.5&nbsp;&nbsp;&nbsp;Les flux standards</a></h2>
<p>Les flux standards stdin, stdout et stderr sont numérotés respectivement 0, 1 et 2.</p>
<p>En conséquence on peut utiliser ces numéros pour les désigner lors des redirections.</p>
</div>
<div class="section" id="input-output">
<h2><a class="toc-backref" href="#id102">7.6&nbsp;&nbsp;&nbsp;Input, Output</a></h2>
<p>La notion d'input (entrée) et d'output (sortie) est relative à la commande, ainsi dans un pipe entre deux commandes l'entrée de la seconde commande et en fait la sortie de la première. Le système crée un flux entre les deux commandes nourri par la première et consommé par la seconde.</p>
</div>
<div class="section" id="les-redirections">
<h2><a class="toc-backref" href="#id103">7.7&nbsp;&nbsp;&nbsp;Les redirections</a></h2>
<p>Les redirections vont permettre d'indiquer que faire des entrées et sorties standards.</p>
<p>Les redirections de fichier :</p>
<pre class="literal-block">
&gt;, 1&gt;  # Stocke la sortie standard dans un fichier
2&gt;     # Stocke la sortie des erreurs dans un fichier
&amp;&gt;     # Stocke les sorties dans un seul fichier
&gt;&amp;     # Idem
&gt;&gt;     # Concatène la sortie standard à la fin d'un fichier
&lt;      # Utilise un fichier en entrée
|      # pipe, décrit ci-après
</pre>
</div>
<div class="section" id="les-pipes">
<h2><a class="toc-backref" href="#id104">7.8&nbsp;&nbsp;&nbsp;Les pipes</a></h2>
<p>Le pipe permet d'enchaîner les commandes, l'entrée d'une commande est alors le résultat de la commande précédente.</p>
<p>L'intérêt est de pouvoir créer des comportements complexes à partir de commandes simples. Cette association peut à son tour être manipulée comme une boite noire et être insérée dans un pipe plus complexe.</p>
<p>Exemple:</p>
<pre class="literal-block">
netstat -anp |grep 'tcp\|udp' | awk '{print $5}' | sed s/::ffff:// | cut -d: -f1 | sort | uniq -c | sort -n
</pre>
</div>
<div class="section" id="les-alias">
<h2><a class="toc-backref" href="#id105">7.9&nbsp;&nbsp;&nbsp;Les alias</a></h2>
<p>La commande intégrée alias permet de redéfinir des commandes :</p>
<pre class="literal-block">
alias rm=&quot;echo 'ça va couper' &amp;&amp; rm&quot;
</pre>
<p>La commande <strong>unalias</strong> supprime les alias.</p>
</div>
<div class="section" id="screen">
<h2><a class="toc-backref" href="#id106">7.10&nbsp;&nbsp;&nbsp;screen</a></h2>
<p>La commande <strong>screen</strong> est un multiplexeur de terminaux il permet de gérer plusieurs shell et de ce déconnecter sans tuer les shell dont les commandes ne sont pas encore finies.</p>
<p>L'intérêt est de pouvoir réaliser des tâches d'administration longues sans devoir rester connecté, ou si le réseau n'est pas fiable de ne pas perdre le travail accompli en reprenant là ou la connexion s'est rompue.</p>
<p>Les options de bases :</p>
<pre class="literal-block">
michaellaunay&#64;luciole:~$ screen -dmS Nom
michaellaunay&#64;luciole:~$ screen -r Nom # Permet de se rattacher au terminal Nom
# Pour se détacher Crtl-a Ctrl-d
# Pour un nouveau Ctrl-a Ctrl-c
# Pour passer de l'un à l'autre : Ctrl-a Ctrl-n
# man screen
</pre>
</div>
<div class="section" id="ssh">
<h2><a class="toc-backref" href="#id107">7.11&nbsp;&nbsp;&nbsp;ssh</a></h2>
<p>La commande <strong>ssh</strong> permet de se connecter à distance sur une machine Unix ceci de façon chiffrée. Elle permet aussi d'ouvrir des tunnels chiffrés.</p>
<p>L'ouverture d'un tunnel entre 2 machines est de la forme :</p>
<pre class="literal-block">
ssh -L ${PORT_SOURCE}:${nom_machine_dest}:${PORT_DEST} ${USER}&#64;${DEST}
</pre>
<p>où ${PORT_SOURCE} est le numéro de port d'entrée du tunnel sur la machine où l'on est, ${nom_machine_dest} est soit localhost soit le nom de la machine destination soit une adresse du réseau privé derrière le serveur destination, ${PORT_DEST} est le numéro du port de sortie du tunnel sur la machine cible
${USER} est le nom d'utilisateur
${DEST} est le nom complet du serveur de destination</p>
<p>Exemple :</p>
<pre class="literal-block">
ssh -l 9880:localhost:80 michaellaunay&#64;plateforme.test.com
</pre>
<p>Me permet d'ouvrir un tunnel entre ma machine et le serveur plateforme en utilisant mon compte michaellaunay.</p>
<p>Une fois mon mot de passe ou ma clé acceptée je me retrouve sur la machine distante et un tunnel est ouvert entre ma machine locale et plateforme.</p>
<p>Si j'ouvre un navigateur sur ma machine et que je mets comme adresse <a class="reference external" href="http://localhost:9880">http://localhost:9880</a>, la communication est chiffrée et envoyée sur plateforme où elle ressort sur le port 80 ce qui me permet d'accéder au serveur web de plateforme1 sans que quiconque ne sache ce que je fais.</p>
<p>Compréhension de ssh :</p>
<blockquote>
<ul class="simple">
<li><a class="reference external" href="http://fr.wikipedia.org/wiki/Ssh">http://fr.wikipedia.org/wiki/Ssh</a></li>
<li><a class="reference external" href="http://web.archive.org/web/20110907084212/http://www.unixgarden.com/index.php/administration-systeme/principes-et-utilisation-de-ssh">http://web.archive.org/web/20110907084212/http://www.unixgarden.com/index.php/administration-systeme/principes-et-utilisation-de-ssh</a></li>
</ul>
</blockquote>
<p>Si la clé d'une machine à laquelle on se connecte habituellement a changé (cas d'une réinstallation), on peut être amené à supprimer son entrée dans le fichier <em>~/.ssh/known_hosts</em>.</p>
<p>Le plus simple est alors d'utiliser la commande <strong>ssh-keygen -R NomDeLaMachineDistante</strong>.</p>
<p>L'installation du deamon <strong>apt-get install ssh</strong></p>
<p>Pour sécuriser les connexions <strong>ssh</strong>, il faut éditer <em>/etc/ssh/sshd_config</em> et mettre l'option <em>PermitRootLogin=no</em> et ajouter en fin de fichier <em>AllowUsers idUtilisateurAutorise</em>.</p>
<p>La commande <strong>screen</strong> est très utilisée avec &quot;ssh&quot;, elle permet de conserver le <strong>tty</strong> ouvert lors des déconnexions et donc de reprendre là où on en était.
Il suffit de la relancer avec l'option &quot;-r&quot; pour rattacher une session précédente,  de même en début de session on peut faire &quot;Ctrl A&quot; &quot;esc&quot; pour enregistrer les lignes et donc avoir la scroll bar.</p>
</div>
<div class="section" id="iptables-et-ufw">
<h2><a class="toc-backref" href="#id108">7.12&nbsp;&nbsp;&nbsp;iptables et ufw</a></h2>
<p>La commande <strong>iptables</strong> permet de consulter et modifier les règles du firewall.</p>
<p>Le service <strong>ufw</strong> est un &quot;firewall&quot; pré-configurer que l'on peut facilement compléter.</p>
<p>Pour l'installer il suffit de faire :</p>
<blockquote>
apt install ufw</blockquote>
<p>Modification du firewall pour permettre en entrée http, https, smtp :</p>
<blockquote>
vim /etc/ufw/ufw.conf  # ENABLED=yes #si pas déjà positionné
ufw allow 22/tcp # Ouvre le port ssh à tous (on peut restreindre à certaines adresses)
ufw allow 80/tcp # Ouverture de http
ufw allow 443/tcp # Ouverture de https
ufw allow 25/tcp # Ouverture de smtp (envoi des courriels)
ufw enable # Rend actif ufw</blockquote>
<p>Ces commandes permettent aussi de gérer ipv6</p>
<p>Vérification :</p>
<blockquote>
<p><a class="reference external" href="mailto:root&#64;triticale">root&#64;triticale</a>:/etc/dovecot# ufw status
État&nbsp;: actif</p>
<p>Vers                       Action      De
----                       ------      --
22/tcp                     ALLOW       Anywhere
25/tcp                     ALLOW       Anywhere
80/tcp                     ALLOW       Anywhere
443/tcp                    ALLOW       Anywhere
22/tcp (v6)                ALLOW       Anywhere (v6)
25/tcp (v6)                ALLOW       Anywhere (v6)
80/tcp (v6)                ALLOW       Anywhere (v6)
443/tcp (v6)               ALLOW       Anywhere (v6)</p>
</blockquote>
</div>
</div>
<div class="section" id="gestion-des-permissions-et-droits-d-acces">
<h1><a class="toc-backref" href="#id109">8&nbsp;&nbsp;&nbsp;Gestion des permissions et droits d'accès</a></h1>
<div class="section" id="concepts">
<h2><a class="toc-backref" href="#id110">8.1&nbsp;&nbsp;&nbsp;Concepts</a></h2>
<p>Tous les utilisateurs ont un compte qui permet de les identifier.</p>
<p>Les programmes fonctionnant en tâche de fond (services) sont lancés depuis des utilisateurs créés spécialement pour eux. Ainsi, le serveur html <strong>apache</strong> est lancé depuis le compte <strong>www-data</strong>.</p>
<p>Les utilisateurs peuvent appartenir à des groupes ce qui permet de donner des droits à un ensemble d'utilisateurs très facilement.</p>
<p>Tout fichier appartient à un utilisateur et à un groupe.</p>
<p>La gestion des droits d'accès et d'exécution se résume alors à gérer les types d'accès en fonction du propriétaire, du groupe, et du reste des utilisateurs.</p>
<p>Comme vu précédemment la commande <strong>ls -l</strong> permet d'afficher les attributs d'un fichier et donc ses permissions.</p>
<p>À la création d'un fichier, les droits sont automatiquement positionnés en fonction de la valeur par défaut du système et de <strong>umask</strong> :</p>
<pre class="literal-block">
michaellaunay&#64;luciole:~$ umask
0022
michaellaunay&#64;luciole:~/tmp$ touch test1
michaellaunay&#64;luciole:~/tmp$ ls -lh test1
-rw-r--r-- 1 michaellaunay michaellaunay 0 avril  5 12:17 test1
michaellaunay&#64;luciole:~/tmp$ umask 027
michaellaunay&#64;luciole:~/tmp$ touch test2
michaellaunay&#64;luciole:~/tmp$ ls -lh test2
-rw-r----- 1 michaellaunay michaellaunay 0 avril  5 12:18 test2
</pre>
<p>Le propriétaire est alors le créateur, et le groupe est généralement le groupe par défaut de l'utilisateur sauf dans le cas ou le répertoire porte le SGID alors le groupe est celui du répertoire.</p>
</div>
<div class="section" id="changer-le-proprietaire-ou-le-groupe-proprietaire">
<h2><a class="toc-backref" href="#id111">8.2&nbsp;&nbsp;&nbsp;Changer le propriétaire ou le groupe propriétaire</a></h2>
<p>La commande <strong>chown</strong> permet de changer le propriétaire et le groupe d'un fichier :</p>
<pre class="literal-block">
root&#64;luciole:~$ ls -l /tmp/MonFichier
-rw-rw-rw- 1 michaellaunay michaellaunay 0 2009-05-03 19:08 /tmp/MonFichier
root&#64;luciole:~# chown root:users /tmp/MonFichier
root&#64;luciole:~# ls -l /tmp/MonFichier
-rw-rw-rw- 1 root users 0 2009-05-03 19:08 /tmp/MonFichier
</pre>
<p>Toutefois pour des raisons de sécurité (gestion des quotas : attaque sushi) la commande peut être réservée au super utilisateur.</p>
<p>On dispose aussi de la commande <strong>chgrp</strong> qui permet de changer le groupe d'un fichier.</p>
</div>
<div class="section" id="valeurs-symboliques-et-octales-des-permissions">
<h2><a class="toc-backref" href="#id112">8.3&nbsp;&nbsp;&nbsp;Valeurs symboliques et octales des permissions</a></h2>
<p>Les tableaux suivants donnent les équivalents symboliques octales des permissions.</p>
<table border="1" class="docutils">
<colgroup>
<col width="52%" />
<col width="29%" />
<col width="19%" />
</colgroup>
<tbody valign="top">
<tr><td>DROIT</td>
<td>LETTRE</td>
<td>VALEUR</td>
</tr>
<tr><td>Lecture</td>
<td>r (read)</td>
<td>4</td>
</tr>
<tr><td>Écriture</td>
<td>w (write)</td>
<td>2</td>
</tr>
<tr><td>Exécution / Traversé</td>
<td>x (execute)</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>Ainsi les permissions <em>rwx</em> sont équivalentes à <em>7</em> et <em>rwxr-xr--</em> donne <em>754</em>.</p>
<table border="1" class="docutils">
<colgroup>
<col width="25%" />
<col width="58%" />
<col width="17%" />
</colgroup>
<tbody valign="top">
<tr><td>DROIT</td>
<td>LETTRE</td>
<td>VALEUR</td>
</tr>
<tr><td>SUID</td>
<td>s si le propriétaire a <em>x</em>
S si non</td>
<td>4</td>
</tr>
<tr><td>SGID</td>
<td>s si le groupe a <em>x</em>
S sinon</td>
<td>2</td>
</tr>
<tr><td>Sticky Bit</td>
<td>t si les autres ont <em>x</em>
T sinon</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>Ainsi <em>rwsr-sr-t</em> est équivalent à <em>7755</em>.</p>
<p>Si l'on a un S ou un T en majuscule cela signifie que les droits d'exécution n'ont pas été positionnés.</p>
<p>Ceci n'a pas de sens dans le cas général et indique une suppression du droit d'exécution avec oubli du SUID ou GUID ou Sticky Bit.</p>
<p>Sauf avec l'usage des ACLs, où un utilisateur particulier peut avoir le droit d'exécution et redonne du sens à S ou T.</p>
</div>
<div class="section" id="changer-les-permissions-sur-les-fichiers">
<h2><a class="toc-backref" href="#id113">8.4&nbsp;&nbsp;&nbsp;Changer les permissions sur les fichiers</a></h2>
<p>La commande <strong>chmod</strong> permet de modifier les droits des fichiers.</p>
<div class="section" id="mode-chiffre">
<h3><a class="toc-backref" href="#id114">8.4.1&nbsp;&nbsp;&nbsp;Mode chiffré</a></h3>
<p>Exemple :</p>
<pre class="literal-block">
michaellaunay&#64;luciole:~/tmp$ ls -l MonFichier
-rw-r--r-- 1 michaellaunay michaellaunay 0 2009-05-03 19:40 MonFichier
michaellaunay&#64;luciole:~/tmp$ chmod 754 MonFichier
michaellaunay&#64;luciole:~/tmp$ ls -l MonFichier
-rwxr-xr-- 1 michaellaunay michaellaunay 0 2009-05-03 19:40 MonFichier
</pre>
</div>
<div class="section" id="notation-relative-aux-droits-existants">
<h3><a class="toc-backref" href="#id115">8.4.2&nbsp;&nbsp;&nbsp;Notation relative (aux droits existants)</a></h3>
<p>Exemple :</p>
<pre class="literal-block">
michaellaunay&#64;luciole:~/tmp$ ls -l MonFichier
-rwxr-xr-- 1 michaellaunay michaellaunay 0 2009-05-03 19:40 MonFichier
michaellaunay&#64;luciole:~/tmp$ chmod u+s,g-x,o-r MonFichier
michaellaunay&#64;luciole:~/tmp$ ls -l MonFichier
-rwsr----- 1 michaellaunay michaellaunay 0 2009-05-03 19:40 MonFichier
</pre>
<p>Attention aux modifications contradictoires :</p>
<pre class="literal-block">
michaellaunay&#64;luciole:~$ echo coucou &gt; /tmp/hello
michaellaunay&#64;luciole:~$ ls -l /tmp/hello
-rw-r--r-- 1 michaellaunay michaellaunay 7 2009-05-07 09:45 /tmp/hello
michaellaunay&#64;luciole:~$ sudo chmod u-w,o+w /tmp/hello
michaellaunay&#64;luciole:~$ ls -l /tmp/hello
-r--r--rw- 1 michaellaunay michaellaunay 7 2009-05-07 09:45 /tmp/hello
michaellaunay&#64;luciole:~$ echo bonjour &gt;&gt; /tmp/hello
bash: /tmp/hello: Permission non accordée
</pre>
</div>
<div class="section" id="notation-absolue">
<h3><a class="toc-backref" href="#id116">8.4.3&nbsp;&nbsp;&nbsp;Notation absolue</a></h3>
<p>Exemple :</p>
<pre class="literal-block">
michaellaunay&#64;luciole:~/tmp$ ls -l MonFichier
-rwsr----- 1 michaellaunay michaellaunay 0 2009-05-03 19:40 MonFichier
michaellaunay&#64;luciole:~/tmp$ chmod u=rx,g=rx,o=rx MonFichier
michaellaunay&#64;luciole:~/tmp$ ls -l MonFichier
-r-xr-xr-x 1 michaellaunay michaellaunay 0 2009-05-03 19:40 MonFichier
</pre>
</div>
</div>
<div class="section" id="umask">
<h2><a class="toc-backref" href="#id117">8.5&nbsp;&nbsp;&nbsp;Umask</a></h2>
<p>Par défaut le système applique les droits 0666 pour un fichier et 0777 pour les répertoires auxquels il applique encore le filtre <strong>umask</strong> qui par défaut vaut 0022, les droits sont alors 0644 (rw-r--r--) pour un fichier et 0755 (rwx-rx-rx) pour un répertoire.</p>
<p>Il est possible de changer la valeur du masque de permissions en appelant <strong>umask nouvellevaleur</strong>.</p>
</div>
<div class="section" id="acl">
<h2><a class="toc-backref" href="#id118">8.6&nbsp;&nbsp;&nbsp;ACL</a></h2>
<p>Le mécanisme de gestion des droits Unix couvre 95% des usages.</p>
<p>Il reste donc certains cas non couverts comme le fait d'attribuer les droits de modification d'un fichier à un utilisateur sans avoir à demander à l'administrateur de devoir créer un groupe (ce qui manque un peu de souplesse).</p>
<p>On peut aussi vouloir associer de nouveaux attributs aux fichiers pour par exemple gérer des informations de sécurités.</p>
<p>À l'inverse il est très difficile de restreindre les droits d'un utilisateur d'un groupe donné pour un seul fichier.</p>
<p>C'est pour répondre ce besoin qu'ont été implémentées les Access Control List</p>
<p>Les ACLs reposent sur le mécanisme des attributs étendus.</p>
<p>Pour les rendre disponibles, il faut que la partition soit montée avec les options <em>acl</em> et <em>user_xattr</em> (modifier en conséquence <em>/etc/fstab</em>).</p>
<p>Les fonctions d'accès aux <em>acl</em> sont <strong>getfacl</strong>, <strong>setfacl</strong>, <strong>getfattr</strong>, <strong>setfattr</strong>.</p>
<p>Voir aussi les man pages de <em>acl</em> et <em>attr(5)</em>.</p>
</div>
<div class="section" id="attributs-etendus">
<h2><a class="toc-backref" href="#id119">8.7&nbsp;&nbsp;&nbsp;Attributs étendus</a></h2>
<p>Les attributs étendus permettent de gérer simplement les métadonnées associées à un fichier.</p>
<p>Ceux sont ces attributs étendus qui recevront les informations liées aux ACLs.</p>
<p>Pour installer le paquet : <strong>apt-get install attr</strong></p>
<p>Ajouter l'option <em>user_xattr</em> aux partitions dans <em>/etc/fstab</em>.</p>
<p>Puis utiliser <strong>setfattr</strong> pour positionner les attributs et <strong>getfattr</strong> pour les afficher :</p>
<pre class="literal-block">
michaellaunay&#64;excalibur:~$ echo test &gt; MonFichier
michaellaunay&#64;excalibur:~$ setfattr -n user.description -v 'Contient des données de test' MonFichier
michaellaunay&#64;excalibur:~$ ls -l MonFichier
-rw-r--r-- 1 michaellaunay michaellaunay 5 2009-05-05 08:17 MonFichier
michaellaunay&#64;excalibur:~$ getfattr -d MonFichier
#file: MonFichier
user.description=&quot;Contient des donn\305\251es de test&quot;
</pre>
<p>Remarque : La présence d'attributs étendus n'est pas signalée par <em>ls</em>.</p>
</div>
<div class="section" id="affectation-des-acl">
<h2><a class="toc-backref" href="#id120">8.8&nbsp;&nbsp;&nbsp;Affectation des ACL</a></h2>
<p>Pour vérifier que les ACLs peuvent être activées :</p>
<pre class="literal-block">
michaellaunay&#64;luciole:~$ grep -i acl /boot/config-`uname -r`

CONFIG_EXT2_FS_POSIX_ACL=y
CONFIG_EXT3_FS_POSIX_ACL=y
CONFIG_EXT4DEV_FS_POSIX_ACL=y
CONFIG_FS_POSIX_ACL=y
CONFIG_GENERIC_ACL=y
CONFIG_JFS_POSIX_ACL=y
CONFIG_NFSD_V2_ACL=y
CONFIG_NFSD_V3_ACL=y
CONFIG_NFS_ACL_SUPPORT=m
CONFIG_NFS_V3_ACL=y
CONFIG_REISERFS_FS_POSIX_ACL=y
CONFIG_TMPFS_POSIX_ACL=y
CONFIG_XFS_POSIX_ACL=y
</pre>
<p>Pour installer les ACL si besoin <em>apt-get install acl</em>.</p>
<p>Puis rendre la partition compatible avec les ACL (édition de fstab).</p>
<p>Exemple de changement de permissions :</p>
<pre class="literal-block">
root&#64;excalibur:~# mkdir /tmp/MYDIR
root&#64;excalibur:~# chacl u::rwx,u:michaellaunay:rwx,g::---,o::---,m::rwx /tmp/MYDIR
root&#64;excalibur:~# ls -l /tmp
drwx------+ 2 root     root    4096 2009-05-04 22:37 MYDIR
root&#64;excalibur:~# su - michaellaunay
michaellaunay&#64;excalibur:~$ touch /tmp/MYDIR/MonFichier
michaellaunay&#64;excalibur:~$ ls -l /tmp/MYDIR/
-rw-r--r-- 1 michaellaunay michaellaunay 0 2009-05-04 22:50 /tmp/MYDIR/
michaellaunay&#64;excalibur:~$ setfacl -m isabelle:r /tmp/MYDIR/MonFichier
michaellaunay&#64;excalibur:~$ setfacl -m g:users:- /tmp/MYDIR/MonFichier
michaellaunay&#64;excalibur:~$ getfacl /tmp/MYDIR/MonFichier
getfacl: Removing leading '/' from absolute path names
# file: tmp/MYDIR/MonFichier
# owner: michaellaunay
# group: michaellaunay
user::rw-
user:isabelle:r--
group::r--
group:users:---
mask::r--
other::r--
</pre>
</div>
</div>
<div class="section" id="les-processus">
<h1><a class="toc-backref" href="#id121">9&nbsp;&nbsp;&nbsp;Les processus</a></h1>
<div class="section" id="definition">
<h2><a class="toc-backref" href="#id122">9.1&nbsp;&nbsp;&nbsp;Définition</a></h2>
<p>Un processus est l'instance d'un programme en cours de fonctionnement.</p>
<p>Une application est constituée de un à plusieurs processus qui collaborent à la réalisation du travail demandé.</p>
<p>Chaque processus s'exécute en parallèle des autres.</p>
<p>Un processus correspond à un fichier exécutable.</p>
<p>Les processus utilisent des bibliothèques qui peuvent être statiques ou dynamiques selon qu'elles sont dans le code de l'application ou non.</p>
<p>L'extension des bibliothèques dynamiques est <em>.so</em> (shared object).</p>
<p>Un processus est lancé par un autre processus, ainsi il existe une relation père fils entre les processus.</p>
<p>Le processus ancêtre de tous les autres est <em>init</em> qui est lancé lors du démarrage par le noyau.</p>
<p>Son <em>PID</em> est 1.</p>
<p><strong>Alt+F2</strong> est un raccourci clavier permettant d'appeler le lanceur.</p>
</div>
<div class="section" id="attributs-d-un-processus">
<h2><a class="toc-backref" href="#id123">9.2&nbsp;&nbsp;&nbsp;Attributs d'un processus</a></h2>
<p>PID : Identifiant du processus (Process Identification),</p>
<p>PPID : Identifiant du processus père (Parent Process Identification),</p>
<p>PGID : Identifiant du groupe de processus qui permet de connaitre l'application à laquelle appartient le processus,</p>
<p>UID : Le compte utilisateur ayant lancé le processus,</p>
<p>GIDs : Les groupes de l'utilisateur ayant lancé le processus,</p>
<p>TTY : Terminal où a été lancé le processus,</p>
<p>NICE : Priorité appliquée pour le scheduling,</p>
<p>CMD : La commande à l'origine du proccessus.</p>
</div>
<div class="section" id="cycle-de-vie-d-un-processus">
<h2><a class="toc-backref" href="#id124">9.3&nbsp;&nbsp;&nbsp;Cycle de vie d'un processus</a></h2>
<p>Un processus est dans un état qui peut être &quot;created&quot;, &quot;ready&quot;, &quot;running&quot;, &quot;sleeping&quot;, &quot;idle&quot; (en attente de signal), &quot;Terminated&quot; = &quot;zombie&quot;</p>
<p><em>Created</em> correspond à l'état du processus au moment de sa création lorsque les variables ne sont pas encore renseignées.</p>
<p><em>Ready</em> le processus est en mémoire, les variables sont renseignées.</p>
<p><em>Running</em> le processus est en cours d'exécution.</p>
<p><em>Sleeping</em> le processus a été préempté.</p>
<p><em>Idle</em> le processus attend un signal.</p>
<p><em>Zombie</em> le processus a fini de s'exécuter, le code de retour attend sa lecture.</p>
<p>Voir : <a class="reference external" href="http://en.wikipedia.org/wiki/Process_states">http://en.wikipedia.org/wiki/Process_states</a></p>
</div>
<div class="section" id="les-differentes-sortes-de-processus">
<h2><a class="toc-backref" href="#id125">9.4&nbsp;&nbsp;&nbsp;Les différentes sortes de processus</a></h2>
<p>On distingue les processus classiques des deamons qui sont les services unix.</p>
<p>Les deamons ou démons fonctionnent en arrière plan ils ont en général pour père le processus 1.</p>
<p>Les démons sont lancés et arrêtés à partir des scripts contenus dans <strong>/etc/init.d</strong>.</p>
</div>
<div class="section" id="envoi-de-signaux-aux-processus">
<h2><a class="toc-backref" href="#id126">9.5&nbsp;&nbsp;&nbsp;Envoi de signaux aux processus</a></h2>
<p>L'envoi de signaux au processus se fait par la commande <strong>kill</strong> ou <strong>pkill</strong>.</p>
<p>Les processus peuvent établir entre eux une communication événementielle basé sur les signaux.</p>
<p>Seul les signaux <strong>9</strong> <strong>SIGKILL</strong>, et <strong>SIGSTOP</strong> ne peuvent être attrapés.</p>
</div>
<div class="section" id="les-commandes-liees-a-la-gestion-des-processus">
<h2><a class="toc-backref" href="#id127">9.6&nbsp;&nbsp;&nbsp;Les commandes liées à la gestion des processus</a></h2>
<p>La commande <strong>free</strong> affiche les ressources mémoires consommées.</p>
<p>La commande <strong>fuser</strong> liste les processus accédant à un fichier.</p>
<p>La commande <strong>ldd</strong> affiche la liste des bibliothèques utilisées par un exécutable.</p>
<p>La commande <strong>lsof</strong> affiche les fichiers ouverts par un processus <strong>lsof -p PID</strong>.</p>
<p>La commande <strong>nice</strong> et <strong>renice</strong> permette de modifier la priorité d'exécution.</p>
<p>La commande <strong>pgrep</strong> recherche un processus par son nom.</p>
<p>La commande <strong>ps</strong> affiche les processus en cours.</p>
<p>La commande <strong>pstree</strong> affiche l'arborescence des processus.</p>
<p>La commande <strong>top</strong> affiche la liste de processus classés par consommation décroissante.</p>
<p>La commande <strong>uptime</strong> affiche les informations de temps de fonctionnement, du nombre d'utilisateurs connectés, de la charge.</p>
</div>
<div class="section" id="arriere-plan-avant-plan-detachement">
<h2><a class="toc-backref" href="#id128">9.7&nbsp;&nbsp;&nbsp;Arrière plan / Avant plan / Détachement</a></h2>
<p>Pour lancer un processus en arrière plan on peut soit terminer la ligne de commande qui le lance avec <strong>&amp;</strong>, soit le lancer, faire <strong>Ctrl+z</strong> puis <strong>bg</strong>.</p>
<p>Lors du <strong>Ctrl+z</strong> la commande <strong>fg</strong> ramène le processus au premier plan.</p>
<p>La commande <strong>jobs</strong> permet de lister les processus suspendus, on peut alors les rattacher avec <strong>fg num_job</strong>.</p>
<p>Les processus dont le père meure sans attendre le statut de ses enfants sont raccrochés à <em>init</em>.</p>
</div>
<div class="section" id="modification-des-priorites">
<h2><a class="toc-backref" href="#id129">9.8&nbsp;&nbsp;&nbsp;Modification des priorités</a></h2>
<p>Les processus ont des priorités fixées entre -20 (la plus haute) et +19.</p>
<p>Le <em>scheduler</em> gère l'ordre d'exécution des processus en fonction de cette priorité.</p>
<p>Par défaut un processus est lancé avec la priorité +10.</p>
<p>Seul l'administrateur peut donner des priorités négatives aux processus.</p>
<p>La commande <strong>nice [COMMAND [ARG]]</strong> permet de lancer une commande en lui donnant la priorité <em>p</em> si l'on passe l'option <em>-n p</em>.</p>
<p>La commande <strong>renice</strong>  permet de modifier la priorité d'un processus.</p>
</div>
</div>
<div class="section" id="planification-de-taches">
<h1><a class="toc-backref" href="#id130">10&nbsp;&nbsp;&nbsp;Planification de tâches</a></h1>
<p>Sous unix deux démons sont chargés de la planification des tâches : <strong>atd</strong> qui permet de programmer une tâche différée et <strong>crond</strong> qui permet de programmer les tâches répétitives.</p>
<div class="section" id="la-commande-crontab">
<h2><a class="toc-backref" href="#id131">10.1&nbsp;&nbsp;&nbsp;La commande crontab</a></h2>
<p><strong>crond</strong> est un service qui peut être programmé grace à la commande <strong>crontab</strong>.</p>
<p><strong>crontab -l</strong> liste les commandes déjà programmées pour l'utilisateur courant.</p>
<p><strong>crontab -e</strong> permet d'éditer le fichier des commandes programmées pour l'utilisateur courant.</p>
<p>L'éditeur utilisé par <strong>crontab -e</strong> est celui désigné par la variable <em>EDITOR</em>.</p>
</div>
<div class="section" id="le-fichier-crontab-systeme">
<h2><a class="toc-backref" href="#id132">10.2&nbsp;&nbsp;&nbsp;Le fichier crontab système</a></h2>
<p>Ils est possible d'éditer directement le fichier /etc/crontab ou ceux contenu dans /var/spool/cron/crontabs/${USER}</p>
<p>Le format du fichier est le même que lors de l'édition avec <em>crontab -e</em>:</p>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="11%" />
<col width="19%" />
<col width="11%" />
<col width="28%" />
<col width="15%" />
</colgroup>
<tbody valign="top">
<tr><td>Minutes</td>
<td>Heures</td>
<td>Jour du mois</td>
<td>Mois</td>
<td>Jour de la semaine</td>
<td>Commande</td>
</tr>
<tr><td>(0-60)</td>
<td>(0-24)</td>
<td>(0-31)</td>
<td>(1-12)</td>
<td>(0-6)</td>
<td>un script</td>
</tr>
</tbody>
</table>
<p>Le joker <strong>*</strong> permet d'indiquer que toutes les valeurs sont acceptées.</p>
<p>Pour les fichiers <em>cron</em> du système, une colonne <em>Utilisateur</em> s'intercale juste avant celle de la <em>commande</em>. Elle permet alors d'indiquer sous quel utilisateur doit être lancée la commande.</p>
<p>Exemple :</p>
<pre class="literal-block">
root&#64;serveur:~# crontab -l
# m h  dom mon dow   command
00 4 * * * /usr/bin/webalizer -c /etc/webalizer/www_ecreall.conf
10 4 * * * /usr/bin/webalizer -c /etc/webalizer/ssl_ecreall.conf
* * * * * /root/load.sh update
0 * * * * /root/load.sh graph &gt; /dev/null

root&#64;serveur:~# cat /etc/crontab
# /etc/crontab: system-wide crontab
# Unlike any other crontab you don't have to run the `crontab'
# command to install the new version when you edit this file
# and files in /etc/cron.d. These files also have username fields,
# that none of the other crontabs do.

SHELL=/bin/sh
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin

# m h dom mon dow user        command
17 *  * * *   root    cd / &amp;&amp; run-parts --report /etc/cron.hourly
25 6  * * *   root    test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.daily )
47 6  * * 7   root    test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.weekly )
52 6  1 * *   root    test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.monthly )
#
</pre>
<p>Sur la plupart des distributions <em>/etc/crontab</em> lance les scripts contenus dans <em>/etc/cron.hourly</em>, <em>/etc/cron.daily</em>, <em>/etc/cron.weekly</em>, <em>/etc/cron.monthly</em>. Pour ajouter une tâche il suffit d'ajouter un script au répertoire désiré.</p>
<p>Les fichiers <em>/etc/cron.allow</em> et <em>/etc/cron.deny</em> permettent s'ils existent de nommer les utilisateurs pouvant programmer des tâches.</p>
</div>
<div class="section" id="la-commande-at">
<h2><a class="toc-backref" href="#id133">10.3&nbsp;&nbsp;&nbsp;La commande at</a></h2>
<p><strong>at</strong> permet de lancer une commande à une heure donnée, la commande utilise le démon <strong>atd</strong></p>
<p><strong>atq</strong> permet de voir la liste des commandes en attente d'exécution.</p>
<p><strong>atrm</strong> Permet de supprimer une commande programmée.</p>
<p>Exemple :</p>
<pre class="literal-block">
root&#64;server:~# apt-get install mailutils # Pour avoir la commande mail
root&#64;server:~# at 6:45; mail -s &quot;Debout&quot; michaellaunay&#64;ecreall.com &lt; reveil.msg
</pre>
<p>Les fichiers <em>/etc/at.allow</em> et <em>at.deny</em> permettent comme pour cron de lister les utilisateurs pouvant ou non lancer <strong>at</strong>.</p>
</div>
</div>
<div class="section" id="les-utilisateurs-et-les-groupes">
<h1><a class="toc-backref" href="#id134">11&nbsp;&nbsp;&nbsp;Les utilisateurs et les groupes</a></h1>
<p>Unix est un système multi-utilisateurs.</p>
<p>Tout fichier est associé à un propriétaire et à un groupe.</p>
<p>La gestion des droits dépend des notions d'utilisateur, de propriétaire, de groupe, et des autres.</p>
<p>Ceci suppose :</p>
<blockquote>
<ul class="simple">
<li>l'existence d'une base des comptes utilisateurs,</li>
<li>l'existence d'une base des groupes d'utilisateurs,</li>
<li>que tout fichier possède un utilisateur propriétaire et un groupe propriétaire,</li>
<li>que tout processus hérite des droits de l'utilisateur l'ayant lancé et par conséquent de l'ensemble des droits des groupes de l'utilisateur,</li>
<li>que l'utilisateur <em>root</em> a tous les droits pour pouvoir gérer le système.</li>
</ul>
</blockquote>
<div class="section" id="qu-est-qu-un-utilisateur">
<h2><a class="toc-backref" href="#id135">11.1&nbsp;&nbsp;&nbsp;Qu'est qu'un utilisateur ?</a></h2>
<p>Chaque utilisateur d'un système Unix est associé à un identifiant unique qui lui permet de s'authentifier et d'accéder à son compte.</p>
<p>Ainsi au <em>login</em> le système demande à l'utilisateur son mot de passe.</p>
<p>Lorsque la connexion réussit le système associe à l'utilisateur l'<strong>UID</strong> (<strong>User IDentification</strong>) correspondant à son identifiant.</p>
<p>Le système associe également à l'utilisateur un <strong>GID</strong> (<strong>Groupe IDentification</strong>) qui est le groupe principal de l'utilisateur.</p>
<p>Ces numéros seront utilisés pour gérer les permissions des fichiers. Les commandes comme <em>ls</em> feront alors la correspondance entre les numéros et les noms d'utilisateurs et de groupes.</p>
<p>Un <strong>UID</strong> est associé à un répertoire personnel et à un shell.</p>
<p>L'UID 0 désigne l'utilisateur <strong>root</strong></p>
<p>Un utilisateur peut ne pas être une personne physique mais être l'utilisateur d'exécution d'un démon.</p>
<p>En conséquence, les <strong>UID</strong> des personnes physiques commencent généralement à partir de 1000.</p>
</div>
<div class="section" id="qu-est-qu-un-groupe">
<h2><a class="toc-backref" href="#id136">11.2&nbsp;&nbsp;&nbsp;Qu'est qu'un groupe ?</a></h2>
<p>Les groupes permettent de créer des ensembles d'utilisateurs afin de gérer collectivement les permissions.</p>
<p>Généralement la création d'un utilisateur engendre la création de son groupe principal ayant pour identifiant de groupe le même identifiant et pour <strong>GID</strong> la même valeur que l'<strong>UID</strong>.</p>
</div>
<div class="section" id="gestion-des-comptes">
<h2><a class="toc-backref" href="#id137">11.3&nbsp;&nbsp;&nbsp;Gestion des comptes</a></h2>
<div class="section" id="ajouter-un-utilisateur">
<h3><a class="toc-backref" href="#id138">11.3.1&nbsp;&nbsp;&nbsp;Ajouter un utilisateur</a></h3>
<p>La création d'un nouvel utilisateur peut être faite à l'aide des commandes <strong>useradd</strong> ou <strong>adduser</strong> la seconde étant préférable, car interactive.</p>
</div>
<div class="section" id="supprimer-un-utilisateur">
<h3><a class="toc-backref" href="#id139">11.3.2&nbsp;&nbsp;&nbsp;Supprimer un utilisateur</a></h3>
<p>La commande <strong>userdel</strong> permet de supprimer un utilisateur.</p>
<p>Avec l'option <em>-r</em> cette commande supprimera en plus le répertoire personnel de l'utilisateur.</p>
</div>
<div class="section" id="desactiver-un-compte-utilisateur">
<h3><a class="toc-backref" href="#id140">11.3.3&nbsp;&nbsp;&nbsp;Désactiver un compte utilisateur</a></h3>
<p>L'une des façons les plus propres d'interdire la connexion à un utilisateur est de lui associer le shell <strong>nologin</strong> :</p>
<pre class="literal-block">
root&#64;server:~# usermod -s /usr/sbin/nologin indesirable
</pre>
</div>
<div class="section" id="changer-le-mot-de-passe-d-un-utilisateur">
<h3><a class="toc-backref" href="#id141">11.3.4&nbsp;&nbsp;&nbsp;Changer le mot de passe d'un utilisateur</a></h3>
<p>La commande <strong>passwd</strong> permet sous <em>root</em> de changer le mot de passe d'un utilisateur.</p>
<p>Si l'on est un utilisateur la commande demandera de saisir l'ancien mot de passe.</p>
<p>La commande <strong>chpasswd</strong> permet de scripter les changements de mots de passe.</p>
</div>
<div class="section" id="afficher-des-informations-d-un-utilisateur">
<h3><a class="toc-backref" href="#id142">11.3.5&nbsp;&nbsp;&nbsp;Afficher des informations d'un utilisateur</a></h3>
<p>La commande <strong>id</strong> permet d'afficher les informations de l'utilisateur :</p>
<pre class="literal-block">
michaellaunay&#64;serveur:~$ id
uid=1000(michaellaunay) gid=1000(michaellaunay) groupes=4(adm),20(dialout),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),107(fuse),111(lpadmin),112(admin),1000(michaellaunay)
</pre>
<p>La commande <strong>groups</strong> permet d'afficher les informations de groupe :</p>
<pre class="literal-block">
michaellaunay&#64;luciole:~/Documents/ecreall/Cours/CoursGNULinux$ groups
michaellaunay adm dialout cdrom plugdev lpadmin admin sambashare
</pre>
<p>La commande <strong>who</strong> permet de savoir qui est connecté sur la machine.</p>
<p>La commande <strong>whoami</strong> permet de savoir sous quelle identité on est connecté.</p>
</div>
<div class="section" id="modifier-les-informations-d-un-utilisateur">
<h3><a class="toc-backref" href="#id143">11.3.6&nbsp;&nbsp;&nbsp;Modifier les informations d'un utilisateur</a></h3>
<p>La commande <strong>usermod</strong> permet de modifier toutes les propriétés d'un utilisateur.</p>
<p>Faire <em>man usermod</em></p>
<p>La commande <strong>chsh</strong> permet de changer le shell de connexion.</p>
<p>La commande <strong>chfn</strong> permet de changer la description d'un utilisateur.</p>
</div>
<div class="section" id="changer-d-identite">
<h3><a class="toc-backref" href="#id144">11.3.7&nbsp;&nbsp;&nbsp;Changer d'identité</a></h3>
<p>La commande <strong>su</strong> permet de changer d'identité. <strong>su -</strong> permettra en plus d'utiliser l'environnement de l'utilisateur.</p>
<p>La commande <strong>sudo</strong> permet d'exécuter un script ou une commande en tant que <em>root</em>. <strong>sudo -i</strong> permet sous <em>Ubuntu</em> de se connecter en tant que <em>root</em>.</p>
</div>
</div>
<div class="section" id="gestion-des-groupes">
<h2><a class="toc-backref" href="#id145">11.4&nbsp;&nbsp;&nbsp;Gestion des groupes</a></h2>
<div class="section" id="creer-un-groupe">
<h3><a class="toc-backref" href="#id146">11.4.1&nbsp;&nbsp;&nbsp;Créer un groupe</a></h3>
<p>Comme pour l'utilisateur nous pouvons utiliser <strong>addgroup</strong> ou <strong>groupadd</strong></p>
</div>
<div class="section" id="afficher-des-informations-sur-les-groupes">
<h3><a class="toc-backref" href="#id147">11.4.2&nbsp;&nbsp;&nbsp;Afficher des informations sur les groupes</a></h3>
<p>La commande <strong>groups</strong> déjà vu affiche les informations d'appartenance.</p>
</div>
<div class="section" id="ajouter-un-utilisateur-a-un-groupe">
<h3><a class="toc-backref" href="#id148">11.4.3&nbsp;&nbsp;&nbsp;Ajouter un utilisateur à un groupe</a></h3>
<p>On utilise la commande <strong>usermod</strong> de la façon suivante :</p>
<pre class="literal-block">
root&#64;server~# usermod -a -G cdrom,dev michaellaunay
</pre>
</div>
<div class="section" id="changer-de-groupe-principal">
<h3><a class="toc-backref" href="#id149">11.4.4&nbsp;&nbsp;&nbsp;Changer de groupe principal</a></h3>
<p>La commande <strong>newgrp</strong> permet de changer de groupe principal.</p>
</div>
<div class="section" id="modifier-un-groupe">
<h3><a class="toc-backref" href="#id150">11.4.5&nbsp;&nbsp;&nbsp;Modifier un groupe</a></h3>
<p>Pour modifier un groupe nous pouvons utiliser la commande <strong>groupmod</strong>.</p>
</div>
<div class="section" id="supprimer-un-groupe">
<h3><a class="toc-backref" href="#id151">11.4.6&nbsp;&nbsp;&nbsp;Supprimer un groupe</a></h3>
<p>La commande <strong>groupdel</strong> permet de supprimer un groupe.</p>
</div>
</div>
<div class="section" id="le-fichier-etc-passwd">
<h2><a class="toc-backref" href="#id152">11.5&nbsp;&nbsp;&nbsp;Le fichier /etc/passwd</a></h2>
<p>Le fichier <em>/etc/passwd</em> contient la définition de tous les comptes.</p>
</div>
<div class="section" id="le-fichier-etc-shadow">
<h2><a class="toc-backref" href="#id153">11.6&nbsp;&nbsp;&nbsp;Le fichier /etc/shadow</a></h2>
<p>Le fichier <em>/etc/shadow</em> contient les mots de passe des comptes définis dans <em>/etc/passwd</em></p>
</div>
<div class="section" id="le-fichier-etc-group">
<h2><a class="toc-backref" href="#id154">11.7&nbsp;&nbsp;&nbsp;Le fichier /etc/group</a></h2>
<p>Le fichier <em>/etc/group</em> contient la définition de tous les groupes.</p>
</div>
<div class="section" id="installation-openldap">
<h2><a class="toc-backref" href="#id155">11.8&nbsp;&nbsp;&nbsp;Installation openldap</a></h2>
<p>Ldap est un annuaire qui permet de gérer le utilisateur d'un service sans créer un compte unix.</p>
<p>Installation du serveur ldap :</p>
<blockquote>
apt install slapd ldap-utils</blockquote>
<p>Modification de la configuration :</p>
<blockquote>
dpkg-reconfigure slapd
# saisie de &quot;ecreall.com&quot; comme domaine
# saisie de &quot;people&quot; comme organization
# saisie du mot de passe (comme celui de l'utilisateur michaellaunay mais pour LDAP)</blockquote>
<p>Attention ! Configurer LTS pour chiffrer les connexions si elles sont extérieures à la machine, car les mots de passe circulent en clair (voir  <a class="reference external" href="https://wiki.debian.org/LDAP/OpenLDAPSetup#Enable_TLS.2FSSL">https://wiki.debian.org/LDAP/OpenLDAPSetup#Enable_TLS.2FSSL</a>)!</p>
<p>Activer le service au démarrage :</p>
<blockquote>
systemctl enable slapd</blockquote>
<p>Rendre &quot;ldap&quot; accessible en éditant &quot;/etc/ldap/ldap.conf&quot; en ajoutant :</p>
<blockquote>
BASE    dc=ecreall,dc=com
URI     <a class="reference external" href="ldap://127.0.0.1">ldap://127.0.0.1</a></blockquote>
<p>Ajout d'une entrée LDAP :</p>
<blockquote>
<p>Créer un fichier ecreall.ldif contenant :</p>
<blockquote>
<p>dn: ou=People,dc=ecreall,dc=com
ou: People
objectClass: top
objectClass: organizationalUnit</p>
<p>dn: ou=Group,dc=ecreall,dc=com
ou: Group
objectClass: top
objectClass: organizationalUnit</p>
<p>dn: cn=Gérant,dc=ecreall,dc=com
objectclass: organizationalRole
cn: Gérant</p>
</blockquote>
<p>ldapadd -x -D &quot;cn=admin,dc=ecreall,dc=com&quot; -W -f ecreall.ldif</p>
</blockquote>
<p>Mettre à jour l'index (cache) :</p>
<blockquote>
systemctl stop slapd
slapindex
chown -R openldap:openldap /var/lib/ldap
systemctl start slapd</blockquote>
<p>Vérification :</p>
<blockquote>
ldapsearch -x -b 'dc=ecreall,dc=com' '(objectclass=*)'</blockquote>
<p>Ajout d'une OrganizationUnit :</p>
<blockquote>
<p>Créer un fichier &quot;e-services.ldif&quot; et y mettre :</p>
<blockquote>
dn: ou=Études,dc=ereall,dc=com
objectClass: organizationalUnit
ou: Études</blockquote>
<p>ldapadd -x -D &quot;cn=admin,dc=ecreall,dc=com&quot; -W -f e-services.ldif</p>
</blockquote>
<p>Ajouter une personne :</p>
<blockquote>
<p>Exemple pour ajouter Michaël Launay, créer un fichier &quot;ldif_files/michaellaunay.ldif&quot; :</p>
<blockquote>
dn: cn=Michaël Launay, ou=People, dc=ecreall, dc=com
objectclass: top
objectclass: person
objectclass: organizationalPerson
objectclass: inetorgperson
cn: Michaël Launay
sn: Launay
gn: Michaël
uid: michaellaunay
title: Gérant
mail: <a class="reference external" href="mailto:michaellaunay&#64;ecreall.com">michaellaunay&#64;ecreall.com</a>
telephoneNumber: 0320793290
officePostalAddress: 11 A Avenue de l'Harmonie
postalCode: 59650
l: Villeneuve d ASCQ</blockquote>
<p>L'ajouter :</p>
<blockquote>
ldapadd -x -D &quot;cn=admin,dc=ecreall,dc=com&quot; -W -f ldif_files/michaellaunay.ldif</blockquote>
</blockquote>
<p>Voir :</p>
<blockquote>
<a class="reference external" href="https://wiki.debian.org/LDAP/OpenLDAPSetup">https://wiki.debian.org/LDAP/OpenLDAPSetup</a>
<a class="reference external" href="https://guide.ubuntu-fr.org/server/openldap-server.html">https://guide.ubuntu-fr.org/server/openldap-server.html</a>
<a class="reference external" href="http://www-sop.inria.fr/members/Laurent.Mirtain/ldap-livre.html">http://www-sop.inria.fr/members/Laurent.Mirtain/ldap-livre.html</a></blockquote>
</div>
</div>
<div class="section" id="syslog">
<h1><a class="toc-backref" href="#id156">12&nbsp;&nbsp;&nbsp;Syslog</a></h1>
<p><strong>Syslog</strong> est le système chargé d'enregistrer les fichiers journaux.</p>
<p>Le démon <strong>klogd</strong> consigne les événements de type message du noyau, authentification, connexion alors que <strong>syslogd</strong> enregistre les message d'envoi ou réception de courrier, ceux d'erreur, etc.</p>
<p>Les fichiers de messages se trouvent dans <em>/var/log</em></p>
<p><strong>syslogd</strong> est configuré avec le fichier <em>/etc/syslog.conf</em>. Ce fichier permet d'indiquer les sources de messages et les destinations associées (fichier, tty, application ou syslog d'une autre machine). Pour être prise en compte, la modification du fichier de conf doit être suivie par un <em>kill 1 $PID_SYSLOG</em>.</p>
<p>Toutefois de nombreux programmes n'utilisent pas <em>syslog</em> comme <em>CUPS</em>, <em>Samba</em>, etc.</p>
<p>Afin d'éviter que la taille des fichiers de logs n'explose la capacité du disque les fichiers sont compressés de façon régulière par <strong>logrotate</strong> dont la configuration est modifiable en éditant <strong>/etc/logrotate</strong></p>
<p>La commande <strong>dmesg</strong> permet d'afficher les messages du noyau.</p>
<div class="section" id="modification-de-la-configuration-de-logrotate">
<h2><a class="toc-backref" href="#id157">12.1&nbsp;&nbsp;&nbsp;Modification de la configuration de logrotate</a></h2>
<p>Logrotate possède une configuration par défaut contenue dans &quot;/etc/logrotate.conf&quot; puis un répertoire avec les configurations des services pour compléter ou remplacer la configuration par défaut.</p>
<p>Il est fréquent que pour des raisons légales, on doive garder un ou deux ans de logs selon la nature des utilisateurs et des services.
Souvant on garde 104 semaines de connexions et 52 semaines de navigation et 14 semaines pour les autres services.</p>
<p>Pour modifier la conf par défaut à 14 semaines on édite &quot;/etc/logrotate.conf&quot; :</p>
<pre class="literal-block">
- Remplacer &quot;rotate 4&quot; par &quot;rotate 14&quot; pour garder 3 mois de log par défaut
- Décommenter &quot;compress&quot; pour compresser les anciens fichiers log
- Ajouter delaycompress chaque vieux fichier de log
- Limiter la taille d'un fichier de log à 100M
</pre>
<p>On doit donc avoir dans /etc/logrotate.conf :</p>
<blockquote>
rotate 14
compress
delaycompress
size 100M</blockquote>
<p>Puis on change &quot;rotate X&quot; à &quot;rotate 104&quot; dans les fichier des services concernés se trouvant dans le répertoire &quot;/etc/logrotate.d/&quot;.
Par exemple, on va modifier &quot;/etc/logrotate.d/apache2&quot; pour mettre rotate à 104, et modifier le fichier &quot;/etc/logrotate.d/rsyslog&quot; modifier les logs des services d'authentifications.</p>
</div>
</div>
<div class="section" id="peripherique-disque-et-systeme-de-fichiers">
<h1><a class="toc-backref" href="#id158">13&nbsp;&nbsp;&nbsp;Périphérique disque et système de fichiers</a></h1>
<div class="section" id="les-disques-durs-sous-linux">
<h2><a class="toc-backref" href="#id159">13.1&nbsp;&nbsp;&nbsp;Les disques durs sous Linux</a></h2>
<p>L'organisation physique d'un disque est constituée de plateaux superposés divisés en pistes concentriques.</p>
<p>Chaque piste contenant un certain nombre de secteurs de 512 octets.</p>
<p>L'ensemble des pistes des différents plateaux accessible sans nouveau déplacement des têtes de lecture constitue un cylindre.</p>
<p>Voire <a class="reference external" href="http://fr.wikipedia.org/wiki/Disque_dur">http://fr.wikipedia.org/wiki/Disque_dur</a>.</p>
<p>Le nommage des périphériques disques dépend de leur nature et de la façon dont ils sont gérés par le bios.</p>
<p>Ainsi sda, sdb correspondent à des disques durs alors que nvme0n1p7 correspond à un disque ssd monté sur le connecteur nvme.</p>
<p>Depuis 2013 les nommages des périphériques suivent les règles <em>ifname</em> voir :  <a class="reference external" href="https://access.redhat.com/documentation/fr-fr/red_hat_enterprise_linux/7/html/networking_guide/sec-understanding_the_device_renaming_procedure">https://access.redhat.com/documentation/fr-fr/red_hat_enterprise_linux/7/html/networking_guide/sec-understanding_the_device_renaming_procedure</a></p>
</div>
<div class="section" id="les-concepts">
<h2><a class="toc-backref" href="#id160">13.2&nbsp;&nbsp;&nbsp;Les concepts</a></h2>
<p>Un disque est &quot;découpé&quot; en partitions.</p>
<p>Le premier secteur contient le MBR (Master Boot Record) qui décrit la table des 4 premières partitions et contient également le code du chargeur primaire (primary loader).</p>
<p>L'une des quatre partitions primaires peut être du type étendue et contenir des partitions logiques qui sont alors chaînées entre elles.</p>
<p>La taille des partitions est donnée en nombre de cylindres, ce qui fixe le nombre de secteurs de la partition.</p>
<p>La partition possède un type qui fixe son usage, par exemple 83 pour Linux, 82 pour le swap, 5 pour une partition étendue, etc.</p>
</div>
<div class="section" id="les-systemes-de-fichiers">
<h2><a class="toc-backref" href="#id161">13.3&nbsp;&nbsp;&nbsp;Les systèmes de fichiers</a></h2>
<p>Un système de fichier est une structure de données permettant de stocker et organiser les informations dans des fichiers.</p>
<p>Le système de fichier est généralement stocké dans une partition mais il peut l'être sur un disque amovible (USB) ou dans un fichier.</p>
</div>
<div class="section" id="partitions">
<h2><a class="toc-backref" href="#id162">13.4&nbsp;&nbsp;&nbsp;Partitions</a></h2>
<p>La numérotation des partitions est réalisée en accolant au nom du périphérique le numéro de la partition. Ainsi :</p>
<pre class="literal-block">
sda est le premier disque complet
sda1 est la première partition
sda4 est généralement la partition étendue
sda5 est la première partition logique
sdb est le second disque
</pre>
</div>
<div class="section" id="utilitaires-de-partitionnement">
<h2><a class="toc-backref" href="#id163">13.5&nbsp;&nbsp;&nbsp;Utilitaires de partitionnement</a></h2>
<p>Historiquement la commande permettant de créer les partitions était <strong>fdisk</strong>, mais elle est limité à des partitions de taille inférieure à 2To.</p>
<p>Elle est remplacée par la commande <strong>parted</strong> et par sa version graphique <strong>gparted</strong> qui permettent de créer et retailler des partitions déjà existantes, mais il faut descendre le paquet.</p>
<p>La commande <strong>partprobe</strong> permet d'avertir le système que l'on a modifié la tables des partitions.</p>
</div>
<div class="section" id="arborescence-standard-et-organisation-du-fhs">
<h2><a class="toc-backref" href="#id164">13.6&nbsp;&nbsp;&nbsp;Arborescence standard et organisation du FHS</a></h2>
<p>Le Filesystem Hierachy Standard est l'organisation standard Unix utilisée par Linux</p>
<p>Tout est fichier. Les périphériques (scanner, imprimante, etc) sont manipulés sous forme de fichier dans lequel on va lire et écrire.</p>
<div class="section" id="arborescence-de">
<h3><a class="toc-backref" href="#id165">13.6.1&nbsp;&nbsp;&nbsp;Arborescence de /</a></h3>
<p>/ est la racine, elle a pour contenu :</p>
<blockquote>
<ul class="simple">
<li>/bin contient les exécutables du système d'exploitation,</li>
<li>/boot les fichiers de démarrage,</li>
<li>/dev les périphériques sous forme de fichiers pouvant être lus ou écrits,</li>
<li>/etc les fichier de configuration et ceux nécessaires au démarrage,</li>
<li>/home les répertoires des utilisateurs,</li>
<li>/lib le bibliothèques partagées et les modules du noyau dans le sous répertoire modules,</li>
<li>/mnt les dossier des points de montage temporaires,</li>
<li>/proc les états du noyau,</li>
<li>/root le répertoire du super utilisateur root,</li>
<li>/sbin les exécutables du super utilisateur,</li>
<li>/sys contient les caractéristiques et informations sur les périfériques comme le nom du fabriquant, les bus connectés,</li>
<li>/tmp les fichiers temporaires liés à l'exécution des applications ou services, ils sont effacés au reboot,</li>
<li>/usr les ressources du système non essentielles (Unix Système Ressources)</li>
<li>/var les fichiers tels que les based de données, les pages html, les mails, les logs</li>
</ul>
</blockquote>
<ul class="simple">
<li>Pour une description plus complète C.f. <a class="reference external" href="http://en.wikipedia.org/wiki/Filesystem_Hierarchy_Standard">http://en.wikipedia.org/wiki/Filesystem_Hierarchy_Standard</a></li>
</ul>
</div>
<div class="section" id="arborescence-de-usr">
<h3><a class="toc-backref" href="#id166">13.6.2&nbsp;&nbsp;&nbsp;Arborescence de /usr</a></h3>
<p>/usr contient :</p>
<blockquote>
<ul class="simple">
<li>/usr/bin/ Binaires de l'utilisateur,</li>
<li>/usr/include/ Entêtes des bibliothèques partagées,</li>
<li>/usr/lib/ Bibliothèques partagées des logiciels utilisateurs,</li>
<li>/usr/local/ Hiérarchie pour les données de locales.</li>
<li>/usr/sbin/ Binaires pour l'administrateur,</li>
<li>/usr/share/ Fichiers indépendants de la plateforme (non binaires),</li>
<li>/usr/src/ Les sources du noyau,</li>
</ul>
</blockquote>
</div>
<div class="section" id="arborescence-de-var">
<h3><a class="toc-backref" href="#id167">13.6.3&nbsp;&nbsp;&nbsp;Arborescence de /var</a></h3>
<p>/var contient:</p>
<blockquote>
<ul class="simple">
<li>/var/lib/ Données persistantes telles les bases de données,</li>
<li>/var/lock Les fichiers de verrous,</li>
<li>/var/log Les fichiers de Log</li>
<li>/var/mail Les mails si la configurations précise qu'ils doivent être stockés ici</li>
<li>/var/run Les informations d'exécution des daemons</li>
<li>/var/spool Les queues de traitement (mail, impression, etc)</li>
<li>/var/tmp Les fichiers temporaires à préserver des reboots</li>
</ul>
</blockquote>
</div>
</div>
<div class="section" id="formater-une-partition">
<h2><a class="toc-backref" href="#id168">13.7&nbsp;&nbsp;&nbsp;Formater une partition</a></h2>
<p>La commande <strong>mkfs</strong> permet de formater une partition. Le type système de fichier est alors choisi à ce moment ex: <strong>mkfs.ext3</strong>.</p>
</div>
<div class="section" id="monter-demonter-une-partition">
<h2><a class="toc-backref" href="#id169">13.8&nbsp;&nbsp;&nbsp;Monter / Démonter une partition</a></h2>
<p>Un système de fichier est accessible après son <em>montage</em> soit au démarrage, soit à l'aide de la commande <strong>mount</strong>.</p>
<p>Le démontage se fait à l'aide de la commande <strong>umount</strong>.</p>
<p>La commande <strong>sshfs</strong> permet de monter un disque distant à travers le protocole <strong>ssh</strong>.
Pour démonter un système de fichier monté avec sshfs : <strong>fusermount -u point_de_montage</strong>.</p>
</div>
<div class="section" id="les-tables-de-montage-etc-fstab">
<h2><a class="toc-backref" href="#id170">13.9&nbsp;&nbsp;&nbsp;Les tables de montage : /etc/fstab</a></h2>
<p>Le fichier <strong>/etc/fstab</strong> contient les montages à réaliser au démarrage ou pour lesquels <em>root</em> a autorisé un montage manuel.</p>
</div>
<div class="section" id="tables-systemes-inodes">
<h2><a class="toc-backref" href="#id171">13.10&nbsp;&nbsp;&nbsp;Tables systèmes, inodes</a></h2>
<p>Un file system est composé de différentes tables systèmes :</p>
<blockquote>
<ul class="simple">
<li>Le super-bloc contenant les informations de taille, d'état de montage.</li>
<li>La table des <em>inodes</em> (nœud d'index) qui fait correspondre à chaque fichier un numéro d'identification unique et qui possède les informations des droits d'accès, de propriété.</li>
<li>Les répertoires qui sont une table de correspondance <em>inode</em> vers nom de fichier.</li>
</ul>
</blockquote>
<p>La commande <strong>ls -i</strong> permet d'afficher l'inode d'un fichier.</p>
<p>Remarques :</p>
<blockquote>
<ul class="simple">
<li>Les <em>inodes</em> ne contiennent pas le nom du fichier.</li>
<li>Un <em>file system</em> est limité en <em>inodes</em></li>
</ul>
</blockquote>
</div>
<div class="section" id="journalisation">
<h2><a class="toc-backref" href="#id172">13.11&nbsp;&nbsp;&nbsp;Journalisation</a></h2>
<p>La journalisation permet d'enregistrer les manipulations réalisées sur les fichiers et l'arborescence.</p>
<p>Pour certain système de fichier elle enregistre en plus les différences, ce qui permet de revenir à un état précédent.</p>
<p>Les système simples permettent néanmoins de revenir au dernier état cohérent en cas de plantage du système.</p>
<p>Toutefois, les coupures de courant peuvent aboutir à des états incohérents, ceci à cause du cache en écriture des disques durs.</p>
<p>Au redémarrage de la machine la journalisation va permettre d'accélérer le diagnostique des disques.</p>
<p><strong>ext3</strong> est un système journalisé de manière simple.</p>
</div>
<div class="section" id="controle-des-systemes-de-fichiers">
<h2><a class="toc-backref" href="#id173">13.12&nbsp;&nbsp;&nbsp;Contrôle des systèmes de fichiers</a></h2>
<p>La commande <strong>df</strong> permet de lister les montages réalisés.</p>
<p>La commande <strong>du</strong> permet de calculer la taille d'une arborescence.</p>
<p>La commande <strong>fsck</strong> permet de vérifier l'état d'une partition.
ATTENTION ! Il ne faut pas l'utiliser sur des partitions montées.</p>
<p>La commande <strong>e2label</strong> permet d'affecter un nom à un <em>file system</em>.</p>
<p>La commande <strong>hdparm</strong> permet avec l'option <em>-t</em> de connaître les performances d'un disque.</p>
</div>
<div class="section" id="montage-des-peripheriques-amovibles">
<h2><a class="toc-backref" href="#id174">13.13&nbsp;&nbsp;&nbsp;Montage des périphériques amovibles</a></h2>
<p>La commande <strong>lsusb</strong> permet de voir les périphériques USB connectés.</p>
<p>La commade <strong>lspci</strong> permet de voir les périphériques PCI connectés.</p>
<p>Lorsqu'un périphérique de type blocs ou caractères est détecté par le noyau, un périphérique correspondant est ajouté dans <em>/dev</em> par le démon <strong>udevd</strong> du système <strong>udev</strong>.</p>
<p>Le système <strong>udev</strong> a pour rôle de gérer l'unicité des noms pour les prériphériques et de maintenir <em>/dev</em> en cohérence avec les périphériques présents.</p>
<p>Les fichiers de configuration de <strong>udev</strong> sont placés dans <em>/etc/udev</em>. Il est possible de définir des règles dans <em>/etc/udev/rules.d</em> qui seront évaluées dans l'ordre lexicographique.</p>
<p>Le démon HAL (Hardware Abstraction Layer) <strong>hald</strong> est notifié par <strong>udev</strong> de l'ajout d'un périphérique (règle <em>/etc/udev/rules.d/90-hal.rules</em>).</p>
<p><strong>HAL</strong> identifie alors le type des périphériques connectés, du système de fichers, et en fonction des informations comme <em>VendorId</em> ou <em>ProductId</em> d'associer le contenu avec un type d'application.</p>
<p>La base de données des périphériques est située dans le répertoire <em>/usr/share/hal/fdi/</em> :</p>
<pre class="literal-block">
michaellaunay&#64;luciole:~$ grep -rl ipod /usr/share/hal/fdi/*
/usr/share/hal/fdi/information/10freedesktop/10-usb-music-players.fdi
</pre>
<p>Une fois le périphérique complètement identifié, <strong>HAL</strong> envoie un message sur le bus de communication des applications <strong>D-Bus</strong>.</p>
<p>Les applications de l'environnement graphique vont alors monter le périphérique et le rendre accessible à l'utilisateur.</p>
<p>Sous <strong>gnome</strong> le comportement peut être modifié via le gestionnaire de fichiers <strong>nautilus</strong> dans Edition-Préférences-Supports**.</p>
<p>Exemple des noms persistants donnés par udev:</p>
<pre class="literal-block">
michaellaunay&#64;luciole:~$ ls -lR /dev/disk
/dev/disk:
total 0
drwxr-xr-x 2 root root 260 avril 18 22:11 by-id
drwxr-xr-x 2 root root  80 avril 18 22:11 by-partlabel
drwxr-xr-x 2 root root 100 avril 18 22:11 by-partuuid
drwxr-xr-x 2 root root 160 avril 18 22:11 by-path
drwxr-xr-x 2 root root 100 avril 18 22:11 by-uuid

/dev/disk/by-id:
total 0
lrwxrwxrwx 1 root root  9 avril 18 22:11 ata-ST8000VN0022-2EL112_ZA1F9KQR -&gt; ../../sda
lrwxrwxrwx 1 root root 10 avril 18 22:11 ata-ST8000VN0022-2EL112_ZA1F9KQR-part1 -&gt; ../../sda1
lrwxrwxrwx 1 root root 13 avril 18 22:11 nvme-eui.0025385491b00f2f -&gt; ../../nvme0n1
lrwxrwxrwx 1 root root 15 avril 18 22:11 nvme-eui.0025385491b00f2f-part1 -&gt; ../../nvme0n1p1
lrwxrwxrwx 1 root root 15 avril 18 22:11 nvme-eui.0025385491b00f2f-part2 -&gt; ../../nvme0n1p2
lrwxrwxrwx 1 root root 13 avril 18 22:11 nvme-Samsung_SSD_970_EVO_Plus_1TB_S4EWNF0M403887L -&gt; ../../nvme0n1
lrwxrwxrwx 1 root root 15 avril 18 22:11 nvme-Samsung_SSD_970_EVO_Plus_1TB_S4EWNF0M403887L-part1 -&gt; ../../nvme0n1p1
lrwxrwxrwx 1 root root 15 avril 18 22:11 nvme-Samsung_SSD_970_EVO_Plus_1TB_S4EWNF0M403887L-part2 -&gt; ../../nvme0n1p2
lrwxrwxrwx 1 root root  9 avril 18 22:11 usb-Generic_STORAGE_DEVICE-0:0 -&gt; ../../sdb
lrwxrwxrwx 1 root root  9 avril 18 22:11 wwn-0x5000c500b5c4d662 -&gt; ../../sda
lrwxrwxrwx 1 root root 10 avril 18 22:11 wwn-0x5000c500b5c4d662-part1 -&gt; ../../sda1

/dev/disk/by-partlabel:
total 0
lrwxrwxrwx 1 root root 15 avril 18 22:11 'EFI\x20System\x20Partition' -&gt; ../../nvme0n1p1
lrwxrwxrwx 1 root root 10 avril 18 22:11  Sauvegardes -&gt; ../../sda1

/dev/disk/by-partuuid:
total 0
lrwxrwxrwx 1 root root 15 avril 18 22:11 54795468-79c2-48ce-9c7e-f6bd6aea6914 -&gt; ../../nvme0n1p2
lrwxrwxrwx 1 root root 15 avril 18 22:11 e9a9f238-ec93-4777-82e8-cbea7c8cf986 -&gt; ../../nvme0n1p1
lrwxrwxrwx 1 root root 10 avril 18 22:11 eeb50a63-ec05-4e34-b673-b90bc5ea2cfa -&gt; ../../sda1

/dev/disk/by-path:
total 0
lrwxrwxrwx 1 root root  9 avril 18 22:11 pci-0000:00:14.0-usb-0:1:1.0-scsi-0:0:0:0 -&gt; ../../sda
lrwxrwxrwx 1 root root 10 avril 18 22:11 pci-0000:00:14.0-usb-0:1:1.0-scsi-0:0:0:0-part1 -&gt; ../../sda1
lrwxrwxrwx 1 root root  9 avril 18 22:11 pci-0000:00:14.0-usb-0:5:1.0-scsi-0:0:0:0 -&gt; ../../sdb
lrwxrwxrwx 1 root root 13 avril 18 22:11 pci-0000:03:00.0-nvme-1 -&gt; ../../nvme0n1
lrwxrwxrwx 1 root root 15 avril 18 22:11 pci-0000:03:00.0-nvme-1-part1 -&gt; ../../nvme0n1p1
lrwxrwxrwx 1 root root 15 avril 18 22:11 pci-0000:03:00.0-nvme-1-part2 -&gt; ../../nvme0n1p2

/dev/disk/by-uuid:
total 0
lrwxrwxrwx 1 root root 10 avril 18 22:11 0a2768a9-34ac-4944-83a2-2e10ed4c48a5 -&gt; ../../sda1
lrwxrwxrwx 1 root root 15 avril 18 22:11 aad5ec2d-1dce-4a2b-8b07-2cd2bef72410 -&gt; ../../nvme0n1p2
lrwxrwxrwx 1 root root 15 avril 18 22:11 C3AC-80CA -&gt; ../../nvme0n1p1
</pre>
<p>Voir :</p>
<blockquote>
<a class="reference external" href="https://doc.ubuntu-fr.org/udev">https://doc.ubuntu-fr.org/udev</a>
<a class="reference external" href="https://web.archive.org/web/20100417131709/www.unixgarden.com/index.php/programmation/decouvertes-et-experimentation-avec-d-bus">https://web.archive.org/web/20100417131709/www.unixgarden.com/index.php/programmation/decouvertes-et-experimentation-avec-d-bus</a></blockquote>
</div>
<div class="section" id="utilitaire-smartd">
<h2><a class="toc-backref" href="#id175">13.14&nbsp;&nbsp;&nbsp;Utilitaire smartd</a></h2>
<p>Smart signifie <strong>Self-Monitoring, Analysis and Reporting Technology</strong> c'est une technologie d'auto surveillance mise en œuvre par certains disques durs.</p>
<p>Le but de cette technologie est de permettre le suivi de l'usure &quot;normale&quot; des disques internes.</p>
<p>Lorsque les disques utilisés supportent les informations d'état <strong>smart</strong>, il devient possible de vérifier leur état, mais aussi de lancer un démon qui nous alerte en cas de risque.</p>
<p>Le contrôle se fait au détriment d'une légère perte de performance.</p>
<p>Installation :</p>
<pre class="literal-block">
root&#64;luciole:~# apt-get install smartmontools
</pre>
<p>Le démon smartd est alors installé et peu prévenir l'administrateur par mail lorsque les informations d'état des disques atteindront les seuils d'alertes.</p>
<p>La vérification se fait au démarrage et est modifiable en éditant <em>etc/smartd.conf</em>.</p>
<p>Si les erreurs disque n'ont pus être corrigées il faut fortement songer à changer de disque...</p>
<p>Attention à l'usage de <em>smart</em> avec le <em>RAID</em> qui pose problème avec certains contrôleurs.</p>
<p>Pour savoir si smart est activé sur le disque:</p>
<pre class="literal-block">
root&#64;luciole:~# smartctl -i /dev/sda
smartctl version 5.38 [x86_64-unknown-linux-gnu] Copyright (C) 2002-8 Bruce Allen
Home page is http://smartmontools.sourceforge.net/

=== START OF INFORMATION SECTION ===
Device Model:     FUJITSU MHW2160BH PL
Serial Number:    K10FT7A25Y3B
Firmware Version: 0084001E
User Capacity:    160 041 885 696 bytes
Device is:        Not in smartctl database [for details use: -P showall]
ATA Version is:   8
ATA Standard is:  ATA-8-ACS revision 3b
Local Time is:    Sun May 24 18:33:45 2009 CEST
SMART support is: Available - device has SMART capability.
SMART support is: Enabled

root&#64;luciole:~# smartctl -A /dev/sda
smartctl version 5.38 [x86_64-unknown-linux-gnu] Copyright (C) 2002-8 Bruce Allen
Home page is http://smartmontools.sourceforge.net/
</pre>
<p>Pour l'activer si nécessaire :</p>
<pre class="literal-block">
root&#64;luciole:~# smartctl -s /dev/sda
</pre>
<p>Consultation de l'état d'un disque :</p>
<pre class="literal-block">
=== START OF READ SMART DATA SECTION ===
SMART Attributes Data Structure revision number: 16
Vendor Specific SMART Attributes with Thresholds:
ID# ATTRIBUTE_NAME          FLAG     VALUE WORST THRESH TYPE      UPDATED  WHEN_FAILED RAW_VALUE
  1 Raw_Read_Error_Rate     0x000f   100   100   046    Pre-fail  Always       -       182781
  2 Throughput_Performance  0x0005   100   100   030    Pre-fail  Offline      -       39256064
  3 Spin_Up_Time            0x0003   100   100   025    Pre-fail  Always       -       1
  4 Start_Stop_Count        0x0032   099   099   000    Old_age   Always       -       603
  5 Reallocated_Sector_Ct   0x0033   100   100   024    Pre-fail  Always       -       8589934592000
  7 Seek_Error_Rate         0x000f   100   100   047    Pre-fail  Always       -       1690
  8 Seek_Time_Performance   0x0005   100   100   019    Pre-fail  Offline      -       0
  9 Power_On_Hours          0x0032   080   080   000    Old_age   Always       -       10494
 10 Spin_Retry_Count        0x0013   100   100   020    Pre-fail  Always       -       0
 12 Power_Cycle_Count       0x0032   100   100   000    Old_age   Always       -       564
192 Power-Off_Retract_Count 0x0032   100   100   000    Old_age   Always       -       9
193 Load_Cycle_Count        0x0032   079   079   000    Old_age   Always       -       422760
194 Temperature_Celsius     0x0022   100   100   000    Old_age   Always       -       42 (Lifetime Min/Max 14/55)
195 Hardware_ECC_Recovered  0x001a   100   100   000    Old_age   Always       -       166
196 Reallocated_Event_Count 0x0032   100   100   000    Old_age   Always       -       453509120
197 Current_Pending_Sector  0x0012   100   100   000    Old_age   Always       -       0
198 Offline_Uncorrectable   0x0010   100   100   000    Old_age   Offline      -       0
199 UDMA_CRC_Error_Count    0x003e   200   200   000    Old_age   Always       -       0
200 Multi_Zone_Error_Rate   0x000f   100   100   060    Pre-fail  Always       -       10052
203 Run_Out_Cancel          0x0002   100   100   000    Old_age   Always       -       3732309344292
240 Head_Flying_Hours       0x003e   200   200   000    Old_age   Always       -       0
</pre>
<p>Lecture du résultat :</p>
<pre class="literal-block">
TYPE :
    Old_age : indique qu'un dépassement n'est pas critique, nous avons simplement dépassé la valeur
              garantie par le constructeur.
    Pre-fail : indique que tout dépassement risque de provoquer une perte du disque.

UPDATED :
    Always : la valeur est maintenue à jour.
    Offline : la valeur est calculée uniquement lors des tests.

VALUE : La valeur actuelle du disque. Une valeur comprise entre 100 et 255 indique générelement
    une bonne santé du disque.

WORST : La pire valeur enregistrée par le disque.

THRESH : La valeur seuil en dessous de laquelle le disque commence à souffrir.

RAW VALUE : est la conversion de VALUE dans les unités utilisées par le constructeur.
</pre>
<p>Il existe plusieurs types de tests pour mettre à jour les valeurs :</p>
<pre class="literal-block">
offline : le disque ne doit pas être monté.
short : test court sur les performances, les problèmes électriques et lectures/écritures physiques.
long : version longue du précédent.
</pre>
<p>Lancement d'un test :</p>
<pre class="literal-block">
root&#64;luciole:~# smartctl -t long /dev/sda
smartctl version 5.38 [x86_64-unknown-linux-gnu] Copyright (C) 2002-8 Bruce Allen
Home page is http://smartmontools.sourceforge.net/

=== START OF OFFLINE IMMEDIATE AND SELF-TEST SECTION ===
Sending command: &quot;Execute SMART Extended self-test routine immediately in off-line mode&quot;.
Drive command &quot;Execute SMART Extended self-test routine immediately in off-line mode&quot; successful.
Testing has begun.
Please wait 92 minutes for test to complete.
Test will complete after Sun May 24 20:18:57 2009

Use smartctl -X to abort test.
</pre>
<p>Pour voir le résultat il faut soit consulter les <em>logs</em> soit :</p>
<pre class="literal-block">
smartctl -c /dev/sda
smartctl -l selftest /dev/sda
smartctl -A /dev/sda
</pre>
<p>Configuration de <strong>smartd</strong> :</p>
<p>Le man de <strong>samrtd</strong> donne l'ensemble des informations permettant de configurer le démon qui scrute l'état des disques.</p>
<p>Informations :</p>
<blockquote>
<ul class="simple">
<li><a class="reference external" href="http://fr.wikipedia.org/wiki/Self-Monitoring,_Analysis_and_Reporting_Technology">http://fr.wikipedia.org/wiki/Self-Monitoring,_Analysis_and_Reporting_Technology</a></li>
<li><a class="reference external" href="http://linux-attitude.fr/post/Soyez-encore-plus-a-lecoute-de-vos-disques">http://linux-attitude.fr/post/Soyez-encore-plus-a-lecoute-de-vos-disques</a></li>
</ul>
</blockquote>
</div>
<div class="section" id="les-montages-en-raid">
<h2><a class="toc-backref" href="#id176">13.15&nbsp;&nbsp;&nbsp;Les montages en raid</a></h2>
<p>Le RAID (Redundant Array of Independant Disk) permet d'augmenter la tolérance aux pannes ou d'avoir un espace de stockage plus rapide ou plus grand que ce que l'on obtiendrait avec un seul disque.</p>
<p>La tolérance est obtenue soit par mirroring, soit par calcul de parité.</p>
<p>Les performances sont obtenues par multiplexage des disques, par exemple un mot de 4 octets voit chacun de ses octets écrits en parallèle sur 4 disques différent.</p>
<p>La concaténation permet elle de disposer virtuellement d'un seul disque dont la capacité est la somme de chacun des disques.</p>
<p>Voir : <a class="reference external" href="http://fr.wikipedia.org/wiki/RAID_(informatique">http://fr.wikipedia.org/wiki/RAID_(informatique</a>)</p>
<div class="section" id="le-raid-0">
<h3><a class="toc-backref" href="#id177">13.15.1&nbsp;&nbsp;&nbsp;Le RAID 0</a></h3>
<p>On cherche les performances sans tolérance aux pannes.</p>
</div>
<div class="section" id="le-raid-1">
<h3><a class="toc-backref" href="#id178">13.15.2&nbsp;&nbsp;&nbsp;Le RAID 1</a></h3>
<p>L'information est dupliquée sur les disques qui sont donc montés en miroir.</p>
</div>
<div class="section" id="le-raid-5">
<h3><a class="toc-backref" href="#id179">13.15.3&nbsp;&nbsp;&nbsp;Le RAID 5</a></h3>
<p>Il nécessite au minimum 3 disques.</p>
<p>Les informations sont stockées par bande (strip).</p>
<p>Par exemple pour un système à 3 disques, deux bandes de données et une de parité sont écrites alternativement sur les 3 disques.</p>
<p>Les bandes de parités sont écrites alternativement sur tous les disques façon a accroitre la résistance aux pannes.</p>
<p>Elles sont calculées en faisant un ou exclusif des bandes de données précédentes.</p>
</div>
<div class="section" id="la-gestion-du-raid-logiciel-par-linux">
<h3><a class="toc-backref" href="#id180">13.15.4&nbsp;&nbsp;&nbsp;La gestion du RAID logiciel par Linux</a></h3>
<p>La commande <strong>mdadm</strong> permet de gérer les disques <em>RAID</em>.</p>
<p>La commande <strong>mdadm --create</strong> permet d'initialiser un disque <em>RAID</em>.</p>
<p>La commande <strong>mdadm --detail /dev/mdX</strong> affiche l'état d'un <em>RAID</em>.</p>
<p>La commande <strong>mdadm --deamonise /dev/mdX</strong> démarre le <em>RAID</em>.</p>
<p>Le fichier <em>/etc/mdadm/mdadm.conf</em> contient la configuration utilisée par mdadm au démarrage.</p>
<p>La commande <strong>mdadm --detail --scan --verbose</strong> permet de récupérer la configuration et si nécessaire de la stocker dans <em>/etc/mdadm/mdadm.conf</em> pour le prochain démarrage.</p>
<p>Lien : <a class="reference external" href="http://doc.ubuntu-fr.org/raid_logiciel">http://doc.ubuntu-fr.org/raid_logiciel</a></p>
<p>Exemple creation d'un dique :</p>
<pre class="literal-block">
fdisk /dev/sda #Pour la création de /dev/sda1
fdisk /dev/sdb #Pour la création de /dev/sdb1
mdadm --create /dev/md0 --level=1 --raid-devices=2 /dev/sda1 /dev/sdb1
mdadm --daemonise /dev/md0
#sinon en éditant /etc/mdadm/mdadm.conf on peut y ajouter
#ARRAY /dev/md0 level=raid1 num-devices=2 devices=/dev/sda1,/dev/sdb1
</pre>
<p>Les périphérique <em>RAID</em> apparaissent sous <em>/dev/md#</em>.</p>
</div>
</div>
<div class="section" id="lvm">
<h2><a class="toc-backref" href="#id181">13.16&nbsp;&nbsp;&nbsp;LVM</a></h2>
<p><strong>LVM</strong> Logical Volume Manager s'intercale entre le noyau et les partitions des disques afin de permettre :</p>
<blockquote>
<ul class="simple">
<li>de redimensionner les partitions,</li>
<li>de concaténer les disque,</li>
<li>de réaliser des instantanés du système de fichier.</li>
</ul>
</blockquote>
<p>Sa mise en place doit être faite dés le partitionnement (type 8E).</p>
<p><em>GRUB</em> ne fonctionne pas avec <em>LVM</em> il faut donc soit utiliser <em>Lilo</em> soit réserver LVM à <em>/home</em>.</p>
<p>Glossaire :</p>
<p><strong>PV</strong> <em>Physical Volume</em> est un disque ou un ensemble de disque utilisé par <em>LVM</em>,</p>
<p><strong>VG</strong> <em>Volume Group</em> est un ensemble de PV,</p>
<p><strong>LV</strong> <em>Logical Volume</em> est une partie du <em>VG</em> vue par l'utilisateur comme s'il s'agissait d'une partition,</p>
<p><strong>PD</strong> <em>Physical Device</em> est ensemble de partition d'un disque utilisé par <em>LVM</em>,</p>
<p><strong>PE</strong> <em>Physical Extent</em> est la plus petite unité de données gérée par LVM (~= 4Mo).</p>
<p>Les modules de <em>LVM</em> doivent être montés avec <em>modprobe dm_load</em>.</p>
<p>La commande <strong>vgscan</strong> permet de lancer <em>LVM</em>.</p>
<p>La commande <strong>pvcreate</strong> permet de créer un volume physique.</p>
<p>La commande <strong>vgcreate</strong> permet de regrouper le <em>PV</em> dans un groupe de volume.</p>
<p>La commande <strong>lvcreate</strong> permet de créer le volume logique.</p>
<p>Il ne faut pas oublier de formater un volume logique pour pouvoir s'en servir, on utilise alors <em>mkfs</em> classiquement.</p>
<p>La commande <strong>lvextend</strong> permet de modifier la taille d'un <em>LV</em>.</p>
<p>Pour retailler le système de fichier on utilisera la commande <strong>resize2fs</strong> après avoir démonté le système de fichier.</p>
</div>
</div>
<div class="section" id="python">
<h1><a class="toc-backref" href="#id182">14&nbsp;&nbsp;&nbsp;Python</a></h1>
<p>Le scripting bash peut vite s'apparenter à du développement, alors pourquoi ne pas utiliser un vrai langage de programmation ?</p>
<div class="section" id="id2">
<h2><a class="toc-backref" href="#id183">14.1&nbsp;&nbsp;&nbsp;Historique</a></h2>
<p>Python a été créé fin 1986 par Guido van Rossum au CWI (Institut de recherche en mathématique et informatique de Hollande), à partir de la version 1.2 en 1995 le CNRI (Corporation of Nationnal Research Initiative) finance le projet.</p>
<p>En 2000 Python passe en version 2.0 au sein de Be.open, puis l'équipe rejoint Digitial Creation (Futur Zope Corporation) en 2001. En mars 2001 création de la python fondation et libération complète du code.</p>
</div>
<div class="section" id="la-notion-d-objet">
<h2><a class="toc-backref" href="#id184">14.2&nbsp;&nbsp;&nbsp;La notion d'objet</a></h2>
<p>Tout est objet.</p>
</div>
<div class="section" id="la-notion-de-classe">
<h2><a class="toc-backref" href="#id185">14.3&nbsp;&nbsp;&nbsp;La notion de classe</a></h2>
<p>Tous les objets appartiennent à une classe.</p>
</div>
<div class="section" id="l-instruction-print">
<h2><a class="toc-backref" href="#id186">14.4&nbsp;&nbsp;&nbsp;L'instruction print</a></h2>
<p>Exemple :</p>
<pre class="literal-block">
print(1)
print(&quot;Hello world&quot;)
print('coucou')
</pre>
</div>
<div class="section" id="les-primitives-d-acces-aux-informations-de-type">
<h2><a class="toc-backref" href="#id187">14.5&nbsp;&nbsp;&nbsp;Les primitives d'accès aux informations de type</a></h2>
<p><strong>id()</strong> renvoie l'identifiant d'un objet.</p>
<p><strong>type()</strong> renvoie le type de l'objet.</p>
<p><strong>dir()</strong> liste les attributs des objets.</p>
</div>
<div class="section" id="les-commentaires">
<h2><a class="toc-backref" href="#id188">14.6&nbsp;&nbsp;&nbsp;Les commentaires</a></h2>
<p>Le caractère <strong>#</strong> marque le début d'un commentaire.</p>
</div>
<div class="section" id="les-chaines-de-caracteres">
<h2><a class="toc-backref" href="#id189">14.7&nbsp;&nbsp;&nbsp;Les chaînes de caractères</a></h2>
<p>En python 3 l'encodage par défaut est UTF-8 qui est une représentation des types unicode.</p>
<p>On passe d'unicode au str en appelant la fonction encode (u&quot;C'est la fête&quot;.encode('ISO-8859-15').</p>
<p>On passe du str au unicode par la fonction decode.</p>
<p>Les délimiteurs et types de chaînes :</p>
<blockquote>
<ul class="simple">
<li>Les guillemets <strong>&quot;</strong> et <strong>&quot;&quot;&quot;</strong>,</li>
<li>Les apostrophes <strong>'</strong>,</li>
<li>Les chaînes raw <strong>r''</strong>,</li>
<li>Les chaînes formatable <strong>f''</strong>,</li>
</ul>
</blockquote>
</div>
<div class="section" id="les-numeriques">
<h2><a class="toc-backref" href="#id190">14.8&nbsp;&nbsp;&nbsp;Les numériques</a></h2>
<p>Les entiers (0 à 2^32) pour le type <strong>int</strong> et pour les entiers longs de type <strong>long</strong> on suffixe par un L ou l, la représentation octale commence par un 0 et l'hexadécimale par 0x.</p>
<p>Le type <strong>bool</strong> (True, False)</p>
<p>Les valeurs à virgule flottante (0.1 et 1e100) leur type est <strong>float</strong>.</p>
<p>Les nombres complexes (1 + 3j) leur type est <strong>complex</strong>.</p>
</div>
<div class="section" id="les-types-a-valeur-unique">
<h2><a class="toc-backref" href="#id191">14.9&nbsp;&nbsp;&nbsp;Les types à valeur unique</a></h2>
<p>None</p>
<p>NotImplemented</p>
</div>
<div class="section" id="les-sequences">
<h2><a class="toc-backref" href="#id192">14.10&nbsp;&nbsp;&nbsp;Les séquences</a></h2>
<p>Les tuples ()</p>
<p>Les listes []</p>
<p>Les dictionnaires {}</p>
</div>
<div class="section" id="les-operateurs">
<h2><a class="toc-backref" href="#id193">14.11&nbsp;&nbsp;&nbsp;Les opérateurs</a></h2>
<p>L'affectation =</p>
<p>La division / (Attention identique au C donc 5/6 = 0 mais 5.0/6 = 0.83333....)</p>
<p>La division entière //</p>
<p>Le modulo % ou divmod(5,3) = (1,2)</p>
<p>La négation -</p>
<p>L'inversion bit à bit ~ (complément à un)</p>
<p>La puissance **</p>
<p>Appartenance in</p>
</div>
<div class="section" id="operateurs-binaires">
<h2><a class="toc-backref" href="#id194">14.12&nbsp;&nbsp;&nbsp;Opérateurs binaires</a></h2>
<p>Le et <strong>&amp;</strong></p>
<p>Le ou <strong>|</strong></p>
<p>Le ou exclusif <strong>^</strong></p>
</div>
<div class="section" id="operateurs-de-comparaison">
<h2><a class="toc-backref" href="#id195">14.13&nbsp;&nbsp;&nbsp;Opérateurs de comparaison</a></h2>
<p>Inférieur <strong>&lt;</strong></p>
<p>Supérieur <strong>&gt;</strong></p>
<p>Inférieur égal <strong>&lt;=</strong></p>
<p>Supérieur égal <strong>&gt;=</strong></p>
<p>égalité <strong>==</strong>
différence <strong>!=</strong> ou <strong>&lt;&gt;</strong></p>
<p>le est <strong>is</strong></p>
<p>le n'est pas <strong>is not</strong></p>
</div>
<div class="section" id="ordre-de-traitement-des-operations">
<h2><a class="toc-backref" href="#id196">14.14&nbsp;&nbsp;&nbsp;Ordre de traitement des opérations</a></h2>
<p>Parenthèses, Exposants, Division, Multiplication, Addition, Soustraction</p>
</div>
<div class="section" id="l-instruction-pass">
<h2><a class="toc-backref" href="#id197">14.15&nbsp;&nbsp;&nbsp;L'instruction pass</a></h2>
</div>
<div class="section" id="l-indentation">
<h2><a class="toc-backref" href="#id198">14.16&nbsp;&nbsp;&nbsp;L'indentation</a></h2>
<p>La création de block de code se fait par indentation.</p>
</div>
<div class="section" id="les-structures-conditionnelles">
<h2><a class="toc-backref" href="#id199">14.17&nbsp;&nbsp;&nbsp;Les structures conditionnelles</a></h2>
<p>L'instruction if (else et elif)</p>
<p>L'instruction for in</p>
<p>L'instruction while</p>
</div>
<div class="section" id="id3">
<h2><a class="toc-backref" href="#id200">14.18&nbsp;&nbsp;&nbsp;Les fonctions</a></h2>
<p>La définition des fonctions se fait à l'aide de l'instruction «&nbsp;def&nbsp;».</p>
<p>La fonction est un objet.</p>
<p>Le code doit être indenté.</p>
<p>Les paramètres ne sont pas typés.</p>
<p>Les paramètres peuvent recevoir une valeur par défaut <em>p1 = 0</em>.</p>
<p>Les paramètres non explicites (ex: def f(<a href="#id4"><span class="problematic" id="id5">**</span></a>dict)) sont placés dans un dictionnaires.</p>
<div class="system-message" id="id4">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">CoursGNULinux.rst</tt>, line 3134); <em><a href="#id5">backlink</a></em></p>
Inline strong start-string without end-string.</div>
<p>Les paramètres arbitraires (ex : def f(<a href="#id6"><span class="problematic" id="id7">*</span></a>pars))sont placé dans un tuple.</p>
<div class="system-message" id="id6">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">CoursGNULinux.rst</tt>, line 3136); <em><a href="#id7">backlink</a></em></p>
Inline emphasis start-string without end-string.</div>
<p>Combinaison paramètres implicites et arbitraires (ex: def f(<a href="#id8"><span class="problematic" id="id9">*</span></a>pars, <a href="#id10"><span class="problematic" id="id11">**</span></a>dict)).</p>
<div class="system-message" id="id8">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">CoursGNULinux.rst</tt>, line 3138); <em><a href="#id9">backlink</a></em></p>
Inline emphasis start-string without end-string.</div>
<div class="system-message" id="id10">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">CoursGNULinux.rst</tt>, line 3138); <em><a href="#id11">backlink</a></em></p>
Inline strong start-string without end-string.</div>
<p>La directive return</p>
<p>La directive lambda</p>
</div>
<div class="section" id="les-docstrings">
<h2><a class="toc-backref" href="#id201">14.19&nbsp;&nbsp;&nbsp;Les docstrings</a></h2>
<p>Les fonctions du code peuvent être documentées, ce qui permet lors de l'exécution d'un code d'interroger une fonction pour savoir comment elle fonctionne.</p>
</div>
<div class="section" id="les-decorateurs">
<h2><a class="toc-backref" href="#id202">14.20&nbsp;&nbsp;&nbsp;Les décorateurs</a></h2>
<p>On peut en python définir des fonctions qui compléteront d'autres fonctions sur le principe de la composition mathématique.</p>
<p>Exemple :</p>
<pre class="literal-block">
def mondecorateur(fonction) :
  def nouvellefonction() :
     print('execution de %s'%fonction .__name__)
     return fonction()
  return nouvellefonction

&#64;mondecorateur
def f() :
  print('coucou')

f()
&gt;&gt;execution de f
&gt;&gt;coucou
</pre>
<p>Utile pour tester les pré-conditions des fonctions.</p>
</div>
<div class="section" id="les-classes">
<h2><a class="toc-backref" href="#id203">14.21&nbsp;&nbsp;&nbsp;Les Classes</a></h2>
<p>Les classes regroupent à la fois des données et des fonctions travaillant sur ces données.</p>
<p>Elles sont définies par l'instruction class</p>
<p>Les classes peuvent hériter d'autres classes.</p>
<p>Exemple :</p>
<pre class="literal-block">
class Animal(object):
  def __init__(self):
    self.age = 0
    self.poids = 0

class Chat(Animal):
   def __init__(self, nom):
     super(Chat, self).__init__() # Permet de construire la partie Animal
     self.nom = nom
</pre>
<p>La notion de constructeur <strong>__init__</strong></p>
<p>La notion de destructeur <strong>__del__</strong></p>
<p>Les attributs privés</p>
</div>
<div class="section" id="les-exceptions">
<h2><a class="toc-backref" href="#id204">14.22&nbsp;&nbsp;&nbsp;Les exceptions</a></h2>
<p>Les erreurs sont signalées par le mécanisme des exceptions :</p>
<pre class="literal-block">
&gt;&gt;&gt; try:
...    PasDefinie = None
... except NameError:
...    print(&quot;Variable non définie&quot;)
...
Variable non définie
</pre>
</div>
<div class="section" id="les-modules">
<h2><a class="toc-backref" href="#id205">14.23&nbsp;&nbsp;&nbsp;Les modules</a></h2>
<p>Les bibliothèques de programmation en python s'appellent des modules.</p>
<p>Primitive import</p>
<p>Primitive reload</p>
</div>
<div class="section" id="les-paquets">
<h2><a class="toc-backref" href="#id206">14.24&nbsp;&nbsp;&nbsp;Les paquets</a></h2>
<p>Les modules sont généralement découpés en paquets qui se traduisent par des dossiers sur le disque.</p>
</div>
<div class="section" id="les-principaux-modules">
<h2><a class="toc-backref" href="#id207">14.25&nbsp;&nbsp;&nbsp;Les principaux modules</a></h2>
<div class="section" id="builtin">
<h3><a class="toc-backref" href="#id208">14.25.1&nbsp;&nbsp;&nbsp;__builtin__</a></h3>
<p>Contient les primitives</p>
</div>
<div class="section" id="id12">
<h3><a class="toc-backref" href="#id209">14.25.2&nbsp;&nbsp;&nbsp;sys</a></h3>
<p>Contient les informations relative à l'exécution en cours</p>
</div>
<div class="section" id="os">
<h3><a class="toc-backref" href="#id210">14.25.3&nbsp;&nbsp;&nbsp;os</a></h3>
<p>Permet de gérer le système</p>
</div>
<div class="section" id="gzip-zipfile">
<h3><a class="toc-backref" href="#id211">14.25.4&nbsp;&nbsp;&nbsp;gzip, zipfile</a></h3>
<p>Permettent de gérer les fichiers compressés.</p>
</div>
<div class="section" id="socket">
<h3><a class="toc-backref" href="#id212">14.25.5&nbsp;&nbsp;&nbsp;socket</a></h3>
<p>Pour gérer les connexions TCP ou UDP</p>
</div>
<div class="section" id="urllib2">
<h3><a class="toc-backref" href="#id213">14.25.6&nbsp;&nbsp;&nbsp;urllib2</a></h3>
<p>Pour gérer les connexions http</p>
<p>Liens :</p>
<blockquote>
<ul class="simple">
<li><a class="reference external" href="http://diveintopython.adrahon.org/">http://diveintopython.adrahon.org/</a></li>
<li><a class="reference external" href="http://docs.python.org/">http://docs.python.org/</a></li>
<li><a class="reference external" href="http://www.afpy.org/">http://www.afpy.org/</a></li>
</ul>
</blockquote>
</div>
</div>
</div>
<div class="section" id="initialisation-du-systeme-et-des-services">
<h1><a class="toc-backref" href="#id214">15&nbsp;&nbsp;&nbsp;Initialisation du système et des services</a></h1>
<div class="section" id="la-sequence-de-boot">
<h2><a class="toc-backref" href="#id215">15.1&nbsp;&nbsp;&nbsp;La séquence de boot</a></h2>
<p>Au démarrage de l'ordinateur, le bios cherche un périphérique d'amorçage selon l'ordre établi par sa séquence de boot.</p>
<p>Le bios lance le chargeur (loader) qui se trouve dans le MBR (Master Boot Record) et qui ne fait que 512 octets.</p>
<p>Si le chargeur est GRUB, alors le MBR ne contient que la 1er partie de GRUB appelée <em>stage 1</em> qui à pour unique rôle de charger stage 1_5 et stage 2.</p>
<p>Stage 1_5 contient le code d'accès aux différents systèmes de fichiers. Il est contenu dans les premiers secteurs et peut avoir une taille de 33ko.</p>
<p>Puis stage 2 est chargé, il peut être n'importe où sur le disque.</p>
<p>Stage 2 propose à l'utilisateur de choisir le système d'exploitation ou la version du noyau à démarrer à travers un menu.</p>
<p>L'utilisateur peut aussi modifier la configuration de démarrage en éditant le menu (appuyer sur <em>e</em>).</p>
<p>Stage 2 charge alors l'image du système d'exploitation choisi, le fichier se trouve généralement dans <em>/boot</em> et porte un nom du type <em>vmlinuz-2.6.XXX</em>.</p>
<p><em>/boot</em> contient aussi des fichiers <em>initrd</em> qui permettent de gérer les périphériques nécessitant le chargement de module spécifique (cas des systèmes de ficher non inclus au noyau).</p>
<p>Le menu de démarrage passe quelques options à l'image du système, notamment le nom du périphérique contenant la racine exemple : <em>root=/dev/sda1</em>.</p>
<p>Une fois le noyau lancé, il exécute <em>/sbin/init</em> avec 1 comme PID.</p>
<p><em>init</em> démarre les démons qui vont par exemple configurer les services réseau.</p>
</div>
<div class="section" id="grub">
<h2><a class="toc-backref" href="#id216">15.2&nbsp;&nbsp;&nbsp;GRUB</a></h2>
<p><strong>GRUB</strong> est l'acronyme de GRand Unified Bootloader. C'est un programme GNU de démarrage permettant de choisir le système d'exploitation qui sera chargé.</p>
<p>Le fichier <em>/boot/grub/menu.lst</em> permet de créer le menu de démarrage, et d'imposer un choix par défaut.
+
<em>GRUB</em> peut charger l'image du noyau depuis le réseau.</p>
<p>La version 2 est celle installée avec Ubuntu 20.04.</p>
<p>La mise à jour du noyau entraine la modification du fichier <em>/boot/grub/grub.cfg</em>, mais il est possible de la forcer avec la commande <strong>update-grub</strong>.</p>
<p>Pour customiser le bootloader on doit éditer le fichier /etc/grub.d/40_custom</p>
<p>Lors du démarage de Grub on peut passer des options au kernel en appuyant sur la touche &quot;e&quot;.</p>
<p>Voir la doc :
<a class="reference external" href="https://doc.ubuntu-fr.org/grub-pc">https://doc.ubuntu-fr.org/grub-pc</a></p>
</div>
<div class="section" id="demarrage-du-noyau">
<h2><a class="toc-backref" href="#id217">15.3&nbsp;&nbsp;&nbsp;Démarrage du noyau</a></h2>
<p>Il est possible de passer des options au noyau lors de son démarrage.</p>
<p>La syntaxe des options est :</p>
<pre class="literal-block">
option1=valeur option2=valeur1,valeur2
</pre>
</div>
<div class="section" id="les-arguments-ou-parametres-du-kernel">
<h2><a class="toc-backref" href="#id218">15.4&nbsp;&nbsp;&nbsp;Les arguments ou paramètres du kernel</a></h2>
<p>Les principales options d'amorçage du noyau sont :</p>
<blockquote>
<ul class="simple">
<li>root=/dev/sda1 indique la partition système,</li>
<li>ro Indique que le système de fichier doit être monté en lecture seul,</li>
<li>init permet de démarrer un autre processus à la place d'<em>init</em>,</li>
<li>single ou emergency permet de passer en mode simple utilisateur et permet par exemple de pouvoir modifier le mot de passe root,</li>
<li>quiet démarre en mode silencieux,</li>
<li>nosmp n'utilise qu'un seul processeur,</li>
<li>noht pas d'hyper threading,</li>
<li>noapic pas de détection des interruptions,</li>
<li>nolapic aucune gestion des interruptions,</li>
<li>apm=off|on désactive ou active la gestion de l'alimentation en énergie,</li>
<li>noresume ne réveille pas une hibernation.</li>
</ul>
</blockquote>
</div>
<div class="section" id="systemd-vs-initv-vs-upstart">
<h2><a class="toc-backref" href="#id219">15.5&nbsp;&nbsp;&nbsp;Systemd vs InitV vs upstart</a></h2>
<p>&#64;TODO Systemd</p>
<p>InitV signifie Init system V.</p>
<p>Ce système est remplacé par <strong>upstart</strong> sur les dernières Ubuntu et Fedora.</p>
<p>Au démarrage, le noyau lance <em>init</em>.</p>
<p>L'ancien système était paramétrable via le fichier <em>/etc/inittab</em> qui est remplacé par la notion de <em>job</em>.</p>
<p><strong>init</strong> lit le répertoire <em>/etc/event.d</em> qui contient les jobs à lancer.</p>
<p>Chaque job réalise des actions en fonction du niveau d'exécution du noyau.</p>
<p><strong>init</strong> se charge de maintenir les jobs opérationnels.</p>
<p>La commande <strong>initctl</strong> permet de communiquer avec <strong>init</strong>.</p>
<p>La liste des jobs démarrés est donnés par <strong>initctl list</strong> :</p>
<pre class="literal-block">
root&#64;luciole:~# initctl list
control-alt-delete (stop) waiting
last-good-boot (stop) waiting
logd (stop) waiting
rc-default (stop) waiting
rc0 (stop) waiting
rc1 (stop) waiting
rc2 (stop) waiting
rc3 (stop) waiting
rc4 (stop) waiting
rc5 (stop) waiting
rc6 (stop) waiting
rcS (stop) waiting
rcS-sulogin (stop) waiting
sulogin (stop) waiting
tty1 (start) running, process 10354
tty2 (start) running, process 8436
tty3 (start) running, process 8437
tty4 (start) running, process 8429
tty5 (start) running, process 8430
tty6 (start) running, process 8439
</pre>
<p>Le lancement d'un job se fait par <em>initctl start rc0</em>, son arrêt par <em>initctl stop rc0</em>.</p>
<p>Liens :</p>
<blockquote>
<ul class="simple">
<li><a class="reference external" href="http://www.digitbooks.fr/articles/2-upstart.html">http://www.digitbooks.fr/articles/2-upstart.html</a></li>
</ul>
</blockquote>
</div>
<div class="section" id="les-niveaux-d-execution-run-level">
<h2><a class="toc-backref" href="#id220">15.6&nbsp;&nbsp;&nbsp;Les niveaux d'exécution (Run level)</a></h2>
<p>Signification des niveaux pour Ubuntu :</p>
<pre class="literal-block">
Niveau S : Initialisation du système (le système de fichier est en read only),
Niveau 0 : Extinction,
Niveau 1 : Mode mono utilisateur,
Niveau 2 et 5 : Mode multi-utilisateurs avec réseau avec démarrage du serveur X,
Niveau 6 : Reboot.
</pre>
</div>
<div class="section" id="le-systeme-de-demarrage-des-services">
<h2><a class="toc-backref" href="#id221">15.7&nbsp;&nbsp;&nbsp;Le système de démarrage des services</a></h2>
<p>Lors du lancement d'<em>init</em> par le noyau, celui-ci transmet l'information de niveau à exécuter.</p>
<p>Ainsi <em>init</em> lance les jobs en leur précisant le niveau demandé.</p>
<p>Le job <em>rc5</em> lance <em>/etc/init.d/rc 5</em>, qui à son tour va lancer les scripts contenu dans <em>/etc/rc5.d</em> selon l'ordre lexicographique.</p>
<p>Les répertoires <em>/etc/rcX.d</em> contiennent des liens vers les scripts de <em>/etc/init.d</em>.</p>
<p>Les scripts contenus dans <em>/etc/init.d</em> permettent de démarrer, arrêter, ou connaître le statut des démons.</p>
</div>
<div class="section" id="changement-du-niveau-d-execution">
<h2><a class="toc-backref" href="#id222">15.8&nbsp;&nbsp;&nbsp;Changement du niveau d'exécution</a></h2>
<p>Il est possible de changer le niveau d'exécution.</p>
<p>Exemple pour arrêter la machine :</p>
<blockquote>
<strong>initctl emit runlevel 0</strong></blockquote>
</div>
</div>
<div class="section" id="modules">
<h1><a class="toc-backref" href="#id223">16&nbsp;&nbsp;&nbsp;Modules</a></h1>
<p>Le noyau Linux est modulaire.</p>
<p>La gestion de nombreux périphériques n'est pas faite dans le noyau mais dans des modules qui sont chargés à la demande.</p>
<p>La commande <strong>modprobe</strong> permet de charger un module directement par son nom.</p>
<p>La commande <strong>lsmod</strong> permet de connaître les modules déjà chargés.</p>
<p>La commande <strong>rmmod</strong> permet de supprimer un module du noyau.</p>
<p>Il est possible d'intégrer définitivement les modules au noyau en recompilant celui-ci.</p>
</div>
<div class="section" id="configuration-reseau-et-outils-tcp-ip">
<h1><a class="toc-backref" href="#id224">17&nbsp;&nbsp;&nbsp;Configuration réseau et outils TCP/IP</a></h1>
<div class="section" id="id13">
<h2><a class="toc-backref" href="#id225">17.1&nbsp;&nbsp;&nbsp;Introduction</a></h2>
<p>L'unix BSD a été l'une des premières plateformes à supporter la pile protocolaire TCP/IP.</p>
<p>Dans cette tradition GNU/Linux regorge d'outils TCP, UDP, ICMP.</p>
<p>TCP signifie Transmission Control Protocol.</p>
<p>IP : Internet Protocol.</p>
<p>UDP : User Datagram Protocol.</p>
<p>ICMP : Internet Control Message Protocol.</p>
<p>Sous Ubuntu l'installation configure l'interface réseau en client DHCP (Dynamique Host Configuration Protocol).</p>
<p>De nombreux programmes communiquent entre eux sur la machine en utilisant l'interface réseau <em>loopback</em> de nom <em>localhost</em> et d'adresse <em>127.0.0.1</em> et ceci alors même que la connexion ne sort pas de la machine.</p>
<p>Liens :</p>
<blockquote>
<ul class="simple">
<li><a class="reference external" href="http://fr.wikipedia.org/wiki/Tcp">http://fr.wikipedia.org/wiki/Tcp</a></li>
<li><a class="reference external" href="http://fr.wikipedia.org/wiki/Internet_Protocol">http://fr.wikipedia.org/wiki/Internet_Protocol</a></li>
</ul>
</blockquote>
</div>
<div class="section" id="configuration-automatique">
<h2><a class="toc-backref" href="#id226">17.2&nbsp;&nbsp;&nbsp;Configuration automatique</a></h2>
<p>Le protocole DHCP permet de demander à un serveur une adresse IP ainsi que les paramètres de connexion tels que le masque de sous réseau, les DNS, la passerelle.</p>
<p>La commande <strong>dhclient</strong>, permet de relancer la négociation avec le serveur.</p>
<p>Infos : <a class="reference external" href="http://fr.wikipedia.org/wiki/DHCP">http://fr.wikipedia.org/wiki/DHCP</a></p>
</div>
<div class="section" id="la-commande-ip">
<h2><a class="toc-backref" href="#id227">17.3&nbsp;&nbsp;&nbsp;La commande ip</a></h2>
<p>La commande ip permet d'afficher et modifier toutes les interfaces réseaux.</p>
<p>ip addr : Affiche les adresses ip et toutes les informations.
ip addr show dev em1 : Affiche les informations pour le périphérique em1
ip addr add 192.168.1.1/24 dev em1 : Ajoute l'adresse 192.168.1.1 avec le masque 24 au préiphérique em1.</p>
<p>ip link : Gère et affiche toutes les interfaces réseaux.
ip link show dev em1 : Affiche les informations pour em1.
ip -s link : ffiche les interfaces statiques.
ip link set dev eno12345678 up : Met en fonctionnement l'interface eno12345678.
ip link set dev eno12345678 down : Éteint l'interface eno12345678.</p>
<p>ip route : Affiche et permet la modification de la table de routage.</p>
<p>ip maddr : Affiche et permet la gestion des adresses multicast.
ip maddr show dev em1 : Affiche les informations multicast de em1</p>
<p>ip neigh : Affiche les objets voisins c'est à dire la table ARP pour IPv4.
ip neigh show dev em1 : Affiche le cache ARP de l'interface em1</p>
<p>La commande ip permet de consulter et changer l'état ou les paramettres de tous les types de périphériques réseaux.
Elle remplace les commandes ifconfig, iwconfig, ifup/ifdown, route que nous détaillerons ci après, car elles sont encore proposées par certaines docs.</p>
<p>voir :</p>
<p><a class="reference external" href="http://cpham.perso.univ-pau.fr/ENSEIGNEMENT/UERHD/DescriptifCmdIP.pdf">http://cpham.perso.univ-pau.fr/ENSEIGNEMENT/UERHD/DescriptifCmdIP.pdf</a></p>
<p><a class="reference external" href="https://access.redhat.com/sites/default/files/attachments/rh_ip_command_cheatsheet_1214_jcs_print.pdf">https://access.redhat.com/sites/default/files/attachments/rh_ip_command_cheatsheet_1214_jcs_print.pdf</a></p>
</div>
<div class="section" id="ifconfig-deprecie">
<h2><a class="toc-backref" href="#id228">17.4&nbsp;&nbsp;&nbsp;ifconfig (déprécié)</a></h2>
<p>La commande <strong>ifconfig</strong> permet à la fois de consulter les paramètres réseau mais également de configurer les interfaces.
Cette commande est aujourd'hui obsolète et remplacée par <strong>ip</strong> que nous détaillerons ci-après, on peut l'installer avec <strong>apt install net-tools</strong>.
Toutefois elle est beaucoup plus simple, mais moins complète que <strong>ip</strong> .</p>
<p>Exemple de configuration :</p>
<pre class="literal-block">
root&#64;luciole:~# ifconfig eth0 192.168.0.7 netmask 255.255.255.0
</pre>
<p>La configuration ainsi réalisée n'est pas permanent, elle sera perdue au prochain démarrage.</p>
<p>Pour modifier de façon permanente la configuration réseau il faut éditer <em>/etc/network/interfaces</em>.</p>
<p><strong>ifconfig</strong> est remplacé par la commande <strong>ip addr</strong> ou <strong>ip a</strong>
<strong>ifconfig eth0 192.168.0.11</strong> est remplacé par <strong>ip addr add 192.168.0.11/255.255.255.0 dev enxe4b97aef38eb</strong>
Les noms comme eth0 sont remplacés par la convention de nommage <strong>ifname</strong> pour éviter le changement de nom lors du reboot.</p>
</div>
<div class="section" id="iwconfig-deprecie">
<h2><a class="toc-backref" href="#id229">17.5&nbsp;&nbsp;&nbsp;iwconfig (déprécié)</a></h2>
<p>La commande <strong>iwconfig</strong> permet de configurer les cartes wifi.</p>
</div>
<div class="section" id="ifup-ifdown-deprecie">
<h2><a class="toc-backref" href="#id230">17.6&nbsp;&nbsp;&nbsp;ifup/ifdown (déprécié)</a></h2>
<p>La commande <strong>ifup</strong> permet de démarrer une interface réseau en fonction de la configuration indiquée dans <em>/etc/network/interfaces</em>
Remplacée par <strong>ip link set NOM_PERIPHERIQUE up</strong></p>
<p>La commande <strong>ifdown</strong> permet de l'arrêter.
Remplacée par <strong>ip link set NOM_PERIPHERIQUE down</strong></p>
</div>
<div class="section" id="route-deprecie">
<h2><a class="toc-backref" href="#id231">17.7&nbsp;&nbsp;&nbsp;route (déprécié)</a></h2>
<p>La commande <strong>route</strong> permet de consulter et de fixer l'adresse de la passerelle :</p>
<pre class="literal-block">
root&#64;luciole:~# route add default gw 192.168.0.1
</pre>
<p>Remplacée par <strong>ip route</strong></p>
<p>En consultation elle est identique à <strong>netstat -nr</strong></p>
</div>
<div class="section" id="ip">
<h2><a class="toc-backref" href="#id232">17.8&nbsp;&nbsp;&nbsp;ip</a></h2>
<p>La commande ip est le couteau suisse de la configuration réseau, son paquet <strong>iproute2</strong> remplace les commandes du paquet <strong>net-tools</strong> :</p>
<pre class="literal-block">
Attribuer une adresse : ::

  ip addr add 192.168.0.54/24 dev eth0

Connaitre son adresse : ::

  ip -4c addr show #-4 affiche uniquement les IPv4, -c pour l'affichage couleur

Activer une interface réseau : ::

  ip link set eth0 update

Désactiver une interface réseau : ::

  ip link set eth0 down

Supprimer une adresse d'une interface : ::

  ip addr del 192.168.0.54 dev eth0

Ajouter une gateway : ::

  ip route add default via 192.168.0.1
</pre>
</div>
<div class="section" id="les-interfaces-virtuelles">
<h2><a class="toc-backref" href="#id233">17.9&nbsp;&nbsp;&nbsp;Les interfaces virtuelles</a></h2>
<p>La création d'interface virtuelle permet de donner plusieurs adresses IP à une même carte réseau.</p>
<p>Cela permet par exemple de créer une adresse ip fixe pour une entrée DNS tout en la redirigeant via l'interface du datacenter vers une autre ip.</p>
<p>La ligne de commande est du type :</p>
<pre class="literal-block">
ip link add link DEVICE name NAME type vlan
</pre>
<p>Voir <a class="reference external" href="https://www.systutorials.com/docs/linux/man/8-ip-link/">https://www.systutorials.com/docs/linux/man/8-ip-link/</a></p>
</div>
<div class="section" id="fixer-le-nom-de-machine">
<h2><a class="toc-backref" href="#id234">17.10&nbsp;&nbsp;&nbsp;Fixer le nom de machine</a></h2>
<p>La commande <strong>hostname</strong> permet à la fois de consulter et de changer le nom de la machine.</p>
<p>Attention il ne s'agit pas du Fully Qualified Domain Name, mais seulement du nom de la machine sans le nom de domaine.</p>
</div>
<div class="section" id="demarrage-et-arret-du-reseau">
<h2><a class="toc-backref" href="#id235">17.11&nbsp;&nbsp;&nbsp;Démarrage et arrêt du réseau</a></h2>
<p>La commande <strong>/etc/init.d/networking start</strong> permet de démarrer la couche réseau.</p>
</div>
<div class="section" id="la-resolution-de-nom">
<h2><a class="toc-backref" href="#id236">17.12&nbsp;&nbsp;&nbsp;La résolution de nom</a></h2>
<p>La commande <strong>dig</strong> permet de réaliser la résolution de nom.</p>
<p>La commande <strong>dig -x $ADRESSE_IP</strong> permet de réaliser la résolution inverse.</p>
<p>Le fichier <strong>/etc/resolv.conf</strong> est utilisé pour connaître les adresses des DNS.</p>
</div>
<div class="section" id="la-modification-du-fichier-etc-hosts">
<h2><a class="toc-backref" href="#id237">17.13&nbsp;&nbsp;&nbsp;La modification du fichier /etc/hosts</a></h2>
<p>Le fichier <em>/etc/hosts</em> contient les adresses et noms des machines connues.</p>
<p>On y trouve au minimum la définition du loopback et de la machine.</p>
<p>Les valeurs qui y sont priment sur la résolution DNS.</p>
<p>Exemple :</p>
<pre class="literal-block">
michaellaunay&#64;griffon:~$ cat /etc/hosts
127.0.0.1     localhost griffon griffon.ecreall.com
88.191.77.45    griffon.ecreall.com
</pre>
<p>La modification est trivial puisqu'il suffit d'ajouter une ligne $Adresse $Nom1 $Nom2.</p>
</div>
<div class="section" id="les-outils-et-commandes-de-tests-reseau">
<h2><a class="toc-backref" href="#id238">17.14&nbsp;&nbsp;&nbsp;Les outils et commandes de tests réseau</a></h2>
<div class="section" id="ping">
<h3><a class="toc-backref" href="#id239">17.14.1&nbsp;&nbsp;&nbsp;ping</a></h3>
<p>La commande <strong>ping</strong> permet d'envoyer des paquets ICMP à une machine distante pour tester la connectivité du réseau.</p>
</div>
<div class="section" id="host">
<h3><a class="toc-backref" href="#id240">17.14.2&nbsp;&nbsp;&nbsp;host</a></h3>
<p>Un autre utilitaire de résolution de nom de domaine.
Traceroute
++++++++++</p>
<p>La commande <strong>traceroute</strong> permet de connaître les noeuds du réseau nous séparant d'un machine cible.</p>
</div>
<div class="section" id="netstat">
<h3><a class="toc-backref" href="#id241">17.14.3&nbsp;&nbsp;&nbsp;netstat</a></h3>
<p>La commande <strong>netstat</strong> permet de connaître le statut des connexions réseaux.</p>
<p><strong>netstat -tp</strong> permet de voir les connexions restées ouvertes et les processus associés.</p>
<p>Exemple :</p>
<pre class="literal-block">
root&#64;luciole:~# netstat -taupe
Connexions Internet actives (serveurs et établies)
Proto Recv-Q Send-Q Adresse locale          Adresse distante        Etat       User       Inode       PID/Program name
tcp        0      0 luciole.local:34978     ecs.amazonaws.com:www   ESTABLISHED michaellaunay 53652       11400/gvfsd-http
tcp        1      0 luciole.local:35516     ecs.amazonaws.com:www   CLOSE_WAIT  michaellaunay 50142       11400/gvfsd-http
tcp        1      0 luciole.local:50217     ecs.amazonaws.com:www   CLOSE_WAIT  michaellaunay 53380       11400/gvfsd-http
tcp        1      0 luciole.local:35515     ecs.amazonaws.com:www   CLOSE_WAIT  michaellaunay 50135       11400/gvfsd-http
tcp        0      0 luciole.local:34979     ecs.amazonaws.com:www   ESTABLISHED michaellaunay 53668       11400/gvfsd-http
</pre>
<p>Permet de voir des connexions en direction du cloud d'Amazon, un <em>cat /proc/11400/cmd</em> donne :</p>
<pre class="literal-block">
root&#64;luciole:~# cat /proc/11400/cmd
/usr/lib/gvfs/gvfsd-http--spawner:1.82/org/gtk/gvfs/exec_spaw/0
</pre>
<p>On voit que la commande est <em>spawnée</em> ce qui signifie que si on la <em>kill</em> elle sera relancée par le système.</p>
<p>Après quelques recherches, il s'avère que c'est l'application <em>Rhythmbox</em> qui va chercher les couvertures des albums écoutés en utilisant le service gvfs.</p>
</div>
<div class="section" id="tcpdump">
<h3><a class="toc-backref" href="#id242">17.14.4&nbsp;&nbsp;&nbsp;tcpdump</a></h3>
<p>La commande <strong>tcpdump</strong> permet &quot;d'espionner&quot; ce qui se passe sur nos interfaces réseau.</p>
</div>
<div class="section" id="nmap">
<h3><a class="toc-backref" href="#id243">17.14.5&nbsp;&nbsp;&nbsp;nmap</a></h3>
<p>La commande <strong>nmap</strong> permet de scanner les ports d'un machine et donc de faire un diagnostic des éventuelles portes d'entrées.</p>
</div>
<div class="section" id="ngrep">
<h3><a class="toc-backref" href="#id244">17.14.6&nbsp;&nbsp;&nbsp;ngrep</a></h3>
<p>La commande <strong>ngrep</strong> permet de n'afficher les paquets réseaux qu'à la condition qu'ils contiennent la chaîne cherchée.</p>
</div>
<div class="section" id="wireshark">
<h3><a class="toc-backref" href="#id245">17.14.7&nbsp;&nbsp;&nbsp;wireshark</a></h3>
<p>Permet d'osculter les paquets réseaux comme ceux enregistrés par <strong>tcpdump</strong>.
last
++++</p>
<p>La commande <strong>last</strong> permet de connaître les derniers <em>login</em> réalisés sur la machine, leur date et adresse d'origine.</p>
</div>
</div>
</div>
<div class="section" id="gestion-des-paquetages-et-installation-de-logiciels-sous-ubuntu">
<h1><a class="toc-backref" href="#id246">18&nbsp;&nbsp;&nbsp;Gestion des paquetages et installation de logiciels sous Ubuntu</a></h1>
<div class="section" id="ubuntu-un-systeme-grand-public">
<h2><a class="toc-backref" href="#id247">18.1&nbsp;&nbsp;&nbsp;Ubuntu, un système &quot;Grand Public&quot;</a></h2>
<p>Ubuntu simplifie extrêmement l'installation et devient donc facile d'accès pour un non linuxien.</p>
</div>
<div class="section" id="quelle-version-choisir-et-pour-quel-usage">
<h2><a class="toc-backref" href="#id248">18.2&nbsp;&nbsp;&nbsp;Quelle version choisir et pour quel usage ?</a></h2>
<p>Il existe deux types de versions :</p>
<blockquote>
<ul class="simple">
<li>Une version serveur, dépouillée d'interface graphique, permettant d'utiliser RAID et LVM,</li>
<li>Une version pc de bureau, utilisant Gnome.</li>
</ul>
</blockquote>
</div>
<div class="section" id="les-depots">
<h2><a class="toc-backref" href="#id249">18.3&nbsp;&nbsp;&nbsp;Les dépôts</a></h2>
<p>Nous avons vu précédemment la gestion graphique des dépôts.</p>
<p>Nous pouvons éditer le fichier <em>/etc/apt/sources.list</em> et ajouter des dépôts.</p>
<p>Exemple :</p>
<pre class="literal-block">
echo &quot;deb http://packages.medibuntu.org/ karmic free non-free&quot; &gt;&gt; /etc/apt/sources.list*
</pre>
<p>Toutefois il faudra télécharger la clé d'authentification du nouveau dépôt et l'ajouter avec  :</p>
<pre class="literal-block">
wget -q http://fr.packages.medibuntu.org/medibuntu-key.gpg -O- | sudo apt-key add -
</pre>
<p>Puis mettre à jour le cache avec <strong>apt update</strong></p>
</div>
<div class="section" id="installation-de-paquets">
<h2><a class="toc-backref" href="#id250">18.4&nbsp;&nbsp;&nbsp;Installation de paquets</a></h2>
<p>La commande <strong>apt install $NOM_PAQUET</strong> permet d'installer des paquets :</p>
<pre class="literal-block">
apt install libdvdread7 mkisofs dvdbackup dvdauthor oggvideotools ffmpeg
apt install libavcodec-58 libavdevice58 libavformat58
</pre>
</div>
<div class="section" id="suppression-de-paquets">
<h2><a class="toc-backref" href="#id251">18.5&nbsp;&nbsp;&nbsp;Suppression de paquets</a></h2>
<p>Pour supprimer un paquet on utilise <strong>apt remove $NOM_PAQUET</strong>.</p>
</div>
<div class="section" id="informations-sur-les-paquetages">
<h2><a class="toc-backref" href="#id252">18.6&nbsp;&nbsp;&nbsp;Informations sur les paquetages</a></h2>
<p>Pour avoir la liste des paquets installés <strong>dpkg -l</strong>.</p>
</div>
<div class="section" id="recherche-de-paquetages">
<h2><a class="toc-backref" href="#id253">18.7&nbsp;&nbsp;&nbsp;Recherche de paquetages</a></h2>
<p>La commande <strong>apt search $MOT_CLE</strong> permet de chercher un paquet à partir d'un mot de sa description.</p>
</div>
<div class="section" id="mise-a-jour-des-paquetages">
<h2><a class="toc-backref" href="#id254">18.8&nbsp;&nbsp;&nbsp;Mise à jour des paquetages</a></h2>
<p>Pour mettre à jour la distribution :</p>
<pre class="literal-block">
apt update
apt upgrade
</pre>
</div>
<div class="section" id="interfaces-graphiques">
<h2><a class="toc-backref" href="#id255">18.9&nbsp;&nbsp;&nbsp;Interfaces graphiques</a></h2>
<p>Il existe deux types d'interfaces graphiques, une en mode texte <strong>aptitude</strong> et une dans X11 <strong>synaptic</strong>.</p>
</div>
<div class="section" id="commande-alien">
<h2><a class="toc-backref" href="#id256">18.10&nbsp;&nbsp;&nbsp;Commande alien</a></h2>
<p>La commande alien permet de transformer un paquet <em>rpm</em> en paquet debian et donc de pouvoir l'installer.</p>
</div>
</div>
<div class="section" id="apache">
<h1><a class="toc-backref" href="#id257">19&nbsp;&nbsp;&nbsp;Apache</a></h1>
<div class="section" id="presentation">
<h2><a class="toc-backref" href="#id258">19.1&nbsp;&nbsp;&nbsp;Présentation</a></h2>
<p>Apache est un serveur web pouvant être utilisé comme proxy, cache etc.</p>
<p>Il supporte le protocole https et est donc utilisé pour servir les applications web à sécuriser.</p>
</div>
<div class="section" id="id14">
<h2><a class="toc-backref" href="#id259">19.2&nbsp;&nbsp;&nbsp;Installation</a></h2>
<p>La commande <strong>apt install apache2</strong> permet d'utiliser une version récente d'Apache.</p>
</div>
<div class="section" id="configuration">
<h2><a class="toc-backref" href="#id260">19.3&nbsp;&nbsp;&nbsp;Configuration</a></h2>
<p>Nous allons créer un petit site <em>www.monsite.com</em> et nous allons voir comment le sécuriser.</p>
<p>Dans un premier temps nous allons ajouter sur le poste client les entrées www.monsite.com pour réaliser des tests sans passer par le DNS.</p>
<p>Ajout de ssl.monsite.com /etc/hosts :</p>
<pre class="literal-block">
192.168.0.7 www.monsite.com
</pre>
<p>Puis sur le serveur nous allons activer les modules utilisés pour la sécurisation :</p>
<pre class="literal-block">
root&#64;monserveur:~# a2enmod ssl
</pre>
<p>Cette commande créer 2 liens dans /etc/apache2/mods-enabled pointant vers ../mods-available/ssl.conf et ../mods-available/ssl.load.</p>
<p>Pour ajouter un site, il suffit de créer un fichier de configuration dans <em>/etc/apache2/sites-available</em> puis de l'activer :</p>
<pre class="literal-block">
root&#64;monserveur:~# vim /etc/apache2/sites-available/www.monsite.com

  &lt;VirtualHost *:443&gt;
    ServerAdmin michaellaunay&#64;ecreall.com
    ServerName www.monsite.com
    SSLEngine on
    SSLCipherSuite ALL:!ADH:!EXPORT56:RC4+RSA:+HIGH:+MEDIUM:+LOW:+SSLv2:+EXP
    SSLCertificateFile /etc/apache2/ssl/server.crt
    SSLCertificateKeyFile /etc/apache2/ssl/server.key
    &lt;Directory /var/www/&gt;
                  Options Indexes FollowSymLinks MultiViews
                  AllowOverride None
                  Order allow,deny
                  allow from all
    &lt;/Directory&gt;
    DocumentRoot /var/www
  &lt;/VirtualHost&gt;

  &lt;VirtualHost *:80&gt;
    ServerAdmin michaellaunay&#64;ecreall.com
    ServerName www.monsite.com
    &lt;Directory /var/www/&gt;
                  Options Indexes FollowSymLinks MultiViews
                  AllowOverride None
                  Order allow,deny
                  allow from all
    &lt;/Directory&gt;
    DocumentRoot /var/www
  &lt;/VirtualHost&gt;
</pre>
<p>Puis d'activer le site :</p>
<pre class="literal-block">
root&#64;monserveur:~# a2ensite www.monsite.com
root&#64;monserveur:~# /etc/init.d/apache2 restart
</pre>
</div>
<div class="section" id="securisation">
<h2><a class="toc-backref" href="#id261">19.4&nbsp;&nbsp;&nbsp;Sécurisation</a></h2>
<p>La sécurisation de fait en ajoutant un certificat X 509 sous forme d'une clé privée et d'une clé privée.</p>
<p>Nous verrons au chapitre X 509 l'usage d'une clé auto-signée.</p>
</div>
<div class="section" id="tracage">
<h2><a class="toc-backref" href="#id262">19.5&nbsp;&nbsp;&nbsp;Traçage</a></h2>
<p>La configuration des logs permet de surveillez les accès aux sites.</p>
<p>On constatera que pour un site mis en ligne sur internet les tentatives d'intrusions sont importantes.</p>
</div>
</div>
<div class="section" id="postfix">
<h1><a class="toc-backref" href="#id263">20&nbsp;&nbsp;&nbsp;Postfix</a></h1>
<div class="section" id="id15">
<h2><a class="toc-backref" href="#id264">20.1&nbsp;&nbsp;&nbsp;Présentation</a></h2>
<p>Postfix est un distributeur de courrier.</p>
<p>Il a pour rôle de recevoir le courrier, de le stocker dans la boite mail du destinataire ou de le relayer à un autre serveur de mail si la boite destinataire n'est pas sur sa machine.</p>
</div>
<div class="section" id="id16">
<h2><a class="toc-backref" href="#id265">20.2&nbsp;&nbsp;&nbsp;Installation</a></h2>
<p>Lors de l'installation il faut préciser le nom de host.</p>
</div>
<div class="section" id="id17">
<h2><a class="toc-backref" href="#id266">20.3&nbsp;&nbsp;&nbsp;Configuration</a></h2>
<p>Le fichier de configuration est <em>/etc/postfix/main.cf</em></p>
<p>Selon que le serveur est la destination ou seulement un relai on précisera <em>mydestination</em> ou non.</p>
<p>Exemple pour un serveur destinataire :</p>
<pre class="literal-block">
michaellaunay&#64;monserveur:~$ cat /etc/postfix/main.cf
biff = no
append_dot_mydomain = no
readme_directory = no
smtpd_tls_cert_file=/etc/ssl/certs/ssl-cert-snakeoil.pem
smtpd_tls_key_file=/etc/ssl/private/ssl-cert-snakeoil.key
smtpd_use_tls=yes
smtpd_tls_session_cache_database = btree:${data_directory}/smtpd_scache
smtp_tls_session_cache_database = btree:${data_directory}/smtp_scache
home_mailbox = Maildir/
mail_spool_directory = /var/spool/mail/
myhostname = monserveur.masociete.com
mydomain = masociete.com
myorigin = $mydomain
header_checks = regexp:/etc/postfix/header_checks
alias_maps = hash:/etc/aliases
alias_database = hash:/etc/aliases
relayhost =
mydestination = masociete.org, masociete.com, localhost.localdomain, localhost
unknown_local_recipient_reject_code = 550
mynetworks_style = host
mynetworks = 127.0.0.1, 82.236.252.174
mailbox_size_limit = 4294967296
recipient_delimiter = +
inet_interfaces = all
inet_protocols = all
message_size_limit = 10240000
header_size_limit = 102400
bounce_size_limit = 512000
disable_vrfy_command = yes
smtpd_helo_required = yes
smtpd_banner = $myhostname ESMTP
maps_rbl_domains = relays.ordb.org, sbl.spamhaus.org, list.dsbl.org
smtpd_helo_restrictions = reject_invalid_hostname,  permit
smtpd_sender_restrictions = reject_unknown_sender_domain, reject_non_fqdn_sender, permit
smtpd_client_restrictions = permit_mynetworks, reject_rbl_client, permit
smtpd_recipient_restrictions = permit_mynetworks,
                                permit_sasl_authenticated,
                                reject_unauth_destination,
                                check_policy_service inet:127.0.0.1:60000
</pre>
</div>
</div>
<div class="section" id="mysql">
<h1><a class="toc-backref" href="#id267">21&nbsp;&nbsp;&nbsp;MySQL</a></h1>
<div class="section" id="id18">
<h2><a class="toc-backref" href="#id268">21.1&nbsp;&nbsp;&nbsp;Présentation</a></h2>
<p>MySQL est une base de données légère facile à mettre en œuvre est très utilisées par les sites web.</p>
<p>Sont utilisation est libre mais si les sources de l'application réalisée ne sont pas en GPL, il faut s'acquitter de l'achat d'une licence commerciale.</p>
</div>
<div class="section" id="id19">
<h2><a class="toc-backref" href="#id269">21.2&nbsp;&nbsp;&nbsp;Installation</a></h2>
<p>La commande <strong>apt install mysql-server</strong> permet d'installer le serveur contenant la base de données alors que <strong>apt-get install mysql-client</strong> se contentera d'installer le client.</p>
</div>
<div class="section" id="id20">
<h2><a class="toc-backref" href="#id270">21.3&nbsp;&nbsp;&nbsp;Configuration</a></h2>
<p>A l'installation il est fortement recommandé de donner un mot de passe à l'utilisateur root.</p>
<p>Liens :</p>
<blockquote>
<ul class="simple">
<li><a class="reference external" href="http://www-fr.mysql.com/">http://www-fr.mysql.com/</a></li>
<li><a class="reference external" href="http://fr.wikipedia.org/wiki/Mysql">http://fr.wikipedia.org/wiki/Mysql</a></li>
</ul>
</blockquote>
</div>
</div>
<div class="section" id="id21">
<h1><a class="toc-backref" href="#id271">22&nbsp;&nbsp;&nbsp;Sécurisation</a></h1>
<div class="section" id="certificat-x-509">
<h2><a class="toc-backref" href="#id272">22.1&nbsp;&nbsp;&nbsp;Certificat X 509</a></h2>
<p>Les certificats X 509 sont utilisés à la fois pour l'authentification et pour le chiffrage des infrastructures à clés publiques (PKI) comme par exemple dans le protocole ssl lors des connexion ssh (port 22) ou https (port 443).</p>
<p>Ils sont délivrés par une autorité de certification et son liées à une adresse électronique ou à une entrée DNS.</p>
<p>Si l'autorité de certification est connue du navigateur, la connexion se fera sans alerter l'utilisateur. Dans le cas contraire, il sera prévenu que le site n'est pas de confiance.</p>
<p>Toutefois, il est possible de disposer des avantages du chiffrement sans passer par une autorité <em>de confiance</em>, en utilisant un certificat <em>auto-signé</em> :</p>
<pre class="literal-block">
root&#64;monserveur:~# make-ssl-cert /usr/share/ssl-cert/ssleay.cnf /etc/ssl/apache2/ssl/ssl.monsite.com.pem
root&#64;monserveur:~# vim /etc/apache2/sites-available/ssl.monsite.com
#remove SSLCertificateFile and update SSLCertificateKeyFile with
SSLCertificateKeyFile /etc/apache2/ssl/ssl.monsite.com.pem
root&#64;monserveur:~# service apache2 restart
</pre>
<p>Mais les certificats autosignés ont l'inconvéniant de ne pas avoir d'autorité connue et donc d'être refusé.</p>
<p>Nous pouvons utiliser les service let's encrypt qui poermette d'avoir un</p>
<p>Configuration de Let's Encrypt pour générer nos certificats ssl :</p>
<blockquote>
apt install apache2 #Si ce n'est pas fait, vérifier que le port http est ouvert sur ufw !
apt install certbot
certbot certonly --webroot -w /var/www/html -d URL_De_Mon_Site</blockquote>
<p>Vérification de la génération :</p>
<blockquote>
<dl class="docutils">
<dt><a class="reference external" href="mailto:root&#64;triticale">root&#64;triticale</a>:~# openssl x509 -noout -text -in /etc/letsencrypt/live/URL_De_Mon_Site/fullchain.pem | grep &quot;Not After&quot;</dt>
<dd>Not After : Aug  5 11:25:06 2020 GMT</dd>
</dl>
</blockquote>
<p>Modifier le cron de renouvellement &quot;/etc/cron.d/certbot&quot; et mettre :</p>
<blockquote>
<p>0 <a href="#id22"><span class="problematic" id="id23">*</span></a>/12 * * * root test -x /usr/bin/certbot -a ! -d /run/systemd/system &amp;&amp; perl -e 'sleep int(rand(43200))' &amp;&amp; certbot -q renew --apache</p>
<div class="system-message" id="id22">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">CoursGNULinux.rst</tt>, line 3990); <em><a href="#id23">backlink</a></em></p>
Inline emphasis start-string without end-string.</div>
</blockquote>
<p>Liens :</p>
<blockquote>
<ul class="simple">
<li><a class="reference external" href="http://doc.ubuntu-fr.org/tutoriel/securiser_apache2_avec_ssl">http://doc.ubuntu-fr.org/tutoriel/securiser_apache2_avec_ssl</a></li>
<li><a class="reference external" href="http://fr.wikipedia.org/wiki/X.509">http://fr.wikipedia.org/wiki/X.509</a></li>
</ul>
</blockquote>
</div>
<div class="section" id="postgrey">
<h2><a class="toc-backref" href="#id273">22.2&nbsp;&nbsp;&nbsp;postgrey</a></h2>
<p><strong>postgrey</strong> est un paquet de configuration de <em>postfix</em> permettant de différer la réception des mails des serveurs inconnus.</p>
<p>Le but est d'éliminer les spams, car les serveurs de spams ne prennent pas la peine de renvoyer un courrier dont la réception est différée.</p>
</div>
<div class="section" id="fail2ban">
<h2><a class="toc-backref" href="#id274">22.3&nbsp;&nbsp;&nbsp;fail2ban</a></h2>
<p>Fail2ban est un démon qui permet de modifier les règles du firewall pour bannir pendant un temps déterminé les adresses IP qui ont échoué plusieurs connexions de suite à l'un des services du serveur.</p>
<p>Le temps d'exclusion, le nombre de tentatives tolérées, les adresses non bannies sont configurables via les fichiers /etc/fail2ban/fail2ban.conf et /etc/fail2ban/jail.conf.</p>
<table class="docutils footnote" frame="void" id="id24" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td><a class="reference external" href="http://en.wikipedia.org/wiki/Comparison_of_operating_systems">http://en.wikipedia.org/wiki/Comparison_of_operating_systems</a></td></tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="footer">
<hr class="footer" />
<strong>###Title###</strong> <em>Page : ###Page###</em>
</div>
</body>
</html>
